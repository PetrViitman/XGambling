var Cb=Object.defineProperty;var Mb=(s,t,e)=>t in s?Cb(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Y=(s,t,e)=>(Mb(s,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();var Zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ig(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Ib(s){if(s.__esModule)return s;var t=s.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return s[n]}})}),e}var Rb={exports:{}};/*!
 * PEP v0.5.1 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */(function(s,t){(function(e,n){s.exports=n()})(Zr,function(){var e=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function i(S,M){M=M||Object.create(null);var B=document.createEvent("Event");B.initEvent(S,M.bubbles||!1,M.cancelable||!1);for(var J=2,dt;J<e.length;J++)dt=e[J],B[dt]=M[dt]||n[J];B.buttons=M.buttons||0;var xt=0;return M.pressure!==void 0&&B.buttons?xt=M.pressure:xt=B.buttons?.5:0,B.x=B.clientX,B.y=B.clientY,B.pointerId=M.pointerId||0,B.width=M.width||1,B.height=M.height||1,B.pressure=xt,B.tiltX=M.tiltX||0,B.tiltY=M.tiltY||0,B.twist=M.twist||0,B.tangentialPressure=M.tangentialPressure||0,B.pointerType=M.pointerType||"",B.hwTimestamp=M.hwTimestamp||0,B.isPrimary=M.isPrimary||!1,B.detail=0,B}var r=window.Map&&window.Map.prototype.forEach,a=r?Map:l;function l(){this.array=[],this.size=0}l.prototype={set:function(S,M){if(M===void 0)return this.delete(S);this.has(S)||this.size++,this.array[S]=M},has:function(S){return this.array[S]!==void 0},delete:function(S){this.has(S)&&(delete this.array[S],this.size--)},get:function(S){return this.array[S]},clear:function(){this.array.length=0,this.size=0},forEach:function(S,M){return this.array.forEach(function(B,J){S.call(M,B,J,this)},this)}};var o=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],h=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],c={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},d=typeof SVGElementInstance<"u",u={pointermap:new a,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(S,M){var B=M,J=B.events;J&&(J.forEach(function(dt){B[dt]&&(this.eventMap[dt]=B[dt].bind(B))},this),this.eventSources[S]=B,this.eventSourceList.push(B))},register:function(S){for(var M=this.eventSourceList.length,B=0,J;B<M&&(J=this.eventSourceList[B]);B++)J.register.call(J,S)},unregister:function(S){for(var M=this.eventSourceList.length,B=0,J;B<M&&(J=this.eventSourceList[B]);B++)J.unregister.call(J,S)},contains:function(S,M){try{return S.contains(M)}catch{return!1}},down:function(S){S.bubbles=!0,this.fireEvent("pointerdown",S)},move:function(S){S.bubbles=!0,this.fireEvent("pointermove",S)},up:function(S){S.bubbles=!0,this.fireEvent("pointerup",S)},enter:function(S){S.bubbles=!1,this.fireEvent("pointerenter",S)},leave:function(S){S.bubbles=!1,this.fireEvent("pointerleave",S)},over:function(S){S.bubbles=!0,this.fireEvent("pointerover",S)},out:function(S){S.bubbles=!0,this.fireEvent("pointerout",S)},cancel:function(S){S.bubbles=!0,this.fireEvent("pointercancel",S)},leaveOut:function(S){this.out(S),this.propagate(S,this.leave,!1)},enterOver:function(S){this.over(S),this.propagate(S,this.enter,!0)},eventHandler:function(S){if(!S._handledByPE){var M=S.type,B=this.eventMap&&this.eventMap[M];B&&B(S),S._handledByPE=!0}},listen:function(S,M){M.forEach(function(B){this.addEvent(S,B)},this)},unlisten:function(S,M){M.forEach(function(B){this.removeEvent(S,B)},this)},addEvent:function(S,M){S.addEventListener(M,this.boundHandler)},removeEvent:function(S,M){S.removeEventListener(M,this.boundHandler)},makeEvent:function(S,M){this.captureInfo[M.pointerId]&&(M.relatedTarget=null);var B=new i(S,M);return M.preventDefault&&(B.preventDefault=M.preventDefault),B._target=B._target||M.target,B},fireEvent:function(S,M){var B=this.makeEvent(S,M);return this.dispatchEvent(B)},cloneEvent:function(S){for(var M=Object.create(null),B,J=0;J<o.length;J++)B=o[J],M[B]=S[B]||h[J],d&&(B==="target"||B==="relatedTarget")&&M[B]instanceof SVGElementInstance&&(M[B]=M[B].correspondingUseElement);return S.preventDefault&&(M.preventDefault=function(){S.preventDefault()}),M},getTarget:function(S){var M=this.captureInfo[S.pointerId];if(!M)return S._target;if(S._target===M||!(S.type in c))return M},propagate:function(S,M,B){for(var J=S.target,dt=[];J!=null&&J!==document&&!J.contains(S.relatedTarget);)if(dt.push(J),J=J.parentNode,!J)return;B&&dt.reverse(),dt.forEach(function(xt){S.target=xt,M.call(this,S)},this)},setCapture:function(S,M,B){this.captureInfo[S]&&this.releaseCapture(S,B),this.captureInfo[S]=M,this.implicitRelease=this.releaseCapture.bind(this,S,B),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var J=new i("gotpointercapture",{bubbles:!0});J.pointerId=S,J._target=M,B||this.asyncDispatchEvent(J)},releaseCapture:function(S,M){var B=this.captureInfo[S];if(B){this.captureInfo[S]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var J=new i("lostpointercapture",{bubbles:!0});J.pointerId=S,J._target=B,M||this.asyncDispatchEvent(J)}},dispatchEvent:function(S){var M=this.getTarget(S);if(M)return M.dispatchEvent(S)},asyncDispatchEvent:function(S){requestAnimationFrame(this.dispatchEvent.bind(this,S))}};u.boundHandler=u.eventHandler.bind(u);var f={shadow:function(S){if(S)return S.shadowRoot||S.webkitShadowRoot},canTarget:function(S){return S&&!!S.elementFromPoint},targetingShadow:function(S){var M=this.shadow(S);if(this.canTarget(M))return M},olderShadow:function(S){var M=S.olderShadowRoot;if(!M){var B=S.querySelector("shadow");B&&(M=B.olderShadowRoot)}return M},allShadows:function(S){for(var M=[],B=this.shadow(S);B;)M.push(B),B=this.olderShadow(B);return M},searchRoot:function(S,M,B){if(S){var J=S.elementFromPoint(M,B),dt,xt;for(xt=this.targetingShadow(J);xt;)if(dt=xt.elementFromPoint(M,B),!dt)xt=this.olderShadow(xt);else{var Zt=this.targetingShadow(dt);return this.searchRoot(Zt,M,B)||dt}return J}},owner:function(S){for(var M=S;M.parentNode;)M=M.parentNode;return M.nodeType!==Node.DOCUMENT_NODE&&M.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(M=document),M},findTarget:function(S){var M=S.clientX,B=S.clientY,J=this.owner(S.target);return J.elementFromPoint(M,B)||(J=document),this.searchRoot(J,M,B)}},m=Array.prototype.forEach.call.bind(Array.prototype.forEach),p=Array.prototype.map.call.bind(Array.prototype.map),g=Array.prototype.slice.call.bind(Array.prototype.slice),v=Array.prototype.filter.call.bind(Array.prototype.filter),b=window.MutationObserver||window.WebKitMutationObserver,x="[touch-action]",y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function w(S,M,B,J){this.addCallback=S.bind(J),this.removeCallback=M.bind(J),this.changedCallback=B.bind(J),b&&(this.observer=new b(this.mutationWatcher.bind(this)))}w.prototype={watchSubtree:function(S){this.observer&&f.canTarget(S)&&this.observer.observe(S,y)},enableOnSubtree:function(S){this.watchSubtree(S),S===document&&document.readyState!=="complete"?this.installOnLoad():this.installNewSubtree(S)},installNewSubtree:function(S){m(this.findElements(S),this.addElement,this)},findElements:function(S){return S.querySelectorAll?S.querySelectorAll(x):[]},removeElement:function(S){this.removeCallback(S)},addElement:function(S){this.addCallback(S)},elementChanged:function(S,M){this.changedCallback(S,M)},concatLists:function(S,M){return S.concat(g(M))},installOnLoad:function(){document.addEventListener("readystatechange",(function(){document.readyState==="complete"&&this.installNewSubtree(document)}).bind(this))},isElement:function(S){return S.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(S){var M=p(S,this.findElements,this);return M.push(v(S,this.isElement)),M.reduce(this.concatLists,[])},mutationWatcher:function(S){S.forEach(this.mutationHandler,this)},mutationHandler:function(S){if(S.type==="childList"){var M=this.flattenMutationTree(S.addedNodes);M.forEach(this.addElement,this);var B=this.flattenMutationTree(S.removedNodes);B.forEach(this.removeElement,this)}else S.type==="attributes"&&this.elementChanged(S.target,S.oldValue)}};function _(S){return"body /shadow-deep/ "+S}function E(S){return"{ -ms-touch-action: "+S+"; touch-action: "+S+"; }"}var T=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],C="",R=window.PointerEvent||window.MSPointerEvent,P=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;function O(){if(R){T.forEach(function(M){C+=M.selector+E(M.value)+`
`,P&&(C+=_(M.selector)+E(M.value)+`
`)});var S=document.createElement("style");S.textContent=C,document.head.appendChild(S)}}var F=u.pointermap,D=25,V=[1,4,2,8,16],X=!1;try{X=new MouseEvent("test",{buttons:1}).buttons===1}catch{}var U={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(S){u.listen(S,this.events)},unregister:function(S){u.unlisten(S,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(S){for(var M=this.lastTouches,B=S.clientX,J=S.clientY,dt=0,xt=M.length,Zt;dt<xt&&(Zt=M[dt]);dt++){var Jt=Math.abs(B-Zt.x),ss=Math.abs(J-Zt.y);if(Jt<=D&&ss<=D)return!0}},prepareEvent:function(S){var M=u.cloneEvent(S),B=M.preventDefault;return M.preventDefault=function(){S.preventDefault(),B()},M.pointerId=this.POINTER_ID,M.isPrimary=!0,M.pointerType=this.POINTER_TYPE,"webkitForce"in S&&(M.pressure=S.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),M},prepareButtonsForMove:function(S,M){var B=F.get(this.POINTER_ID);M.which===0||!B?S.buttons=0:S.buttons=B.buttons,M.buttons=S.buttons},mousedown:function(S){if(!this.isEventSimulatedFromTouch(S)){var M=F.get(this.POINTER_ID),B=this.prepareEvent(S);X||(B.buttons=V[B.button],M&&(B.buttons|=M.buttons),S.buttons=B.buttons),F.set(this.POINTER_ID,S),!M||M.buttons===0?u.down(B):u.move(B)}},webkitmouseforcechanged:function(S){this.mousemove(S)},mousemove:function(S){if(!this.isEventSimulatedFromTouch(S)){var M=this.prepareEvent(S);X||this.prepareButtonsForMove(M,S),M.button=-1,F.set(this.POINTER_ID,S),u.move(M)}},mouseup:function(S){if(!this.isEventSimulatedFromTouch(S)){var M=F.get(this.POINTER_ID),B=this.prepareEvent(S);if(!X){var J=V[B.button];B.buttons=M?M.buttons&~J:0,S.buttons=B.buttons}F.set(this.POINTER_ID,S),B.buttons&=~V[B.button],B.buttons===0?u.up(B):u.move(B)}},mouseover:function(S){if(!this.isEventSimulatedFromTouch(S)){var M=this.prepareEvent(S);X||this.prepareButtonsForMove(M,S),M.button=-1,F.set(this.POINTER_ID,S),u.enterOver(M)}},mouseout:function(S){if(!this.isEventSimulatedFromTouch(S)){var M=this.prepareEvent(S);X||this.prepareButtonsForMove(M,S),M.button=-1,u.leaveOut(M)}},cancel:function(S){var M=this.prepareEvent(S);u.cancel(M),this.deactivateMouse()},deactivateMouse:function(){F.delete(this.POINTER_ID)}},j=u.captureInfo,z=f.findTarget.bind(f),N=f.allShadows.bind(f),G=u.pointermap,q=2500,K="touch-action",Q,tt=1,ht=2,vt=4,At=8,_t=tt|ht|vt|At,Et={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(S){Q.enableOnSubtree(S)},unregister:function(){},elementAdded:function(S){var M=S.getAttribute(K),B=this.touchActionToScrollType(M);typeof B=="number"&&(S._scrollType=B,u.listen(S,this.events),N(S).forEach(function(J){J._scrollType=B,u.listen(J,this.events)},this))},elementRemoved:function(S){if(G.size>0){var M=this.events;S.addEventListener("touchend",function(){S._scrollType=void 0,u.unlisten(S,M)})}else S._scrollType=void 0,u.unlisten(S,this.events);N(S).forEach(function(B){B._scrollType=void 0,u.unlisten(B,this.events)},this)},elementChanged:function(S,M){var B=S.getAttribute(K),J=this.touchActionToScrollType(B),dt=this.touchActionToScrollType(M);typeof J=="number"&&typeof dt=="number"?(S._scrollType=J,N(S).forEach(function(xt){xt._scrollType=J},this)):typeof dt=="number"?this.elementRemoved(S):typeof J=="number"&&this.elementAdded(S)},scrollTypes:{UP:function(S){return S.includes("pan-y")||S.includes("pan-up")?tt:0},DOWN:function(S){return S.includes("pan-y")||S.includes("pan-down")?ht:0},LEFT:function(S){return S.includes("pan-x")||S.includes("pan-left")?vt:0},RIGHT:function(S){return S.includes("pan-x")||S.includes("pan-right")?At:0}},touchActionToScrollType:function(S){if(S){if(S==="auto")return _t;if(S==="none")return 0;var M=S.split(" "),B=this.scrollTypes;return B.UP(M)|B.DOWN(M)|B.LEFT(M)|B.RIGHT(M)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(S){return this.firstTouch===S.identifier},setPrimaryTouch:function(S){(G.size===0||G.size===1&&G.has(1))&&(this.firstTouch=S.identifier,this.firstXY={X:S.clientX,Y:S.clientY},this.scrolling=!1)},removePrimaryPointer:function(S){S.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(S){var M=0;return(S==="touchstart"||S==="touchmove"||S==="touchforcechange")&&(M=1),M},touchToPointer:function(S){var M=this.currentTouchEvent,B=u.cloneEvent(S),J=B.pointerId=S.identifier+2;if(B.target=j[J]||z(B),B.bubbles=!0,B.cancelable=!0,B.button=0,B.buttons=this.typeToButtons(M.type),B.width=(S.radiusX||S.webkitRadiusX||0)*2,B.height=(S.radiusY||S.webkitRadiusY||0)*2,B.pressure=S.force!==void 0?S.force:S.webkitForce!==void 0?S.webkitForce:void 0,B.isPrimary=this.isPrimaryTouch(S),S.altitudeAngle){var dt=Math.tan(S.altitudeAngle),xt=180/Math.PI;B.tiltX=Math.atan(Math.cos(S.azimuthAngle)/dt)*xt,B.tiltY=Math.atan(Math.sin(S.azimuthAngle)/dt)*xt}else B.tiltX=0,B.tiltY=0;S.touchType==="stylus"?B.pointerType="pen":B.pointerType=this.POINTER_TYPE,B.altKey=M.altKey,B.ctrlKey=M.ctrlKey,B.metaKey=M.metaKey,B.shiftKey=M.shiftKey;var Zt=this;return B.preventDefault=function(){Zt.scrolling=!1,Zt.firstXY=null,M.preventDefault()},B},processTouches:function(S,M){var B=S.changedTouches;this.currentTouchEvent=S;for(var J=0,dt;J<B.length;J++)dt=B[J],M.call(this,this.touchToPointer(dt))},shouldScroll:function(S){if(this.firstXY){var M,B=S.currentTarget._scrollType;if(B===0)M=!1;else if(B===_t)M=!0;else{var J=S.changedTouches[0],dt=J.clientY-this.firstXY.Y,xt=Math.abs(dt),Zt=J.clientX-this.firstXY.X,Jt=Math.abs(Zt),ss=B&tt,ns=B&ht,Si=B&vt,Mo=B&At;Si&&Mo?M=Jt>xt:Si?M=Jt>xt&&Zt>0:Mo&&(M=Jt>xt&&Zt<0),M||(ss&&ns?M=Jt<xt:ss?M=Jt<xt&&dt>0:ns&&(M=Jt<xt&&dt<0))}return this.firstXY=null,M}},findTouch:function(S,M){for(var B=0,J=S.length,dt;B<J&&(dt=S[B]);B++)if(dt.identifier===M)return!0},vacuumTouches:function(S){var M=S.touches;if(G.size>=M.length){var B=[];G.forEach(function(J,dt){if(dt!==1&&!this.findTouch(M,dt-2)){var xt=J.out;B.push(xt)}},this),B.forEach(this.cancelOut,this)}},touchstart:function(S){this.vacuumTouches(S),this.setPrimaryTouch(S.changedTouches[0]),this.dedupSynthMouse(S),this.scrolling||this.processTouches(S,this.overDown)},overDown:function(S){G.set(S.pointerId,{target:S.target,out:S,outTarget:S.target}),u.enterOver(S),u.down(S)},touchforcechange:function(S){this.touchmove(S)},touchmove:function(S){this.scrolling||(this.shouldScroll(S)?(this.scrolling=!0,this.touchcancel(S)):(S.type!=="touchforcechange"&&S.preventDefault(),this.processTouches(S,this.moveOverOut)))},moveOverOut:function(S){var M=S,B=G.get(M.pointerId);if(B){var J=B.out,dt=B.outTarget;u.move(M),J&&dt!==M.target&&(J.relatedTarget=M.target,M.relatedTarget=dt,J.target=dt,M.target?(u.leaveOut(J),u.enterOver(M)):(M.target=dt,M.relatedTarget=null,this.cancelOut(M))),B.out=M,B.outTarget=M.target}},touchend:function(S){this.dedupSynthMouse(S),this.processTouches(S,this.upOut)},upOut:function(S){this.scrolling||(u.up(S),u.leaveOut(S)),this.cleanUpPointer(S)},touchcancel:function(S){this.processTouches(S,this.cancelOut)},cancelOut:function(S){u.cancel(S),u.leaveOut(S),this.cleanUpPointer(S)},cleanUpPointer:function(S){G.delete(S.pointerId),this.removePrimaryPointer(S)},dedupSynthMouse:function(S){var M=U.lastTouches,B=S.changedTouches[0];if(this.isPrimaryTouch(B)){var J={x:B.clientX,y:B.clientY};M.push(J);var dt=(function(xt,Zt){var Jt=xt.indexOf(Zt);Jt>-1&&xt.splice(Jt,1)}).bind(null,M,J);setTimeout(dt,q)}}};Q=new w(Et.elementAdded,Et.elementRemoved,Et.elementChanged,Et);var St=u.pointermap,Ot=window.MSPointerEvent&&typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE=="number",k={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(S){u.listen(S,this.events)},unregister:function(S){u.unlisten(S,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(S){var M=S;return Ot&&(M=u.cloneEvent(S),M.pointerType=this.POINTER_TYPES[S.pointerType]),M},cleanup:function(S){St.delete(S)},MSPointerDown:function(S){St.set(S.pointerId,S);var M=this.prepareEvent(S);u.down(M)},MSPointerMove:function(S){var M=this.prepareEvent(S);u.move(M)},MSPointerUp:function(S){var M=this.prepareEvent(S);u.up(M),this.cleanup(S.pointerId)},MSPointerOut:function(S){var M=this.prepareEvent(S);u.leaveOut(M)},MSPointerOver:function(S){var M=this.prepareEvent(S);u.enterOver(M)},MSPointerCancel:function(S){var M=this.prepareEvent(S);u.cancel(M),this.cleanup(S.pointerId)},MSLostPointerCapture:function(S){var M=u.makeEvent("lostpointercapture",S);u.dispatchEvent(M)},MSGotPointerCapture:function(S){var M=u.makeEvent("gotpointercapture",S);u.dispatchEvent(M)}};function L(){if(!window.PointerEvent){if(window.PointerEvent=i,window.navigator.msPointerEnabled){var S=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:S,enumerable:!0}),u.registerSource("ms",k)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",U),window.ontouchstart!==void 0&&u.registerSource("touch",Et);u.register(document)}}var H=window.navigator,et,Z,st;function rt(S){if(!u.pointermap.has(S)){var M=new Error("NotFoundError");throw M.name="NotFoundError",M}}function it(S){for(var M=S.parentNode;M&&M!==S.ownerDocument;)M=M.parentNode;if(!M){var B=new Error("InvalidStateError");throw B.name="InvalidStateError",B}}function ot(S){var M=u.pointermap.get(S);return M.buttons!==0}H.msPointerEnabled?(et=function(S){rt(S),it(this),ot(S)&&(u.setCapture(S,this,!0),this.msSetPointerCapture(S))},Z=function(S){rt(S),u.releaseCapture(S,!0),this.msReleasePointerCapture(S)}):(et=function(M){rt(M),it(this),ot(M)&&u.setCapture(M,this)},Z=function(M){rt(M),u.releaseCapture(M)}),st=function(M){return!!u.captureInfo[M]};function nt(){window.Element&&!window.Element.prototype.setPointerCapture&&Object.defineProperties(window.Element.prototype,{setPointerCapture:{value:et},releasePointerCapture:{value:Z},hasPointerCapture:{value:st}})}O(),L(),nt();var gt={dispatcher:u,Installer:w,PointerEvent:i,PointerMap:a,targetFinding:f};return gt})})(Rb);const Pb={OUT_OF_BALANCE:200};class kb{constructor(t){Y(this,"payout");Y(this,"coefficients");Y(this,"betsOptions",[]);Y(this,"balance",0);Y(this,"currencyCode","");Y(this,"betIndex");Y(this,"webAPI");let{webAPI:e,presentation:n}=t;this.webAPI=e,this.presentation=n}async init(){var r,a;const{coefficients:t,betsOptions:e,balance:n,currencyCode:i}=await this.webAPI.gameDescription();this.coefficients=t,this.balance=n,this.currencyCode=i,this.betsOptions=e,this.betIndex=0,await((a=(r=this.presentation)==null?void 0:r.init)==null?void 0:a.call(r,{currencyCode:i,betsOptions:e,betIndex:this.betIndex,balance:n,coefficients:t})),this.idle()}async error(t){var i,r,a,l;let{errorCode:e,isFatal:n=!1}=t;this.payout=0,(r=(i=this.presentation)==null?void 0:i.presentError)==null||r.call(i,e),await((l=(a=this.presentation)==null?void 0:a.presentSpinStop)==null?void 0:l.call(a)),n||this.idle()}changeBet(t){this.betIndex=t,this.idle()}async makeBet(t){var m,p,g,v,b,x,y;let{betIndex:e=this.betIndex,desiredReels:n}=t;const{presentation:i}=this,r=this.betsOptions[e],a=this.balance-r;if(this.balance<r)return this.error({errorCode:Pb.OUT_OF_BALANCE});await((m=i==null?void 0:i.presentSpinStart)==null?void 0:m.call(i,{balance:a}));const{errorCode:l,balance:o,currencyCode:h,steps:c,totalCoefficient:d,totalPayout:u}=await this.webAPI.makeBet({desiredReels:n,bet:r});if(this.balance=o??this.balance,l)return this.error({errorCode:l});let f=0;for(let w=0;w<c.length;w++){const _=c[w],{reels:E,collapses:T,reelsPatch:C}=_;!!E&&(w&&await((p=i==null?void 0:i.presentSpinStart)==null?void 0:p.call(i,{balance:a,commonPayout:f,currencyCode:h})),await((g=i==null?void 0:i.presentSpinStop)==null?void 0:g.call(i,E)));const P=_.payout??0,O=_.coefficient??1;f+=P,P?await((v=i==null?void 0:i.presentWin)==null?void 0:v.call(i,{coefficient:O,payout:P,commonPayout:f,currencyCode:h})):await((b=i==null?void 0:i.presentLose)==null?void 0:b.call(i)),C&&await Promise.all([(x=i==null?void 0:i.presentCascade)==null?void 0:x.call(i,{collapses:T,patchMap:C})])}u&&await((y=i==null?void 0:i.presentTotalWin)==null?void 0:y.call(i,{totalCoefficient:d,totalPayout:u,currencyCode:h})),this.payout=u,this.idle()}makeCheatBet(t){let{reels:e,riskOption:n,specialSymbolId:i}=t;return this.makeBet({desiredReels:e,riskOption:n,specialSymbolId:i})}async idle(){var c;const{betIndex:t,balance:e,currencyCode:n,presentation:i,betsOptions:r,payout:a}=this,{key:l,value:o}=await((c=i==null?void 0:i.getUserInput)==null?void 0:c.call(i,{betsOptions:r,betIndex:t,bet:r[t],balance:e,currencyCode:n,payout:a}))??{},h={change_bet:d=>{this.changeBet(d)},make_bet:()=>{this.makeBet({})},make_cheat_bet:d=>{let{reels:u,riskOption:f,specialSymbolId:m}=d;this.makeCheatBet({reels:u,riskOption:f,specialSymbolId:m})},idle:()=>{this.idle()}};if(!h[l])return this.error({errorCode:"Fatal Error, unknown user input",isFatal:!0});h[l](o)}}var Cr=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(Cr||{}),Rg=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.WEBGL=1]="WEBGL",s[s.CANVAS=2]="CANVAS",s))(Rg||{}),Zc=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(Zc||{}),ft=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(ft||{}),En=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(En||{}),lt=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(lt||{}),Jr=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(Jr||{}),wt=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(wt||{}),Jc=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(Jc||{}),Os=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(Os||{}),Li=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(Li||{}),tn=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(tn||{}),sn=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(sn||{}),Hn=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(Hn||{}),ld=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(ld||{}),Hs=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(Hs||{}),Fe=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(Fe||{}),Ie=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(Ie||{}),qn=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(qn||{});const Fb={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},ct={ADAPTER:Fb,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Gh=/iPhone/i,sm=/iPod/i,nm=/iPad/i,im=/\biOS-universal(?:.+)Mac\b/i,Wh=/\bAndroid(?:.+)Mobile\b/i,rm=/Android/i,Pr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ka=/Silk/i,ti=/Windows Phone/i,om=/\bWindows(?:.+)ARM\b/i,am=/BlackBerry/i,lm=/BB10/i,hm=/Opera Mini/i,cm=/\b(CriOS|Chrome)(?:.+)Mobile/i,um=/Mobile(?:.+)Firefox\b/i,dm=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function Db(s){return function(t){return t.test(s)}}function fm(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,n=e.split("[FBAN");typeof n[1]<"u"&&(e=n[0]),n=e.split("Twitter"),typeof n[1]<"u"&&(e=n[0]);var i=Db(e),r={apple:{phone:i(Gh)&&!i(ti),ipod:i(sm),tablet:!i(Gh)&&(i(nm)||dm(t))&&!i(ti),universal:i(im),device:(i(Gh)||i(sm)||i(nm)||i(im)||dm(t))&&!i(ti)},amazon:{phone:i(Pr),tablet:!i(Pr)&&i(ka),device:i(Pr)||i(ka)},android:{phone:!i(ti)&&i(Pr)||!i(ti)&&i(Wh),tablet:!i(ti)&&!i(Pr)&&!i(Wh)&&(i(ka)||i(rm)),device:!i(ti)&&(i(Pr)||i(ka)||i(Wh)||i(rm))||i(/\bokhttp\b/i)},windows:{phone:i(ti),tablet:i(om),device:i(ti)||i(om)},other:{blackberry:i(am),blackberry10:i(lm),opera:i(hm),firefox:i(um),chrome:i(cm),device:i(am)||i(lm)||i(hm)||i(um)||i(cm)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const Bb=fm.default??fm,mi=Bb(globalThis.navigator);ct.RETINA_PREFIX=/@([0-9\.]+)x/;ct.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Pg={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(o,h,c){this.fn=o,this.context=h,this.once=c||!1}function r(o,h,c,d,u){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,d||o,u),m=e?e+h:h;return o._events[m]?o._events[m].fn?o._events[m]=[o._events[m],f]:o._events[m].push(f):(o._events[m]=f,o._eventsCount++),o}function a(o,h){--o._eventsCount===0?o._events=new n:delete o._events[h]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],c,d;if(this._eventsCount===0)return h;for(d in c=this._events)t.call(c,d)&&h.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},l.prototype.listeners=function(h){var c=e?e+h:h,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var u=0,f=d.length,m=new Array(f);u<f;u++)m[u]=d[u].fn;return m},l.prototype.listenerCount=function(h){var c=e?e+h:h,d=this._events[c];return d?d.fn?1:d.length:0},l.prototype.emit=function(h,c,d,u,f,m){var p=e?e+h:h;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,b,x;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,d),!0;case 4:return g.fn.call(g.context,c,d,u),!0;case 5:return g.fn.call(g.context,c,d,u,f),!0;case 6:return g.fn.call(g.context,c,d,u,f,m),!0}for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];g.fn.apply(g.context,b)}else{var y=g.length,w;for(x=0;x<y;x++)switch(g[x].once&&this.removeListener(h,g[x].fn,void 0,!0),v){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,c);break;case 3:g[x].fn.call(g[x].context,c,d);break;case 4:g[x].fn.call(g[x].context,c,d,u);break;default:if(!b)for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];g[x].fn.apply(g[x].context,b)}}return!0},l.prototype.on=function(h,c,d){return r(this,h,c,d,!1)},l.prototype.once=function(h,c,d){return r(this,h,c,d,!0)},l.prototype.removeListener=function(h,c,d,u){var f=e?e+h:h;if(!this._events[f])return this;if(!c)return a(this,f),this;var m=this._events[f];if(m.fn)m.fn===c&&(!u||m.once)&&(!d||m.context===d)&&a(this,f);else{for(var p=0,g=[],v=m.length;p<v;p++)(m[p].fn!==c||u&&!m[p].once||d&&m[p].context!==d)&&g.push(m[p]);g.length?this._events[f]=g.length===1?g[0]:g:a(this,f)}return this},l.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,s.exports=l})(Pg);var Ob=Pg.exports;const _a=Ig(Ob);var hd={exports:{}};hd.exports=Ql;hd.exports.default=Ql;function Ql(s,t,e){e=e||2;var n=t&&t.length,i=n?t[0]*e:s.length,r=kg(s,0,i,e,!0),a=[];if(!r||r.next===r.prev)return a;var l,o,h,c,d,u,f;if(n&&(r=Xb(s,t,r,e)),s.length>80*e){l=h=s[0],o=c=s[1];for(var m=e;m<i;m+=e)d=s[m],u=s[m+1],d<l&&(l=d),u<o&&(o=u),d>h&&(h=d),u>c&&(c=u);f=Math.max(h-l,c-o),f=f!==0?32767/f:0}return oa(r,a,e,l,o,f,0),a}function kg(s,t,e,n,i){var r,a;if(i===eu(s,t,e,n)>0)for(r=t;r<e;r+=n)a=mm(r,s[r],s[r+1],a);else for(r=e-n;r>=t;r-=n)a=mm(r,s[r],s[r+1],a);return a&&th(a,a.next)&&(la(a),a=a.next),a}function br(s,t){if(!s)return s;t||(t=s);var e=s,n;do if(n=!1,!e.steiner&&(th(e,e.next)||de(e.prev,e,e.next)===0)){if(la(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function oa(s,t,e,n,i,r,a){if(s){!a&&r&&Hb(s,n,i,r);for(var l=s,o,h;s.prev!==s.next;){if(o=s.prev,h=s.next,r?Lb(s,n,i,r):Nb(s)){t.push(o.i/e|0),t.push(s.i/e|0),t.push(h.i/e|0),la(s),s=h.next,l=h.next;continue}if(s=h,s===l){a?a===1?(s=Vb(br(s),t,e),oa(s,t,e,n,i,r,2)):a===2&&Ub(s,t,e,n,i,r):oa(br(s),t,e,n,i,r,1);break}}}}function Nb(s){var t=s.prev,e=s,n=s.next;if(de(t,e,n)>=0)return!1;for(var i=t.x,r=e.x,a=n.x,l=t.y,o=e.y,h=n.y,c=i<r?i<a?i:a:r<a?r:a,d=l<o?l<h?l:h:o<h?o:h,u=i>r?i>a?i:a:r>a?r:a,f=l>o?l>h?l:h:o>h?o:h,m=n.next;m!==t;){if(m.x>=c&&m.x<=u&&m.y>=d&&m.y<=f&&zr(i,l,r,o,a,h,m.x,m.y)&&de(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Lb(s,t,e,n){var i=s.prev,r=s,a=s.next;if(de(i,r,a)>=0)return!1;for(var l=i.x,o=r.x,h=a.x,c=i.y,d=r.y,u=a.y,f=l<o?l<h?l:h:o<h?o:h,m=c<d?c<u?c:u:d<u?d:u,p=l>o?l>h?l:h:o>h?o:h,g=c>d?c>u?c:u:d>u?d:u,v=Qc(f,m,t,e,n),b=Qc(p,g,t,e,n),x=s.prevZ,y=s.nextZ;x&&x.z>=v&&y&&y.z<=b;){if(x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==i&&x!==a&&zr(l,c,o,d,h,u,x.x,x.y)&&de(x.prev,x,x.next)>=0||(x=x.prevZ,y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==i&&y!==a&&zr(l,c,o,d,h,u,y.x,y.y)&&de(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==i&&x!==a&&zr(l,c,o,d,h,u,x.x,x.y)&&de(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;y&&y.z<=b;){if(y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==i&&y!==a&&zr(l,c,o,d,h,u,y.x,y.y)&&de(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function Vb(s,t,e){var n=s;do{var i=n.prev,r=n.next.next;!th(i,r)&&Fg(i,n,n.next,r)&&aa(i,r)&&aa(r,i)&&(t.push(i.i/e|0),t.push(n.i/e|0),t.push(r.i/e|0),la(n),la(n.next),n=s=r),n=n.next}while(n!==s);return br(n)}function Ub(s,t,e,n,i,r){var a=s;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&qb(a,l)){var o=Dg(a,l);a=br(a,a.next),o=br(o,o.next),oa(a,t,e,n,i,r,0),oa(o,t,e,n,i,r,0);return}l=l.next}a=a.next}while(a!==s)}function Xb(s,t,e,n){var i=[],r,a,l,o,h;for(r=0,a=t.length;r<a;r++)l=t[r]*n,o=r<a-1?t[r+1]*n:s.length,h=kg(s,l,o,n,!1),h===h.next&&(h.steiner=!0),i.push(jb(h));for(i.sort(Yb),r=0;r<i.length;r++)e=$b(i[r],e);return e}function Yb(s,t){return s.x-t.x}function $b(s,t){var e=Gb(s,t);if(!e)return t;var n=Dg(e,s);return br(n,n.next),br(e,e.next)}function Gb(s,t){var e=t,n=s.x,i=s.y,r=-1/0,a;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var l=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=n&&l>r&&(r=l,a=e.x<e.next.x?e:e.next,l===n))return a}e=e.next}while(e!==t);if(!a)return null;var o=a,h=a.x,c=a.y,d=1/0,u;e=a;do n>=e.x&&e.x>=h&&n!==e.x&&zr(i<c?n:r,i,h,c,i<c?r:n,i,e.x,e.y)&&(u=Math.abs(i-e.y)/(n-e.x),aa(e,s)&&(u<d||u===d&&(e.x>a.x||e.x===a.x&&Wb(a,e)))&&(a=e,d=u)),e=e.next;while(e!==o);return a}function Wb(s,t){return de(s.prev,s,t.prev)<0&&de(t.next,s,s.next)<0}function Hb(s,t,e,n){var i=s;do i.z===0&&(i.z=Qc(i.x,i.y,t,e,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,zb(i)}function zb(s){var t,e,n,i,r,a,l,o,h=1;do{for(e=s,s=null,r=null,a=0;e;){for(a++,n=e,l=0,t=0;t<h&&(l++,n=n.nextZ,!!n);t++);for(o=h;l>0||o>0&&n;)l!==0&&(o===0||!n||e.z<=n.z)?(i=e,e=e.nextZ,l--):(i=n,n=n.nextZ,o--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;e=n}r.nextZ=null,h*=2}while(a>1);return s}function Qc(s,t,e,n,i){return s=(s-e)*i|0,t=(t-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function jb(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function zr(s,t,e,n,i,r,a,l){return(i-a)*(t-l)>=(s-a)*(r-l)&&(s-a)*(n-l)>=(e-a)*(t-l)&&(e-a)*(r-l)>=(i-a)*(n-l)}function qb(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Kb(s,t)&&(aa(s,t)&&aa(t,s)&&Zb(s,t)&&(de(s.prev,s,t.prev)||de(s,t.prev,t))||th(s,t)&&de(s.prev,s,s.next)>0&&de(t.prev,t,t.next)>0)}function de(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function th(s,t){return s.x===t.x&&s.y===t.y}function Fg(s,t,e,n){var i=Da(de(s,t,e)),r=Da(de(s,t,n)),a=Da(de(e,n,s)),l=Da(de(e,n,t));return!!(i!==r&&a!==l||i===0&&Fa(s,e,t)||r===0&&Fa(s,n,t)||a===0&&Fa(e,s,n)||l===0&&Fa(e,t,n))}function Fa(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Da(s){return s>0?1:s<0?-1:0}function Kb(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&Fg(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function aa(s,t){return de(s.prev,s,s.next)<0?de(s,t,s.next)>=0&&de(s,s.prev,t)>=0:de(s,t,s.prev)<0||de(s,s.next,t)<0}function Zb(s,t){var e=s,n=!1,i=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&i<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==s);return n}function Dg(s,t){var e=new tu(s.i,s.x,s.y),n=new tu(t.i,t.x,t.y),i=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=i,i.prev=e,n.next=e,e.prev=n,r.next=n,n.prev=r,n}function mm(s,t,e,n){var i=new tu(s,t,e);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function la(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function tu(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ql.deviation=function(s,t,e,n){var i=t&&t.length,r=i?t[0]*e:s.length,a=Math.abs(eu(s,0,r,e));if(i)for(var l=0,o=t.length;l<o;l++){var h=t[l]*e,c=l<o-1?t[l+1]*e:s.length;a-=Math.abs(eu(s,h,c,e))}var d=0;for(l=0;l<n.length;l+=3){var u=n[l]*e,f=n[l+1]*e,m=n[l+2]*e;d+=Math.abs((s[u]-s[m])*(s[f+1]-s[u+1])-(s[u]-s[f])*(s[m+1]-s[u+1]))}return a===0&&d===0?0:Math.abs((d-a)/a)};function eu(s,t,e,n){for(var i=0,r=t,a=e-n;r<e;r+=n)i+=(s[a]-s[r])*(s[r+1]+s[a+1]),a=r;return i}Ql.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},n=0,i=0;i<s.length;i++){for(var r=0;r<s[i].length;r++)for(var a=0;a<t;a++)e.vertices.push(s[i][r][a]);i>0&&(n+=s[i-1].length,e.holes.push(n))}return e};var Jb=hd.exports;const Qb=Ig(Jb);var bl={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */bl.exports;(function(s,t){(function(e){var n=t&&!t.nodeType&&t,i=s&&!s.nodeType&&s,r=typeof Zr=="object"&&Zr;(r.global===r||r.window===r||r.self===r)&&(e=r);var a,l=2147483647,o=36,h=1,c=26,d=38,u=700,f=72,m=128,p="-",g=/^xn--/,v=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=o-h,w=Math.floor,_=String.fromCharCode,E;function T(N){throw new RangeError(x[N])}function C(N,G){for(var q=N.length,K=[];q--;)K[q]=G(N[q]);return K}function R(N,G){var q=N.split("@"),K="";q.length>1&&(K=q[0]+"@",N=q[1]),N=N.replace(b,".");var Q=N.split("."),tt=C(Q,G).join(".");return K+tt}function P(N){for(var G=[],q=0,K=N.length,Q,tt;q<K;)Q=N.charCodeAt(q++),Q>=55296&&Q<=56319&&q<K?(tt=N.charCodeAt(q++),(tt&64512)==56320?G.push(((Q&1023)<<10)+(tt&1023)+65536):(G.push(Q),q--)):G.push(Q);return G}function O(N){return C(N,function(G){var q="";return G>65535&&(G-=65536,q+=_(G>>>10&1023|55296),G=56320|G&1023),q+=_(G),q}).join("")}function F(N){return N-48<10?N-22:N-65<26?N-65:N-97<26?N-97:o}function D(N,G){return N+22+75*(N<26)-((G!=0)<<5)}function V(N,G,q){var K=0;for(N=q?w(N/u):N>>1,N+=w(N/G);N>y*c>>1;K+=o)N=w(N/y);return w(K+(y+1)*N/(N+d))}function X(N){var G=[],q=N.length,K,Q=0,tt=m,ht=f,vt,At,_t,Et,St,Ot,k,L,H;for(vt=N.lastIndexOf(p),vt<0&&(vt=0),At=0;At<vt;++At)N.charCodeAt(At)>=128&&T("not-basic"),G.push(N.charCodeAt(At));for(_t=vt>0?vt+1:0;_t<q;){for(Et=Q,St=1,Ot=o;_t>=q&&T("invalid-input"),k=F(N.charCodeAt(_t++)),(k>=o||k>w((l-Q)/St))&&T("overflow"),Q+=k*St,L=Ot<=ht?h:Ot>=ht+c?c:Ot-ht,!(k<L);Ot+=o)H=o-L,St>w(l/H)&&T("overflow"),St*=H;K=G.length+1,ht=V(Q-Et,K,Et==0),w(Q/K)>l-tt&&T("overflow"),tt+=w(Q/K),Q%=K,G.splice(Q++,0,tt)}return O(G)}function U(N){var G,q,K,Q,tt,ht,vt,At,_t,Et,St,Ot=[],k,L,H,et;for(N=P(N),k=N.length,G=m,q=0,tt=f,ht=0;ht<k;++ht)St=N[ht],St<128&&Ot.push(_(St));for(K=Q=Ot.length,Q&&Ot.push(p);K<k;){for(vt=l,ht=0;ht<k;++ht)St=N[ht],St>=G&&St<vt&&(vt=St);for(L=K+1,vt-G>w((l-q)/L)&&T("overflow"),q+=(vt-G)*L,G=vt,ht=0;ht<k;++ht)if(St=N[ht],St<G&&++q>l&&T("overflow"),St==G){for(At=q,_t=o;Et=_t<=tt?h:_t>=tt+c?c:_t-tt,!(At<Et);_t+=o)et=At-Et,H=o-Et,Ot.push(_(D(Et+et%H,0))),At=w(et/H);Ot.push(_(D(At,0))),tt=V(q,L,K==Q),q=0,++K}++q,++G}return Ot.join("")}function j(N){return R(N,function(G){return g.test(G)?X(G.slice(4).toLowerCase()):G})}function z(N){return R(N,function(G){return v.test(G)?"xn--"+U(G):G})}if(a={version:"1.4.1",ucs2:{decode:P,encode:O},decode:X,encode:U,toASCII:z,toUnicode:j},n&&i)if(s.exports==n)i.exports=a;else for(E in a)a.hasOwnProperty(E)&&(n[E]=a[E]);else e.punycode=a})(Zr)})(bl,bl.exports);var tv=bl.exports,vo=TypeError;const ev={},sv=Object.freeze(Object.defineProperty({__proto__:null,default:ev},Symbol.toStringTag,{value:"Module"})),nv=Ib(sv);var cd=typeof Map=="function"&&Map.prototype,Hh=Object.getOwnPropertyDescriptor&&cd?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,vl=cd&&Hh&&typeof Hh.get=="function"?Hh.get:null,pm=cd&&Map.prototype.forEach,ud=typeof Set=="function"&&Set.prototype,zh=Object.getOwnPropertyDescriptor&&ud?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,wl=ud&&zh&&typeof zh.get=="function"?zh.get:null,gm=ud&&Set.prototype.forEach,iv=typeof WeakMap=="function"&&WeakMap.prototype,jo=iv?WeakMap.prototype.has:null,rv=typeof WeakSet=="function"&&WeakSet.prototype,qo=rv?WeakSet.prototype.has:null,ov=typeof WeakRef=="function"&&WeakRef.prototype,xm=ov?WeakRef.prototype.deref:null,av=Boolean.prototype.valueOf,lv=Object.prototype.toString,hv=Function.prototype.toString,cv=String.prototype.match,dd=String.prototype.slice,Bi=String.prototype.replace,uv=String.prototype.toUpperCase,ym=String.prototype.toLowerCase,Bg=RegExp.prototype.test,bm=Array.prototype.concat,zn=Array.prototype.join,dv=Array.prototype.slice,vm=Math.floor,su=typeof BigInt=="function"?BigInt.prototype.valueOf:null,jh=Object.getOwnPropertySymbols,nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,mo=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ls=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===mo||"symbol")?Symbol.toStringTag:null,Og=Object.prototype.propertyIsEnumerable,wm=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(s){return s.__proto__}:null);function _m(s,t){if(s===1/0||s===-1/0||s!==s||s&&s>-1e3&&s<1e3||Bg.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof s=="number"){var n=s<0?-vm(-s):vm(s);if(n!==s){var i=String(n),r=dd.call(t,i.length+1);return Bi.call(i,e,"$&_")+"."+Bi.call(Bi.call(r,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Bi.call(t,e,"$&_")}var iu=nv,Em=iu.custom,Sm=Vg(Em)?Em:null,Ng={__proto__:null,double:'"',single:"'"},fv={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},eh=function s(t,e,n,i){var r=e||{};if(hi(r,"quoteStyle")&&!hi(Ng,r.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(hi(r,"maxStringLength")&&(typeof r.maxStringLength=="number"?r.maxStringLength<0&&r.maxStringLength!==1/0:r.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=hi(r,"customInspect")?r.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(hi(r,"indent")&&r.indent!==null&&r.indent!=="	"&&!(parseInt(r.indent,10)===r.indent&&r.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(hi(r,"numericSeparator")&&typeof r.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=r.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Xg(t,r);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var o=String(t);return l?_m(t,o):o}if(typeof t=="bigint"){var h=String(t)+"n";return l?_m(t,h):h}var c=typeof r.depth>"u"?5:r.depth;if(typeof n>"u"&&(n=0),n>=c&&c>0&&typeof t=="object")return ru(t)?"[Array]":"[Object]";var d=Pv(r,n);if(typeof i>"u")i=[];else if(Ug(i,t)>=0)return"[Circular]";function u(F,D,V){if(D&&(i=dv.call(i),i.push(D)),V){var X={depth:r.depth};return hi(r,"quoteStyle")&&(X.quoteStyle=r.quoteStyle),s(F,X,n+1,i)}return s(F,r,n+1,i)}if(typeof t=="function"&&!Tm(t)){var f=_v(t),m=Ba(t,u);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(m.length>0?" { "+zn.call(m,", ")+" }":"")}if(Vg(t)){var p=mo?Bi.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):nu.call(t);return typeof t=="object"&&!mo?Io(p):p}if(Mv(t)){for(var g="<"+ym.call(String(t.nodeName)),v=t.attributes||[],b=0;b<v.length;b++)g+=" "+v[b].name+"="+Lg(mv(v[b].value),"double",r);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+ym.call(String(t.nodeName))+">",g}if(ru(t)){if(t.length===0)return"[]";var x=Ba(t,u);return d&&!Rv(x)?"["+ou(x,d)+"]":"[ "+zn.call(x,", ")+" ]"}if(gv(t)){var y=Ba(t,u);return!("cause"in Error.prototype)&&"cause"in t&&!Og.call(t,"cause")?"{ ["+String(t)+"] "+zn.call(bm.call("[cause]: "+u(t.cause),y),", ")+" }":y.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+zn.call(y,", ")+" }"}if(typeof t=="object"&&a){if(Sm&&typeof t[Sm]=="function"&&iu)return iu(t,{depth:c-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Ev(t)){var w=[];return pm&&pm.call(t,function(F,D){w.push(u(D,t,!0)+" => "+u(F,t))}),Am("Map",vl.call(t),w,d)}if(Av(t)){var _=[];return gm&&gm.call(t,function(F){_.push(u(F,t))}),Am("Set",wl.call(t),_,d)}if(Sv(t))return qh("WeakMap");if(Cv(t))return qh("WeakSet");if(Tv(t))return qh("WeakRef");if(yv(t))return Io(u(Number(t)));if(vv(t))return Io(u(su.call(t)));if(bv(t))return Io(av.call(t));if(xv(t))return Io(u(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof Zr<"u"&&t===Zr)return"{ [object globalThis] }";if(!pv(t)&&!Tm(t)){var E=Ba(t,u),T=wm?wm(t)===Object.prototype:t instanceof Object||t.constructor===Object,C=t instanceof Object?"":"null prototype",R=!T&&ls&&Object(t)===t&&ls in t?dd.call(Wi(t),8,-1):C?"Object":"",P=T||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",O=P+(R||C?"["+zn.call(bm.call([],R||[],C||[]),": ")+"] ":"");return E.length===0?O+"{}":d?O+"{"+ou(E,d)+"}":O+"{ "+zn.call(E,", ")+" }"}return String(t)};function Lg(s,t,e){var n=e.quoteStyle||t,i=Ng[n];return i+s+i}function mv(s){return Bi.call(String(s),/"/g,"&quot;")}function ru(s){return Wi(s)==="[object Array]"&&(!ls||!(typeof s=="object"&&ls in s))}function pv(s){return Wi(s)==="[object Date]"&&(!ls||!(typeof s=="object"&&ls in s))}function Tm(s){return Wi(s)==="[object RegExp]"&&(!ls||!(typeof s=="object"&&ls in s))}function gv(s){return Wi(s)==="[object Error]"&&(!ls||!(typeof s=="object"&&ls in s))}function xv(s){return Wi(s)==="[object String]"&&(!ls||!(typeof s=="object"&&ls in s))}function yv(s){return Wi(s)==="[object Number]"&&(!ls||!(typeof s=="object"&&ls in s))}function bv(s){return Wi(s)==="[object Boolean]"&&(!ls||!(typeof s=="object"&&ls in s))}function Vg(s){if(mo)return s&&typeof s=="object"&&s instanceof Symbol;if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||!nu)return!1;try{return nu.call(s),!0}catch{}return!1}function vv(s){if(!s||typeof s!="object"||!su)return!1;try{return su.call(s),!0}catch{}return!1}var wv=Object.prototype.hasOwnProperty||function(s){return s in this};function hi(s,t){return wv.call(s,t)}function Wi(s){return lv.call(s)}function _v(s){if(s.name)return s.name;var t=cv.call(hv.call(s),/^function\s*([\w$]+)/);return t?t[1]:null}function Ug(s,t){if(s.indexOf)return s.indexOf(t);for(var e=0,n=s.length;e<n;e++)if(s[e]===t)return e;return-1}function Ev(s){if(!vl||!s||typeof s!="object")return!1;try{vl.call(s);try{wl.call(s)}catch{return!0}return s instanceof Map}catch{}return!1}function Sv(s){if(!jo||!s||typeof s!="object")return!1;try{jo.call(s,jo);try{qo.call(s,qo)}catch{return!0}return s instanceof WeakMap}catch{}return!1}function Tv(s){if(!xm||!s||typeof s!="object")return!1;try{return xm.call(s),!0}catch{}return!1}function Av(s){if(!wl||!s||typeof s!="object")return!1;try{wl.call(s);try{vl.call(s)}catch{return!0}return s instanceof Set}catch{}return!1}function Cv(s){if(!qo||!s||typeof s!="object")return!1;try{qo.call(s,qo);try{jo.call(s,jo)}catch{return!0}return s instanceof WeakSet}catch{}return!1}function Mv(s){return!s||typeof s!="object"?!1:typeof HTMLElement<"u"&&s instanceof HTMLElement?!0:typeof s.nodeName=="string"&&typeof s.getAttribute=="function"}function Xg(s,t){if(s.length>t.maxStringLength){var e=s.length-t.maxStringLength,n="... "+e+" more character"+(e>1?"s":"");return Xg(dd.call(s,0,t.maxStringLength),t)+n}var i=fv[t.quoteStyle||"single"];i.lastIndex=0;var r=Bi.call(Bi.call(s,i,"\\$1"),/[\x00-\x1f]/g,Iv);return Lg(r,"single",t)}function Iv(s){var t=s.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+uv.call(t.toString(16))}function Io(s){return"Object("+s+")"}function qh(s){return s+" { ? }"}function Am(s,t,e,n){var i=n?ou(e,n):zn.call(e,", ");return s+" ("+t+") {"+i+"}"}function Rv(s){for(var t=0;t<s.length;t++)if(Ug(s[t],`
`)>=0)return!1;return!0}function Pv(s,t){var e;if(s.indent==="	")e="	";else if(typeof s.indent=="number"&&s.indent>0)e=zn.call(Array(s.indent+1)," ");else return null;return{base:e,prev:zn.call(Array(t+1),e)}}function ou(s,t){if(s.length===0)return"";var e=`
`+t.prev+t.base;return e+zn.call(s,","+e)+`
`+t.prev}function Ba(s,t){var e=ru(s),n=[];if(e){n.length=s.length;for(var i=0;i<s.length;i++)n[i]=hi(s,i)?t(s[i],s):""}var r=typeof jh=="function"?jh(s):[],a;if(mo){a={};for(var l=0;l<r.length;l++)a["$"+r[l]]=r[l]}for(var o in s)hi(s,o)&&(e&&String(Number(o))===o&&o<s.length||mo&&a["$"+o]instanceof Symbol||(Bg.call(/[^\w$]/,o)?n.push(t(o,s)+": "+t(s[o],s)):n.push(o+": "+t(s[o],s))));if(typeof jh=="function")for(var h=0;h<r.length;h++)Og.call(s,r[h])&&n.push("["+t(r[h])+"]: "+t(s[r[h]],s));return n}var kv=eh,Fv=vo,sh=function(s,t,e){for(var n=s,i;(i=n.next)!=null;n=i)if(i.key===t)return n.next=i.next,e||(i.next=s.next,s.next=i),i},Dv=function(s,t){if(s){var e=sh(s,t);return e&&e.value}},Bv=function(s,t,e){var n=sh(s,t);n?n.value=e:s.next={key:t,next:s.next,value:e}},Ov=function(s,t){return s?!!sh(s,t):!1},Nv=function(s,t){if(s)return sh(s,t,!0)},Lv=function(){var t,e={assert:function(n){if(!e.has(n))throw new Fv("Side channel does not contain "+kv(n))},delete:function(n){var i=t&&t.next,r=Nv(t,n);return r&&i&&i===r&&(t=void 0),!!r},get:function(n){return Dv(t,n)},has:function(n){return Ov(t,n)},set:function(n,i){t||(t={next:void 0}),Bv(t,n,i)}};return e},Yg=Object,Vv=Error,Uv=EvalError,Xv=RangeError,Yv=ReferenceError,$v=SyntaxError,Gv=URIError,Wv=Math.abs,Hv=Math.floor,zv=Math.max,jv=Math.min,qv=Math.pow,Kv=Math.round,Zv=Number.isNaN||function(t){return t!==t},Jv=Zv,Qv=function(t){return Jv(t)||t===0?t:t<0?-1:1},t1=Object.getOwnPropertyDescriptor,rl=t1;if(rl)try{rl([],"length")}catch{rl=null}var $g=rl,ol=Object.defineProperty||!1;if(ol)try{ol({},"a",{value:1})}catch{ol=!1}var e1=ol,Kh,Cm;function s1(){return Cm||(Cm=1,Kh=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(var r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var a=Object.getOwnPropertySymbols(t);if(a.length!==1||a[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,e);if(l.value!==i||l.enumerable!==!0)return!1}return!0}),Kh}var Zh,Mm;function n1(){if(Mm)return Zh;Mm=1;var s=typeof Symbol<"u"&&Symbol,t=s1();return Zh=function(){return typeof s!="function"||typeof Symbol!="function"||typeof s("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Zh}var Jh,Im;function Gg(){return Im||(Im=1,Jh=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Jh}var Qh,Rm;function Wg(){if(Rm)return Qh;Rm=1;var s=Yg;return Qh=s.getPrototypeOf||null,Qh}var i1="Function.prototype.bind called on incompatible ",r1=Object.prototype.toString,o1=Math.max,a1="[object Function]",Pm=function(t,e){for(var n=[],i=0;i<t.length;i+=1)n[i]=t[i];for(var r=0;r<e.length;r+=1)n[r+t.length]=e[r];return n},l1=function(t,e){for(var n=[],i=e||0,r=0;i<t.length;i+=1,r+=1)n[r]=t[i];return n},h1=function(s,t){for(var e="",n=0;n<s.length;n+=1)e+=s[n],n+1<s.length&&(e+=t);return e},c1=function(t){var e=this;if(typeof e!="function"||r1.apply(e)!==a1)throw new TypeError(i1+e);for(var n=l1(arguments,1),i,r=function(){if(this instanceof i){var c=e.apply(this,Pm(n,arguments));return Object(c)===c?c:this}return e.apply(t,Pm(n,arguments))},a=o1(0,e.length-n.length),l=[],o=0;o<a;o++)l[o]="$"+o;if(i=Function("binder","return function ("+h1(l,",")+"){ return binder.apply(this,arguments); }")(r),e.prototype){var h=function(){};h.prototype=e.prototype,i.prototype=new h,h.prototype=null}return i},u1=c1,nh=Function.prototype.bind||u1,fd=Function.prototype.call,tc,km;function Hg(){return km||(km=1,tc=Function.prototype.apply),tc}var d1=typeof Reflect<"u"&&Reflect&&Reflect.apply,f1=nh,m1=Hg(),p1=fd,g1=d1,x1=g1||f1.call(p1,m1),y1=nh,b1=vo,v1=fd,w1=x1,zg=function(t){if(t.length<1||typeof t[0]!="function")throw new b1("a function is required");return w1(y1,v1,t)},ec,Fm;function _1(){if(Fm)return ec;Fm=1;var s=zg,t=$g,e;try{e=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!e&&t&&t(Object.prototype,"__proto__"),i=Object,r=i.getPrototypeOf;return ec=n&&typeof n.get=="function"?s([n.get]):typeof r=="function"?function(l){return r(l==null?l:i(l))}:!1,ec}var sc,Dm;function E1(){if(Dm)return sc;Dm=1;var s=Gg(),t=Wg(),e=_1();return sc=s?function(i){return s(i)}:t?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return t(i)}:e?function(i){return e(i)}:null,sc}var nc,Bm;function S1(){if(Bm)return nc;Bm=1;var s=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=nh;return nc=e.call(s,t),nc}var Vt,T1=Yg,A1=Vv,C1=Uv,M1=Xv,I1=Yv,po=$v,Qr=vo,R1=Gv,P1=Wv,k1=Hv,F1=zv,D1=jv,B1=qv,O1=Kv,N1=Qv,jg=Function,ic=function(s){try{return jg('"use strict"; return ('+s+").constructor;")()}catch{}},ha=$g,L1=e1,rc=function(){throw new Qr},V1=ha?function(){try{return arguments.callee,rc}catch{try{return ha(arguments,"callee").get}catch{return rc}}}():rc,kr=n1()(),Ye=E1(),U1=Wg(),X1=Gg(),qg=Hg(),Ea=fd,Nr={},Y1=typeof Uint8Array>"u"||!Ye?Vt:Ye(Uint8Array),mr={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Vt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Vt:ArrayBuffer,"%ArrayIteratorPrototype%":kr&&Ye?Ye([][Symbol.iterator]()):Vt,"%AsyncFromSyncIteratorPrototype%":Vt,"%AsyncFunction%":Nr,"%AsyncGenerator%":Nr,"%AsyncGeneratorFunction%":Nr,"%AsyncIteratorPrototype%":Nr,"%Atomics%":typeof Atomics>"u"?Vt:Atomics,"%BigInt%":typeof BigInt>"u"?Vt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Vt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Vt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Vt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":A1,"%eval%":eval,"%EvalError%":C1,"%Float32Array%":typeof Float32Array>"u"?Vt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Vt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Vt:FinalizationRegistry,"%Function%":jg,"%GeneratorFunction%":Nr,"%Int8Array%":typeof Int8Array>"u"?Vt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Vt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Vt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":kr&&Ye?Ye(Ye([][Symbol.iterator]())):Vt,"%JSON%":typeof JSON=="object"?JSON:Vt,"%Map%":typeof Map>"u"?Vt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!kr||!Ye?Vt:Ye(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":T1,"%Object.getOwnPropertyDescriptor%":ha,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Vt:Promise,"%Proxy%":typeof Proxy>"u"?Vt:Proxy,"%RangeError%":M1,"%ReferenceError%":I1,"%Reflect%":typeof Reflect>"u"?Vt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Vt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!kr||!Ye?Vt:Ye(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Vt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":kr&&Ye?Ye(""[Symbol.iterator]()):Vt,"%Symbol%":kr?Symbol:Vt,"%SyntaxError%":po,"%ThrowTypeError%":V1,"%TypedArray%":Y1,"%TypeError%":Qr,"%Uint8Array%":typeof Uint8Array>"u"?Vt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Vt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Vt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Vt:Uint32Array,"%URIError%":R1,"%WeakMap%":typeof WeakMap>"u"?Vt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Vt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Vt:WeakSet,"%Function.prototype.call%":Ea,"%Function.prototype.apply%":qg,"%Object.defineProperty%":L1,"%Object.getPrototypeOf%":U1,"%Math.abs%":P1,"%Math.floor%":k1,"%Math.max%":F1,"%Math.min%":D1,"%Math.pow%":B1,"%Math.round%":O1,"%Math.sign%":N1,"%Reflect.getPrototypeOf%":X1};if(Ye)try{null.error}catch(s){var $1=Ye(Ye(s));mr["%Error.prototype%"]=$1}var G1=function s(t){var e;if(t==="%AsyncFunction%")e=ic("async function () {}");else if(t==="%GeneratorFunction%")e=ic("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=ic("async function* () {}");else if(t==="%AsyncGenerator%"){var n=s("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=s("%AsyncGenerator%");i&&Ye&&(e=Ye(i.prototype))}return mr[t]=e,e},Om={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Sa=nh,_l=S1(),W1=Sa.call(Ea,Array.prototype.concat),H1=Sa.call(qg,Array.prototype.splice),Nm=Sa.call(Ea,String.prototype.replace),El=Sa.call(Ea,String.prototype.slice),z1=Sa.call(Ea,RegExp.prototype.exec),j1=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,q1=/\\(\\)?/g,K1=function(t){var e=El(t,0,1),n=El(t,-1);if(e==="%"&&n!=="%")throw new po("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new po("invalid intrinsic syntax, expected opening `%`");var i=[];return Nm(t,j1,function(r,a,l,o){i[i.length]=l?Nm(o,q1,"$1"):a||r}),i},Z1=function(t,e){var n=t,i;if(_l(Om,n)&&(i=Om[n],n="%"+i[0]+"%"),_l(mr,n)){var r=mr[n];if(r===Nr&&(r=G1(n)),typeof r>"u"&&!e)throw new Qr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:r}}throw new po("intrinsic "+t+" does not exist!")},md=function(t,e){if(typeof t!="string"||t.length===0)throw new Qr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Qr('"allowMissing" argument must be a boolean');if(z1(/^%?[^%]*%?$/,t)===null)throw new po("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=K1(t),i=n.length>0?n[0]:"",r=Z1("%"+i+"%",e),a=r.name,l=r.value,o=!1,h=r.alias;h&&(i=h[0],H1(n,W1([0,1],h)));for(var c=1,d=!0;c<n.length;c+=1){var u=n[c],f=El(u,0,1),m=El(u,-1);if((f==='"'||f==="'"||f==="`"||m==='"'||m==="'"||m==="`")&&f!==m)throw new po("property names with quotes must have matching quotes");if((u==="constructor"||!d)&&(o=!0),i+="."+u,a="%"+i+"%",_l(mr,a))l=mr[a];else if(l!=null){if(!(u in l)){if(!e)throw new Qr("base intrinsic for "+t+" exists, but the property is not available.");return}if(ha&&c+1>=n.length){var p=ha(l,u);d=!!p,d&&"get"in p&&!("originalValue"in p.get)?l=p.get:l=l[u]}else d=_l(l,u),l=l[u];d&&!o&&(mr[a]=l)}}return l},Kg=md,Zg=zg,J1=Zg([Kg("%String.prototype.indexOf%")]),Jg=function(t,e){var n=Kg(t,!!e);return typeof n=="function"&&J1(t,".prototype.")>-1?Zg([n]):n},Q1=md,Ta=Jg,tw=eh,ew=vo,Lm=Q1("%Map%",!0),sw=Ta("Map.prototype.get",!0),nw=Ta("Map.prototype.set",!0),iw=Ta("Map.prototype.has",!0),rw=Ta("Map.prototype.delete",!0),ow=Ta("Map.prototype.size",!0),Qg=!!Lm&&function(){var t,e={assert:function(n){if(!e.has(n))throw new ew("Side channel does not contain "+tw(n))},delete:function(n){if(t){var i=rw(t,n);return ow(t)===0&&(t=void 0),i}return!1},get:function(n){if(t)return sw(t,n)},has:function(n){return t?iw(t,n):!1},set:function(n,i){t||(t=new Lm),nw(t,n,i)}};return e},aw=md,ih=Jg,lw=eh,Oa=Qg,hw=vo,Fr=aw("%WeakMap%",!0),cw=ih("WeakMap.prototype.get",!0),uw=ih("WeakMap.prototype.set",!0),dw=ih("WeakMap.prototype.has",!0),fw=ih("WeakMap.prototype.delete",!0),mw=Fr?function(){var t,e,n={assert:function(i){if(!n.has(i))throw new hw("Side channel does not contain "+lw(i))},delete:function(i){if(Fr&&i&&(typeof i=="object"||typeof i=="function")){if(t)return fw(t,i)}else if(Oa&&e)return e.delete(i);return!1},get:function(i){return Fr&&i&&(typeof i=="object"||typeof i=="function")&&t?cw(t,i):e&&e.get(i)},has:function(i){return Fr&&i&&(typeof i=="object"||typeof i=="function")&&t?dw(t,i):!!e&&e.has(i)},set:function(i,r){Fr&&i&&(typeof i=="object"||typeof i=="function")?(t||(t=new Fr),uw(t,i,r)):Oa&&(e||(e=Oa()),e.set(i,r))}};return n}:Oa,pw=vo,gw=eh,xw=Lv,yw=Qg,bw=mw,vw=bw||yw||xw,ww=function(){var t,e={assert:function(n){if(!e.has(n))throw new pw("Side channel does not contain "+gw(n))},delete:function(n){return!!t&&t.delete(n)},get:function(n){return t&&t.get(n)},has:function(n){return!!t&&t.has(n)},set:function(n,i){t||(t=vw()),t.set(n,i)}};return e},_w=String.prototype.replace,Ew=/%20/g,oc={RFC1738:"RFC1738",RFC3986:"RFC3986"},pd={default:oc.RFC3986,formatters:{RFC1738:function(s){return _w.call(s,Ew,"+")},RFC3986:function(s){return String(s)}},RFC1738:oc.RFC1738,RFC3986:oc.RFC3986},Sw=pd,ac=Object.prototype.hasOwnProperty,hr=Array.isArray,Nn=function(){for(var s=[],t=0;t<256;++t)s.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return s}(),Tw=function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(hr(n)){for(var i=[],r=0;r<n.length;++r)typeof n[r]<"u"&&i.push(n[r]);e.obj[e.prop]=i}}},t0=function(t,e){for(var n=e&&e.plainObjects?{__proto__:null}:{},i=0;i<t.length;++i)typeof t[i]<"u"&&(n[i]=t[i]);return n},Aw=function s(t,e,n){if(!e)return t;if(typeof e!="object"&&typeof e!="function"){if(hr(t))t.push(e);else if(t&&typeof t=="object")(n&&(n.plainObjects||n.allowPrototypes)||!ac.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var i=t;return hr(t)&&!hr(e)&&(i=t0(t,n)),hr(t)&&hr(e)?(e.forEach(function(r,a){if(ac.call(t,a)){var l=t[a];l&&typeof l=="object"&&r&&typeof r=="object"?t[a]=s(l,r,n):t.push(r)}else t[a]=r}),t):Object.keys(e).reduce(function(r,a){var l=e[a];return ac.call(r,a)?r[a]=s(r[a],l,n):r[a]=l,r},i)},Cw=function(t,e){return Object.keys(e).reduce(function(n,i){return n[i]=e[i],n},t)},Mw=function(s,t,e){var n=s.replace(/\+/g," ");if(e==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},lc=1024,Iw=function(t,e,n,i,r){if(t.length===0)return t;var a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),n==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var l="",o=0;o<a.length;o+=lc){for(var h=a.length>=lc?a.slice(o,o+lc):a,c=[],d=0;d<h.length;++d){var u=h.charCodeAt(d);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||r===Sw.RFC1738&&(u===40||u===41)){c[c.length]=h.charAt(d);continue}if(u<128){c[c.length]=Nn[u];continue}if(u<2048){c[c.length]=Nn[192|u>>6]+Nn[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Nn[224|u>>12]+Nn[128|u>>6&63]+Nn[128|u&63];continue}d+=1,u=65536+((u&1023)<<10|h.charCodeAt(d)&1023),c[c.length]=Nn[240|u>>18]+Nn[128|u>>12&63]+Nn[128|u>>6&63]+Nn[128|u&63]}l+=c.join("")}return l},Rw=function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],a=r.obj[r.prop],l=Object.keys(a),o=0;o<l.length;++o){var h=l[o],c=a[h];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(e.push({obj:a,prop:h}),n.push(c))}return Tw(e),t},Pw=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},kw=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},Fw=function(t,e){return[].concat(t,e)},Dw=function(t,e){if(hr(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)},e0={arrayToObject:t0,assign:Cw,combine:Fw,compact:Rw,decode:Mw,encode:Iw,isBuffer:kw,isRegExp:Pw,maybeMap:Dw,merge:Aw},s0=ww,al=e0,Ko=pd,Bw=Object.prototype.hasOwnProperty,n0={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Gn=Array.isArray,Ow=Array.prototype.push,i0=function(s,t){Ow.apply(s,Gn(t)?t:[t])},Nw=Date.prototype.toISOString,Vm=Ko.default,ke={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:al.encode,encodeValuesOnly:!1,filter:void 0,format:Vm,formatter:Ko.formatters[Vm],indices:!1,serializeDate:function(t){return Nw.call(t)},skipNulls:!1,strictNullHandling:!1},Lw=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},hc={},Vw=function s(t,e,n,i,r,a,l,o,h,c,d,u,f,m,p,g,v,b){for(var x=t,y=b,w=0,_=!1;(y=y.get(hc))!==void 0&&!_;){var E=y.get(t);if(w+=1,typeof E<"u"){if(E===w)throw new RangeError("Cyclic object value");_=!0}typeof y.get(hc)>"u"&&(w=0)}if(typeof c=="function"?x=c(e,x):x instanceof Date?x=f(x):n==="comma"&&Gn(x)&&(x=al.maybeMap(x,function(N){return N instanceof Date?f(N):N})),x===null){if(a)return h&&!g?h(e,ke.encoder,v,"key",m):e;x=""}if(Lw(x)||al.isBuffer(x)){if(h){var T=g?e:h(e,ke.encoder,v,"key",m);return[p(T)+"="+p(h(x,ke.encoder,v,"value",m))]}return[p(e)+"="+p(String(x))]}var C=[];if(typeof x>"u")return C;var R;if(n==="comma"&&Gn(x))g&&h&&(x=al.maybeMap(x,h)),R=[{value:x.length>0?x.join(",")||null:void 0}];else if(Gn(c))R=c;else{var P=Object.keys(x);R=d?P.sort(d):P}var O=o?String(e).replace(/\./g,"%2E"):String(e),F=i&&Gn(x)&&x.length===1?O+"[]":O;if(r&&Gn(x)&&x.length===0)return F+"[]";for(var D=0;D<R.length;++D){var V=R[D],X=typeof V=="object"&&V&&typeof V.value<"u"?V.value:x[V];if(!(l&&X===null)){var U=u&&o?String(V).replace(/\./g,"%2E"):String(V),j=Gn(x)?typeof n=="function"?n(F,U):F:F+(u?"."+U:"["+U+"]");b.set(t,w);var z=s0();z.set(hc,b),i0(C,s(X,j,n,i,r,a,l,o,n==="comma"&&g&&Gn(x)?null:h,c,d,u,f,m,p,g,v,z))}}return C},Uw=function(t){if(!t)return ke;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||ke.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Ko.default;if(typeof t.format<"u"){if(!Bw.call(Ko.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var i=Ko.formatters[n],r=ke.filter;(typeof t.filter=="function"||Gn(t.filter))&&(r=t.filter);var a;if(t.arrayFormat in n0?a=t.arrayFormat:"indices"in t?a=t.indices?"indices":"repeat":a=ke.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:ke.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:ke.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ke.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ke.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?ke.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:ke.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:ke.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:ke.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:ke.encodeValuesOnly,filter:r,format:n,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:ke.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:ke.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ke.strictNullHandling}},Xw=function(s,t){var e=s,n=Uw(t),i,r;typeof n.filter=="function"?(r=n.filter,e=r("",e)):Gn(n.filter)&&(r=n.filter,i=r);var a=[];if(typeof e!="object"||e===null)return"";var l=n0[n.arrayFormat],o=l==="comma"&&n.commaRoundTrip;i||(i=Object.keys(e)),n.sort&&i.sort(n.sort);for(var h=s0(),c=0;c<i.length;++c){var d=i[c],u=e[d];n.skipNulls&&u===null||i0(a,Vw(u,d,l,o,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,h))}var f=a.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),f.length>0?m+f:""},vr=e0,au=Object.prototype.hasOwnProperty,Um=Array.isArray,ye={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:vr.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},Yw=function(s){return s.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},r0=function(s,t,e){if(s&&typeof s=="string"&&t.comma&&s.indexOf(",")>-1)return s.split(",");if(t.throwOnLimitExceeded&&e>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(t.arrayLimit===1?"":"s")+" allowed in an array.");return s},$w="utf8=%26%2310003%3B",Gw="utf8=%E2%9C%93",Ww=function(t,e){var n={__proto__:null},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var r=e.parameterLimit===1/0?void 0:e.parameterLimit,a=i.split(e.delimiter,e.throwOnLimitExceeded?r+1:r);if(e.throwOnLimitExceeded&&a.length>r)throw new RangeError("Parameter limit exceeded. Only "+r+" parameter"+(r===1?"":"s")+" allowed.");var l=-1,o,h=e.charset;if(e.charsetSentinel)for(o=0;o<a.length;++o)a[o].indexOf("utf8=")===0&&(a[o]===Gw?h="utf-8":a[o]===$w&&(h="iso-8859-1"),l=o,o=a.length);for(o=0;o<a.length;++o)if(o!==l){var c=a[o],d=c.indexOf("]="),u=d===-1?c.indexOf("="):d+1,f,m;u===-1?(f=e.decoder(c,ye.decoder,h,"key"),m=e.strictNullHandling?null:""):(f=e.decoder(c.slice(0,u),ye.decoder,h,"key"),m=vr.maybeMap(r0(c.slice(u+1),e,Um(n[f])?n[f].length:0),function(g){return e.decoder(g,ye.decoder,h,"value")})),m&&e.interpretNumericEntities&&h==="iso-8859-1"&&(m=Yw(String(m))),c.indexOf("[]=")>-1&&(m=Um(m)?[m]:m);var p=au.call(n,f);p&&e.duplicates==="combine"?n[f]=vr.combine(n[f],m):(!p||e.duplicates==="last")&&(n[f]=m)}return n},Hw=function(s,t,e,n){var i=0;if(s.length>0&&s[s.length-1]==="[]"){var r=s.slice(0,-1).join("");i=Array.isArray(t)&&t[r]?t[r].length:0}for(var a=n?t:r0(t,e,i),l=s.length-1;l>=0;--l){var o,h=s[l];if(h==="[]"&&e.parseArrays)o=e.allowEmptyArrays&&(a===""||e.strictNullHandling&&a===null)?[]:vr.combine([],a);else{o=e.plainObjects?{__proto__:null}:{};var c=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,d=e.decodeDotInKeys?c.replace(/%2E/g,"."):c,u=parseInt(d,10);!e.parseArrays&&d===""?o={0:a}:!isNaN(u)&&h!==d&&String(u)===d&&u>=0&&e.parseArrays&&u<=e.arrayLimit?(o=[],o[u]=a):d!=="__proto__"&&(o[d]=a)}a=o}return a},zw=function(t,e,n,i){if(t){var r=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,o=n.depth>0&&a.exec(r),h=o?r.slice(0,o.index):r,c=[];if(h){if(!n.plainObjects&&au.call(Object.prototype,h)&&!n.allowPrototypes)return;c.push(h)}for(var d=0;n.depth>0&&(o=l.exec(r))!==null&&d<n.depth;){if(d+=1,!n.plainObjects&&au.call(Object.prototype,o[1].slice(1,-1))&&!n.allowPrototypes)return;c.push(o[1])}if(o){if(n.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+n.depth+" and strictDepth is true");c.push("["+r.slice(o.index)+"]")}return Hw(c,e,n,i)}},jw=function(t){if(!t)return ye;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof t.throwOnLimitExceeded<"u"&&typeof t.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=typeof t.charset>"u"?ye.charset:t.charset,n=typeof t.duplicates>"u"?ye.duplicates:t.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:ye.allowDots:!!t.allowDots;return{allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ye.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:ye.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:ye.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:ye.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ye.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:ye.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:ye.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:ye.decoder,delimiter:typeof t.delimiter=="string"||vr.isRegExp(t.delimiter)?t.delimiter:ye.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:ye.depth,duplicates:n,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:ye.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:ye.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:ye.plainObjects,strictDepth:typeof t.strictDepth=="boolean"?!!t.strictDepth:ye.strictDepth,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ye.strictNullHandling,throwOnLimitExceeded:typeof t.throwOnLimitExceeded=="boolean"?t.throwOnLimitExceeded:!1}},qw=function(s,t){var e=jw(t);if(s===""||s===null||typeof s>"u")return e.plainObjects?{__proto__:null}:{};for(var n=typeof s=="string"?Ww(s,e):s,i=e.plainObjects?{__proto__:null}:{},r=Object.keys(n),a=0;a<r.length;++a){var l=r[a],o=zw(l,n[l],e,typeof s=="string");i=vr.merge(i,o,e)}return e.allowSparse===!0?i:vr.compact(i)},Kw=Xw,Zw=qw,Jw=pd,Qw={formats:Jw,parse:Zw,stringify:Kw},t_=tv;function Tn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var e_=/^([a-z0-9.+-]+:)/i,s_=/:[0-9]*$/,n_=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,i_=["<",">",'"',"`"," ","\r",`
`,"	"],r_=["{","}","|","\\","^","`"].concat(i_),lu=["'"].concat(r_),Xm=["%","/","?",";","#"].concat(lu),Ym=["/","?","#"],o_=255,$m=/^[+a-z0-9A-Z_-]{0,63}$/,a_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,l_={javascript:!0,"javascript:":!0},hu={javascript:!0,"javascript:":!0},to={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},cu=Qw;function rh(s,t,e){if(s&&typeof s=="object"&&s instanceof Tn)return s;var n=new Tn;return n.parse(s,t,e),n}Tn.prototype.parse=function(s,t,e){if(typeof s!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var n=s.indexOf("?"),i=n!==-1&&n<s.indexOf("#")?"?":"#",r=s.split(i),a=/\\/g;r[0]=r[0].replace(a,"/"),s=r.join(i);var l=s;if(l=l.trim(),!e&&s.split("#").length===1){var o=n_.exec(l);if(o)return this.path=l,this.href=l,this.pathname=o[1],o[2]?(this.search=o[2],t?this.query=cu.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=e_.exec(l);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,l=l.substr(h.length)}if(e||h||l.match(/^\/\/[^@/]+@[^@/]+/)){var d=l.substr(0,2)==="//";d&&!(h&&hu[h])&&(l=l.substr(2),this.slashes=!0)}if(!hu[h]&&(d||h&&!to[h])){for(var u=-1,f=0;f<Ym.length;f++){var m=l.indexOf(Ym[f]);m!==-1&&(u===-1||m<u)&&(u=m)}var p,g;u===-1?g=l.lastIndexOf("@"):g=l.lastIndexOf("@",u),g!==-1&&(p=l.slice(0,g),l=l.slice(g+1),this.auth=decodeURIComponent(p)),u=-1;for(var f=0;f<Xm.length;f++){var m=l.indexOf(Xm[f]);m!==-1&&(u===-1||m<u)&&(u=m)}u===-1&&(u=l.length),this.host=l.slice(0,u),l=l.slice(u),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var b=this.hostname.split(/\./),f=0,x=b.length;f<x;f++){var y=b[f];if(y&&!y.match($m)){for(var w="",_=0,E=y.length;_<E;_++)y.charCodeAt(_)>127?w+="x":w+=y[_];if(!w.match($m)){var T=b.slice(0,f),C=b.slice(f+1),R=y.match(a_);R&&(T.push(R[1]),C.unshift(R[2])),C.length&&(l="/"+C.join(".")+l),this.hostname=T.join(".");break}}}this.hostname.length>o_?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=t_.toASCII(this.hostname));var P=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+P,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!l_[c])for(var f=0,x=lu.length;f<x;f++){var F=lu[f];if(l.indexOf(F)!==-1){var D=encodeURIComponent(F);D===F&&(D=escape(F)),l=l.split(F).join(D)}}var V=l.indexOf("#");V!==-1&&(this.hash=l.substr(V),l=l.slice(0,V));var X=l.indexOf("?");if(X!==-1?(this.search=l.substr(X),this.query=l.substr(X+1),t&&(this.query=cu.parse(this.query)),l=l.slice(0,X)):t&&(this.search="",this.query={}),l&&(this.pathname=l),to[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var P=this.pathname||"",U=this.search||"";this.path=P+U}return this.href=this.format(),this};function h_(s){return typeof s=="string"&&(s=rh(s)),s instanceof Tn?s.format():Tn.prototype.format.call(s)}Tn.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var t=this.protocol||"",e=this.pathname||"",n=this.hash||"",i=!1,r="";this.host?i=s+this.host:this.hostname&&(i=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(r=cu.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||r&&"?"+r||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||to[t])&&i!==!1?(i="//"+(i||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),a&&a.charAt(0)!=="?"&&(a="?"+a),e=e.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),a=a.replace("#","%23"),t+i+e+a+n};function c_(s,t){return rh(s,!1,!0).resolve(t)}Tn.prototype.resolve=function(s){return this.resolveObject(rh(s,!1,!0)).format()};Tn.prototype.resolveObject=function(s){if(typeof s=="string"){var t=new Tn;t.parse(s,!1,!0),s=t}for(var e=new Tn,n=Object.keys(this),i=0;i<n.length;i++){var r=n[i];e[r]=this[r]}if(e.hash=s.hash,s.href==="")return e.href=e.format(),e;if(s.slashes&&!s.protocol){for(var a=Object.keys(s),l=0;l<a.length;l++){var o=a[l];o!=="protocol"&&(e[o]=s[o])}return to[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(s.protocol&&s.protocol!==e.protocol){if(!to[s.protocol]){for(var h=Object.keys(s),c=0;c<h.length;c++){var d=h[c];e[d]=s[d]}return e.href=e.format(),e}if(e.protocol=s.protocol,!s.host&&!hu[s.protocol]){for(var x=(s.pathname||"").split("/");x.length&&!(s.host=x.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),x[0]!==""&&x.unshift(""),x.length<2&&x.unshift(""),e.pathname=x.join("/")}else e.pathname=s.pathname;if(e.search=s.search,e.query=s.query,e.host=s.host||"",e.auth=s.auth,e.hostname=s.hostname||s.host,e.port=s.port,e.pathname||e.search){var u=e.pathname||"",f=e.search||"";e.path=u+f}return e.slashes=e.slashes||s.slashes,e.href=e.format(),e}var m=e.pathname&&e.pathname.charAt(0)==="/",p=s.host||s.pathname&&s.pathname.charAt(0)==="/",g=p||m||e.host&&s.pathname,v=g,b=e.pathname&&e.pathname.split("/")||[],x=s.pathname&&s.pathname.split("/")||[],y=e.protocol&&!to[e.protocol];if(y&&(e.hostname="",e.port=null,e.host&&(b[0]===""?b[0]=e.host:b.unshift(e.host)),e.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(x[0]===""?x[0]=s.host:x.unshift(s.host)),s.host=null),g=g&&(x[0]===""||b[0]==="")),p)e.host=s.host||s.host===""?s.host:e.host,e.hostname=s.hostname||s.hostname===""?s.hostname:e.hostname,e.search=s.search,e.query=s.query,b=x;else if(x.length)b||(b=[]),b.pop(),b=b.concat(x),e.search=s.search,e.query=s.query;else if(s.search!=null){if(y){e.host=b.shift(),e.hostname=e.host;var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.hostname=w.shift(),e.host=e.hostname)}return e.search=s.search,e.query=s.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!b.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var _=b.slice(-1)[0],E=(e.host||s.host||b.length>1)&&(_==="."||_==="..")||_==="",T=0,C=b.length;C>=0;C--)_=b[C],_==="."?b.splice(C,1):_===".."?(b.splice(C,1),T++):T&&(b.splice(C,1),T--);if(!g&&!v)for(;T--;T)b.unshift("..");g&&b[0]!==""&&(!b[0]||b[0].charAt(0)!=="/")&&b.unshift(""),E&&b.join("/").substr(-1)!=="/"&&b.push("");var R=b[0]===""||b[0]&&b[0].charAt(0)==="/";if(y){e.hostname=R?"":b.length?b.shift():"",e.host=e.hostname;var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.hostname=w.shift(),e.host=e.hostname)}return g=g||e.host&&b.length,g&&!R&&b.unshift(""),b.length>0?e.pathname=b.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=s.auth||e.auth,e.slashes=e.slashes||s.slashes,e.href=e.format(),e};Tn.prototype.parseHost=function(){var s=this.host,t=s_.exec(s);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),s=s.substr(0,s.length-t.length)),s&&(this.hostname=s)};var u_=rh,d_=c_,f_=h_;const m_={parse:u_,format:f_,resolve:d_};function rn(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function Ro(s){return s.split("?")[0].split("#")[0]}function p_(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g_(s,t,e){return s.replace(new RegExp(p_(t),"g"),e)}function x_(s,t){let e="",n=0,i=-1,r=0,a=-1;for(let l=0;l<=s.length;++l){if(l<s.length)a=s.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(i===l-1||r===1))if(i!==l-1&&r===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",n=0):(e=e.slice(0,o),n=e.length-1-e.lastIndexOf("/")),i=l,r=0;continue}}else if(e.length===2||e.length===1){e="",n=0,i=l,r=0;continue}}t&&(e.length>0?e+="/..":e="..",n=2)}else e.length>0?e+=`/${s.slice(i+1,l)}`:e=s.slice(i+1,l),n=l-i-1;i=l,r=0}else a===46&&r!==-1?++r:r=-1}return e}const me={toPosix(s){return g_(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},hasProtocol(s){return/^[^/:]+:\//.test(this.toPosix(s))},getProtocol(s){rn(s),s=this.toPosix(s);let t="";const e=/^file:\/\/\//.exec(s),n=/^[^/:]+:\/\//.exec(s),i=/^[^/:]+:\//.exec(s);if(e||n||i){const r=(e==null?void 0:e[0])||(n==null?void 0:n[0])||(i==null?void 0:i[0]);t=r,s=s.slice(r.length)}return t},toAbsolute(s,t,e){if(this.isDataUrl(s))return s;const n=Ro(this.toPosix(t??ct.ADAPTER.getBaseUrl())),i=Ro(this.toPosix(e??this.rootname(n)));return rn(s),s=this.toPosix(s),s.startsWith("/")?me.join(i,s.slice(1)):this.isAbsolute(s)?s:this.join(n,s)},normalize(s){if(s=this.toPosix(s),rn(s),s.length===0)return".";let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const n=s.endsWith("/");return s=x_(s,!1),s.length>0&&n&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return rn(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const n=s[e];if(rn(n),n.length>0)if(t===void 0)t=n;else{const i=s[e-1]??"";this.extname(i)?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(rn(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let n=-1,i=!0;const r=this.getProtocol(s),a=s;s=s.slice(r.length);for(let l=s.length-1;l>=1;--l)if(t=s.charCodeAt(l),t===47){if(!i){n=l;break}}else i=!1;return n===-1?e?"/":this.isUrl(a)?r+s:r:e&&n===1?"//":r+s.slice(0,n)},rootname(s){rn(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){rn(s),t&&rn(t),s=Ro(this.toPosix(s));let e=0,n=-1,i=!0,r;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let a=t.length-1,l=-1;for(r=s.length-1;r>=0;--r){const o=s.charCodeAt(r);if(o===47){if(!i){e=r+1;break}}else l===-1&&(i=!1,l=r+1),a>=0&&(o===t.charCodeAt(a)?--a===-1&&(n=r):(a=-1,n=l))}return e===n?n=l:n===-1&&(n=s.length),s.slice(e,n)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===47){if(!i){e=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":s.slice(e,n)},extname(s){rn(s),s=Ro(this.toPosix(s));let t=-1,e=0,n=-1,i=!0,r=0;for(let a=s.length-1;a>=0;--a){const l=s.charCodeAt(a);if(l===47){if(!i){e=a+1;break}continue}n===-1&&(i=!1,n=a+1),l===46?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||n===-1||r===0||r===1&&t===n-1&&t===e+1?"":s.slice(t,n)},parse(s){rn(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=Ro(this.toPosix(s));let e=s.charCodeAt(0);const n=this.isAbsolute(s);let i;t.root=this.rootname(s),n||this.hasProtocol(s)?i=1:i=0;let r=-1,a=0,l=-1,o=!0,h=s.length-1,c=0;for(;h>=i;--h){if(e=s.charCodeAt(h),e===47){if(!o){a=h+1;break}continue}l===-1&&(o=!1,l=h+1),e===46?r===-1?r=h:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||l===-1||c===0||c===1&&r===l-1&&r===a+1?l!==-1&&(a===0&&n?t.base=t.name=s.slice(1,l):t.base=t.name=s.slice(a,l)):(a===0&&n?(t.name=s.slice(1,r),t.base=s.slice(1,l)):(t.name=s.slice(a,r),t.base=s.slice(a,l)),t.ext=s.slice(r,l)),t.dir=this.dirname(s),t},sep:"/",delimiter:":"},Gm={};function Lt(s,t,e=3){if(Gm[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(n=n.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(n))),Gm[t]=!0}let cc;function y_(){return typeof cc>"u"&&(cc=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:ct.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ct.ADAPTER.getWebGLRenderingContext())return!1;const n=ct.ADAPTER.createCanvas();let i=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);const r=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const a=i.getExtension("WEBGL_lose_context");a&&a.loseContext()}return i=null,r}catch{return!1}}()),cc}var b_={grad:.9,turn:360,rad:360/(2*Math.PI)},ei=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},$e=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},zs=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},o0=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Wm=function(s){return{r:zs(s.r,0,255),g:zs(s.g,0,255),b:zs(s.b,0,255),a:zs(s.a)}},uc=function(s){return{r:$e(s.r),g:$e(s.g),b:$e(s.b),a:$e(s.a,3)}},v_=/^#([0-9a-f]{3,8})$/i,Na=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},a0=function(s){var t=s.r,e=s.g,n=s.b,i=s.a,r=Math.max(t,e,n),a=r-Math.min(t,e,n),l=a?r===t?(e-n)/a:r===e?2+(n-t)/a:4+(t-e)/a:0;return{h:60*(l<0?l+6:l),s:r?a/r*100:0,v:r/255*100,a:i}},l0=function(s){var t=s.h,e=s.s,n=s.v,i=s.a;t=t/360*6,e/=100,n/=100;var r=Math.floor(t),a=n*(1-e),l=n*(1-(t-r)*e),o=n*(1-(1-t+r)*e),h=r%6;return{r:255*[n,l,a,a,o,n][h],g:255*[o,n,n,l,a,a][h],b:255*[a,a,o,n,n,l][h],a:i}},Hm=function(s){return{h:o0(s.h),s:zs(s.s,0,100),l:zs(s.l,0,100),a:zs(s.a)}},zm=function(s){return{h:$e(s.h),s:$e(s.s),l:$e(s.l),a:$e(s.a,3)}},jm=function(s){return l0((e=(t=s).s,{h:t.h,s:(e*=((n=t.l)<50?n:100-n)/100)>0?2*e/(n+e)*100:0,v:n+e,a:t.a}));var t,e,n},Zo=function(s){return{h:(t=a0(s)).h,s:(i=(200-(e=t.s))*(n=t.v)/100)>0&&i<200?e*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,e,n,i},w_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,__=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,E_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,S_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uu={string:[[function(s){var t=v_.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?$e(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?$e(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=E_.exec(s)||S_.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Wm({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=w_.exec(s)||__.exec(s);if(!t)return null;var e,n,i=Hm({h:(e=t[1],n=t[2],n===void 0&&(n="deg"),Number(e)*(b_[n]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return jm(i)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,n=s.b,i=s.a,r=i===void 0?1:i;return ei(t)&&ei(e)&&ei(n)?Wm({r:Number(t),g:Number(e),b:Number(n),a:Number(r)}):null},"rgb"],[function(s){var t=s.h,e=s.s,n=s.l,i=s.a,r=i===void 0?1:i;if(!ei(t)||!ei(e)||!ei(n))return null;var a=Hm({h:Number(t),s:Number(e),l:Number(n),a:Number(r)});return jm(a)},"hsl"],[function(s){var t=s.h,e=s.s,n=s.v,i=s.a,r=i===void 0?1:i;if(!ei(t)||!ei(e)||!ei(n))return null;var a=function(l){return{h:o0(l.h),s:zs(l.s,0,100),v:zs(l.v,0,100),a:zs(l.a)}}({h:Number(t),s:Number(e),v:Number(n),a:Number(r)});return l0(a)},"hsv"]]},qm=function(s,t){for(var e=0;e<t.length;e++){var n=t[e][0](s);if(n)return[n,t[e][1]]}return[null,void 0]},T_=function(s){return typeof s=="string"?qm(s.trim(),uu.string):typeof s=="object"&&s!==null?qm(s,uu.object):[null,void 0]},dc=function(s,t){var e=Zo(s);return{h:e.h,s:zs(e.s+100*t,0,100),l:e.l,a:e.a}},fc=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Km=function(s,t){var e=Zo(s);return{h:e.h,s:e.s,l:zs(e.l+100*t,0,100),a:e.a}},du=function(){function s(t){this.parsed=T_(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return $e(fc(this.rgba),2)},s.prototype.isDark=function(){return fc(this.rgba)<.5},s.prototype.isLight=function(){return fc(this.rgba)>=.5},s.prototype.toHex=function(){return t=uc(this.rgba),e=t.r,n=t.g,i=t.b,a=(r=t.a)<1?Na($e(255*r)):"","#"+Na(e)+Na(n)+Na(i)+a;var t,e,n,i,r,a},s.prototype.toRgb=function(){return uc(this.rgba)},s.prototype.toRgbString=function(){return t=uc(this.rgba),e=t.r,n=t.g,i=t.b,(r=t.a)<1?"rgba("+e+", "+n+", "+i+", "+r+")":"rgb("+e+", "+n+", "+i+")";var t,e,n,i,r},s.prototype.toHsl=function(){return zm(Zo(this.rgba))},s.prototype.toHslString=function(){return t=zm(Zo(this.rgba)),e=t.h,n=t.s,i=t.l,(r=t.a)<1?"hsla("+e+", "+n+"%, "+i+"%, "+r+")":"hsl("+e+", "+n+"%, "+i+"%)";var t,e,n,i,r},s.prototype.toHsv=function(){return t=a0(this.rgba),{h:$e(t.h),s:$e(t.s),v:$e(t.v),a:$e(t.a,3)};var t},s.prototype.invert=function(){return Un({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Un(dc(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Un(dc(this.rgba,-t))},s.prototype.grayscale=function(){return Un(dc(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Un(Km(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Un(Km(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Un({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):$e(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=Zo(this.rgba);return typeof t=="number"?Un({h:t,s:e.s,l:e.l,a:e.a}):$e(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Un(t).toHex()},s}(),Un=function(s){return s instanceof du?s:new du(s)},Zm=[],A_=function(s){s.forEach(function(t){Zm.indexOf(t)<0&&(t(du,uu),Zm.push(t))})};function C_(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in e)n[e[i]]=i;var r={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,o,h=n[this.toHex()];if(h)return h;if(a!=null&&a.closest){var c=this.toRgb(),d=1/0,u="black";if(!r.length)for(var f in e)r[f]=new s(e[f]).toRgb();for(var m in e){var p=(l=c,o=r[m],Math.pow(l.r-o.r,2)+Math.pow(l.g-o.g,2)+Math.pow(l.b-o.b,2));p<d&&(d=p,u=m)}return u}},t.string.push([function(a){var l=a.toLowerCase(),o=l==="transparent"?"#0000":e[l];return o?new s(o).toRgb():null},"name"])}A_([C_]);const eo=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof eo)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if(n==="number"||n==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,a)=>r===e[a]);if(t!==null&&e!==null){const r=Object.keys(t),a=Object.keys(e);return r.length!==a.length?!1:r.every(l=>t[l]===e[l])}return t===e}toRgba(){const[t,e,n,i]=this._components;return{r:t,g:e,b:n,a:i}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,i]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(n*255),t[2]=Math.round(i*255),t}toRgbArray(t){t=t??[];const[e,n,i]=this._components;return t[0]=e,t[1]=n,t[2]=i,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,n,i,r]=eo.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=n,this._components[2]*=i,this._components[3]*=r,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,r=this._int&255;return e&&(n=n*t+.5|0,i=i*t+.5|0,r=r*t+.5|0),(t*255<<24)+(n<<16)+(i<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,n,i]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(n*t)/t,this._components[2]=Math.round(i*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,n,i,r]=this._components;return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}normalize(t){let e,n,i,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,n=(a>>8&255)/255,i=(a&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,n,i,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,n,i,r=255]=t,e/=255,n/=255,i/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const l=eo.HEX_PATTERN.exec(t);l&&(t=`#${l[2]}`)}const a=Un(t);a.isValid()&&({r:e,g:n,b:i,a:r}=a.rgba,e/=255,n/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=n,this._components[2]=i,this._components[3]=r,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(t*255<<16)+(e*255<<8)+(n*255|0)}_clamp(t,e=0,n=1){return typeof t=="number"?Math.min(Math.max(t,e),n):(t.forEach((i,r)=>{t[r]=Math.min(Math.max(i,e),n)}),t)}};let Kt=eo;Kt.shared=new eo;Kt.temp=new eo;Kt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function M_(s,t=[]){return Lt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Kt.shared.setValue(s).toRgbArray(t)}function I_(s){return Lt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Kt.shared.setValue(s).toHex()}function ll(s){return Lt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Kt.shared.setValue(s).toNumber()}function R_(){const s=[],t=[];for(let n=0;n<32;n++)s[n]=n,t[n]=n;s[ft.NORMAL_NPM]=ft.NORMAL,s[ft.ADD_NPM]=ft.ADD,s[ft.SCREEN_NPM]=ft.SCREEN,t[ft.NORMAL]=ft.NORMAL_NPM,t[ft.ADD]=ft.ADD_NPM,t[ft.SCREEN]=ft.SCREEN_NPM;const e=[];return e.push(t),e.push(s),e}const h0=R_();function c0(s,t){return h0[t?1:0][s]}function P_(s,t=null){const e=s*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let n=0,i=0;n<e;n+=6,i+=4)t[n+0]=i+0,t[n+1]=i+1,t[n+2]=i+2,t[n+3]=i+0,t[n+4]=i+2,t[n+5]=i+3;return t}function u0(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}function Sl(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Jm(s){return!(s&s-1)&&!!s}function Qm(s){let t=(s>65535?1:0)<<4;s>>>=t;let e=(s>255?1:0)<<3;return s>>>=e,t|=e,e=(s>15?1:0)<<2,s>>>=e,t|=e,e=(s>3?1:0)<<1,s>>>=e,t|=e,t|s>>1}function so(s,t,e){const n=s.length;let i;if(t>=n||e===0)return;e=t+e>n?n-t:e;const r=n-e;for(i=t;i<r;++i)s[i]=s[i+e];s.length=r}function Oi(s){return s===0?0:s<0?-1:1}let k_=0;function wr(){return++k_}const d0=class{constructor(s,t,e,n){this.left=s,this.top=t,this.right=e,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let fu=d0;fu.EMPTY=new d0(0,0,0,0);const tp={},Xn=Object.create(null),Ti=Object.create(null);class F_{constructor(t,e,n){this._canvas=ct.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||ct.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function ep(s,t,e){for(let n=0,i=4*e*t;n<t;++n,i+=4)if(s[i+3]!==0)return!1;return!0}function sp(s,t,e,n,i){const r=4*t;for(let a=n,l=n*r+4*e;a<=i;++a,l+=r)if(s[l+3]!==0)return!1;return!0}function D_(s){const{width:t,height:e}=s,n=s.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const r=n.getImageData(0,0,t,e).data;let a=0,l=0,o=t-1,h=e-1;for(;l<e&&ep(r,t,l);)++l;if(l===e)return fu.EMPTY;for(;ep(r,t,h);)--h;for(;sp(r,t,a,l,h);)++a;for(;sp(r,t,o,l,h);)--o;return++o,++h,new fu(a,l,o,h)}function B_(s){const t=D_(s),{width:e,height:n}=t;let i=null;if(!t.isEmpty()){const r=s.getContext("2d");if(r===null)throw new TypeError("Failed to get canvas 2D context");i=r.getImageData(t.left,t.top,e,n)}return{width:e,height:n,data:i}}let La;function O_(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location,La||(La=document.createElement("a")),La.href=s;const e=m_.parse(La.href),n=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!n||e.protocol!==t.protocol?"anonymous":""}function Ui(s,t=1){var n;const e=(n=ct.RETINA_PREFIX)==null?void 0:n.exec(s);return e?parseFloat(e[1]):t}var ut=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(ut||{});const mu=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},np=(s,t)=>mu(s).priority??t,bt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(mu).forEach(t=>{t.type.forEach(e=>{var n,i;return(i=(n=this._removeHandlers)[e])==null?void 0:i.call(n,t)})}),this},add(...s){return s.map(mu).forEach(t=>{t.type.forEach(e=>{const n=this._addHandlers,i=this._queue;n[e]?n[e](t):(i[e]=i[e]||[],i[e].push(t))})}),this},handle(s,t,e){const n=this._addHandlers,i=this._removeHandlers;if(n[s]||i[s])throw new Error(`Extension type ${s} already has a handler`);n[s]=t,i[s]=e;const r=this._queue;return r[s]&&(r[s].forEach(a=>t(a)),delete r[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(s,t,e=-1){return this.handle(s,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((i,r)=>np(r,e)-np(i,e)))},n=>{const i=t.indexOf(n.ref);i!==-1&&t.splice(i,1)})}};class pu{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const N_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function L_(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function V_(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=N_.replace(/%forloop%/gi,L_(s));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}return s}const mc=0,pc=1,gc=2,xc=3,yc=4,bc=5;class wi{constructor(){this.data=0,this.blendMode=ft.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<mc)}set blend(t){!!(this.data&1<<mc)!==t&&(this.data^=1<<mc)}get offsets(){return!!(this.data&1<<pc)}set offsets(t){!!(this.data&1<<pc)!==t&&(this.data^=1<<pc)}get culling(){return!!(this.data&1<<gc)}set culling(t){!!(this.data&1<<gc)!==t&&(this.data^=1<<gc)}get depthTest(){return!!(this.data&1<<xc)}set depthTest(t){!!(this.data&1<<xc)!==t&&(this.data^=1<<xc)}get depthMask(){return!!(this.data&1<<bc)}set depthMask(t){!!(this.data&1<<bc)!==t&&(this.data^=1<<bc)}get clockwiseFrontFace(){return!!(this.data&1<<yc)}set clockwiseFrontFace(t){!!(this.data&1<<yc)!==t&&(this.data^=1<<yc)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ft.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new wi;return t.depthTest=!1,t.blend=!0,t}}const gu=[];function f0(s,t){if(!s)return null;let e="";if(typeof s=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);n&&(e=n[1].toLowerCase())}for(let n=gu.length-1;n>=0;--n){const i=gu[n];if(i.test&&i.test(s,e))return new i(s,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class An{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,i,r,a,l,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:c}=this;this._aliasCount++;for(let d=0,u=c.length;d<u;d++)c[d][h](t,e,n,i,r,a,l,o);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(An.prototype,{dispatch:{value:An.prototype.emit},run:{value:An.prototype.emit}});class ca{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new An("setRealSize"),this.onUpdate=new An("update"),this.onError=new An("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Aa extends ca{constructor(t,e){const{width:n,height:i}=e||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=t}upload(t,e,n){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sn.UNPACK);const r=e.realWidth,a=e.realHeight;return n.width===r&&n.height===a?i.texSubImage2D(e.target,0,0,0,r,a,e.format,n.type,this.data):(n.width=r,n.height=a,i.texImage2D(e.target,0,n.internalFormat,r,a,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const U_={scaleMode:Os.NEAREST,format:lt.RGBA,alphaMode:sn.NPM},Lr=class extends _a{constructor(s=null,t=null){super(),t=Object.assign({},Lr.defaultOptions,t);const{alphaMode:e,mipmap:n,anisotropicLevel:i,scaleMode:r,width:a,height:l,wrapMode:o,format:h,type:c,target:d,resolution:u,resourceOptions:f}=t;s&&!(s instanceof ca)&&(s=f0(s,f),s.internal=!0),this.resolution=u||ct.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=i,this._wrapMode=o,this._scaleMode=r,this.format=h,this.type=c,this.target=d,this.alphaMode=e,this.uid=wr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(s)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(s){this._mipmap!==s&&(this._mipmap=s,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(s){this._scaleMode!==s&&(this._scaleMode=s,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(s){this._wrapMode!==s&&(this._wrapMode=s,this.dirtyStyleId++)}setStyle(s,t){let e;return s!==void 0&&s!==this.scaleMode&&(this.scaleMode=s,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(s,t,e){return e=e||this.resolution,this.setRealSize(s*e,t*e,e)}setRealSize(s,t,e){return this.resolution=e||this.resolution,this.width=Math.round(s)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Jm(this.realWidth)&&Jm(this.realHeight)}setResolution(s){const t=this.resolution;return t===s?this:(this.resolution=s,this.valid&&(this.width=Math.round(this.width*t)/s,this.height=Math.round(this.height*t)/s,this.emit("update",this)),this._refreshPOT(),this)}setResource(s){if(this.resource===s)return this;if(this.resource)throw new Error("Resource can be set only once");return s.bind(this),this.resource=s,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(s){this.emit("error",this,s)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ti[this.cacheId],delete Xn[this.cacheId],this.cacheId=null),this.dispose(),Lr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(s,t,e=ct.STRICT_TEXTURE_CACHE){const n=typeof s=="string";let i=null;if(n)i=s;else{if(!s._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";s._pixiId=`${a}_${wr()}`}i=s._pixiId}let r=Ti[i];if(n&&e&&!r)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return r||(r=new Lr(s,t),r.cacheId=i,Lr.addToCache(r,i)),r}static fromBuffer(s,t,e,n){s=s||new Float32Array(t*e*4);const i=new Aa(s,{width:t,height:e}),r=s instanceof Float32Array?wt.FLOAT:wt.UNSIGNED_BYTE;return new Lr(i,Object.assign({},U_,{type:r},n))}static addToCache(s,t){t&&(s.textureCacheIds.includes(t)||s.textureCacheIds.push(t),Ti[t]&&Ti[t]!==s&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Ti[t]=s)}static removeFromCache(s){if(typeof s=="string"){const t=Ti[s];if(t){const e=t.textureCacheIds.indexOf(s);return e>-1&&t.textureCacheIds.splice(e,1),delete Ti[s],t}}else if(s!=null&&s.textureCacheIds){for(let t=0;t<s.textureCacheIds.length;++t)delete Ti[s.textureCacheIds[t]];return s.textureCacheIds.length=0,s}return null}};let Ct=Lr;Ct.defaultOptions={mipmap:tn.POW2,anisotropicLevel:0,scaleMode:Os.LINEAR,wrapMode:Li.CLAMP,alphaMode:sn.UNPACK,target:Jr.TEXTURE_2D,format:lt.RGBA,type:wt.UNSIGNED_BYTE};Ct._globalBatch=0;class xu{constructor(){this.texArray=null,this.blend=0,this.type=En.TRIANGLES,this.start=0,this.size=0,this.data=null}}let X_=0;class Se{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=X_++,this.disposeRunner=new An("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?qn.ELEMENT_ARRAY_BUFFER:qn.ARRAY_BUFFER}get index(){return this.type===qn.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Se(t)}}class Tl{constructor(t,e=0,n=!1,i=wt.FLOAT,r,a,l,o=1){this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=a,this.instance=l,this.divisor=o}destroy(){this.buffer=null}static from(t,e,n,i,r){return new Tl(t,e,n,i,r)}}const Y_={Float32Array,Uint32Array,Int32Array,Uint8Array};function $_(s,t){let e=0,n=0;const i={};for(let o=0;o<s.length;o++)n+=t[o],e+=s[o].length;const r=new ArrayBuffer(e*4);let a=null,l=0;for(let o=0;o<s.length;o++){const h=t[o],c=s[o],d=u0(c);i[d]||(i[d]=new Y_[d](r)),a=i[d];for(let u=0;u<c.length;u++){const f=(u/h|0)*n+l,m=u%h;a[f+m]=c[u]}l+=h}return new Float32Array(r)}const ip={5126:4,5123:2,5121:1};let G_=0;const W_={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Xi{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=G_++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new An("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,i=!1,r,a,l,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Se||(e instanceof Array&&(e=new Float32Array(e)),e=new Se(e));const h=t.split("|");if(h.length>1){for(let d=0;d<h.length;d++)this.addAttribute(h[d],e,n,i,r);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Tl(c,n,i,r,a,l,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Se||(t instanceof Array&&(t=new Uint16Array(t)),t=new Se(t)),t.type=qn.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],n=new Se;let i;for(i in this.attributes){const r=this.attributes[i],a=this.buffers[r.buffer];t.push(a.data),e.push(r.size*ip[r.type]/4),r.buffer=0}for(n.data=$_(t,e),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Xi;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Se(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new Tl(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=qn.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Xi,n=[],i=[],r=[];let a;for(let l=0;l<t.length;l++){a=t[l];for(let o=0;o<a.buffers.length;o++)i[o]=i[o]||0,i[o]+=a.buffers[o].data.length,r[o]=0}for(let l=0;l<a.buffers.length;l++)n[l]=new W_[u0(a.buffers[l].data)](i[l]),e.buffers[l]=new Se(n[l]);for(let l=0;l<t.length;l++){a=t[l];for(let o=0;o<a.buffers.length;o++)n[o].set(a.buffers[o].data,r[o]),r[o]+=a.buffers[o].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=qn.ELEMENT_ARRAY_BUFFER;let l=0,o=0,h=0,c=0;for(let d=0;d<a.buffers.length;d++)if(a.buffers[d]!==a.indexBuffer){c=d;break}for(const d in a.attributes){const u=a.attributes[d];(u.buffer|0)===c&&(o+=u.size*ip[u.type]/4)}for(let d=0;d<t.length;d++){const u=t[d].indexBuffer.data;for(let f=0;f<u.length;f++)e.indexBuffer.data[f+h]+=l;l+=t[d].buffers[c].data.length/o,h+=u.length}}return e}}class m0 extends Xi{constructor(t=!1){super(),this._buffer=new Se(null,t,!1),this._indexBuffer=new Se(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,wt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,wt.FLOAT).addAttribute("aColor",this._buffer,4,!0,wt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,wt.FLOAT).addIndex(this._indexBuffer)}}const Al=Math.PI*2,H_=180/Math.PI,z_=Math.PI/180;var Ke=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(Ke||{});class Ht{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Ht(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Va=[new Ht,new Ht,new Ht,new Ht];class Dt{constructor(t=0,e=0,n=0,i=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=Ke.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Dt(0,0,0,0)}clone(){return new Dt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const R=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>R}const n=this.left,i=this.right,r=this.top,a=this.bottom;if(i<=n||a<=r)return!1;const l=Va[0].set(t.left,t.top),o=Va[1].set(t.left,t.bottom),h=Va[2].set(t.right,t.top),c=Va[3].set(t.right,t.bottom);if(h.x<=l.x||o.y<=l.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(l,l),e.apply(o,o),e.apply(h,h),e.apply(c,c),Math.max(l.x,o.x,h.x,c.x)<=n||Math.min(l.x,o.x,h.x,c.x)>=i||Math.max(l.y,o.y,h.y,c.y)<=r||Math.min(l.y,o.y,h.y,c.y)>=a))return!1;const u=d*(o.y-l.y),f=d*(l.x-o.x),m=u*n+f*r,p=u*i+f*r,g=u*n+f*a,v=u*i+f*a;if(Math.max(m,p,g,v)<=u*l.x+f*l.y||Math.min(m,p,g,v)>=u*c.x+f*c.y)return!1;const b=d*(l.y-h.y),x=d*(h.x-l.x),y=b*n+x*r,w=b*i+x*r,_=b*n+x*a,E=b*i+x*a;return!(Math.max(y,w,_,E)<=b*l.x+x*l.y||Math.min(y,w,_,E)>=b*c.x+x*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class gd{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=Ke.CIRC}clone(){return new gd(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-t,r=this.y-e;return i*=i,r*=r,i+r<=n}getBounds(){return new Dt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class xd{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.width=n,this.height=i,this.type=Ke.ELIP}clone(){return new xd(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,i=(e-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new Dt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class pr{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let i=0,r=e.length;i<r;i++)n.push(e[i].x,e[i].y);e=n}this.points=e,this.type=Ke.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new pr(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const i=this.points.length/2;for(let r=0,a=i-1;r<i;a=r++){const l=this.points[r*2],o=this.points[r*2+1],h=this.points[a*2],c=this.points[a*2+1];o>e!=c>e&&t<(h-l)*((e-o)/(c-o))+l&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class yd{constructor(t=0,e=0,n=0,i=0,r=20){this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=Ke.RREC}clone(){return new yd(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let i=t-(this.x+n),r=e-(this.y+n);const a=n*n;if(i*i+r*r<=a||(i=t-(this.x+this.width-n),i*i+r*r<=a)||(r=e-(this.y+this.height-n),i*i+r*r<=a)||(i=t-(this.x+n),i*i+r*r<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class se{constructor(t=1,e=0,n=0,i=1,r=0,a=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,i,r,a){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new Ht;const n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e}applyInverse(t,e){e=e||new Ht;const n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,a=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e,this}append(t){const e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this}setTransform(t,e,n,i,r,a,l,o,h){return this.a=Math.cos(l+h)*r,this.b=Math.sin(l+h)*r,this.c=-Math.sin(l-o)*a,this.d=Math.cos(l-o)*a,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,i=this.c,r=this.d,a=t.pivot,l=-Math.atan2(-i,r),o=Math.atan2(n,e),h=Math.abs(l+o);return h<1e-5||Math.abs(Al-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=o),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(a.x*e+a.y*i),t.position.y=this.ty+(a.x*n+a.y*r),t}invert(){const t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,a=t*i-e*n;return this.a=i/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-i*r)/a,this.ty=-(t*this.ty-e*r)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new se;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new se}static get TEMP_MATRIX(){return new se}}const er=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],sr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],nr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ir=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],yu=[],p0=[],Ua=Math.sign;function j_(){for(let s=0;s<16;s++){const t=[];yu.push(t);for(let e=0;e<16;e++){const n=Ua(er[s]*er[e]+nr[s]*sr[e]),i=Ua(sr[s]*er[e]+ir[s]*sr[e]),r=Ua(er[s]*nr[e]+nr[s]*ir[e]),a=Ua(sr[s]*nr[e]+ir[s]*ir[e]);for(let l=0;l<16;l++)if(er[l]===n&&sr[l]===i&&nr[l]===r&&ir[l]===a){t.push(l);break}}}for(let s=0;s<16;s++){const t=new se;t.set(er[s],sr[s],nr[s],ir[s],0,0),p0.push(t)}}j_();const ue={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>er[s],uY:s=>sr[s],vX:s=>nr[s],vY:s=>ir[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>yu[s][t],sub:(s,t)=>yu[s][ue.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?ue.S:ue.N:Math.abs(t)*2<=Math.abs(s)?s>0?ue.E:ue.W:t>0?s>0?ue.SE:ue.SW:s>0?ue.NE:ue.NW,matrixAppendRotationInv:(s,t,e=0,n=0)=>{const i=p0[ue.inv(t)];i.tx=e,i.ty=n,s.append(i)}};class Ni{constructor(t,e,n=0,i=0){this._x=n,this._y=i,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Ni(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const g0=class{constructor(){this.worldTransform=new se,this.localTransform=new se,this.position=new Ni(this.onChange,this,0,0),this.scale=new Ni(this.onChange,this,1,1),this.pivot=new Ni(this.onChange,this,0,0),this.skew=new Ni(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const e=s.worldTransform,n=this.worldTransform;n.a=t.a*e.a+t.b*e.c,n.b=t.a*e.b+t.b*e.d,n.c=t.c*e.a+t.d*e.c,n.d=t.c*e.b+t.d*e.d,n.tx=t.tx*e.a+t.ty*e.c+e.tx,n.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};let oh=g0;oh.IDENTITY=new g0;var q_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,K_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function rp(s,t,e){const n=s.createShader(t);return s.shaderSource(n,e),s.compileShader(n),n}function vc(s){const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=!1;return t}function x0(s,t){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return vc(2*t);case"bvec3":return vc(3*t);case"bvec4":return vc(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const no=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,t)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(t==null||t.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,t)=>s.type==="mat3"&&s.size===1&&!s.isArray&&t.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,t)=>s.type==="vec2"&&s.size===1&&!s.isArray&&t.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${s}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(s,t)=>s.type==="vec3"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${s}"].location, v.red, v.green, v.blue)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],Z_={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},J_={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Q_(s,t){var n;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in s.uniforms){const r=t[i];if(!r){(n=s.uniforms[i])!=null&&n.group&&(s.uniforms[i].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const a=s.uniforms[i];let l=!1;for(let o=0;o<no.length;o++)if(no[o].test(r,a)){e.push(no[o].code(i,a)),l=!0;break}if(!l){const h=(r.size===1&&!r.isArray?Z_:J_)[r.type].replace("location",`ud["${i}"].location`);e.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const y0={};let Dr=y0;function tE(){if(Dr===y0||Dr!=null&&Dr.isContextLost()){const s=ct.ADAPTER.createCanvas();let t;ct.PREFER_ENV>=Cr.WEBGL2&&(t=s.getContext("webgl2",{})),t||(t=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Dr=t}return Dr}let Xa;function eE(){if(!Xa){Xa=Hs.MEDIUM;const s=tE();s&&s.getShaderPrecisionFormat&&(Xa=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?Hs.HIGH:Hs.MEDIUM)}return Xa}function op(s,t){const e=s.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),n=s.getShaderInfoLog(t),i=n.split(`
`),r={},a=i.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!r[h]?(r[h]=!0,!0):!1),l=[""];a.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const o=e.join(`
`);l[0]=o,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function sE(s,t,e,n){s.getProgramParameter(t,s.LINK_STATUS)||(s.getShaderParameter(e,s.COMPILE_STATUS)||op(s,e),s.getShaderParameter(n,s.COMPILE_STATUS)||op(s,n),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(t)))}const nE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function b0(s){return nE[s]}let Ya=null;const ap={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function v0(s,t){if(!Ya){const e=Object.keys(ap);Ya={};for(let n=0;n<e.length;++n){const i=e[n];Ya[s[i]]=ap[i]}}return Ya[t]}function lp(s,t,e){if(s.substring(0,9)!=="precision"){let n=t;return t===Hs.HIGH&&e!==Hs.HIGH&&(n=Hs.MEDIUM),`precision ${n} float;
${s}`}else if(e!==Hs.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let Po;function iE(){if(typeof Po=="boolean")return Po;try{Po=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Po=!1}return Po}let rE=0;const $a={},Vr=class{constructor(s,t,e="pixi-shader",n={}){this.extra={},this.id=rE++,this.vertexSrc=s||Vr.defaultVertexSrc,this.fragmentSrc=t||Vr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),$a[e]?($a[e]++,e+=`-${$a[e]}`):$a[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=lp(this.vertexSrc,Vr.defaultVertexPrecision,Hs.HIGH),this.fragmentSrc=lp(this.fragmentSrc,Vr.defaultFragmentPrecision,eE())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return K_}static get defaultFragmentSrc(){return q_}static from(s,t,e){const n=s+t;let i=tp[n];return i||(tp[n]=i=new Vr(s,t,e)),i}};let Sn=Vr;Sn.defaultVertexPrecision=Hs.HIGH;Sn.defaultFragmentPrecision=mi.apple.device?Hs.HIGH:Hs.MEDIUM;let oE=0;class Cn{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=oE++,this.static=!!e,this.ubo=!!n,t instanceof Se?(this.buffer=t,this.buffer.type=qn.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Se(new Float32Array(1)),this.buffer.type=qn.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(!this.ubo)this.uniforms[t]=new Cn(e,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,n){return new Cn(t,e,n)}static uboFrom(t,e){return new Cn(t,e??!0,!0)}}class Kn{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof Cn?this.uniformGroup=e:this.uniformGroup=new Cn(e):this.uniformGroup=new Cn({}),this.disposeRunner=new An("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const i=Sn.from(t,e);return new Kn(i,n)}}class aE{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=r;this.defaultGroupCache[t]=Cn.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${t}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Sn(this.vertexSrc,i)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new se,default:this.defaultGroupCache[t]};return new Kn(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let n=0;n<t;n++)n>0&&(e+=`
else `),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class bu{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function lE(){return!mi.apple.device}function hE(s){let t=!0;const e=ct.ADAPTER.getNavigator();if(mi.tablet||mi.phone){if(mi.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if(mi.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?s:4}class ah{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var cE=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,uE=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const an=class extends ah{constructor(s){super(s),this.setShaderGenerator(),this.geometryClass=m0,this.vertexSize=6,this.state=wi.for2d(),this.size=an.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),s.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??hE(32),this._defaultMaxTextures}static set defaultMaxTextures(s){this._defaultMaxTextures=s}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??lE(),this._canUploadSameBuffer}static set canUploadSameBuffer(s){this._canUploadSameBuffer=s}get MAX_TEXTURES(){return Lt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return uE}static get defaultFragmentTemplate(){return cE}setShaderGenerator({vertex:s=an.defaultVertexSrc,fragment:t=an.defaultFragmentTemplate}={}){this.shaderGenerator=new aE(s,t)}contextChange(){const s=this.renderer.gl;ct.PREFER_ENV===Cr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),an.defaultMaxTextures),this.maxTextures=V_(this.maxTextures,s)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:s,_textureArrayPool:t}=an,e=this.size/4,n=Math.floor(e/this.maxTextures)+1;for(;s.length<e;)s.push(new xu);for(;t.length<n;)t.push(new bu);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(s){s._texture.valid&&(this._vertexCount+s.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=s.vertexData.length/2,this._indexCount+=s.indices.length,this._bufferedTextures[this._bufferSize]=s._texture.baseTexture,this._bufferedElements[this._bufferSize++]=s)}buildTexturesAndDrawCalls(){const{_bufferedTextures:s,maxTextures:t}=this,e=an._textureArrayPool,n=this.renderer.batch,i=this._tempBoundTextures,r=this.renderer.textureGC.count;let a=++Ct._globalBatch,l=0,o=e[0],h=0;n.copyBoundTextures(i,t);for(let c=0;c<this._bufferSize;++c){const d=s[c];s[c]=null,d._batchEnabled!==a&&(o.count>=t&&(n.boundArray(o,i,a,t),this.buildDrawCalls(o,h,c),h=c,o=e[++l],++a),d._batchEnabled=a,d.touched=r,o.elements[o.count++]=d)}o.count>0&&(n.boundArray(o,i,a,t),this.buildDrawCalls(o,h,this._bufferSize),++l,++a);for(let c=0;c<i.length;c++)i[c]=null;Ct._globalBatch=a}buildDrawCalls(s,t,e){const{_bufferedElements:n,_attributeBuffer:i,_indexBuffer:r,vertexSize:a}=this,l=an._drawCallPool;let o=this._dcIndex,h=this._aIndex,c=this._iIndex,d=l[o];d.start=this._iIndex,d.texArray=s;for(let u=t;u<e;++u){const f=n[u],m=f._texture.baseTexture,p=h0[m.alphaMode?1:0][f.blendMode];n[u]=null,t<u&&d.blend!==p&&(d.size=c-d.start,t=u,d=l[++o],d.texArray=s,d.start=c),this.packInterleavedGeometry(f,i,r,h,c),h+=f.vertexData.length/2*a,c+=f.indices.length,d.blend=p}t<e&&(d.size=c-d.start,++o),this._dcIndex=o,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(s){const t=this.renderer.texture;for(let e=0;e<s.count;e++)t.bind(s.elements[e],s.ids[e]),s.elements[e]=null;s.count=0}updateGeometry(){const{_packedGeometries:s,_attributeBuffer:t,_indexBuffer:e}=this;an.canUploadSameBuffer?(s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const s=this._dcIndex,{gl:t,state:e}=this.renderer,n=an._drawCallPool;let i=null;for(let r=0;r<s;r++){const{texArray:a,type:l,size:o,start:h,blend:c}=n[r];i!==a&&(i=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,e.set(this.state),t.drawElements(l,o,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),an.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]&&this._packedGeometries[s].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(s){const t=Sl(Math.ceil(s/8)),e=Qm(t),n=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new pu(n*this.vertexSize*4)),i}getIndexBuffer(s){const t=Sl(Math.ceil(s/12)),e=Qm(t),n=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let i=this._iBuffers[e];return i||(this._iBuffers[e]=i=new Uint16Array(n)),i}packInterleavedGeometry(s,t,e,n,i){const{uint32View:r,float32View:a}=t,l=n/this.vertexSize,o=s.uvs,h=s.indices,c=s.vertexData,d=s._texture.baseTexture._batchLocation,u=Math.min(s.worldAlpha,1),f=Kt.shared.setValue(s._tintRGB).toPremultiplied(u,s._texture.baseTexture.alphaMode>0);for(let m=0;m<c.length;m+=2)a[n++]=c[m],a[n++]=c[m+1],a[n++]=o[m],a[n++]=o[m+1],r[n++]=f,a[n++]=d;for(let m=0;m<h.length;m++)e[i++]=l+h[m]}};let vn=an;vn.defaultBatchSize=4096;vn.extension={name:"batch",type:ut.RendererPlugin};vn._drawCallPool=[];vn._textureArrayPool=[];bt.add(vn);var dE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,fE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Vo=class extends Kn{constructor(s,t,e){const n=Sn.from(s||Vo.defaultVertexSrc,t||Vo.defaultFragmentSrc);super(n,e),this.padding=0,this.resolution=Vo.defaultResolution,this.multisample=Vo.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new wi}apply(s,t,e,n,i){s.applyFilter(this,t,e,n)}get blendMode(){return this.state.blendMode}set blendMode(s){this.state.blendMode=s}get resolution(){return this._resolution}set resolution(s){this._resolution=s}static get defaultVertexSrc(){return fE}static get defaultFragmentSrc(){return dE}};let Je=Vo;Je.defaultResolution=1;Je.defaultMultisample=Ie.NONE;class lh{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Kt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:n,backgroundAlpha:i}=t,r=n??e;r!==void 0&&(this.color=r),this.alpha=i}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}lh.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};lh.extension={type:[ut.RendererSystem,ut.CanvasRendererSystem],name:"background"};bt.add(lh);class w0{constructor(t){this.renderer=t,this.emptyRenderer=new ah(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)}boundArray(t,e,n,i){const{elements:r,ids:a,count:l}=t;let o=0;for(let h=0;h<l;h++){const c=r[h],d=c._batchLocation;if(d>=0&&d<i&&e[d]===c){a[h]=d;continue}for(;o<i;){const u=e[o];if(u&&u._batchEnabled===n&&u._batchLocation===o){o++;continue}a[h]=o,c._batchLocation=o,e[o]=c;break}}}destroy(){this.renderer=null}}w0.extension={type:ut.RendererSystem,name:"batch"};bt.add(w0);let hp=0;class hh{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=hp++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=hp++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(ct.PREFER_ENV>=Cr.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}hh.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};hh.extension={type:ut.RendererSystem,name:"context"};bt.add(hh);class mE extends Aa{upload(t,e,n){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sn.UNPACK);const r=e.realWidth,a=e.realHeight;return n.width===r&&n.height===a?i.texSubImage2D(e.target,0,0,0,r,a,e.format,n.type,this.data):(n.width=r,n.height=a,i.texImage2D(e.target,0,n.internalFormat,r,a,0,e.format,n.type,this.data)),!0}}class vu{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new An("disposeFramebuffer"),this.multisample=Ie.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Ct(null,{scaleMode:Os.NEAREST,resolution:1,mipmap:tn.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Ct(new mE(null,{width:this.width,height:this.height}),{scaleMode:Os.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:tn.OFF,format:lt.DEPTH_COMPONENT,type:wt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class _0 extends Ct{constructor(t={}){if(typeof t=="number"){const e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];t={width:e,height:n,scaleMode:i,resolution:r}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Ie.NONE),super(null,t),this.mipmap=tn.OFF,this.valid=!0,this._clear=new Kt([0,0,0,0]),this.framebuffer=new vu(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Yi extends ca{constructor(t){const e=t,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;super(n,i),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){n===void 0&&!e.startsWith("data:")?t.crossOrigin=O_(e):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")}upload(t,e,n,i){const r=t.gl,a=e.realWidth,l=e.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&i.buffered.length===0)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===sn.UNPACK),!this.noSubImage&&e.target===r.TEXTURE_2D&&n.width===a&&n.height===l?r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,n.type,i):(n.width=a,n.height=l,r.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class E0 extends Yi{constructor(t,e){if(e=e||{},typeof t=="string"){const n=new Image;Yi.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??ct.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,n)=>{const i=this.source;this.url=i.src;const r=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?e(this.process()):e(this))};i.complete&&i.src?r():(i.onload=r,i.onerror=a=>{n(a),this.onError.emit(a)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>e(i,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===sn.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,n){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let i=!0;const r=e._glTextures;for(const a in r){const l=r[a];if(l!==n&&l.dirtyId!==e.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class S0{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const i=e.width,r=e.height;if(n){const a=t.width/2/i,l=t.height/2/r,o=t.x/i+a,h=t.y/r+l;n=ue.add(n,ue.NW),this.x0=o+a*ue.uX(n),this.y0=h+l*ue.uY(n),n=ue.add(n,2),this.x1=o+a*ue.uX(n),this.y1=h+l*ue.uY(n),n=ue.add(n,2),this.x2=o+a*ue.uX(n),this.y2=h+l*ue.uY(n),n=ue.add(n,2),this.x3=o+a*ue.uX(n),this.y3=h+l*ue.uY(n)}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const cp=new S0;function Ga(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}class pt extends _a{constructor(t,e,n,i,r,a,l){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Dt(0,0,1,1)),t instanceof pt&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=i,this.valid=!1,this._uvs=cp,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(r||0),r===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Ht(a.x,a.y):new Ht(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Xn[e.url]&&pt.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,pt.removeFromCache(this),this.textureCacheIds=null}clone(){var i;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new pt(this.baseTexture,!this.noFrame&&t,e,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===cp&&(this._uvs=new S0),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=ct.STRICT_TEXTURE_CACHE){const i=typeof t=="string";let r=null;if(i)r=t;else if(t instanceof Ct){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${wr()}`,Ct.addToCache(t,t.cacheId)}r=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${wr()}`}r=t._pixiId}let a=Xn[r];if(i&&n&&!a)throw new Error(`The cacheId "${r}" does not exist in TextureCache.`);return!a&&!(t instanceof Ct)?(e.resolution||(e.resolution=Ui(t)),a=new pt(new Ct(t,e)),a.baseTexture.cacheId=r,Ct.addToCache(a.baseTexture,r),pt.addToCache(a,r)):!a&&t instanceof Ct&&(a=new pt(t),pt.addToCache(a,r)),a}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),i=pt.from(t,Object.assign({resourceOptions:n},e),!1),r=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):r.load().then(()=>Promise.resolve(i))}static fromBuffer(t,e,n,i){return new pt(Ct.fromBuffer(t,e,n,i))}static fromLoader(t,e,n,i){const r=new Ct(t,Object.assign({scaleMode:Ct.defaultOptions.scaleMode,resolution:Ui(e)},i)),{resource:a}=r;a instanceof E0&&(a.url=e);const l=new pt(r);return n||(n=e),Ct.addToCache(l.baseTexture,n),pt.addToCache(l,n),n!==e&&(Ct.addToCache(l.baseTexture,e),pt.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(o=>{l.baseTexture.once("loaded",()=>o(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Xn[e]&&Xn[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Xn[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Xn[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Xn[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Xn[t.textureCacheIds[e]]===t&&delete Xn[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:i,height:r}=t,a=e+i>this.baseTexture.width,l=n+r>this.baseTexture.height;if(a||l){const o=a&&l?"and":"or",h=`X: ${e} + ${i} = ${e+i} > ${this.baseTexture.width}`,c=`Y: ${n} + ${r} = ${n+r} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${o} ${c}`)}this.valid=i&&r&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return pt._EMPTY||(pt._EMPTY=new pt(new Ct),Ga(pt._EMPTY),Ga(pt._EMPTY.baseTexture)),pt._EMPTY}static get WHITE(){if(!pt._WHITE){const t=ct.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),pt._WHITE=new pt(Ct.from(t)),Ga(pt._WHITE),Ga(pt._WHITE.baseTexture)}return pt._WHITE}}class Mr extends pt{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const i=this.baseTexture.resolution,r=Math.round(t*i)/i,a=Math.round(e*i)/i;this.valid=r>0&&a>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(r,a),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Mr(new _0(t))}}class T0{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=Ie.NONE){const i=new _0(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Mr(i)}getOptimalTexture(t,e,n=1,i=Ie.NONE){let r;t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Sl(t),e=Sl(e),r=((t&65535)<<16|e&65535)>>>0,i>1&&(r+=i*4294967296)):r=i>1?-i:-1,this.texturePool[r]||(this.texturePool[r]=[]);let a=this.texturePool[r].pop();return a||(a=this.createTexture(t,e,i)),a.filterPoolKey=r,a.setResolution(n),a}getFilterTexture(t,e,n){const i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||Ie.NONE);return i.filterFrame=t.filterFrame,i}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const n=this.texturePool[e];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const n=this.texturePool[e];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}T0.SCREEN_KEY=-1;class pE extends Xi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class A0 extends Xi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Se(this.vertices),this.uvBuffer=new Se(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class gE{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ie.NONE,this.sourceFrame=new Dt,this.destinationFrame=new Dt,this.bindingSourceFrame=new Dt,this.bindingDestinationFrame=new Dt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Wa=[new Ht,new Ht,new Ht,new Ht],wc=new se;class C0{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new T0,this.statePool=[],this.quad=new pE,this.quadUv=new A0,this.tempRect=new Dt,this.activeState={},this.globalUniforms=new Cn({outputFrame:new Dt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,i=this.defaultFilterStack,r=this.statePool.pop()||new gE,a=this.renderer.renderTexture;let l=e[0].resolution,o=e[0].multisample,h=e[0].padding,c=e[0].autoFit,d=e[0].legacy??!0;for(let m=1;m<e.length;m++){const p=e[m];l=Math.min(l,p.resolution),o=Math.min(o,p.multisample),h=this.useMaxPadding?Math.max(h,p.padding):h+p.padding,c=c&&p.autoFit,d=d||(p.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),i.push(r),r.resolution=l,r.multisample=o,r.legacy=d,r.target=t,r.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),r.sourceFrame.pad(h);const u=this.tempRect.copyFrom(a.sourceFrame);n.projection.transform&&this.transformAABB(wc.copyFrom(n.projection.transform).invert(),u),c?(r.sourceFrame.fit(u),(r.sourceFrame.width<=0||r.sourceFrame.height<=0)&&(r.sourceFrame.width=0,r.sourceFrame.height=0)):r.sourceFrame.intersects(u)||(r.sourceFrame.width=0,r.sourceFrame.height=0),this.roundFrame(r.sourceFrame,a.current?a.current.resolution:n.resolution,a.sourceFrame,a.destinationFrame,n.projection.transform),r.renderTexture=this.getOptimalFilterTexture(r.sourceFrame.width,r.sourceFrame.height,l,o),r.filters=e,r.destinationFrame.width=r.renderTexture.width,r.destinationFrame.height=r.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=r.sourceFrame.width,f.height=r.sourceFrame.height,r.renderTexture.filterFrame=r.sourceFrame,r.bindingSourceFrame.copyFrom(a.sourceFrame),r.bindingDestinationFrame.copyFrom(a.destinationFrame),r.transform=n.projection.transform,n.projection.transform=null,a.bind(r.renderTexture,r.sourceFrame,f),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;const r=i.inputSize,a=i.inputPixel,l=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],a[0]=Math.round(r[0]*e.resolution),a[1]=Math.round(r[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=e.sourceFrame.width*r[2]-.5*a[2],l[3]=e.sourceFrame.height*r[3]-.5*a[3],e.legacy){const h=i.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,e.renderTexture,o.renderTexture,Hn.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,e.resolution);c.filterFrame=h.filterFrame;let d=0;for(d=0;d<n.length-1;++d){d===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,e.resolution),c.filterFrame=h.filterFrame),n[d].apply(this,h,c,Hn.CLEAR,e);const u=h;h=c,c=u}n[d].apply(this,h,o.renderTexture,Hn.BLEND,e),d>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Hn.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,n.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const r=i.stateId&1||this.forceClear;(e===Hn.CLEAR||e===Hn.BLIT&&r)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,i){const r=this.renderer;r.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(En.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(En.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:r}=e._texture,a=t.set(i.width,0,0,i.height,n.x,n.y),l=e.worldTransform.copyTo(se.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/r.width,1/r.height),a.translate(e.anchor.x,e.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,i=Ie.NONE){return this.texturePool.getOptimalTexture(t,e,n,i)}getFilterTexture(t,e,n){if(typeof t=="number"){const r=t;t=e,e=r}t=t||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||Ie.NONE);return i.filterFrame=t.filterFrame,i}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=Wa[0],i=Wa[1],r=Wa[2],a=Wa[3];n.set(e.left,e.top),i.set(e.left,e.bottom),r.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(r,r),t.apply(a,a);const l=Math.min(n.x,i.x,r.x,a.x),o=Math.min(n.y,i.y,r.y,a.y),h=Math.max(n.x,i.x,r.x,a.x),c=Math.max(n.y,i.y,r.y,a.y);e.x=l,e.y=o,e.width=h-l,e.height=c-o}roundFrame(t,e,n,i,r){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(r){const{a,b:l,c:o,d:h}=r;if((Math.abs(l)>1e-4||Math.abs(o)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(h)>1e-4))return}r=r?wc.copyFrom(r):wc.identity(),r.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t)}}}C0.extension={type:ut.RendererSystem,name:"filter"};bt.add(C0);class xE{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ie.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const yE=new Dt;class M0{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new vu(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Dt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;ct.PREFER_ENV===Cr.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=i=>e.drawBuffersWEBGL(i):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:i}=this;if(t){const r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=n),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){const l=t.colorTextures[a];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const a=e.width>>n,l=e.height>>n,o=a/e.width;this.setViewport(e.x*o,e.y*o,a,l)}else{const a=t.width>>n,l=t.height>>n;this.setViewport(0,0,a,l)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,i){const r=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),(r.width!==n||r.height!==i||r.x!==t||r.y!==e)&&(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,i,r=Zc.COLOR|Zc.DEPTH){const{gl:a}=this;a.clearColor(t,e,n,i),a.clear(r)}initFramebuffer(t){const{gl:e}=this,n=new xE(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const i=t.colorTextures;let r=i.length;e.drawBuffers||(r=Math.min(r,1));for(let a=0;a<r;a++){const l=i[a],o=l.parentTextureArray||l;this.renderer.texture.bind(o,0),a===0&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures;let a=r.length;n.drawBuffers||(a=Math.min(a,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const l=[];for(let o=0;o<a;o++){const h=r[o],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),o===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+o,h.target,c._glTextures[this.CONTEXT_UID].texture,e),l.push(n.COLOR_ATTACHMENT0+o))}if(l.length>1&&n.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil)):i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=Ie.NONE;if(t<=1||e===null)return n;for(let i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return n===1&&(n=Ie.NONE),n}blit(t,e,n){const{current:i,renderer:r,gl:a,CONTEXT_UID:l}=this;if(r.context.webGLVersion!==2||!i)return;const o=i.glFramebuffers[l];if(!o)return;if(!t){if(!o.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;o.blitFramebuffer||(o.blitFramebuffer=new vu(i.width,i.height),o.blitFramebuffer.addColorTexture(0,c)),t=o.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==i.width||t.height!==i.height)&&(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}e||(e=yE,e.width=i.width,e.height=i.height),n||(n=e);const h=e.width===n.width&&e.height===n.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,o.framebuffer),a.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const n=t.width,i=t.height,r=this.gl,a=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,a),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,n,i):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=a,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Dt}destroy(){this.renderer=null}}M0.extension={type:ut.RendererSystem,name:"framebuffer"};bt.add(M0);const _c={5126:4,5123:2,5121:1};class I0{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;ct.PREFER_ENV===Cr.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=()=>n.createVertexArrayOES(),t.bindVertexArray=i=>n.bindVertexArrayOES(i),t.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const n=t.getExtension("ANGLE_instanced_arrays");n?(t.vertexAttribDivisor=(i,r)=>n.vertexAttribDivisorANGLE(i,r),t.drawElementsInstanced=(i,r,a,l,o)=>n.drawElementsInstancedANGLE(i,r,a,l,o),t.drawArraysInstanced=(i,r,a,l)=>n.drawArraysInstancedANGLE(i,r,a,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let i=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},r=!0);const a=i[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const i=t.buffers[n];e.update(i)}}checkCompatibility(t,e){const n=t.attributes,i=e.attributeData;for(const r in i)if(!n[r])throw new Error(`shader and geometry incompatible, geometry missing the "${r}" attribute`)}getSignature(t,e){const n=t.attributes,i=e.attributeData,r=["g",t.id];for(const a in n)i[a]&&r.push(a,i[a].location);return r.join("-")}initGeometryVao(t,e,n=!0){const i=this.gl,r=this.CONTEXT_UID,a=this.renderer.buffer,l=e.program;l.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const o=this.getSignature(t,l),h=t.glVertexArrayObjects[this.CONTEXT_UID];let c=h[o];if(c)return h[l.id]=c,c;const d=t.buffers,u=t.attributes,f={},m={};for(const p in d)f[p]=0,m[p]=0;for(const p in u)!u[p].size&&l.attributeData[p]?u[p].size=l.attributeData[p].size:u[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),f[u[p].buffer]+=u[p].size*_c[u[p].type];for(const p in u){const g=u[p],v=g.size;g.stride===void 0&&(f[g.buffer]===v*_c[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=m[g.buffer],m[g.buffer]+=v*_c[g.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let p=0;p<d.length;p++){const g=d[p];a.bind(g),n&&g._glBuffers[r].refCount++}return this.activateVao(t,l),h[l.id]=c,h[o]=c,i.bindVertexArray(null),a.unbind(qn.ARRAY_BUFFER),c}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,r=t.buffers,a=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!n){if(a)for(let o=0;o<r.length;o++){const h=r[o]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&a.dispose(r[o],e))}if(!e){for(const o in n)if(o[0]==="g"){const h=n[o];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,a=t.buffers,l=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);let o=null;for(const h in l){const c=l[h],d=a[c.buffer],u=d._glBuffers[i];if(e.attributeData[h]){o!==u&&(r.bind(d),o=u);const f=e.attributeData[h].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,n,i){const{gl:r}=this,a=this._activeGeometry;if(a.indexBuffer){const l=a.indexBuffer.data.BYTES_PER_ELEMENT,o=l===2?r.UNSIGNED_SHORT:r.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?r.drawElementsInstanced(t,e||a.indexBuffer.data.length,o,(n||0)*l,i||1):r.drawElements(t,e||a.indexBuffer.data.length,o,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?r.drawArraysInstanced(t,n,e||a.getSize(),i||1):r.drawArrays(t,n,e||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}I0.extension={type:ut.RendererSystem,name:"geometry"};bt.add(I0);const up=new se;class R0{constructor(t,e){this._texture=t,this.mapCoord=new se,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let i=0;i<t.length;i+=2){const r=t[i],a=t[i+1];e[i]=r*n.a+a*n.c+n.tx,e[i+1]=r*n.b+a*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=e.orig,r=e.trim;r&&(up.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(up));const a=e.baseTexture,l=this.uClampFrame,o=this.clampMargin/a.resolution,h=this.clampOffset;return l[0]=(e._frame.x+o+h)/a.width,l[1]=(e._frame.y+o+h)/a.height,l[2]=(e._frame.x+e._frame.width-o+h)/a.width,l[3]=(e._frame.y+e._frame.height-o+h)/a.height,this.uClampOffset[0]=h/a.realWidth,this.uClampOffset[1]=h/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&e.rotate===0,!0}}var bE=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class wE extends Je{constructor(t,e,n){let i=null;typeof t!="string"&&e===void 0&&n===void 0&&(i=t,t=void 0,e=void 0,n=void 0),super(t||vE,e||bE,n),this.maskSprite=i,this.maskMatrix=new se}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,i){const r=this._maskSprite,a=r._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new R0(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))}}class _E{constructor(t=null){this.type=Fe.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Je.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Fe.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class P0{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const r=this.maskDataPool.pop()||new _E;r.pooled=!0,r.maskObject=e,n=r}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==Fe.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Fe.SCISSOR:this.renderer.scissor.push(n);break;case Fe.STENCIL:this.renderer.stencil.push(n);break;case Fe.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case Fe.COLOR:this.pushColorMask(n);break}n.type===Fe.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Fe.SCISSOR:this.renderer.scissor.pop(e);break;case Fe.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Fe.SPRITE:this.popSpriteMask(e);break;case Fe.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===Fe.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Fe.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Fe.SCISSOR:t.type=Fe.STENCIL:t.type=Fe.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let i=t._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new wE]));const r=this.renderer,a=r.renderTexture;let l,o;if(a.current){const c=a.current;l=t.resolution||c.resolution,o=t.multisample??c.multisample}else l=t.resolution||r.resolution,o=t.multisample??r.multisample;i[0].resolution=l,i[0].multisample=o,i[0].maskSprite=e;const h=n.filterArea;n.filterArea=e.getBounds(!0),r.filter.push(n,i),n.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}P0.extension={type:ut.RendererSystem,name:"mask"};bt.add(P0);class k0{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const i=this.getStackLength();i!==n&&(i===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const dp=new se,fp=[],hl=class extends k0{constructor(s){super(s),this.glConst=ct.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const s=this.maskStack[this.maskStack.length-1];return s?s._scissorCounter:0}calcScissorRect(s){if(s._scissorRectLocal)return;const t=s._scissorRect,{maskObject:e}=s,{renderer:n}=this,i=n.renderTexture,r=e.getBounds(!0,fp.pop()??new Dt);this.roundFrameToPixels(r,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),t&&r.fit(t),s._scissorRectLocal=r}static isMatrixRotated(s){if(!s)return!1;const{a:t,b:e,c:n,d:i}=s;return(Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(s){const{maskObject:t}=s;if(!t.isFastRect||!t.isFastRect()||hl.isMatrixRotated(t.worldTransform)||hl.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(s);const e=s._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(s,t,e,n,i){hl.isMatrixRotated(i)||(i=i?dp.copyFrom(i):dp.identity(),i.translate(-e.x,-e.y).scale(n.width/e.width,n.height/e.height).translate(n.x,n.y),this.renderer.filter.transformAABB(i,s),s.fit(n),s.x=Math.round(s.x*t),s.y=Math.round(s.y*t),s.width=Math.round(s.width*t),s.height=Math.round(s.height*t))}push(s){s._scissorRectLocal||this.calcScissorRect(s);const{gl:t}=this.renderer;s._scissorRect||t.enable(t.SCISSOR_TEST),s._scissorCounter++,s._scissorRect=s._scissorRectLocal,this._useCurrent()}pop(s){const{gl:t}=this.renderer;s&&fp.push(s._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const s=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=s.y:t=this.renderer.height-s.height-s.y,this.renderer.gl.scissor(s.x,t,s.width,s.height)}};let F0=hl;F0.extension={type:ut.RendererSystem,name:"scissor"};bt.add(F0);class D0 extends k0{constructor(t){super(t),this.glConst=ct.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,i=t._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const r=t._colorMask;r!==0&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(t._colorMask=r,n.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,i!==0&&(n._colorMask=i,e.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}D0.extension={type:ut.RendererSystem,name:"stencil"};bt.add(D0);class B0{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Lt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Lt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Lt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}B0.extension={type:[ut.RendererSystem,ut.CanvasRendererSystem],name:"_plugin"};bt.add(B0);class O0{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new se,this.transform=null}update(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)}calculateProjection(t,e,n,i){const r=this.projectionMatrix,a=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=a*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-a-e.y*r.d}setTransform(t){}destroy(){this.renderer=null}}O0.extension={type:ut.RendererSystem,name:"projection"};bt.add(O0);const EE=new oh;class N0{constructor(t){this.renderer=t,this._tempMatrix=new se}generateTexture(t,e){const{region:n,...i}=e||{},r=n||t.getLocalBounds(null,!0);r.width===0&&(r.width=1),r.height===0&&(r.height=1);const a=Mr.create({width:r.width,height:r.height,...i});this._tempMatrix.tx=-r.x,this._tempMatrix.ty=-r.y;const l=t.transform;return t.transform=EE,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,a}destroy(){}}N0.extension={type:[ut.RendererSystem,ut.CanvasRendererSystem],name:"textureGenerator"};bt.add(N0);const Zi=new Dt,ko=new Dt;class L0{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Dt,this.destinationFrame=new Dt,this.viewportFrame=new Dt}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,n){const i=this.renderer;this.current=t;let r,a,l;t?(r=t.baseTexture,l=r.resolution,e||(Zi.width=t.frame.width,Zi.height=t.frame.height,e=Zi),n||(ko.x=t.frame.x,ko.y=t.frame.y,ko.width=e.width,ko.height=e.height,n=ko),a=r.framebuffer):(l=i.resolution,e||(Zi.width=i._view.screen.width,Zi.height=i._view.screen.height,e=Zi),n||(n=Zi,n.width=e.width,n.height=e.height));const o=this.viewportFrame;o.x=n.x*l,o.y=n.y*l,o.width=n.width*l,o.height=n.height*l,t||(o.y=i.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(a,o),this.renderer.projection.update(n,e,l,!a),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Kt.shared.setValue(t||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const r=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,l=r.width!==a.width||r.height!==a.height;if(l){let{x:o,y:h,width:c,height:d}=this.viewportFrame;o=Math.round(o),h=Math.round(h),c=Math.round(c),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,h,c,d)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,e),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}L0.extension={type:ut.RendererSystem,name:"renderTexture"};bt.add(L0);class SE{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function TE(s,t){const e={},n=t.getProgramParameter(s,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const r=t.getActiveAttrib(s,i);if(r.name.startsWith("gl_"))continue;const a=v0(t,r.type),l={type:a,name:r.name,size:b0(a),location:t.getAttribLocation(s,r.name)};e[r.name]=l}return e}function AE(s,t){const e={},n=t.getProgramParameter(s,t.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const r=t.getActiveUniform(s,i),a=r.name.replace(/\[.*?\]$/,""),l=!!r.name.match(/\[.*?\]$/),o=v0(t,r.type);e[a]={name:a,index:i,type:o,size:r.size,isArray:l,value:x0(o,r.size)}}return e}function CE(s,t){var o;const e=rp(s,s.VERTEX_SHADER,t.vertexSrc),n=rp(s,s.FRAGMENT_SHADER,t.fragmentSrc),i=s.createProgram();s.attachShader(i,e),s.attachShader(i,n);const r=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(r&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(i,r.names,r.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(i),s.getProgramParameter(i,s.LINK_STATUS)||sE(s,i,e,n),t.attributeData=TE(i,s),t.uniformData=AE(i,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((c,d)=>c>d?1:-1);for(let c=0;c<h.length;c++)t.attributeData[h[c]].location=c,s.bindAttribLocation(i,c,h[c]);s.linkProgram(i)}s.deleteShader(e),s.deleteShader(n);const a={};for(const h in t.uniformData){const c=t.uniformData[h];a[h]={location:s.getUniformLocation(i,h),value:x0(c.type,c.size)}}return new SE(i,a)}function ME(s,t,e,n,i){e.buffer.update(i)}const IE={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},V0={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function RE(s){const t=s.map(r=>({data:r,offset:0,dataLen:0,dirty:0}));let e=0,n=0,i=0;for(let r=0;r<t.length;r++){const a=t[r];if(e=V0[a.data.type],a.data.size>1&&(e=Math.max(e,16)*a.data.size),a.dataLen=e,n%e!==0&&n<16){const l=n%e%16;n+=l,i+=l}n+e>16?(i=Math.ceil(i/16)*16,a.offset=i,i+=e,n=e):(a.offset=i,n+=e,i+=e)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function PE(s,t){const e=[];for(const n in s)t[n]&&e.push(t[n]);return e.sort((n,i)=>n.index-i.index),e}function kE(s,t){if(!s.autoManage)return{size:0,syncFunc:ME};const e=PE(s.uniforms,t),{uboElements:n,size:i}=RE(e),r=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<n.length;a++){const l=n[a],o=s.uniforms[l.data.name],h=l.data.name;let c=!1;for(let d=0;d<no.length;d++){const u=no[d];if(u.codeUbo&&u.test(l.data,o)){r.push(`offset = ${l.offset/4};`,no[d].codeUbo(l.data.name,o)),c=!0;break}}if(!c)if(l.data.size>1){const d=b0(l.data.type),u=Math.max(V0[l.data.type]/16,1),f=d/u,m=(4-f%4)%4;r.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*u}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const d=IE[l.data.type];r.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${l.offset/4};
                ${d};
                `)}}return r.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",r.join(`
`))}}let FE=0;const Ha={textureCount:0,uboCount:0};class U0{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=FE++}systemCheck(){if(!iE())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(Ha.textureCount=0,Ha.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ha)),i}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Q_(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||t.dirtyId!==0||!n.uniformGroups[t.id]){t.dirtyId=0;const i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,Ha,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(t.buffer);const r=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[a];if(l||(l=this._uboCache[a]=kE(t,this.shader.program.uniformData)),t.autoManage){const o=new Float32Array(l.size/4);t.buffer.update(o)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const i=t.uniforms,r=[`${n}-`];for(const a in i)r.push(a),e[a]&&r.push(e[a].type);return r.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,i=CE(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}U0.extension={type:ut.RendererSystem,name:"shader"};bt.add(U0);class ch{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.4 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}ch.defaultOptions={hello:!1};ch.extension={type:[ut.RendererSystem,ut.CanvasRendererSystem],name:"startup"};bt.add(ch);function DE(s,t=[]){return t[ft.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.ADD]=[s.ONE,s.ONE],t[ft.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.NONE]=[0,0],t[ft.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],t[ft.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[ft.SRC_IN]=[s.DST_ALPHA,s.ZERO],t[ft.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],t[ft.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[ft.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],t[ft.DST_IN]=[s.ZERO,s.SRC_ALPHA],t[ft.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],t[ft.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],t[ft.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[ft.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],t}const BE=0,OE=1,NE=2,LE=3,VE=4,UE=5,wu=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ft.NONE,this._blendEq=!1,this.map=[],this.map[BE]=this.setBlend,this.map[OE]=this.setOffset,this.map[NE]=this.setCullFace,this.map[LE]=this.setDepthTest,this.map[VE]=this.setFrontFace,this.map[UE]=this.setDepthMask,this.checks=[],this.defaultState=new wi,this.defaultState.blend=!0}contextChange(s){this.gl=s,this.blendModes=DE(s),this.set(this.defaultState),this.reset()}set(s){if(s=s||this.defaultState,this.stateId!==s.data){let t=this.stateId^s.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(s.data&1<<e)),t=t>>1,e++;this.stateId=s.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,s)}forceState(s){s=s||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(s.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,s);this.stateId=s.data}setBlend(s){this.updateCheck(wu.checkBlendMode,s),this.gl[s?"enable":"disable"](this.gl.BLEND)}setOffset(s){this.updateCheck(wu.checkPolygonOffset,s),this.gl[s?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(s){this.gl[s?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(s){this.gl.depthMask(s)}setCullFace(s){this.gl[s?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(s){this.gl.frontFace(this.gl[s?"CW":"CCW"])}setBlendMode(s){if(s===this.blendMode)return;this.blendMode=s;const t=this.blendModes[s],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(s,t){this.gl.polygonOffset(s,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(s,t){const e=this.checks.indexOf(s);t&&e===-1?this.checks.push(s):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(s,t){s.setBlendMode(t.blendMode)}static checkPolygonOffset(s,t){s.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let X0=wu;X0.extension={type:ut.RendererSystem,name:"state"};bt.add(X0);class XE extends _a{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(i=>t.systems[i]),n=[...e,...Object.keys(t.systems).filter(i=>!e.includes(i))];for(const i of n)this.addSystem(t.systems[i],i)}addRunners(...t){t.forEach(e=>{this.runners[e]=new An(e)})}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach(i=>{const r=n.find(a=>this._systemsHash[a]===i);i[t.name](e[r])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const cl=class{constructor(s){this.renderer=s,this.count=0,this.checkCount=0,this.maxIdle=cl.defaultMaxIdle,this.checkCountMax=cl.defaultCheckCountMax,this.mode=cl.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ld.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const s=this.renderer.texture,t=s.managedTextures;let e=!1;for(let n=0;n<t.length;n++){const i=t[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(s.destroyTexture(i,!0),t[n]=null,e=!0)}if(e){let n=0;for(let i=0;i<t.length;i++)t[i]!==null&&(t[n++]=t[i]);t.length=n}}unload(s){const t=this.renderer.texture,e=s._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let n=s.children.length-1;n>=0;n--)this.unload(s.children[n])}destroy(){this.renderer=null}};let wn=cl;wn.defaultMode=ld.AUTO;wn.defaultMaxIdle=60*60;wn.defaultCheckCountMax=60*10;wn.extension={type:ut.RendererSystem,name:"textureGC"};bt.add(wn);class Ec{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=wt.UNSIGNED_BYTE,this.internalFormat=lt.RGBA,this.samplerType=0}}function YE(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[wt.UNSIGNED_BYTE]:{[lt.RGBA]:s.RGBA8,[lt.RGB]:s.RGB8,[lt.RG]:s.RG8,[lt.RED]:s.R8,[lt.RGBA_INTEGER]:s.RGBA8UI,[lt.RGB_INTEGER]:s.RGB8UI,[lt.RG_INTEGER]:s.RG8UI,[lt.RED_INTEGER]:s.R8UI,[lt.ALPHA]:s.ALPHA,[lt.LUMINANCE]:s.LUMINANCE,[lt.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[wt.BYTE]:{[lt.RGBA]:s.RGBA8_SNORM,[lt.RGB]:s.RGB8_SNORM,[lt.RG]:s.RG8_SNORM,[lt.RED]:s.R8_SNORM,[lt.RGBA_INTEGER]:s.RGBA8I,[lt.RGB_INTEGER]:s.RGB8I,[lt.RG_INTEGER]:s.RG8I,[lt.RED_INTEGER]:s.R8I},[wt.UNSIGNED_SHORT]:{[lt.RGBA_INTEGER]:s.RGBA16UI,[lt.RGB_INTEGER]:s.RGB16UI,[lt.RG_INTEGER]:s.RG16UI,[lt.RED_INTEGER]:s.R16UI,[lt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[wt.SHORT]:{[lt.RGBA_INTEGER]:s.RGBA16I,[lt.RGB_INTEGER]:s.RGB16I,[lt.RG_INTEGER]:s.RG16I,[lt.RED_INTEGER]:s.R16I},[wt.UNSIGNED_INT]:{[lt.RGBA_INTEGER]:s.RGBA32UI,[lt.RGB_INTEGER]:s.RGB32UI,[lt.RG_INTEGER]:s.RG32UI,[lt.RED_INTEGER]:s.R32UI,[lt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[wt.INT]:{[lt.RGBA_INTEGER]:s.RGBA32I,[lt.RGB_INTEGER]:s.RGB32I,[lt.RG_INTEGER]:s.RG32I,[lt.RED_INTEGER]:s.R32I},[wt.FLOAT]:{[lt.RGBA]:s.RGBA32F,[lt.RGB]:s.RGB32F,[lt.RG]:s.RG32F,[lt.RED]:s.R32F,[lt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[wt.HALF_FLOAT]:{[lt.RGBA]:s.RGBA16F,[lt.RGB]:s.RGB16F,[lt.RG]:s.RG16F,[lt.RED]:s.R16F},[wt.UNSIGNED_SHORT_5_6_5]:{[lt.RGB]:s.RGB565},[wt.UNSIGNED_SHORT_4_4_4_4]:{[lt.RGBA]:s.RGBA4},[wt.UNSIGNED_SHORT_5_5_5_1]:{[lt.RGBA]:s.RGB5_A1},[wt.UNSIGNED_INT_2_10_10_10_REV]:{[lt.RGBA]:s.RGB10_A2,[lt.RGBA_INTEGER]:s.RGB10_A2UI},[wt.UNSIGNED_INT_10F_11F_11F_REV]:{[lt.RGB]:s.R11F_G11F_B10F},[wt.UNSIGNED_INT_5_9_9_9_REV]:{[lt.RGB]:s.RGB9_E5},[wt.UNSIGNED_INT_24_8]:{[lt.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[wt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[lt.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:t={[wt.UNSIGNED_BYTE]:{[lt.RGBA]:s.RGBA,[lt.RGB]:s.RGB,[lt.ALPHA]:s.ALPHA,[lt.LUMINANCE]:s.LUMINANCE,[lt.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[wt.UNSIGNED_SHORT_5_6_5]:{[lt.RGB]:s.RGB},[wt.UNSIGNED_SHORT_4_4_4_4]:{[lt.RGBA]:s.RGBA},[wt.UNSIGNED_SHORT_5_5_5_1]:{[lt.RGBA]:s.RGBA}},t}class Y0{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ct,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=YE(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new Ec(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ec(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(t,e=0){const{gl:n}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let r=t-1;r>=0;--r){const a=e[r];a&&a._glTextures[i].samplerType!==Jc.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){const e=new Ec(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var n;e.internalFormat=((n=this.internalFormats[t.type])==null?void 0:n[t.format])??t.format,this.webGLVersion===2&&t.type===wt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var i;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),(i=t.resource)!=null&&i.upload(n,t,e))e.samplerType!==Jc.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,a=t.realHeight,l=n.gl;(e.width!==r||e.height!==a||e.dirtyId<0)&&(e.width=r,e.height=a,l.texImage2D(t.target,0,e.internalFormat,r,a,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const i=this.managedTextures.indexOf(t);i!==-1&&so(this.managedTextures,i,1)}}updateTextureStyle(t){var n;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===tn.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Li.CLAMP:e.wrapMode=t.wrapMode,(n=t.resource)!=null&&n.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==tn.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Os.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Os.LINEAR){const r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Os.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Os.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}Y0.extension={type:ut.RendererSystem,name:"texture"};bt.add(Y0);class $0{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:i}=this;e&&i.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:i}=this,r=e.createTransformFeedback();t._glTransformFeedbacks[i]=r,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r);for(let a=0;a<t.buffers.length;a++){const l=t.buffers[a];l&&(n.buffer.update(l),l._glBuffers[i].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a,l._glBuffers[i].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),r}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this);const r=this.renderer.buffer;if(r)for(let a=0;a<t.buffers.length;a++){const l=t.buffers[a];if(!l)continue;const o=l._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,o.refCount===0&&!e&&r.dispose(l,e))}n&&(e||i.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}$0.extension={type:ut.RendererSystem,name:"transformFeedback"};bt.add($0);class uh{constructor(t){this.renderer=t}init(t){this.screen=new Dt(0,0,t.width,t.height),this.element=t.view||ct.ADAPTER.createCanvas(),this.resolution=t.resolution||ct.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}uh.defaultOptions={width:800,height:600,resolution:ct.RESOLUTION,autoDensity:!1};uh.extension={type:[ut.RendererSystem,ut.CanvasRendererSystem],name:"_view"};bt.add(uh);ct.PREFER_ENV=Cr.WEBGL2;ct.STRICT_TEXTURE_CACHE=!1;ct.RENDER_OPTIONS={...hh.defaultOptions,...lh.defaultOptions,...uh.defaultOptions,...ch.defaultOptions};Object.defineProperties(ct,{WRAP_MODE:{get(){return Ct.defaultOptions.wrapMode},set(s){Lt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Ct.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return Ct.defaultOptions.scaleMode},set(s){Lt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Ct.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return Ct.defaultOptions.mipmap},set(s){Lt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Ct.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return Ct.defaultOptions.anisotropicLevel},set(s){Lt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Ct.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return Lt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Je.defaultResolution},set(s){Je.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return Lt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Je.defaultMultisample},set(s){Je.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return vn.defaultMaxTextures},set(s){Lt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),vn.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return vn.defaultBatchSize},set(s){Lt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),vn.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return vn.canUploadSameBuffer},set(s){Lt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),vn.canUploadSameBuffer=s}},GC_MODE:{get(){return wn.defaultMode},set(s){Lt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),wn.defaultMode=s}},GC_MAX_IDLE:{get(){return wn.defaultMaxIdle},set(s){Lt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),wn.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return wn.defaultCheckCountMax},set(s){Lt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),wn.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return Sn.defaultVertexPrecision},set(s){Lt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Sn.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return Sn.defaultFragmentPrecision},set(s){Lt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Sn.defaultFragmentPrecision=s}}});var _r=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(_r||{});class Sc{constructor(t,e=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const ks=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Sc(null,null,1/0),this.deltaMS=1/ks.targetFPMS,this.elapsedMS=1/ks.targetFPMS,this._tick=s=>{this._requestId=null,this.started&&(this.update(s),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(s,t,e=_r.NORMAL){return this._addListener(new Sc(s,t,e))}addOnce(s,t,e=_r.NORMAL){return this._addListener(new Sc(s,t,e,!0))}_addListener(s){let t=this._head.next,e=this._head;if(!t)s.connect(e);else{for(;t;){if(s.priority>t.priority){s.connect(e);break}e=t,t=t.next}s.previous||s.connect(e)}return this._startIfPossible(),this}remove(s,t){let e=this._head.next;for(;e;)e.match(s,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let s=0,t=this._head;for(;t=t.next;)s++;return s}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let s=this._head.next;for(;s;)s=s.destroy(!0);this._head.destroy(),this._head=null}}update(s=performance.now()){let t;if(s>this.lastTime){if(t=this.elapsedMS=s-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const i=s-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=s-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ks.targetFPMS;const e=this._head;let n=e.next;for(;n;)n=n.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=s}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(s){const t=Math.min(this.maxFPS,s),e=Math.min(Math.max(0,t)/1e3,ks.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(s){if(s===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,s);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ks._shared){const s=ks._shared=new ks;s.autoStart=!0,s._protected=!0}return ks._shared}static get system(){if(!ks._system){const s=ks._system=new ks;s.autoStart=!0,s._protected=!0}return ks._system}};let Oe=ks;Oe.targetFPMS=.06;Object.defineProperties(ct,{TARGET_FPMS:{get(){return Oe.targetFPMS},set(s){Lt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Oe.targetFPMS=s}}});class G0{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,_r.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Oe.shared:new Oe,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}G0.extension=ut.Application;bt.add(G0);const W0=[];bt.handleByList(ut.Renderer,W0);function $E(s){for(const t of W0)if(t.test(s))return new t(s);throw new Error("Unable to auto-detect a suitable renderer.")}var GE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,WE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const HE=GE,H0=WE;class z0{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=Ie.HIGH?this.multisample=Ie.HIGH:e>=Ie.MEDIUM?this.multisample=Ie.MEDIUM:e>=Ie.LOW?this.multisample=Ie.LOW:this.multisample=Ie.NONE}destroy(){}}z0.extension={type:ut.RendererSystem,name:"_multisample"};bt.add(z0);class zE{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class j0{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[e]!==t){const r=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer)}}bindBufferRange(t,e,n){const{gl:i,CONTEXT_UID:r}=this;n=n||0;const a=t._glBuffers[r]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,a.buffer,n*256,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new zE(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}j0.extension={type:ut.RendererSystem,name:"buffer"};bt.add(j0);class q0{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let i,r,a,l;if(e&&(i=e.renderTexture,r=e.clear,a=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=a,!n.context.isLost){if(i||(this.lastObjectRendered=t),!l){const o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(r??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),i&&(e.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}q0.extension={type:ut.RendererSystem,name:"objectRenderer"};bt.add(q0);const _u=class extends XE{constructor(s){super(),this.type=Rg.WEBGL,s=Object.assign({},ct.RENDER_OPTIONS,s),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Cn({projectionMatrix:new se},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:_u.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in s&&(Lt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),s.premultipliedAlpha=s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",s.backgroundAlpha=s.useContextAlpha===!1?1:s.backgroundAlpha),this._plugin.rendererPlugins=_u.__plugins,this.options=s,this.startup.run(this.options)}static test(s){return s!=null&&s.forceCanvas?!1:y_()}render(s,t){this.objectRenderer.render(s,t)}resize(s,t){this._view.resizeView(s,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(s=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:s}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(s){this._view.resolution=s,this.runners.resolutionChange.emit(s)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Lt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Lt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Lt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Lt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(s){Lt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=s}get backgroundAlpha(){return Lt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(s){Lt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=s}get powerPreference(){return Lt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(s,t){return this.textureGenerator.generateTexture(s,t)}};let wo=_u;wo.extension={type:ut.Renderer,priority:1};wo.__plugins={};wo.__systems={};bt.handleByMap(ut.RendererPlugin,wo.__plugins);bt.handleByMap(ut.RendererSystem,wo.__systems);bt.add(wo);class K0 extends ca{constructor(t,e){const{width:n,height:i}=e||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let r=0;r<t;r++){const a=new Ct;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof ca?this.addResourceAt(t[n],n):this.addResourceAt(f0(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:i}=this.items[0];return this.resize(n,i),Promise.resolve(this)}),this._load}}class jE extends K0{constructor(t,e){const{width:n,height:i}=e||{};let r,a;Array.isArray(t)?(r=t,a=t.length):a=t,super(a,{width:n,height:i}),r&&this.initFromArray(r,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Jr.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:i,itemDirtyIds:r,items:a}=this,{gl:l}=t;n.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,e.format,n.type,null);for(let o=0;o<i;o++){const h=a[o];r[o]<h.dirtyId&&(r[o]=h.dirtyId,h.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,o,h.resource.width,h.resource.height,1,e.format,n.type,h.resource.source))}return!0}}class qE extends Yi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Uo=class extends K0{constructor(s,t){const{width:e,height:n,autoLoad:i,linkBaseTexture:r}=t||{};if(s&&s.length!==Uo.SIDES)throw new Error(`Invalid length. Got ${s.length}, expected 6`);super(6,{width:e,height:n});for(let a=0;a<Uo.SIDES;a++)this.items[a].target=Jr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=r!==!1,s&&this.initFromArray(s,t),i!==!1&&this.load()}bind(s){super.bind(s),s.target=Jr.TEXTURE_CUBE_MAP}addBaseTextureAt(s,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||s.parentTextureArray||Object.keys(s._glTextures).length>0)if(s.resource)this.addResourceAt(s.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else s.target=Jr.TEXTURE_CUBE_MAP_POSITIVE_X+t,s.parentTextureArray=this.baseTexture,this.items[t]=s;return s.valid&&!this.valid&&this.resize(s.realWidth,s.realHeight),this.items[t]=s,this}upload(s,t,e){const n=this.itemDirtyIds;for(let i=0;i<Uo.SIDES;i++){const r=this.items[i];(n[i]<r.dirtyId||e.dirtyId<t.dirtyId)&&(r.valid&&r.resource?(r.resource.upload(s,r,e),n[i]=r.dirtyId):n[i]<-1&&(s.gl.texImage2D(r.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),n[i]=-1))}return!0}static test(s){return Array.isArray(s)&&s.length===Uo.SIDES}};let Z0=Uo;Z0.SIDES=6;class jr extends Yi{constructor(t,e){e=e||{};let n,i;typeof t=="string"?(n=jr.EMPTY,i=t):(n=t,i=null),super(n),this.url=i,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const n=await ct.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const r=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===sn.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=r,this.update(),t(this)}catch(n){if(this.destroyed)return;e(n),this.onError.emit(n)}}),this._load)}upload(t,e,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return jr._EMPTY=jr._EMPTY??ct.ADAPTER.createCanvas(0,0),jr._EMPTY}}const ul=class extends Yi{constructor(s,t){t=t||{},super(ct.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=s,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(s=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),s(this)},ul.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const s=new Image;Yi.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=t=>{this._resolve&&(s.onerror=null,this.onError.emit(t))},s.onload=()=>{if(!this._resolve)return;const t=s.width,e=s.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,i=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/e*t,i=this._overrideHeight||this._overrideWidth/t*e),n=Math.round(n),i=Math.round(i);const r=this.source;r.width=n,r.height=i,r._pixiId=`canvas_${wr()}`,r.getContext("2d").drawImage(s,0,0,t,e,0,0,n,i),this._resolve(),this._resolve=null}}static getSize(s){const t=ul.SVG_SIZE.exec(s),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(s,t){return t==="svg"||typeof s=="string"&&s.startsWith("data:image/svg+xml")||typeof s=="string"&&ul.SVG_XML.test(s)}};let ua=ul;ua.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;ua.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Eu=class extends Yi{constructor(s,t){if(t=t||{},!(s instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof s=="string"&&(s=[s]);const n=s[0].src||s[0];Yi.crossOrigin(e,n,t.crossorigin);for(let i=0;i<s.length;++i){const r=document.createElement("source");let{src:a,mime:l}=s[i];a=a||s[i];const o=a.split("?").shift().toLowerCase(),h=o.slice(o.lastIndexOf(".")+1);l=l||Eu.MIME_TYPES[h]||`video/${h}`,r.src=a,r.type=l,e.appendChild(r)}s=e}super(s),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(s=0){if(!this.destroyed){const t=Oe.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,s.load())}),this._load}_onError(s){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(s)}_isSourcePlaying(){const s=this.source;return!s.paused&&!s.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Oe.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Oe.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const s=this.source;s.removeEventListener("canplay",this._onCanPlay),s.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(s.videoWidth,s.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&s.play()}dispose(){this._isConnectedToTicker&&(Oe.shared.remove(this.update,this),this._isConnectedToTicker=!1);const s=this.source;s&&(s.removeEventListener("error",this._onError,!0),s.pause(),s.src="",s.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,!this._autoUpdate&&this._isConnectedToTicker?(Oe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Oe.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(s){s!==this._updateFPS&&(this._updateFPS=s)}static test(s,t){return globalThis.HTMLVideoElement&&s instanceof HTMLVideoElement||Eu.TYPES.includes(t)}};let bd=Eu;bd.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];bd.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};gu.push(jr,E0,qE,bd,ua,Aa,Z0,jE);class Cl{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Dt.EMPTY:(t=t||new Dt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:i,c:r,d:a,tx:l,ty:o}=t,h=n*e.x+r*e.y+l,c=i*e.x+a*e.y+o;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,a=t[0],l=t[1];e=a<e?a:e,n=l<n?l:n,i=a>i?a:i,r=l>r?l:r,a=t[2],l=t[3],e=a<e?a:e,n=l<n?l:n,i=a>i?a:i,r=l>r?l:r,a=t[4],l=t[5],e=a<e?a:e,n=l<n?l:n,i=a>i?a:i,r=l>r?l:r,a=t[6],l=t[7],e=a<e?a:e,n=l<n?l:n,i=a>i?a:i,r=l>r?l:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r}addFrame(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r)}addFrameMatrix(t,e,n,i,r){const a=t.a,l=t.b,o=t.c,h=t.d,c=t.tx,d=t.ty;let u=this.minX,f=this.minY,m=this.maxX,p=this.maxY,g=a*e+o*n+c,v=l*e+h*n+d;u=g<u?g:u,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*i+o*n+c,v=l*i+h*n+d,u=g<u?g:u,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*e+o*r+c,v=l*e+h*r+d,u=g<u?g:u,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*i+o*r+c,v=l*i+h*r+d,u=g<u?g:u,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,this.minX=u,this.minY=f,this.maxX=m,this.maxY=p}addVertexData(t,e,n){let i=this.minX,r=this.minY,a=this.maxX,l=this.maxY;for(let o=e;o<n;o+=2){const h=t[o],c=t[o+1];i=h<i?h:i,r=c<r?c:r,a=h>a?h:a,l=c>l?c:l}this.minX=i,this.minY=r,this.maxX=a,this.maxY=l}addVertices(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)}addVerticesMatrix(t,e,n,i,r=0,a=r){const l=t.a,o=t.b,h=t.c,c=t.d,d=t.tx,u=t.ty;let f=this.minX,m=this.minY,p=this.maxX,g=this.maxY;for(let v=n;v<i;v+=2){const b=e[v],x=e[v+1],y=l*b+h*x+d,w=c*x+o*b+u;f=Math.min(f,y-r),p=Math.max(p,y+r),m=Math.min(m,w-a),g=Math.max(g,w+a)}this.minX=f,this.minY=m,this.maxX=p,this.maxY=g}addBounds(t){const e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=a){const l=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=n<l?n:l,this.minY=i<o?i:o,this.maxX=r>h?r:h,this.maxY=a>c?a:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=a){const l=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=n<l?n:l,this.minY=i<o?i:o,this.maxX=r>h?r:h,this.maxY=a>c?a:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,i,r,a){t-=r,e-=a,n+=r,i+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i}}class pe extends _a{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new oh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Cl,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const i=e[n];Object.defineProperty(pe.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Dt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Dt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Cl);const e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,a}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,n=1,i=1,r=0,a=0,l=0,o=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=a,this.skew.y=l,this.pivot.x=o,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new KE),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*H_}set angle(t){this.transform.rotation=t*z_}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class KE extends pe{constructor(){super(...arguments),this.sortDirty=null}}pe.prototype.displayObjectUpdateTransform=pe.prototype.updateTransform;const ZE=new se;function JE(s,t){return s.zIndex===t.zIndex?s._lastSortedIndex-t._lastSortedIndex:s.zIndex-t.zIndex}const Su=class extends pe{constructor(){super(),this.children=[],this.sortableChildren=Su.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(s){}addChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.addChild(s[t]);else{const t=s[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return s[0]}addChildAt(s,t){if(t<0||t>this.children.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.splice(t,0,s),this._boundsID++,this.onChildrenChange(t),s.emit("added",this),this.emit("childAdded",s,this,t),s}swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=s,this.onChildrenChange(e<n?e:n)}getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(s);so(this.children,e,1),this.children.splice(t,0,s),this.onChildrenChange(t)}getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]}removeChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.removeChild(s[t]);else{const t=s[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,so(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return s[0]}removeChildAt(s){const t=this.getChildAt(s);return t.parent=null,t.transform._parentID=-1,so(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this),this.emit("childRemoved",t,this,s),t}removeChildren(s=0,t=this.children.length){const e=s,n=t,i=n-e;let r;if(i>0&&i<=n){r=this.children.splice(e,i);for(let a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(s);for(let a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let s=!1;for(let t=0,e=this.children.length;t<e;++t){const n=this.children[t];n._lastSortedIndex=t,!s&&n.zIndex!==0&&(s=!0)}s&&this.children.length>1&&this.children.sort(JE),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let s=0,t=this.children.length;s<t;++s){const e=this.children[s];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let s=0;s<this.children.length;s++){const t=this.children[s];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(s,t=!1){const e=super.getLocalBounds(s);if(!t)for(let n=0,i=this.children.length;n<i;++n){const r=this.children[n];r.visible&&r.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(s){const t=s.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,n;this.cullArea?(e=this.cullArea,n=this.worldTransform):this._render!==Su.prototype._render&&(e=this.getBounds(!0));const i=s.projection.transform;if(i&&(n?(n=ZE.copyFrom(n),n.prepend(i)):n=i),e&&t.intersects(e,n))this._render(s);else if(this.cullArea)return;for(let r=0,a=this.children.length;r<a;++r){const l=this.children[r],o=l.cullable;l.cullable=o||!this.cullArea,l.render(s),l.cullable=o}}render(s){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(s);else if(this.cullable)this._renderWithCulling(s);else{this._render(s);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(s)}}renderAdvanced(s){var i,r,a;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const n=t&&((i=this._enabledFilters)==null?void 0:i.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==Fe.NONE));if(n&&s.batch.flush(),t&&((r=this._enabledFilters)!=null&&r.length)&&s.filter.push(this,this._enabledFilters),e&&s.mask.push(this,this._mask),this.cullable)this._renderWithCulling(s);else{this._render(s);for(let l=0,o=this.children.length;l<o;++l)this.children[l].render(s)}n&&s.batch.flush(),e&&s.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&s.filter.pop()}_render(s){}destroy(s){super.destroy(),this.sortDirty=!1;const t=typeof s=="boolean"?s:s==null?void 0:s.children,e=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<e.length;++n)e[n].destroy(s)}get width(){return this.scale.x*this.getLocalBounds().width}set width(s){const t=this.getLocalBounds().width;t!==0?this.scale.x=s/t:this.scale.x=1,this._width=s}get height(){return this.scale.y*this.getLocalBounds().height}set height(s){const t=this.getLocalBounds().height;t!==0?this.scale.y=s/t:this.scale.y=1,this._height=s}};let Mt=Su;Mt.defaultSortableChildren=!1;Mt.prototype.containerUpdateTransform=Mt.prototype.updateTransform;Object.defineProperties(ct,{SORTABLE_CHILDREN:{get(){return Mt.defaultSortableChildren},set(s){Lt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Mt.defaultSortableChildren=s}}});const Fo=new Ht,QE=new Uint16Array([0,1,2,0,2,3]);class ve extends Mt{constructor(t){super(),this._anchor=new Ni(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Kt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ft.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||pt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=QE,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ct.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Oi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Oi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,a=e.d,l=e.tx,o=e.ty,h=this.vertexData,c=t.trim,d=t.orig,u=this._anchor;let f=0,m=0,p=0,g=0;if(c?(m=c.x-u._x*d.width,f=m+c.width,g=c.y-u._y*d.height,p=g+c.height):(m=-u._x*d.width,f=m+d.width,g=-u._y*d.height,p=g+d.height),h[0]=n*m+r*g+l,h[1]=a*g+i*m+o,h[2]=n*f+r*g+l,h[3]=a*g+i*f+o,h[4]=n*f+r*p+l,h[5]=a*p+i*f+o,h[6]=n*m+r*p+l,h[7]=a*p+i*m+o,this._roundPixels){const v=ct.RESOLUTION;for(let b=0;b<h.length;++b)h[b]=Math.round(h[b]*v)/v}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,a=r.a,l=r.b,o=r.c,h=r.d,c=r.tx,d=r.ty,u=-i._x*n.width,f=u+n.width,m=-i._y*n.height,p=m+n.height;e[0]=a*u+o*m+c,e[1]=h*m+l*u+d,e[2]=a*f+o*m+c,e[3]=h*m+l*f+d,e[4]=a*f+o*p+c,e[5]=h*p+l*f+d,e[6]=a*u+o*p+c,e[7]=h*p+l*u+d}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Cl),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Dt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Fo);const e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x;let r=0;return Fo.x>=i&&Fo.x<i+e&&(r=-n*this.anchor.y,Fo.y>=r&&Fo.y<r+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(t,e){const n=t instanceof pt?t:pt.from(t,e);return new ve(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=Oi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=Oi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||pt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const J0=new se;pe.prototype._cacheAsBitmap=!1;pe.prototype._cacheData=null;pe.prototype._cacheAsBitmapResolution=null;pe.prototype._cacheAsBitmapMultisample=null;class tS{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(pe.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(s){s!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(s){s!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(s){if(this._cacheAsBitmap===s)return;this._cacheAsBitmap=s;let t;s?(this._cacheData||(this._cacheData=new tS),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});pe.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};pe.prototype._initCachedDisplayObject=function(t){var u,f;if((u=this._cacheData)!=null&&u.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(null,!0).clone();if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;n.pad(m)}n.ceil(ct.RESOLUTION);const i=t.renderTexture.current,r=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,o=Mr.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${wr()}`;this._cacheData.textureCacheId=h,Ct.addToCache(o.baseTexture,h),pt.addToCache(o,h);const c=this.transform.localTransform.copyTo(J0).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:o,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(i,r,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new ve(o);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(n.x/n.width),d.anchor.y=-(n.y/n.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};pe.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};pe.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;const i=t.canvasContext.activeContext,r=t._projTransform;e.ceil(ct.RESOLUTION);const a=Mr.create({width:e.width,height:e.height}),l=`cacheAsBitmap_${wr()}`;this._cacheData.textureCacheId=l,Ct.addToCache(a.baseTexture,l),pt.addToCache(a,l);const o=J0;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:o,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const h=new ve(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(e.x/e.width),h.anchor.y=-(e.y/e.height),h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};pe.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};pe.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};pe.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Ct.removeFromCache(this._cacheData.textureCacheId),pt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};pe.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};pe.prototype.name=null;Mt.prototype.getChildByName=function(t,e){for(let n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,i=this.children.length;n<i;n++){const r=this.children[n];if(!r.getChildByName)continue;const a=r.getChildByName(t,!0);if(a)return a}return null};pe.prototype.getGlobalPosition=function(t=new Ht,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var eS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class sS extends Je{constructor(t=1){super(HE,eS,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const nS={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},iS=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function rS(s){const t=nS[s],e=t.length;let n=iS,i="";const r="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let l=0;l<s;l++){let o=r.replace("%index%",l.toString());a=l,l>=e&&(a=s-l-1),o=o.replace("%value%",t[a].toString()),i+=o,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",s.toString()),n}const oS=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function aS(s,t){const e=Math.ceil(s/2);let n=oS,i="",r;t?r="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":r="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<s;a++){let l=r.replace("%index%",a.toString());l=l.replace("%sampleIndex%",`${a-(e-1)}.0`),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",s.toString()),n}class Tu extends Je{constructor(t,e=8,n=4,i=Je.defaultResolution,r=5){const a=aS(r,t),l=rS(r);super(a,l),this.horizontal=t,this.resolution=i,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,n,i);else{const r=t.getFilterTexture(),a=t.renderer;let l=e,o=r;this.state.blend=!1,t.applyFilter(this,l,o,Hn.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(l,Hn.BLIT),this.uniforms.uSampler=o;const c=o;o=l,l=c,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,n,i),t.returnFilterTexture(r)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class lS extends Je{constructor(t=8,e=4,n=Je.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Tu(!0,t,e,n,i),this.blurYFilter=new Tu(!1,t,e,n,i),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,i){const r=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(r&&a){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,Hn.CLEAR),this.blurYFilter.apply(t,l,n,i),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var hS=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Au extends Je{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(H0,hS,t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const[n,i,r]=Kt.shared.setValue(t).toArray(),a=[n,0,0,0,0,0,i,0,0,0,0,0,r,0,0,0,0,0,1,0];this._loadMatrix(a,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),i=Math.sin(t),r=Math.sqrt,a=1/3,l=r(a),o=n+(1-n)*a,h=a*(1-n)-l*i,c=a*(1-n)+l*i,d=a*(1-n)+l*i,u=n+a*(1-n),f=a*(1-n)-l*i,m=a*(1-n)-l*i,p=a*(1-n)+l*i,g=n+a*(1-n),v=[o,h,c,0,0,d,u,f,0,0,m,p,g,0,0,0,0,0,1,0];this._loadMatrix(v,e)}contrast(t,e){const n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)}saturate(t=0,e){const n=t*2/3+1,i=(n-1)*-.5,r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,n,i,r){t=t||.2,e=e||.15,n=n||16770432,i=i||3375104;const a=Kt.shared,[l,o,h]=a.setValue(n).toArray(),[c,d,u]=a.setValue(i).toArray(),f=[.3,.59,.11,0,0,l,o,h,t,0,c,d,u,e,0,l-c,o-d,h-u,0,0];this._loadMatrix(f,r)}night(t,e){t=t||.1;const n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Au.prototype.grayscale=Au.prototype.greyscale;var cS=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,uS=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class dS extends Je{constructor(t,e){const n=new se;t.renderable=!1,super(uS,cS,{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,e==null&&(e=20),this.scale=new Ht(e,e)}apply(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const r=this.maskSprite.worldTransform,a=Math.sqrt(r.a*r.a+r.b*r.b),l=Math.sqrt(r.c*r.c+r.d*r.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=r.a/a,this.uniforms.rotation[1]=r.b/a,this.uniforms.rotation[2]=r.c/l,this.uniforms.rotation[3]=r.d/l),t.applyFilter(this,e,n,i)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var fS=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,mS=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class pS extends Je{constructor(){super(mS,fS)}}var gS=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class xS extends Je{constructor(t=.5,e=Math.random()){super(H0,gS,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const mp={AlphaFilter:sS,BlurFilter:lS,BlurFilterPass:Tu,ColorMatrixFilter:Au,DisplacementFilter:dS,FXAAFilter:pS,NoiseFilter:xS};Object.entries(mp).forEach(([s,t])=>{Object.defineProperty(mp,s,{get(){return Lt("7.1.0",`filters.${s} has moved to ${s}`),t}})});class yS{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Oe.system.add(this.tickerUpdate,this,_r.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Oe.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Di=new yS;class Ca{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ca.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ht,this.page=new Ht,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,i,r){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ml extends Ca{constructor(){super(...arguments),this.client=new Ht,this.movement=new Ht,this.offset=new Ht,this.global=new Ht,this.screen=new Ht}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,i,r,a,l,o,h,c,d,u,f,m,p){throw new Error("Method not implemented.")}}class ln extends Ml{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class go extends Ml{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}go.DOM_DELTA_PIXEL=0;go.DOM_DELTA_LINE=1;go.DOM_DELTA_PAGE=2;const bS=2048,vS=new Ht,Tc=new Ht;class wS{constructor(t){this.dispatch=new _a,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((n,i)=>n.priority-i.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,i=e.length;n<i;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Di.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[i](this.rootTarget,this.rootTarget.eventMode,vS.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,r=n.length-1;i<r;i++)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this._allInteractiveElements){if(n.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const i=Array.isArray(e)?e:[e];for(let r=n.length-1;r>=0;r--)i.forEach(a=>{t.currentTarget=n[r],this.notifyTarget(t,a)})}propagationPath(t){const e=[t];for(let n=0;n<bS&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,n,i,r,a=!1){let l=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Di.pauseUpdate=!1),t.interactiveChildren&&t.children){const c=t.children;for(let d=c.length-1;d>=0;d--){const u=c[d],f=this.hitTestMoveRecursive(u,this._isInteractive(e)?e:u.eventMode,n,i,r,a||r(t,n));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=t.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),l=!0}}}const o=this._isInteractive(e),h=t.isInteractive();return h&&h&&this._allInteractiveElements.push(t),a||this._hitElements.length>0?null:l?this._hitElements:o&&!r(t,n)&&i(t,n)?h?[t]:[]:null}hitTestRecursive(t,e,n,i,r){if(this._interactivePrune(t)||r(t,n))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Di.pauseUpdate=!1),t.interactiveChildren&&t.children){const o=t.children;for(let h=o.length-1;h>=0;h--){const c=o[h],d=this.hitTestRecursive(c,this._isInteractive(e)?e:c.eventMode,n,i,r);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const u=t.isInteractive();return(d.length>0||u)&&d.push(t),d}}}const a=this._isInteractive(e),l=t.isInteractive();return a&&i(t,n)?l?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var n;if(t.hitArea&&(t.worldTransform.applyInverse(e,Tc),!t.hitArea.contains(Tc.x,Tc.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var r,a;e=e??t.type;const n=`on${e}`;(a=(r=t.currentTarget)[n])==null||a.call(r,t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const i=e.button===2;this.dispatchEvent(e,i?"rightdown":"mousedown")}const n=this.trackingData(t.pointerId);n.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var o,h;if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.overTargets);if(((o=i.overTargets)==null?void 0:o.length)>0&&r!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,c,r);if(this.dispatchEvent(d,"pointerout"),n&&this.dispatchEvent(d,"mouseout"),!e.composedPath().includes(r)){const u=this.createPointerEvent(t,"pointerleave",r);for(u.eventPhase=u.AT_TARGET;u.target&&!e.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),n&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(d)}if(r!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(e,c);this.dispatchEvent(d,"pointerover"),n&&this.dispatchEvent(d,"mouseover");let u=r==null?void 0:r.parent;for(;u&&u!==this.rootTarget.parent&&u!==e.target;)u=u.parent;if(!u||u===this.rootTarget.parent){const m=this.clonePointerEvent(e,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==r&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),n&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(d)}const a=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(e,"pointermove"),l&&a.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),l&&a.push("globaltouchmove")),n&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),l&&a.push("globalmousemove"),this.cursor=(h=e.target)==null?void 0:h.cursor),a.length>0&&this.all(e,a),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var a;if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(a=n.target)==null?void 0:a.cursor);const r=this.clonePointerEvent(n,"pointerenter");for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),i&&this.notifyTarget(r,"mouseenter"),r.target=r.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(r)}mapPointerOut(t){if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const n=t.pointerType==="mouse"||t.pointerType==="pen",i=this.findMountedTarget(e.overTargets),r=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(r),n&&this.dispatchEvent(r,"mouseout");const a=this.createPointerEvent(t,"pointerleave",i);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),n&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;e.overTargets=null,this.freeEvent(r),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.dispatchEvent(n,l?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]);let a=r;if(r&&!n.composedPath().includes(r)){let l=r;for(;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const o=n.button===2;this.notifyTarget(n,o?"rightupoutside":"mouseupoutside")}l=l.parent}delete i.pressTargetsByButton[t.button],a=l}if(a){const l=this.clonePointerEvent(n,"click");l.target=a,l.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const o=i.clicksByButton[t.button];if(o.target===l.target&&e-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=l.target,o.timeStamp=e,l.detail=o.clickCount,l.pointerType==="mouse"){const h=l.button===2;this.dispatchEvent(l,h?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof ln)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(n){let r=n;for(;r;)i.currentTarget=r,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),r=r.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof go)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const i=this.allocateEvent(ln);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=n??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof e=="string"&&(i.type=e),i}createWheelEvent(t){const e=this.allocateEvent(go);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(ln);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ln&&e instanceof ln&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Ml&&e instanceof Ml&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n&&t.currentTarget.isInteractive())if("fn"in n)n.once&&t.currentTarget.removeListener(e,n.fn,void 0,!0),n.fn.call(n.context,t);else for(let i=0,r=n.length;i<r&&!t.propagationImmediatelyStopped;i++)n[i].once&&t.currentTarget.removeListener(e,n[i].fn,void 0,!0),n[i].fn.call(n[i].context,t)}}const _S=1,ES={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Cu=class{constructor(s){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=s,this.rootBoundary=new wS(null),Di.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ln(null),this.rootWheelEvent=new go(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Cu.defaultEventFeatures},{set:(t,e,n)=>(e==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=n),t[e]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(s){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e,Cu._defaultEventMode=s.eventMode??"auto",Object.assign(this.features,s.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(s){this.resolution=s}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(s){s=s||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===s)return;this.currentCursor=s;const e=this.cursorStyles[s];if(e)switch(typeof e){case"string":t&&(this.domElement.style.cursor=e);break;case"function":e(s);break;case"object":t&&Object.assign(this.domElement.style,e);break}else t&&typeof s=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,s)&&(this.domElement.style.cursor=s)}get pointer(){return this.rootPointerEvent}onPointerDown(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;const t=this.normalizeToPointerData(s);this.autoPreventDefault&&t[0].isNormalized&&(s.cancelable||!("cancelable"in s))&&s.preventDefault();for(let e=0,n=t.length;e<n;e++){const i=t[e],r=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(s){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;Di.pointerMoved();const t=this.normalizeToPointerData(s);for(let e=0,n=t.length;e<n;e++){const i=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;let t=s.target;s.composedPath&&s.composedPath().length>0&&(t=s.composedPath()[0]);const e=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(s);for(let i=0,r=n.length;i<r;i++){const a=this.bootstrapEvent(this.rootPointerEvent,n[i]);a.type+=e,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;const t=this.normalizeToPointerData(s);for(let e=0,n=t.length;e<n;e++){const i=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(s){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(s);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(s){this.removeEvents(),this.domElement=s,Di.domElement=s,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Di.addTickerListener();const s=this.domElement.style;s&&(globalThis.navigator.msPointerEnabled?(s.msContentZooming="none",s.msTouchAction="none"):this.supportsPointerEvents&&(s.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Di.removeTickerListener();const s=this.domElement.style;globalThis.navigator.msPointerEnabled?(s.msContentZooming="",s.msTouchAction=""):this.supportsPointerEvents&&(s.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(s,t,e){let n;this.domElement.parentElement?n=this.domElement.getBoundingClientRect():n={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const i=1/this.resolution;s.x=(t-n.left)*(this.domElement.width/n.width)*i,s.y=(e-n.top)*(this.domElement.height/n.height)*i}normalizeToPointerData(s){const t=[];if(this.supportsTouchEvents&&s instanceof TouchEvent)for(let e=0,n=s.changedTouches.length;e<n;e++){const i=s.changedTouches[e];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=s.touches.length===1&&s.type==="touchstart"),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=s.type,t.push(i)}else if(!globalThis.MouseEvent||s instanceof MouseEvent&&(!this.supportsPointerEvents||!(s instanceof globalThis.PointerEvent))){const e=s;typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=_S),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0,t.push(e)}else t.push(s);return t}normalizeWheelEvent(s){const t=this.rootWheelEvent;return this.transferMouseData(t,s),t.deltaX=s.deltaX,t.deltaY=s.deltaY,t.deltaZ=s.deltaZ,t.deltaMode=s.deltaMode,this.mapPositionToPoint(t.screen,s.clientX,s.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=s,t.type=s.type,t}bootstrapEvent(s,t){return s.originalEvent=null,s.nativeEvent=t,s.pointerId=t.pointerId,s.width=t.width,s.height=t.height,s.isPrimary=t.isPrimary,s.pointerType=t.pointerType,s.pressure=t.pressure,s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist,this.transferMouseData(s,t),this.mapPositionToPoint(s.screen,t.clientX,t.clientY),s.global.copyFrom(s.screen),s.offset.copyFrom(s.screen),s.isTrusted=t.isTrusted,s.type==="pointerleave"&&(s.type="pointerout"),s.type.startsWith("mouse")&&(s.type=s.type.replace("mouse","pointer")),s.type.startsWith("touch")&&(s.type=ES[s.type]||s.type),s}transferMouseData(s,t){s.isTrusted=t.isTrusted,s.srcElement=t.srcElement,s.timeStamp=performance.now(),s.type=t.type,s.altKey=t.altKey,s.button=t.button,s.buttons=t.buttons,s.client.x=t.clientX,s.client.y=t.clientY,s.ctrlKey=t.ctrlKey,s.metaKey=t.metaKey,s.movement.x=t.movementX,s.movement.y=t.movementY,s.page.x=t.pageX,s.page.y=t.pageY,s.relatedTarget=null,s.shiftKey=t.shiftKey}};let da=Cu;da.extension={name:"events",type:[ut.RendererSystem,ut.CanvasRendererSystem]};da.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};bt.add(da);function pp(s){return s==="dynamic"||s==="static"}const SS={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??pp(da.defaultEventMode)},set interactive(s){Lt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=s,this.eventMode=s?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??da.defaultEventMode},set eventMode(s){this._internalInteractive=pp(s),this._internalEventMode=s},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(s,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,i=typeof t=="function"?void 0:t;s=n?`${s}capture`:s,t=typeof t=="function"?t:t.handleEvent,this.on(s,t,i)},removeEventListener(s,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,i=typeof t=="function"?void 0:t;s=n?`${s}capture`:s,t=typeof t=="function"?t:t.handleEvent,this.off(s,t,i)},dispatchEvent(s){if(!(s instanceof Ca))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return s.defaultPrevented=!1,s.path=null,s.target=this,s.manager.dispatchEvent(s),!s.defaultPrevented}};pe.mixin(SS);const TS={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};pe.mixin(TS);const AS=9,za=100,CS=0,MS=0,gp=2,xp=1,IS=-1e3,RS=-1e3,PS=2;class Q0{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(mi.tablet||mi.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${za}px`,e.style.height=`${za}px`,e.style.position="absolute",e.style.top=`${CS}px`,e.style.left=`${MS}px`,e.style.zIndex=gp.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${xp}px`,t.style.height=`${xp}px`,t.style.position="absolute",t.style.top=`${IS}px`,t.style.left=`${RS}px`,t.style.zIndex=PS.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}update(){const t=performance.now();if(mi.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:i,height:r}=this.renderer.view.getBoundingClientRect(),{width:a,height:l,resolution:o}=this.renderer,h=i/a*o,c=r/l*o;let d=this.div;d.style.left=`${e}px`,d.style.top=`${n}px`,d.style.width=`${a}px`,d.style.height=`${l}px`;for(let u=0;u<this.children.length;u++){const f=this.children[u];if(f.renderId!==this.renderId)f._accessibleActive=!1,so(this.children,u,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,u--;else{d=f._accessibleDiv;let m=f.hitArea;const p=f.worldTransform;f.hitArea?(d.style.left=`${(p.tx+m.x*p.a)*h}px`,d.style.top=`${(p.ty+m.y*p.d)*c}px`,d.style.width=`${m.width*p.a*h}px`,d.style.height=`${m.height*p.d*c}px`):(m=f.getBounds(),this.capHitArea(m),d.style.left=`${m.x*h}px`,d.style.top=`${m.y*c}px`,d.style.width=`${m.width*h}px`,d.style.height=`${m.height*c}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${za}px`,e.style.height=`${za}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=gp.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,i=this.renderer.events.rootBoundary,r=Object.assign(new Ca(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,e.forEach(a=>i.dispatchEvent(r,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===AS&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Q0.extension={name:"accessibility",type:[ut.RendererPlugin,ut.CanvasRendererPlugin]};bt.add(Q0);const Mu=class{constructor(s){this.stage=new Mt,s=Object.assign({forceCanvas:!1},s),this.renderer=$E(s),Mu._plugins.forEach(t=>{t.init.call(this,s)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(s,t){const e=Mu._plugins.slice(0);e.reverse(),e.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(s),this.renderer=null}};let vd=Mu;vd._plugins=[];bt.handleByList(ut.Application,vd._plugins);class tx{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,n;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:r}=this._resizeTo;e=i,n=r}this.renderer.resize(e,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}tx.extension=ut.Application;bt.add(tx);const yp={loader:ut.LoadParser,resolver:ut.ResolveParser,cache:ut.CacheParser,detection:ut.DetectionParser};bt.handle(ut.Asset,s=>{const t=s.ref;Object.entries(yp).filter(([e])=>!!t[e]).forEach(([e,n])=>bt.add(Object.assign(t[e],{extension:t[e].extension??n})))},s=>{const t=s.ref;Object.keys(yp).filter(e=>!!t[e]).forEach(e=>bt.remove(t[e]))});class kS{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Ma(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ns(s,t){const e=s.split("?")[0],n=me.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const gi=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s),Iu=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s};function ex(s,t,e,n,i){const r=t[e];for(let a=0;a<r.length;a++){const l=r[a];e<t.length-1?ex(s.replace(n[e],l),t,e+1,n,i):i.push(s.replace(n[e],l))}}function FS(s){const t=/\{(.*?)\}/g,e=s.match(t),n=[];if(e){const i=[];e.forEach(r=>{const a=r.substring(1,r.length-1).split(",");i.push(a)}),ex(s,i,0,e,n)}else n.push(s);return n}const Il=s=>!Array.isArray(s);class DS{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=gi(t);let i;for(let l=0;l<this.parsers.length;l++){const o=this.parsers[l];if(o.test(e)){i=o.getCacheableAssets(n,e);break}}i||(i={},n.forEach(l=>{i[l]=e}));const r=Object.keys(i),a={cacheKeys:r,keys:n};if(n.forEach(l=>{this._cacheMap.set(l,a)}),r.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,i[l])}),e instanceof pt){const l=e;n.forEach(o=>{l.baseTexture!==pt.EMPTY.baseTexture&&Ct.addToCache(l.baseTexture,o),pt.addToCache(l,o)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Do=new DS;class BS{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var a,l;let i=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let o=0;o<this.parsers.length;o++){const h=this.parsers[o];if(h.load&&((a=h.test)!=null&&a.call(h,t,e,this))){r=h;break}}if(!r)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await r.load(t,e,this),n.parser=r;for(let o=0;o<this.parsers.length;o++){const h=this.parsers[o];h.parse&&h.parse&&await((l=h.testParse)==null?void 0:l.call(h,i,e,this))&&(i=await h.parse(i,e,this)||i,n.parser=h)}return i})(),n}async load(t,e){this._parsersValidated||this._validateParsers();let n=0;const i={},r=Il(t),a=gi(t,h=>({src:h})),l=a.length,o=a.map(async h=>{const c=me.toAbsolute(h.src);if(!i[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),i[h.src]=await this.promiseCache[c].promise,e&&e(++n/l)}catch(d){throw delete this.promiseCache[c],delete i[h.src],new Error(`[Loader.load] Failed to load ${c}.
${d}`)}});return await Promise.all(o),r?i[a[0].src]:i}async unload(t){const n=gi(t,i=>({src:i})).map(async i=>{var l,o;const r=me.toAbsolute(i.src),a=this.promiseCache[r];if(a){const h=await a.promise;(o=(l=a.parser)==null?void 0:l.unload)==null||o.call(l,h,i,this),delete this.promiseCache[r]}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var nn=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(nn||{});const OS=".json",NS="application/json",LS={extension:{type:ut.LoadParser,priority:nn.Low},name:"loadJson",test(s){return Ma(s,NS)||Ns(s,OS)},async load(s){return await(await ct.ADAPTER.fetch(s)).json()}};bt.add(LS);const VS=".txt",US="text/plain",XS={name:"loadTxt",extension:{type:ut.LoadParser,priority:nn.Low},test(s){return Ma(s,US)||Ns(s,VS)},async load(s){return await(await ct.ADAPTER.fetch(s)).text()}};bt.add(XS);const YS=["normal","bold","100","200","300","400","500","600","700","800","900"],$S=[".ttf",".otf",".woff",".woff2"],GS=["font/ttf","font/otf","font/woff","font/woff2"],WS=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function HS(s){const t=me.extname(s),i=me.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1));let r=i.length>0;for(const l of i)if(!l.match(WS)){r=!1;break}let a=i.join(" ");return r||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const zS={extension:{type:ut.LoadParser,priority:nn.Low},name:"loadWebFont",test(s){return Ma(s,GS)||Ns(s,$S)},async load(s,t){var n,i,r;const e=ct.ADAPTER.getFontFaceSet();if(e){const a=[],l=((n=t.data)==null?void 0:n.family)??HS(s),o=((r=(i=t.data)==null?void 0:i.weights)==null?void 0:r.filter(c=>YS.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<o.length;c++){const d=o[c],u=new FontFace(l,`url(${encodeURI(s)})`,{...h,weight:d});await u.load(),e.add(u),a.push(u)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>ct.ADAPTER.getFontFaceSet().delete(t))}};bt.add(zS);let bp=0,Ac;const jS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",qS={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${jS}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},KS={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Cc;class ZS{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([qS.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",i=>{n.terminate(),URL.revokeObjectURL(e),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ac===void 0&&(Ac=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Ac&&(Cc||(Cc=URL.createObjectURL(new Blob([KS.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Cc),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((i,r)=>{this.queue.push({id:t,arguments:e,resolve:i,reject:r})});return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[bp]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:bp++,id:n})}}const vp=new ZS;function dh(s,t,e){const n=new pt(s);return n.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),n}const JS=[".jpeg",".jpg",".png",".webp",".avif"],QS=["image/jpeg","image/png","image/webp","image/avif"];async function tT(s){const t=await ct.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const fh={name:"loadTextures",extension:{type:ut.LoadParser,priority:nn.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Ma(s,QS)||Ns(s,JS)},async load(s,t,e){let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await vp.isImageBitmapSupported()?n=await vp.loadImageBitmap(s):n=await tT(s):n=await new Promise(r=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=s,n.complete?r(n):n.onload=()=>{r(n)}});const i=new Ct(n,{resolution:Ui(s),...t.data});return i.resource.src=s,dh(i,e,s)},unload(s){s.destroy(!0)}};bt.add(fh);const eT=".svg",sT="image/svg+xml",nT={extension:{type:ut.LoadParser,priority:nn.High},name:"loadSVG",test(s){return Ma(s,sT)||Ns(s,eT)},async testParse(s){return ua.test(s)},async parse(s,t,e){var a;const n=new ua(s,(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions);await n.load();const i=new Ct(n,{resolution:Ui(s),...t==null?void 0:t.data});return i.resource.src=s,dh(i,e,s)},async load(s,t){return(await ct.ADAPTER.fetch(s)).text()},unload:fh.unload};bt.add(nT);class iT{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach(i=>{if(typeof i.name=="string"){const r=this._createBundleAssetId(t,i.name);n.push(r),this.add([i.name,r],i.srcs,i.data)}else{const r=i.name.map(a=>this._createBundleAssetId(t,a));r.forEach(a=>{n.push(a)}),this.add([...i.name,...r],i.srcs)}}):Object.keys(e).forEach(i=>{n.push(this._createBundleAssetId(t,i)),this.add([i,this._createBundleAssetId(t,i)],e[i])}),this._bundles[t]=n}add(t,e,n){const i=gi(t);i.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=FS(e):e=[e]);const r=e.map(a=>{let l=a;if(typeof a=="string"){let o=!1;for(let h=0;h<this._parsers.length;h++){const c=this._parsers[h];if(c.test(a)){l=c.parse(a),o=!0;break}}o||(l={src:a})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=i),(this._basePath||this._rootPath)&&(l.src=me.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??n,l});i.forEach(a=>{this._assetMap[a]=r})}resolveBundle(t){const e=Il(t);t=gi(t);const n={};return t.forEach(i=>{const r=this._bundles[i];if(r){const a=this.resolve(r),l={};for(const o in a){const h=a[o];l[this._extractAssetIdFromBundle(i,o)]=h}n[i]=l}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const i in e)n[i]=e[i].src;return n}return e.src}resolve(t){const e=Il(t);t=gi(t);const n={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let r=this._assetMap[i];const a=this._getPreferredOrder(r),l=r[0];a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const c=r.filter(d=>d[o]?d[o]===h:!1);c.length&&(r=c)})}),this._resolverHash[i]=r[0]??l}else{let r=i;(this._basePath||this._rootPath)&&(r=me.toAbsolute(r,this._basePath,this._rootPath)),r=this._appendDefaultSearchParams(r),this._resolverHash[i]={src:r}}n[i]=this._resolverHash[i]}),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[0],i=this._preferredOrder.find(r=>r.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class rT{constructor(){this._detections=[],this._initialized=!1,this.resolver=new iT,this.loader=new BS,this.cache=Do,this._backgroundLoader=new kS(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,a,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,n=typeof e=="number"?[e]:e;let i=[];if((a=t.texturePreference)!=null&&a.format){const o=(l=t.texturePreference)==null?void 0:l.format;i=typeof o=="string"?[o]:o;for(const h of this._detections)await h.test()||(i=await h.remove(i))}else for(const o of this._detections)await o.test()&&(i=await o.add(i));this.resolver.prefer({params:{format:i,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,n){this.resolver.add(t,e,n)}async load(t,e){this._initialized||await this.init();const n=Il(t),i=gi(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):(this.resolver.hasKey(l)||this.resolver.add(l,l),l)),r=this.resolver.resolve(i),a=await this._mapLoadToResolve(r,e);return n?a[i[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const i=this.resolver.resolveBundle(t),r={},a=Object.keys(i);let l=0,o=0;const h=()=>{e==null||e(++l/o)},c=a.map(d=>{const u=i[d];return o+=Object.keys(u).length,this._mapLoadToResolve(u,h).then(f=>{r[d]=f})});return await Promise.all(c),n?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Do.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=Do.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),i=Object.keys(t);this._backgroundLoader.active=!1;const r=await this.loader.load(n,e);this._backgroundLoader.active=!0;const a={};return n.forEach((l,o)=>{const h=r[l.src],c=[l.src];l.alias&&c.push(...l.alias),a[i[o]]=h,Do.set(c,h)}),a}async unload(t){this._initialized||await this.init();const e=gi(t).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=gi(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(i=>this._unloadFromResolved(e[i]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{Do.remove(n.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return fh.config.preferWorkers}set preferWorkers(t){Lt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(n=>n in t).forEach(n=>{e.config[n]=t[n]})})}}const pi=new rT;bt.handleByList(ut.LoadParser,pi.loader.parsers).handleByList(ut.ResolveParser,pi.resolver.parsers).handleByList(ut.CacheParser,pi.cache.parsers).handleByList(ut.DetectionParser,pi.detections);const oT={extension:ut.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof pt),getCacheableAssets:(s,t)=>{const e={};return s.forEach(n=>{t.forEach((i,r)=>{e[n+(r===0?"":r+1)]=i})}),e}};bt.add(oT);const aT={extension:{type:ut.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await ct.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")};bt.add(aT);const lT={extension:{type:ut.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await ct.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};bt.add(lT);const wp=["png","jpg","jpeg"],hT={extension:{type:ut.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...wp],remove:async s=>s.filter(t=>!wp.includes(t))};bt.add(hT);const cT={extension:ut.ResolveParser,test:fh.test,parse:s=>{var t;return{resolution:parseFloat(((t=ct.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}};bt.add(cT);var Ds=(s=>(s[s.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",s[s.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",s[s.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",s[s.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",s[s.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",s[s.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",s[s.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",s[s.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",s[s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",s[s.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",s[s.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",s[s.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",s))(Ds||{});const Rl={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let ii,Ur;function _p(){Ur={s3tc:ii.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ii.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ii.getExtension("WEBGL_compressed_texture_etc"),etc1:ii.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ii.getExtension("WEBGL_compressed_texture_pvrtc")||ii.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ii.getExtension("WEBGL_compressed_texture_atc"),astc:ii.getExtension("WEBGL_compressed_texture_astc")}}const uT={extension:{type:ut.DetectionParser,priority:2},test:async()=>{const t=ct.ADAPTER.createCanvas().getContext("webgl");return t?(ii=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async s=>{Ur||_p();const t=[];for(const e in Ur)Ur[e]&&t.push(e);return[...t,...s]},remove:async s=>(Ur||_p(),s.filter(t=>!(t in Ur)))};bt.add(uT);class dT extends Aa{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,i;typeof t=="string"?(n=t,i=new Uint8Array):(n=null,i=t),super(i,e),this.origin=n,this.buffer=i?new pu(i):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new pu(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class gr extends dT{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=gr._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||gr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const i=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,l=this.levels;a<l;a++){const{levelID:o,levelWidth:h,levelHeight:c,levelBuffer:d}=this._levelBuffers[a];i.compressedTexImage2D(i.TEXTURE_2D,o,this.format,h,c,0,d)}return!0}onBlobLoaded(){this._levelBuffers=gr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,n,i,r,a,l){const o=new Array(n);let h=t.byteOffset,c=a,d=l,u=c+i-1&~(i-1),f=d+r-1&~(r-1),m=u*f*Rl[e];for(let p=0;p<n;p++)o[p]={levelID:p,levelWidth:n>1?c:u,levelHeight:n>1?d:f,levelBuffer:new Uint8Array(t.buffer,h,m)},h+=m,c=c>>1||1,d=d>>1||1,u=c+i-1&~(i-1),f=d+r-1&~(r-1),m=u*f*Rl[e];return o}}const Mc=4,ja=124,fT=32,Ep=20,mT=542327876,qa={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},pT={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Ka={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},gT=1,xT=2,yT=4,bT=64,vT=512,wT=131072,_T=827611204,ET=861165636,ST=894720068,TT=808540228,AT=4,CT={[_T]:Ds.COMPRESSED_RGBA_S3TC_DXT1_EXT,[ET]:Ds.COMPRESSED_RGBA_S3TC_DXT3_EXT,[ST]:Ds.COMPRESSED_RGBA_S3TC_DXT5_EXT},MT={70:Ds.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ds.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ds.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ds.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ds.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ds.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ds.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ds.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ds.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function IT(s){const t=new Uint32Array(s);if(t[0]!==mT)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(s,0,ja/Uint32Array.BYTES_PER_ELEMENT),i=n[qa.HEIGHT],r=n[qa.WIDTH],a=n[qa.MIPMAP_COUNT],l=new Uint32Array(s,qa.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,fT/Uint32Array.BYTES_PER_ELEMENT),o=l[gT];if(o&yT){const h=l[pT.FOURCC];if(h!==TT){const x=CT[h],y=Mc+ja,w=new Uint8Array(s,y);return[new gr(w,{format:x,width:r,height:i,levels:a})]}const c=Mc+ja,d=new Uint32Array(t.buffer,c,Ep/Uint32Array.BYTES_PER_ELEMENT),u=d[Ka.DXGI_FORMAT],f=d[Ka.RESOURCE_DIMENSION],m=d[Ka.MISC_FLAG],p=d[Ka.ARRAY_SIZE],g=MT[u];if(g===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${u}`);if(m===AT)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const v=new Array,b=Mc+ja+Ep;if(p===1)v.push(new Uint8Array(s,b));else{const x=Rl[g];let y=0,w=r,_=i;for(let T=0;T<a;T++){const C=Math.max(1,w+3&-4),R=Math.max(1,_+3&-4),P=C*R*x;y+=P,w=w>>>1,_=_>>>1}let E=b;for(let T=0;T<p;T++)v.push(new Uint8Array(s,E,y)),E+=y}return v.map(x=>new gr(x,{format:g,width:r,height:i,levels:a}))}throw o&bT?new Error("DDSParser does not support uncompressed texture data."):o&vT?new Error("DDSParser does not supported YUV uncompressed texture data."):o&wT?new Error("DDSParser does not support single-channel (lumninance) texture data!"):o&xT?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Sp=[171,75,84,88,32,49,49,187,13,10,26,10],RT=67305985,on={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Ru=64,Tp={[wt.UNSIGNED_BYTE]:1,[wt.UNSIGNED_SHORT]:2,[wt.INT]:4,[wt.UNSIGNED_INT]:4,[wt.FLOAT]:4,[wt.HALF_FLOAT]:8},PT={[lt.RGBA]:4,[lt.RGB]:3,[lt.RG]:2,[lt.RED]:1,[lt.LUMINANCE]:1,[lt.LUMINANCE_ALPHA]:2,[lt.ALPHA]:1},kT={[wt.UNSIGNED_SHORT_4_4_4_4]:2,[wt.UNSIGNED_SHORT_5_5_5_1]:2,[wt.UNSIGNED_SHORT_5_6_5]:2};function FT(s,t,e=!1){const n=new DataView(t);if(!DT(s,n))return null;const i=n.getUint32(on.ENDIANNESS,!0)===RT,r=n.getUint32(on.GL_TYPE,i),a=n.getUint32(on.GL_FORMAT,i),l=n.getUint32(on.GL_INTERNAL_FORMAT,i),o=n.getUint32(on.PIXEL_WIDTH,i),h=n.getUint32(on.PIXEL_HEIGHT,i)||1,c=n.getUint32(on.PIXEL_DEPTH,i)||1,d=n.getUint32(on.NUMBER_OF_ARRAY_ELEMENTS,i)||1,u=n.getUint32(on.NUMBER_OF_FACES,i),f=n.getUint32(on.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32(on.BYTES_OF_KEY_VALUE_DATA,i);if(h===0||c!==1)throw new Error("Only 2D textures are supported");if(u!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const p=4,g=4,v=o+3&-4,b=h+3&-4,x=new Array(d);let y=o*h;r===0&&(y=v*b);let w;if(r!==0?Tp[r]?w=Tp[r]*PT[a]:w=kT[r]:w=Rl[l],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const _=e?OT(n,m,i):null;let T=y*w,C=o,R=h,P=v,O=b,F=Ru+m;for(let D=0;D<f;D++){const V=n.getUint32(F,i);let X=F+4;for(let U=0;U<d;U++){let j=x[U];j||(j=x[U]=new Array(f)),j[D]={levelID:D,levelWidth:f>1||r!==0?C:P,levelHeight:f>1||r!==0?R:O,levelBuffer:new Uint8Array(t,X,T)},X+=T}F+=V+4,F=F%4!==0?F+4-F%4:F,C=C>>1||1,R=R>>1||1,P=C+p-1&~(p-1),O=R+g-1&~(g-1),T=P*O*w}return r!==0?{uncompressed:x.map(D=>{let V=D[0].levelBuffer,X=!1;return r===wt.FLOAT?V=new Float32Array(D[0].levelBuffer.buffer,D[0].levelBuffer.byteOffset,D[0].levelBuffer.byteLength/4):r===wt.UNSIGNED_INT?(X=!0,V=new Uint32Array(D[0].levelBuffer.buffer,D[0].levelBuffer.byteOffset,D[0].levelBuffer.byteLength/4)):r===wt.INT&&(X=!0,V=new Int32Array(D[0].levelBuffer.buffer,D[0].levelBuffer.byteOffset,D[0].levelBuffer.byteLength/4)),{resource:new Aa(V,{width:D[0].levelWidth,height:D[0].levelHeight}),type:r,format:X?BT(a):a}}),kvData:_}:{compressed:x.map(D=>new gr(null,{format:l,width:o,height:h,levels:f,levelBuffers:D})),kvData:_}}function DT(s,t){for(let e=0;e<Sp.length;e++)if(t.getUint8(e)!==Sp[e])return console.error(`${s} is not a valid *.ktx file!`),!1;return!0}function BT(s){switch(s){case lt.RGBA:return lt.RGBA_INTEGER;case lt.RGB:return lt.RGB_INTEGER;case lt.RG:return lt.RG_INTEGER;case lt.RED:return lt.RED_INTEGER;default:return s}}function OT(s,t,e){const n=new Map;let i=0;for(;i<t;){const r=s.getUint32(Ru+i,e),a=Ru+i+4,l=3-(r+3)%4;if(r===0||r>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let o=0;for(;o<r&&s.getUint8(a+o)!==0;o++);if(o===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(s.buffer,a,o)),c=new DataView(s.buffer,a+o+1,r-o-1);n.set(h,c),i+=4+r+l}return n}const NT={extension:{type:ut.LoadParser,priority:nn.High},name:"loadDDS",test(s){return Ns(s,".dds")},async load(s,t,e){const i=await(await ct.ADAPTER.fetch(s)).arrayBuffer(),a=IT(i).map(l=>{const o=new Ct(l,{mipmap:tn.OFF,alphaMode:sn.NO_PREMULTIPLIED_ALPHA,resolution:Ui(s),...t.data});return dh(o,e,s)});return a.length===1?a[0]:a},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};bt.add(NT);const LT={extension:{type:ut.LoadParser,priority:nn.High},name:"loadKTX",test(s){return Ns(s,".ktx")},async load(s,t,e){const i=await(await ct.ADAPTER.fetch(s)).arrayBuffer(),{compressed:r,uncompressed:a,kvData:l}=FT(s,i),o=r??a,h={mipmap:tn.OFF,alphaMode:sn.NO_PREMULTIPLIED_ALPHA,resolution:Ui(s),...t.data},c=o.map(d=>{o===a&&Object.assign(h,{type:d.type,format:d.format});const u=new Ct(d,h);return u.ktxKeyValueData=l,dh(u,e,s)});return c.length===1?c[0]:c},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};bt.add(LT);const VT={extension:ut.ResolveParser,test:s=>{const e=s.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:s=>{var n,i;if(s.split("?")[0].split(".").pop()==="ktx"){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(a=>s.endsWith(a)))return{resolution:parseFloat(((n=ct.RETINA_PREFIX.exec(s))==null?void 0:n[1])??"1"),format:r.find(a=>s.endsWith(a)),src:s}}return{resolution:parseFloat(((i=ct.RETINA_PREFIX.exec(s))==null?void 0:i[1])??"1"),format:s.split(".").pop(),src:s}}};bt.add(VT);const UT=new Dt,XT=4,Xo=class{constructor(s){this.renderer=s}async image(s,t,e){const n=new Image;return n.src=await this.base64(s,t,e),n}async base64(s,t,e){const n=this.canvas(s);if(n.toBlob!==void 0)return new Promise((i,r)=>{n.toBlob(a=>{if(!a){r(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>i(l.result),l.onerror=r,l.readAsDataURL(a)},t,e)});if(n.toDataURL!==void 0)return n.toDataURL(t,e);if(n.convertToBlob!==void 0){const i=await n.convertToBlob({type:t,quality:e});return new Promise((r,a)=>{const l=new FileReader;l.onload=()=>r(l.result),l.onerror=a,l.readAsDataURL(i)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(s,t){const{pixels:e,width:n,height:i,flipY:r}=this._rawPixels(s,t);r&&Xo._flipY(e,n,i),Xo._unpremultiplyAlpha(e);const a=new F_(n,i,1),l=new ImageData(new Uint8ClampedArray(e.buffer),n,i);return a.context.putImageData(l,0,0),a.canvas}pixels(s,t){const{pixels:e,width:n,height:i,flipY:r}=this._rawPixels(s,t);return r&&Xo._flipY(e,n,i),Xo._unpremultiplyAlpha(e),e}_rawPixels(s,t){const e=this.renderer;if(!e)throw new Error("The Extract has already been destroyed");let n,i=!1,r,a=!1;if(s&&(s instanceof Mr?r=s:(r=e.generateTexture(s,{resolution:e.resolution,multisample:e.multisample}),a=!0)),r){if(n=r.baseTexture.resolution,t=t??r.frame,i=!1,!a){e.renderTexture.bind(r);const d=r.framebuffer.glFramebuffers[e.CONTEXT_UID];d.blitFramebuffer&&e.framebuffer.bind(d.blitFramebuffer)}}else n=e.resolution,t||(t=UT,t.width=e.width/n,t.height=e.height/n),i=!0,e.renderTexture.bind();const l=Math.round(t.width*n),o=Math.round(t.height*n),h=new Uint8Array(XT*l*o),c=e.gl;return c.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,o,c.RGBA,c.UNSIGNED_BYTE,h),a&&(r==null||r.destroy(!0)),{pixels:h,width:l,height:o,flipY:i}}destroy(){this.renderer=null}static _flipY(s,t,e){const n=t<<2,i=e>>1,r=new Uint8Array(n);for(let a=0;a<i;a++){const l=a*n,o=(e-a-1)*n;r.set(s.subarray(l,l+n)),s.copyWithin(l,o,o+n),s.set(r,o)}}static _unpremultiplyAlpha(s){s instanceof Uint8ClampedArray&&(s=new Uint8Array(s.buffer));const t=s.length;for(let e=0;e<t;e+=4){const n=s[e+3];if(n!==0){const i=255.001/n;s[e]=s[e]*i+.5,s[e+1]=s[e+1]*i+.5,s[e+2]=s[e+2]*i+.5}}}};let sx=Xo;sx.extension={name:"extract",type:ut.RendererSystem};bt.add(sx);const Pl={build(s){const t=s.points;let e,n,i,r,a,l;if(s.type===Ke.CIRC){const m=s.shape;e=m.x,n=m.y,a=l=m.radius,i=r=0}else if(s.type===Ke.ELIP){const m=s.shape;e=m.x,n=m.y,a=m.width,l=m.height,i=r=0}else{const m=s.shape,p=m.width/2,g=m.height/2;e=m.x+p,n=m.y+g,a=l=Math.max(0,Math.min(m.radius,Math.min(p,g))),i=p-a,r=g-l}if(!(a>=0&&l>=0&&i>=0&&r>=0)){t.length=0;return}const o=Math.ceil(2.3*Math.sqrt(a+l)),h=o*8+(i?4:0)+(r?4:0);if(t.length=h,h===0)return;if(o===0){t.length=8,t[0]=t[6]=e+i,t[1]=t[3]=n+r,t[2]=t[4]=e-i,t[5]=t[7]=n-r;return}let c=0,d=o*4+(i?2:0)+2,u=d,f=h;{const m=i+a,p=r,g=e+m,v=e-m,b=n+p;if(t[c++]=g,t[c++]=b,t[--d]=b,t[--d]=v,r){const x=n-p;t[u++]=v,t[u++]=x,t[--f]=x,t[--f]=g}}for(let m=1;m<o;m++){const p=Math.PI/2*(m/o),g=i+Math.cos(p)*a,v=r+Math.sin(p)*l,b=e+g,x=e-g,y=n+v,w=n-v;t[c++]=b,t[c++]=y,t[--d]=y,t[--d]=x,t[u++]=x,t[u++]=w,t[--f]=w,t[--f]=b}{const m=i,p=r+l,g=e+m,v=e-m,b=n+p,x=n-p;t[c++]=g,t[c++]=b,t[--f]=x,t[--f]=g,i&&(t[c++]=v,t[c++]=b,t[--f]=x,t[--f]=v)}},triangulate(s,t){const e=s.points,n=t.points,i=t.indices;if(e.length===0)return;let r=n.length/2;const a=r;let l,o;if(s.type!==Ke.RREC){const c=s.shape;l=c.x,o=c.y}else{const c=s.shape;l=c.x+c.width/2,o=c.y+c.height/2}const h=s.matrix;n.push(s.matrix?h.a*l+h.c*o+h.tx:l,s.matrix?h.b*l+h.d*o+h.ty:o),r++,n.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)n.push(e[c],e[c+1]),i.push(r++,a,r);i.push(a+1,a,r)}};function Ap(s,t=!1){const e=s.length;if(e<6)return;let n=0;for(let i=0,r=s[e-2],a=s[e-1];i<e;i+=2){const l=s[i],o=s[i+1];n+=(l-r)*(o+a),r=l,a=o}if(!t&&n>0||t&&n<=0){const i=e/2;for(let r=i+i%2;r<e;r+=2){const a=e-r-2,l=e-r-1,o=r,h=r+1;[s[a],s[o]]=[s[o],s[a]],[s[l],s[h]]=[s[h],s[l]]}}}const nx={build(s){s.points=s.shape.points.slice()},triangulate(s,t){let e=s.points;const n=s.holes,i=t.points,r=t.indices;if(e.length>=6){Ap(e,!1);const a=[];for(let h=0;h<n.length;h++){const c=n[h];Ap(c.points,!0),a.push(e.length/2),e=e.concat(c.points)}const l=Qb(e,a,2);if(!l)return;const o=i.length/2;for(let h=0;h<l.length;h+=3)r.push(l[h]+o),r.push(l[h+1]+o),r.push(l[h+2]+o);for(let h=0;h<e.length;h++)i.push(e[h])}}},YT={build(s){const t=s.shape,e=t.x,n=t.y,i=t.width,r=t.height,a=s.points;a.length=0,i>=0&&r>=0&&a.push(e,n,e+i,n,e+i,n+r,e,n+r)},triangulate(s,t){const e=s.points,n=t.points;if(e.length===0)return;const i=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},$T={build(s){Pl.build(s)},triangulate(s,t){Pl.triangulate(s,t)}};var yn=(s=>(s.MITER="miter",s.BEVEL="bevel",s.ROUND="round",s))(yn||{}),cr=(s=>(s.BUTT="butt",s.ROUND="round",s.SQUARE="square",s))(cr||{});const xo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(s,t=20){if(!this.adaptive||!s||isNaN(s))return t;let e=Math.ceil(s/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Cp{static curveTo(t,e,n,i,r,a){const l=a[a.length-2],h=a[a.length-1]-e,c=l-t,d=i-e,u=n-t,f=Math.abs(h*u-c*d);if(f<1e-8||r===0)return(a[a.length-2]!==t||a[a.length-1]!==e)&&a.push(t,e),null;const m=h*h+c*c,p=d*d+u*u,g=h*d+c*u,v=r*Math.sqrt(m)/f,b=r*Math.sqrt(p)/f,x=v*g/m,y=b*g/p,w=v*u+b*c,_=v*d+b*h,E=c*(b+x),T=h*(b+x),C=u*(v+y),R=d*(v+y),P=Math.atan2(T-_,E-w),O=Math.atan2(R-_,C-w);return{cx:w+t,cy:_+e,radius:r,startAngle:P,endAngle:O,anticlockwise:c*d>u*h}}static arc(t,e,n,i,r,a,l,o,h){const c=l-a,d=xo._segmentsCount(Math.abs(c)*r,Math.ceil(Math.abs(c)/Al)*40),u=c/(d*2),f=u*2,m=Math.cos(u),p=Math.sin(u),g=d-1,v=g%1/g;for(let b=0;b<=g;++b){const x=b+v*b,y=u+a+f*x,w=Math.cos(y),_=-Math.sin(y);h.push((m*w+p*_)*r+n,(m*-_+p*w)*r+i)}}}class GT{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class wd{static curveLength(t,e,n,i,r,a,l,o){let c=0,d=0,u=0,f=0,m=0,p=0,g=0,v=0,b=0,x=0,y=0,w=t,_=e;for(let E=1;E<=10;++E)d=E/10,u=d*d,f=u*d,m=1-d,p=m*m,g=p*m,v=g*t+3*p*d*n+3*m*u*r+f*l,b=g*e+3*p*d*i+3*m*u*a+f*o,x=w-v,y=_-b,w=v,_=b,c+=Math.sqrt(x*x+y*y);return c}static curveTo(t,e,n,i,r,a,l){const o=l[l.length-2],h=l[l.length-1];l.length-=2;const c=xo._segmentsCount(wd.curveLength(o,h,t,e,n,i,r,a));let d=0,u=0,f=0,m=0,p=0;l.push(o,h);for(let g=1,v=0;g<=c;++g)v=g/c,d=1-v,u=d*d,f=u*d,m=v*v,p=m*v,l.push(f*o+3*u*v*t+3*d*m*n+p*r,f*h+3*u*v*e+3*d*m*i+p*a)}}function Mp(s,t,e,n,i,r,a,l){const o=s-e*i,h=t-n*i,c=s+e*r,d=t+n*r;let u,f;a?(u=n,f=-e):(u=-n,f=e);const m=o+u,p=h+f,g=c+u,v=d+f;return l.push(m,p,g,v),2}function Ji(s,t,e,n,i,r,a,l){const o=e-s,h=n-t;let c=Math.atan2(o,h),d=Math.atan2(i-s,r-t);l&&c<d?c+=Math.PI*2:!l&&c>d&&(d+=Math.PI*2);let u=c;const f=d-c,m=Math.abs(f),p=Math.sqrt(o*o+h*h),g=(15*m*Math.sqrt(p)/Math.PI>>0)+1,v=f/g;if(u+=v,l){a.push(s,t,e,n);for(let b=1,x=u;b<g;b++,x+=v)a.push(s,t,s+Math.sin(x)*p,t+Math.cos(x)*p);a.push(s,t,i,r)}else{a.push(e,n,s,t);for(let b=1,x=u;b<g;b++,x+=v)a.push(s+Math.sin(x)*p,t+Math.cos(x)*p,s,t);a.push(i,r,s,t)}return g*2}function WT(s,t){const e=s.shape;let n=s.points||e.points.slice();const i=t.closePointEps;if(n.length===0)return;const r=s.lineStyle,a=new Ht(n[0],n[1]),l=new Ht(n[n.length-2],n[n.length-1]),o=e.type!==Ke.POLY||e.closeStroke,h=Math.abs(a.x-l.x)<i&&Math.abs(a.y-l.y)<i;if(o){n=n.slice(),h&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const U=(a.x+l.x)*.5,j=(l.y+a.y)*.5;n.unshift(U,j),n.push(U,j)}const c=t.points,d=n.length/2;let u=n.length;const f=c.length/2,m=r.width/2,p=m*m,g=r.miterLimit*r.miterLimit;let v=n[0],b=n[1],x=n[2],y=n[3],w=0,_=0,E=-(b-y),T=v-x,C=0,R=0,P=Math.sqrt(E*E+T*T);E/=P,T/=P,E*=m,T*=m;const O=r.alignment,F=(1-O)*2,D=O*2;o||(r.cap===cr.ROUND?u+=Ji(v-E*(F-D)*.5,b-T*(F-D)*.5,v-E*F,b-T*F,v+E*D,b+T*D,c,!0)+2:r.cap===cr.SQUARE&&(u+=Mp(v,b,E,T,F,D,!0,c))),c.push(v-E*F,b-T*F,v+E*D,b+T*D);for(let U=1;U<d-1;++U){v=n[(U-1)*2],b=n[(U-1)*2+1],x=n[U*2],y=n[U*2+1],w=n[(U+1)*2],_=n[(U+1)*2+1],E=-(b-y),T=v-x,P=Math.sqrt(E*E+T*T),E/=P,T/=P,E*=m,T*=m,C=-(y-_),R=x-w,P=Math.sqrt(C*C+R*R),C/=P,R/=P,C*=m,R*=m;const j=x-v,z=b-y,N=x-w,G=_-y,q=j*N+z*G,K=z*N-G*j,Q=K<0;if(Math.abs(K)<.001*Math.abs(q)){c.push(x-E*F,y-T*F,x+E*D,y+T*D),q>=0&&(r.join===yn.ROUND?u+=Ji(x,y,x-E*F,y-T*F,x-C*F,y-R*F,c,!1)+4:u+=2,c.push(x-C*D,y-R*D,x+C*F,y+R*F));continue}const tt=(-E+v)*(-T+y)-(-E+x)*(-T+b),ht=(-C+w)*(-R+y)-(-C+x)*(-R+_),vt=(j*ht-N*tt)/K,At=(G*tt-z*ht)/K,_t=(vt-x)*(vt-x)+(At-y)*(At-y),Et=x+(vt-x)*F,St=y+(At-y)*F,Ot=x-(vt-x)*D,k=y-(At-y)*D,L=Math.min(j*j+z*z,N*N+G*G),H=Q?F:D,et=L+H*H*p,Z=_t<=et;let st=r.join;if(st===yn.MITER&&_t/p>g&&(st=yn.BEVEL),Z)switch(st){case yn.MITER:{c.push(Et,St,Ot,k);break}case yn.BEVEL:{Q?c.push(Et,St,x+E*D,y+T*D,Et,St,x+C*D,y+R*D):c.push(x-E*F,y-T*F,Ot,k,x-C*F,y-R*F,Ot,k),u+=2;break}case yn.ROUND:{Q?(c.push(Et,St,x+E*D,y+T*D),u+=Ji(x,y,x+E*D,y+T*D,x+C*D,y+R*D,c,!0)+4,c.push(Et,St,x+C*D,y+R*D)):(c.push(x-E*F,y-T*F,Ot,k),u+=Ji(x,y,x-E*F,y-T*F,x-C*F,y-R*F,c,!1)+4,c.push(x-C*F,y-R*F,Ot,k));break}}else{switch(c.push(x-E*F,y-T*F,x+E*D,y+T*D),st){case yn.MITER:{Q?c.push(Ot,k,Ot,k):c.push(Et,St,Et,St),u+=2;break}case yn.ROUND:{Q?u+=Ji(x,y,x+E*D,y+T*D,x+C*D,y+R*D,c,!0)+2:u+=Ji(x,y,x-E*F,y-T*F,x-C*F,y-R*F,c,!1)+2;break}}c.push(x-C*F,y-R*F,x+C*D,y+R*D),u+=2}}v=n[(d-2)*2],b=n[(d-2)*2+1],x=n[(d-1)*2],y=n[(d-1)*2+1],E=-(b-y),T=v-x,P=Math.sqrt(E*E+T*T),E/=P,T/=P,E*=m,T*=m,c.push(x-E*F,y-T*F,x+E*D,y+T*D),o||(r.cap===cr.ROUND?u+=Ji(x-E*(F-D)*.5,y-T*(F-D)*.5,x-E*F,y-T*F,x+E*D,y+T*D,c,!1)+2:r.cap===cr.SQUARE&&(u+=Mp(x,y,E,T,F,D,!1,c)));const V=t.indices,X=xo.epsilon*xo.epsilon;for(let U=f;U<u+f-2;++U)v=c[U*2],b=c[U*2+1],x=c[(U+1)*2],y=c[(U+1)*2+1],w=c[(U+2)*2],_=c[(U+2)*2+1],!(Math.abs(v*(y-_)+x*(_-b)+w*(b-y))<X)&&V.push(U,U+1,U+2)}function HT(s,t){let e=0;const n=s.shape,i=s.points||n.points,r=n.type!==Ke.POLY||n.closeStroke;if(i.length===0)return;const a=t.points,l=t.indices,o=i.length/2,h=a.length/2;let c=h;for(a.push(i[0],i[1]),e=1;e<o;e++)a.push(i[e*2],i[e*2+1]),l.push(c,c+1),c++;r&&l.push(c,h)}function Ip(s,t){s.lineStyle.native?HT(s,t):WT(s,t)}class _d{static curveLength(t,e,n,i,r,a){const l=t-2*n+r,o=e-2*i+a,h=2*n-2*t,c=2*i-2*e,d=4*(l*l+o*o),u=4*(l*h+o*c),f=h*h+c*c,m=2*Math.sqrt(d+u+f),p=Math.sqrt(d),g=2*d*p,v=2*Math.sqrt(f),b=u/p;return(g*m+p*u*(m-v)+(4*f*d-u*u)*Math.log((2*p+b+m)/(b+v)))/(4*g)}static curveTo(t,e,n,i,r){const a=r[r.length-2],l=r[r.length-1],o=xo._segmentsCount(_d.curveLength(a,l,t,e,n,i));let h=0,c=0;for(let d=1;d<=o;++d){const u=d/o;h=a+(t-a)*u,c=l+(e-l)*u,r.push(h+(t+(n-t)*u-h)*u,c+(e+(i-e)*u-c)*u)}}}const Ic={[Ke.POLY]:nx,[Ke.CIRC]:Pl,[Ke.ELIP]:Pl,[Ke.RECT]:YT,[Ke.RREC]:$T},Rp=[],Za=[];class kl{constructor(t,e=null,n=null,i=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type}clone(){return new kl(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Br=new Ht,ix=class extends m0{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Cl,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),Za.push(this.drawCalls[s]);this.drawCalls.length=0;for(let s=0;s<this.batches.length;s++){const t=this.batches[s];t.reset(),Rp.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(s,t=null,e=null,n=null){const i=new kl(s,t,e,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(s,t=null){if(!this.graphicsData.length)return null;const e=new kl(s,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=n.lineStyle,n.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let s=0;s<this.graphicsData.length;++s)this.graphicsData[s].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(s){const t=this.graphicsData;for(let e=0;e<t.length;++e){const n=t[e];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(s,Br):Br.copyFrom(s),n.shape.contains(Br.x,Br.y))){let i=!1;if(n.holes){for(let r=0;r<n.holes.length;r++)if(n.holes[r].shape.contains(Br.x,Br.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const s=this.uvs,t=this.graphicsData;let e=null,n=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],n=e.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const o=t[l],h=o.fillStyle,c=o.lineStyle;Ic[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(h.visible||c.visible)&&this.processHoles(o.holes);for(let u=0;u<2;u++){const f=u===0?h:c;if(!f.visible)continue;const m=f.texture.baseTexture,p=this.indices.length,g=this.points.length/2;m.wrapMode=Li.REPEAT,u===0?this.processFill(o):this.processLine(o);const v=this.points.length/2-g;v!==0&&(e&&!this._compareStyles(n,f)&&(e.end(p,g),e=null),e||(e=Rp.pop()||new GT,e.begin(f,p,g),this.batches.push(e),n=f),this.addUvs(this.points,s,f.texture,g,v,f.matrix))}}const i=this.indices.length,r=this.points.length/2;if(e&&e.end(i,r),this.batches.length===0){this.batchable=!0;return}const a=r>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(s,t){return!(!s||!t||s.texture.baseTexture!==t.texture.baseTexture||s.color+s.alpha!==t.color+t.alpha||!!s.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let s=0,t=this.graphicsData.length;s<t;s++){const e=this.graphicsData[s],n=e.fillStyle,i=e.lineStyle;if(n&&!n.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const s=this.batches;for(let t=0,e=s.length;t<e;t++){const n=s[t];for(let i=0;i<n.size;i++){const r=n.start+i;this.indicesUint16[r]=this.indicesUint16[r]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const s=this.batches;for(let t=0;t<s.length;t++)if(s[t].style.native)return!1;return this.points.length<ix.BATCHABLE_SIZE*2}buildDrawCalls(){let s=++Ct._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Za.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let n=Za.pop();n||(n=new xu,n.texArray=new bu),n.texArray.count=0,n.start=0,n.size=0,n.type=En.TRIANGLES;let i=0,r=null,a=0,l=!1,o=En.TRIANGLES,h=0;this.drawCalls.push(n);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],u=8,f=d.style,m=f.texture.baseTexture;l!==!!f.native&&(l=!!f.native,o=l?En.LINES:En.TRIANGLES,r=null,i=u,s++),r!==m&&(r=m,m._batchEnabled!==s&&(i===u&&(s++,i=0,n.size>0&&(n=Za.pop(),n||(n=new xu,n.texArray=new bu),this.drawCalls.push(n)),n.start=h,n.size=0,n.texArray.count=0,n.type=o),m.touched=1,m._batchEnabled=s,m._batchLocation=i,m.wrapMode=Li.REPEAT,n.texArray.elements[n.texArray.count++]=m,i++)),n.size+=d.size,h+=d.size,a=m._batchLocation,this.addColors(t,f.color,f.alpha,d.attribSize,d.attribStart),this.addTextureIds(e,a,d.attribSize,d.attribStart)}Ct._globalBatch=s,this.packAttributes()}packAttributes(){const s=this.points,t=this.uvs,e=this.colors,n=this.textureIds,i=new ArrayBuffer(s.length*3*4),r=new Float32Array(i),a=new Uint32Array(i);let l=0;for(let o=0;o<s.length/2;o++)r[l++]=s[o*2],r[l++]=s[o*2+1],r[l++]=t[o*2],r[l++]=t[o*2+1],a[l++]=e[o],r[l++]=n[o];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(s){s.holes.length?nx.triangulate(s,this):Ic[s.type].triangulate(s,this)}processLine(s){Ip(s,this);for(let t=0;t<s.holes.length;t++)Ip(s.holes[t],this)}processHoles(s){for(let t=0;t<s.length;t++){const e=s[t];Ic[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const s=this._bounds;s.clear(),s.addVertexData(this.points,0,this.points.length),s.pad(this.boundsPadding,this.boundsPadding)}transformPoints(s,t){for(let e=0;e<s.length/2;e++){const n=s[e*2],i=s[e*2+1];s[e*2]=t.a*n+t.c*i+t.tx,s[e*2+1]=t.b*n+t.d*i+t.ty}}addColors(s,t,e,n,i=0){const r=Kt.shared.setValue(t).toLittleEndianNumber(),a=Kt.shared.setValue(r).toPremultiplied(e);s.length=Math.max(s.length,i+n);for(let l=0;l<n;l++)s[i+l]=a}addTextureIds(s,t,e,n=0){s.length=Math.max(s.length,n+e);for(let i=0;i<e;i++)s[n+i]=t}addUvs(s,t,e,n,i,r=null){let a=0;const l=t.length,o=e.frame;for(;a<i;){let c=s[(n+a)*2],d=s[(n+a)*2+1];if(r){const u=r.a*c+r.c*d+r.tx;d=r.b*c+r.d*d+r.ty,c=u}a++,t.push(c/o.width,d/o.height)}const h=e.baseTexture;(o.width<h.width||o.height<h.height)&&this.adjustUvs(t,e,l,i)}adjustUvs(s,t,e,n){const i=t.baseTexture,r=1e-6,a=e+n*2,l=t.frame,o=l.width/i.width,h=l.height/i.height;let c=l.x/l.width,d=l.y/l.height,u=Math.floor(s[e]+r),f=Math.floor(s[e+1]+r);for(let m=e+2;m<a;m+=2)u=Math.min(u,Math.floor(s[m]+r)),f=Math.min(f,Math.floor(s[m+1]+r));c-=u,d-=f;for(let m=e;m<a;m+=2)s[m]=(s[m]+c)*o,s[m+1]=(s[m+1]+d)*h}};let rx=ix;rx.BATCHABLE_SIZE=100;class mh{constructor(){this.color=16777215,this.alpha=1,this.texture=pt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new mh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=pt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Ed extends mh{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=cr.BUTT,this.join=yn.MITER,this.miterLimit=10}clone(){const t=new Ed;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Rc={},dl=class extends Mt{constructor(s=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new mh,this._lineStyle=new Ed,this._matrix=null,this._holeMode=!1,this.state=wi.for2d(),this._geometry=s||new rx,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Kt(16777215),this.blendMode=ft.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new dl(this._geometry)}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(s){this._tintColor.setValue(s)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(s=null,t=0,e,n=.5,i=!1){return typeof s=="number"&&(s={width:s,color:t,alpha:e,alignment:n,native:i}),this.lineTextureStyle(s)}lineTextureStyle(s){const t={width:0,texture:pt.WHITE,color:s!=null&&s.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:cr.BUTT,join:yn.MITER,miterLimit:10};s=Object.assign(t,s),this.normalizeColor(s),this.currentPath&&this.startPoly();const e=s.width>0&&s.alpha>0;return e?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._lineStyle,{visible:e},s)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const s=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new pr,this.currentPath.closeStroke=!1,this.currentPath.points.push(s[t-2],s[t-1]))}else this.currentPath=new pr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(s,t){return this.startPoly(),this.currentPath.points[0]=s,this.currentPath.points[1]=t,this}lineTo(s,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,n=e[e.length-2],i=e[e.length-1];return(n!==s||i!==t)&&e.push(s,t),this}_initCurve(s=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[s,t]):this.moveTo(s,t)}quadraticCurveTo(s,t,e,n){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),_d.curveTo(s,t,e,n,i),this}bezierCurveTo(s,t,e,n,i,r){return this._initCurve(),wd.curveTo(s,t,e,n,i,r,this.currentPath.points),this}arcTo(s,t,e,n,i){this._initCurve(s,t);const r=this.currentPath.points,a=Cp.curveTo(s,t,e,n,i,r);if(a){const{cx:l,cy:o,radius:h,startAngle:c,endAngle:d,anticlockwise:u}=a;this.arc(l,o,h,c,d,u)}return this}arc(s,t,e,n,i,r=!1){if(n===i)return this;if(!r&&i<=n?i+=Al:r&&n<=i&&(n+=Al),i-n===0)return this;const l=s+Math.cos(n)*e,o=t+Math.sin(n)*e,h=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const d=Math.abs(c[c.length-2]-l),u=Math.abs(c[c.length-1]-o);d<h&&u<h||c.push(l,o)}else this.moveTo(l,o),c=this.currentPath.points;return Cp.arc(l,o,s,t,e,n,i,r,c),this}beginFill(s=0,t){return this.beginTextureFill({texture:pt.WHITE,color:s,alpha:t})}normalizeColor(s){const t=Kt.shared.setValue(s.color??0);s.color=t.toNumber(),s.alpha??(s.alpha=t.alpha)}beginTextureFill(s){const t={texture:pt.WHITE,color:16777215,matrix:null};s=Object.assign(t,s),this.normalizeColor(s),this.currentPath&&this.startPoly();const e=s.alpha>0;return e?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._fillStyle,{visible:e},s)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(s,t,e,n){return this.drawShape(new Dt(s,t,e,n))}drawRoundedRect(s,t,e,n,i){return this.drawShape(new yd(s,t,e,n,i))}drawCircle(s,t,e){return this.drawShape(new gd(s,t,e))}drawEllipse(s,t,e,n){return this.drawShape(new xd(s,t,e,n))}drawPolygon(...s){let t,e=!0;const n=s[0];n.points?(e=n.closeStroke,t=n.points):Array.isArray(s[0])?t=s[0]:t=s;const i=new pr(t);return i.closeStroke=e,this.drawShape(i),this}drawShape(s){return this._holeMode?this._geometry.drawHole(s,this._matrix):this._geometry.drawShape(s,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const s=this._geometry.graphicsData;return s.length===1&&s[0].shape.type===Ke.RECT&&!s[0].matrix&&!s[0].holes.length&&!(s[0].lineStyle.visible&&s[0].lineStyle.width)}_render(s){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(s)):(s.batch.flush(),this._renderDirect(s))}_populateBatches(){const s=this._geometry,t=this.blendMode,e=s.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=s.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(s.points);for(let n=0;n<e;n++){const i=s.batches[n],r=i.style.color,a=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),l=new Float32Array(s.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),o=new Uint16Array(s.indicesUint16.buffer,i.start*2,i.size),h={vertexData:a,blendMode:t,indices:o,uvs:l,_batchRGB:Kt.shared.setValue(r).toRgbArray(),_tintRGB:r,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=h}}_renderBatched(s){if(this.batches.length){s.batch.setObjectRenderer(s.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,s.plugins[this.pluginName].render(n)}}}_renderDirect(s){const t=this._resolveDirectShader(s),e=this._geometry,n=this.worldAlpha,i=t.uniforms,r=e.drawCalls;i.translationMatrix=this.transform.worldTransform,Kt.shared.setValue(this._tintColor).premultiply(n).toArray(i.tint),s.shader.bind(t),s.geometry.bind(e,t),s.state.set(this.state);for(let a=0,l=r.length;a<l;a++)this._renderDrawCallDirect(s,e.drawCalls[a])}_renderDrawCallDirect(s,t){const{texArray:e,type:n,size:i,start:r}=t,a=e.count;for(let l=0;l<a;l++)s.texture.bind(e.elements[l],l);s.geometry.draw(n,i,r)}_resolveDirectShader(s){let t=this.shader;const e=this.pluginName;if(!t){if(!Rc[e]){const{maxTextures:n}=s.plugins[e],i=new Int32Array(n);for(let l=0;l<n;l++)i[l]=l;const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new se,default:Cn.from({uSamplers:i},!0)},a=s.plugins[e]._shader.program;Rc[e]=new Kn(a,r)}t=Rc[e]}return t}_calculateBounds(){this.finishPoly();const s=this._geometry;if(!s.graphicsData.length)return;const{minX:t,minY:e,maxX:n,maxY:i}=s.bounds;this._bounds.addFrame(this.transform,t,e,n,i)}containsPoint(s){return this.worldTransform.applyInverse(s,dl._TEMP_POINT),this._geometry.containsPoint(dl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let s=0;s<this.batches.length;s++){const t=this.batches[s];t._tintRGB=Kt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const s=this.transform._worldID;if(this._transformID===s)return;this._transformID=s;const t=this.transform.worldTransform,e=t.a,n=t.b,i=t.c,r=t.d,a=t.tx,l=t.ty,o=this._geometry.points,h=this.vertexData;let c=0;for(let d=0;d<o.length;d+=2){const u=o[d],f=o[d+1];h[c++]=e*u+i*f+a,h[c++]=r*f+n*u+l}}closePath(){const s=this.currentPath;return s&&(s.closeStroke=!0,this.finishPoly()),this}setMatrix(s){return this._matrix=s,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(s){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(s)}};let Fn=dl;Fn.curves=xo;Fn._TEMP_POINT=new Ht;class zT{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Pc=new Ht,Pp=new pr,ox=class extends Mt{constructor(s,t,e,n=En.TRIANGLES){super(),this.geometry=s,this.shader=t,this.state=e||wi.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ct.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(s){this._geometry!==s&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=s,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(s){this.shader=s}get material(){return this.shader}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}set roundPixels(s){this._roundPixels!==s&&(this._transformID=-1),this._roundPixels=s}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(s){this.shader.tint=s}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(s){this.shader.texture=s}_render(s){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===En.TRIANGLES&&t.length<ox.BATCHABLE_SIZE*2?this._renderToBatch(s):this._renderDefault(s)}_renderDefault(s){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),s.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),s.shader.bind(t),s.state.set(this.state),s.geometry.bind(this.geometry,t),s.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(s){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const n=this.material.pluginName;s.batch.setObjectRenderer(s.plugins[n]),s.plugins[n].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const i=this.transform.worldTransform,r=i.a,a=i.b,l=i.c,o=i.d,h=i.tx,c=i.ty,d=this.vertexData;for(let u=0;u<d.length/2;u++){const f=e[u*2],m=e[u*2+1];d[u*2]=r*f+l*m+h,d[u*2+1]=a*f+o*m+c}if(this._roundPixels){const u=ct.RESOLUTION;for(let f=0;f<d.length;++f)d[f]=Math.round(d[f]*u)/u}this.vertexDirty=n}calculateUvs(){const s=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=s.data:(this.batchUvs||(this.batchUvs=new zT(s,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(s){if(!this.getBounds().contains(s.x,s.y))return!1;this.worldTransform.applyInverse(s,Pc);const t=this.geometry.getBuffer("aVertexPosition").data,e=Pp.points,n=this.geometry.getIndex().data,i=n.length,r=this.drawMode===4?3:1;for(let a=0;a+2<i;a+=r){const l=n[a]*2,o=n[a+1]*2,h=n[a+2]*2;if(e[0]=t[l],e[1]=t[l+1],e[2]=t[o],e[3]=t[o+1],e[4]=t[h],e[5]=t[h+1],Pp.contains(Pc.x,Pc.y))return!0}return!1}destroy(s){super.destroy(s),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Fl=ox;Fl.BATCHABLE_SIZE=100;class ax extends Xi{constructor(t,e,n){super();const i=new Se(t),r=new Se(e,!0),a=new Se(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,wt.FLOAT).addAttribute("aTextureCoord",r,2,!1,wt.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var jT=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,qT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Pu extends Kn{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:se.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(n,e.uniforms),super(e.program||Sn.from(qT,jT),n),this._colorDirty=!1,this.uvMatrix=new R0(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new Kt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Kt.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class KT extends Fl{constructor(t=pt.EMPTY,e,n,i,r){const a=new ax(e,n,i);a.getBuffer("aVertexPosition").static=!1;const l=new Pu(t);super(a,l,null,r),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class kp{constructor(t,e,n){this.geometry=new Xi,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<t.length;++i){let r=t[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||wt.FLOAT,offset:r.offset},e[i]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Se(P_(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Se(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];l.offset=i,i+=l.size,this.staticStride+=l.size}const r=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(r),this.staticDataUint32=new Uint32Array(r),this.staticBuffer=new Se(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===wt.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===wt.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,n){for(let i=0;i<this.dynamicProperties.length;i++){const r=this.dynamicProperties[i];r.uploadFunction(t,e,n,r.type===wt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let i=0;i<this.staticProperties.length;i++){const r=this.staticProperties[i];r.uploadFunction(t,e,n,r.type===wt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var ZT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,JT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class lx extends ah{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new se,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:wt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Kn.from(JT,ZT,{}),this.state=wi.for2d()}render(t){const e=t.children,n=t._maxSize,i=t._batchSize,r=this.renderer;let a=e.length;if(a===0)return;a>n&&!t.autoResize&&(a=n);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const o=e[0]._texture.baseTexture,h=o.alphaMode>0;this.state.blendMode=c0(t.blendMode,h),r.state.set(this.state);const c=r.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=Kt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);let u=!1;for(let f=0,m=0;f<a;f+=i,m+=1){let p=a-f;p>i&&(p=i),m>=l.length&&l.push(this._generateOneMoreBuffer(t));const g=l[m];g.uploadDynamic(e,f,p);const v=t._bufferUpdateIDs[m]||0;u=u||g._updateID<v,u&&(g._updateID=t._updateID,g.uploadStatic(e,f,p)),r.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,p*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,i=t._batchSize,r=t._properties;for(let a=0;a<n;a+=i)e.push(new kp(this.properties,r,i));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new kp(this.properties,n,e)}uploadVertices(t,e,n,i,r,a){let l=0,o=0,h=0,c=0;for(let d=0;d<n;++d){const u=t[e+d],f=u._texture,m=u.scale.x,p=u.scale.y,g=f.trim,v=f.orig;g?(o=g.x-u.anchor.x*v.width,l=o+g.width,c=g.y-u.anchor.y*v.height,h=c+g.height):(l=v.width*(1-u.anchor.x),o=v.width*-u.anchor.x,h=v.height*(1-u.anchor.y),c=v.height*-u.anchor.y),i[a]=o*m,i[a+1]=c*p,i[a+r]=l*m,i[a+r+1]=c*p,i[a+r*2]=l*m,i[a+r*2+1]=h*p,i[a+r*3]=o*m,i[a+r*3+1]=h*p,a+=r*4}}uploadPosition(t,e,n,i,r,a){for(let l=0;l<n;l++){const o=t[e+l].position;i[a]=o.x,i[a+1]=o.y,i[a+r]=o.x,i[a+r+1]=o.y,i[a+r*2]=o.x,i[a+r*2+1]=o.y,i[a+r*3]=o.x,i[a+r*3+1]=o.y,a+=r*4}}uploadRotation(t,e,n,i,r,a){for(let l=0;l<n;l++){const o=t[e+l].rotation;i[a]=o,i[a+r]=o,i[a+r*2]=o,i[a+r*3]=o,a+=r*4}}uploadUvs(t,e,n,i,r,a){for(let l=0;l<n;++l){const o=t[e+l]._texture._uvs;o?(i[a]=o.x0,i[a+1]=o.y0,i[a+r]=o.x1,i[a+r+1]=o.y1,i[a+r*2]=o.x2,i[a+r*2+1]=o.y2,i[a+r*3]=o.x3,i[a+r*3+1]=o.y3,a+=r*4):(i[a]=0,i[a+1]=0,i[a+r]=0,i[a+r+1]=0,i[a+r*2]=0,i[a+r*2+1]=0,i[a+r*3]=0,i[a+r*3+1]=0,a+=r*4)}}uploadTint(t,e,n,i,r,a){for(let l=0;l<n;++l){const o=t[e+l],h=Kt.shared.setValue(o._tintRGB).toPremultiplied(o.alpha,o.texture.baseTexture.alphaMode>0);i[a]=h,i[a+r]=h,i[a+r*2]=h,i[a+r*3]=h,a+=r*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}lx.extension={name:"particle",type:ut.RendererPlugin};bt.add(lx);var ph=(s=>(s[s.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",s[s.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",s))(ph||{});const Ja={willReadFrequently:!0},yt=class{static get experimentalLetterSpacingSupported(){let s=yt._experimentalLetterSpacingSupported;if(s!==void 0){const t=ct.ADAPTER.getCanvasRenderingContext2D().prototype;s=yt._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return s}constructor(s,t,e,n,i,r,a,l,o){this.text=s,this.style=t,this.width=e,this.height=n,this.lines=i,this.lineWidths=r,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=o}static measureText(s,t,e,n=yt._canvas){e=e??t.wordWrap;const i=t.toFontString(),r=yt.measureFont(i);r.fontSize===0&&(r.fontSize=t.fontSize,r.ascent=t.fontSize);const a=n.getContext("2d",Ja);a.font=i;const o=(e?yt.wordWrap(s,t,n):s).split(/(?:\r\n|\r|\n)/),h=new Array(o.length);let c=0;for(let m=0;m<o.length;m++){const p=yt._measureText(o[m],t.letterSpacing,a);h[m]=p,c=Math.max(c,p)}let d=c+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);const u=t.lineHeight||r.fontSize+t.strokeThickness;let f=Math.max(u,r.fontSize+t.strokeThickness*2)+(o.length-1)*(u+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new yt(s,t,d,f,o,h,u+t.leading,c,r)}static _measureText(s,t,e){let n=!1;yt.experimentalLetterSpacingSupported&&(yt.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,n=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let i=e.measureText(s).width;return i>0&&(n?i-=t:i+=(yt.graphemeSegmenter(s).length-1)*t),i}static wordWrap(s,t,e=yt._canvas){const n=e.getContext("2d",Ja);let i=0,r="",a="";const l=Object.create(null),{letterSpacing:o,whiteSpace:h}=t,c=yt.collapseSpaces(h),d=yt.collapseNewlines(h);let u=!c;const f=t.wordWrapWidth+o,m=yt.tokenize(s);for(let p=0;p<m.length;p++){let g=m[p];if(yt.isNewline(g)){if(!d){a+=yt.addLine(r),u=!c,r="",i=0;continue}g=" "}if(c){const b=yt.isBreakingSpace(g),x=yt.isBreakingSpace(r[r.length-1]);if(b&&x)continue}const v=yt.getFromCache(g,o,l,n);if(v>f)if(r!==""&&(a+=yt.addLine(r),r="",i=0),yt.canBreakWords(g,t.breakWords)){const b=yt.wordWrapSplit(g);for(let x=0;x<b.length;x++){let y=b[x],w=y,_=1;for(;b[x+_];){const T=b[x+_];if(!yt.canBreakChars(w,T,g,x,t.breakWords))y+=T;else break;w=T,_++}x+=_-1;const E=yt.getFromCache(y,o,l,n);E+i>f&&(a+=yt.addLine(r),u=!1,r="",i=0),r+=y,i+=E}}else{r.length>0&&(a+=yt.addLine(r),r="",i=0);const b=p===m.length-1;a+=yt.addLine(g,!b),u=!1,r="",i=0}else v+i>f&&(u=!1,a+=yt.addLine(r),r="",i=0),(r.length>0||!yt.isBreakingSpace(g)||u)&&(r+=g,i+=v)}return a+=yt.addLine(r,!1),a}static addLine(s,t=!0){return s=yt.trimRight(s),s=t?`${s}
`:s,s}static getFromCache(s,t,e,n){let i=e[s];return typeof i!="number"&&(i=yt._measureText(s,t,n)+t,e[s]=i),i}static collapseSpaces(s){return s==="normal"||s==="pre-line"}static collapseNewlines(s){return s==="normal"}static trimRight(s){if(typeof s!="string")return"";for(let t=s.length-1;t>=0;t--){const e=s[t];if(!yt.isBreakingSpace(e))break;s=s.slice(0,-1)}return s}static isNewline(s){return typeof s!="string"?!1:yt._newlines.includes(s.charCodeAt(0))}static isBreakingSpace(s,t){return typeof s!="string"?!1:yt._breakingSpaces.includes(s.charCodeAt(0))}static tokenize(s){const t=[];let e="";if(typeof s!="string")return t;for(let n=0;n<s.length;n++){const i=s[n],r=s[n+1];if(yt.isBreakingSpace(i,r)||yt.isNewline(i)){e!==""&&(t.push(e),e=""),t.push(i);continue}e+=i}return e!==""&&t.push(e),t}static canBreakWords(s,t){return t}static canBreakChars(s,t,e,n,i){return!0}static wordWrapSplit(s){return yt.graphemeSegmenter(s)}static measureFont(s){if(yt._fonts[s])return yt._fonts[s];const t={ascent:0,descent:0,fontSize:0},e=yt._canvas,n=yt._context;n.font=s;const i=yt.METRICS_STRING+yt.BASELINE_SYMBOL,r=Math.ceil(n.measureText(i).width);let a=Math.ceil(n.measureText(yt.BASELINE_SYMBOL).width);const l=Math.ceil(yt.HEIGHT_MULTIPLIER*a);if(a=a*yt.BASELINE_MULTIPLIER|0,r===0||l===0)return yt._fonts[s]=t,t;e.width=r,e.height=l,n.fillStyle="#f00",n.fillRect(0,0,r,l),n.font=s,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(i,0,a);const o=n.getImageData(0,0,r,l).data,h=o.length,c=r*4;let d=0,u=0,f=!1;for(d=0;d<a;++d){for(let m=0;m<c;m+=4)if(o[u+m]!==255){f=!0;break}if(!f)u+=c;else break}for(t.ascent=a-d,u=h-c,f=!1,d=l;d>a;--d){for(let m=0;m<c;m+=4)if(o[u+m]!==255){f=!0;break}if(!f)u-=c;else break}return t.descent=d-a,t.fontSize=t.ascent+t.descent,yt._fonts[s]=t,t}static clearMetrics(s=""){s?delete yt._fonts[s]:yt._fonts={}}static get _canvas(){if(!yt.__canvas){let s;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",Ja);if(e!=null&&e.measureText)return yt.__canvas=t,t;s=ct.ADAPTER.createCanvas()}catch{s=ct.ADAPTER.createCanvas()}s.width=s.height=10,yt.__canvas=s}return yt.__canvas}static get _context(){return yt.__context||(yt.__context=yt._canvas.getContext("2d",Ja)),yt.__context}};let qe=yt;qe.METRICS_STRING="|q";qe.BASELINE_SYMBOL="M";qe.BASELINE_MULTIPLIER=1.4;qe.HEIGHT_MULTIPLIER=2;qe.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})();qe.experimentalLetterSpacing=!1;qe._fonts={};qe._newlines=[10,13];qe._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const QT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Yo=class{constructor(s){this.styleID=0,this.reset(),Fc(this,s,s)}clone(){const s={};return Fc(s,this,Yo.defaultStyle),new Yo(s)}reset(){Fc(this,Yo.defaultStyle,Yo.defaultStyle)}get align(){return this._align}set align(s){this._align!==s&&(this._align=s,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(s){this._breakWords!==s&&(this._breakWords=s,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(s){this._dropShadow!==s&&(this._dropShadow=s,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(s){this._dropShadowAlpha!==s&&(this._dropShadowAlpha=s,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(s){this._dropShadowAngle!==s&&(this._dropShadowAngle=s,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(s){this._dropShadowBlur!==s&&(this._dropShadowBlur=s,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(s){const t=kc(s);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(s){this._dropShadowDistance!==s&&(this._dropShadowDistance=s,this.styleID++)}get fill(){return this._fill}set fill(s){const t=kc(s);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(s){this._fillGradientType!==s&&(this._fillGradientType=s,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(s){tA(this._fillGradientStops,s)||(this._fillGradientStops=s,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(s){this.fontFamily!==s&&(this._fontFamily=s,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(s){this._fontSize!==s&&(this._fontSize=s,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(s){this._fontStyle!==s&&(this._fontStyle=s,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(s){this._fontVariant!==s&&(this._fontVariant=s,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(s){this._fontWeight!==s&&(this._fontWeight=s,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(s){this._letterSpacing!==s&&(this._letterSpacing=s,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(s){this._lineHeight!==s&&(this._lineHeight=s,this.styleID++)}get leading(){return this._leading}set leading(s){this._leading!==s&&(this._leading=s,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(s){this._lineJoin!==s&&(this._lineJoin=s,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(s){this._miterLimit!==s&&(this._miterLimit=s,this.styleID++)}get padding(){return this._padding}set padding(s){this._padding!==s&&(this._padding=s,this.styleID++)}get stroke(){return this._stroke}set stroke(s){const t=kc(s);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(s){this._strokeThickness!==s&&(this._strokeThickness=s,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(s){this._textBaseline!==s&&(this._textBaseline=s,this.styleID++)}get trim(){return this._trim}set trim(s){this._trim!==s&&(this._trim=s,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(s){this._whiteSpace!==s&&(this._whiteSpace=s,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(s){this._wordWrap!==s&&(this._wordWrap=s,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(s){this._wordWrapWidth!==s&&(this._wordWrapWidth=s,this.styleID++)}toFontString(){const s=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let n=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!QT.includes(n)&&(n=`"${n}"`),t[e]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${s} ${t.join(",")}`}};let bi=Yo;bi.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ph.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function kc(s){const t=Kt.shared;return Array.isArray(s)?s.map(e=>t.setValue(e).toHex()):t.setValue(s).toHex()}function tA(s,t){if(!Array.isArray(s)||!Array.isArray(t)||s.length!==t.length)return!1;for(let e=0;e<s.length;++e)if(s[e]!==t[e])return!1;return!0}function Fc(s,t,e){for(const n in e)Array.isArray(t[n])?s[n]=t[n].slice():s[n]=t[n]}const eA={texture:!0,children:!1,baseTexture:!0},ku=class extends ve{constructor(s,t,e){let n=!1;e||(e=ct.ADAPTER.createCanvas(),n=!0),e.width=3,e.height=3;const i=pt.from(e);i.orig=new Dt,i.trim=new Dt,super(i),this._ownCanvas=n,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=ku.defaultResolution??ct.RESOLUTION,this._autoResolution=ku.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=s,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return qe.experimentalLetterSpacing}static set experimentalLetterSpacing(s){Lt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),qe.experimentalLetterSpacing=s}updateText(s){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&s)return;this._font=this._style.toFontString();const e=this.context,n=qe.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=n.width,r=n.height,a=n.lines,l=n.lineHeight,o=n.lineWidths,h=n.maxLineWidth,c=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let d,u;const f=t.dropShadow?2:1;for(let m=0;m<f;++m){const p=t.dropShadow&&m===0,g=p?Math.ceil(Math.max(1,r)+t.padding*2):0,v=g*this._resolution;if(p){e.fillStyle="black",e.strokeStyle="black";const x=t.dropShadowColor,y=t.dropShadowBlur*this._resolution,w=t.dropShadowDistance*this._resolution;e.shadowColor=Kt.shared.setValue(x).setAlpha(t.dropShadowAlpha).toRgbaString(),e.shadowBlur=y,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*w,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*w+v}else e.fillStyle=this._generateFillStyle(t,a,n),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let b=(l-c.fontSize)/2;l-c.fontSize<0&&(b=0);for(let x=0;x<a.length;x++)d=t.strokeThickness/2,u=t.strokeThickness/2+x*l+c.ascent+b,t.align==="right"?d+=h-o[x]:t.align==="center"&&(d+=(h-o[x])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[x],d+t.padding,u+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[x],d+t.padding,u+t.padding-g)}this.updateTexture()}drawLetterSpacing(s,t,e,n=!1){const r=this._style.letterSpacing;let a=!1;if(qe.experimentalLetterSpacingSupported&&(qe.experimentalLetterSpacing?(this.context.letterSpacing=`${r}px`,this.context.textLetterSpacing=`${r}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),r===0||a){n?this.context.strokeText(s,t,e):this.context.fillText(s,t,e);return}let l=t;const o=qe.graphemeSegmenter(s);let h=this.context.measureText(s).width,c=0;for(let d=0;d<o.length;++d){const u=o[d];n?this.context.strokeText(u,l,e):this.context.fillText(u,l,e);let f="";for(let m=d+1;m<o.length;++m)f+=o[m];c=this.context.measureText(f).width,l+=h-c+r,h=c}}updateTexture(){const s=this.canvas;if(this._style.trim){const r=B_(s);r.data&&(s.width=r.width,s.height=r.height,this.context.putImageData(r.data,0,0))}const t=this._texture,e=this._style,n=e.trim?0:e.padding,i=t.baseTexture;t.trim.width=t._frame.width=s.width/this._resolution,t.trim.height=t._frame.height=s.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),i.setRealSize(s.width,s.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._render(s)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(s,t){return this.updateText(!0),this._textureID===-1&&(s=!1),super.getBounds(s,t)}getLocalBounds(s){return this.updateText(!0),super.getLocalBounds.call(this,s)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(s,t,e){const n=s.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let i;const r=s.dropShadow?s.dropShadowDistance:0,a=s.padding||0,l=this.canvas.width/this._resolution-r-a*2,o=this.canvas.height/this._resolution-r-a*2,h=n.slice(),c=s.fillGradientStops.slice();if(!c.length){const d=h.length+1;for(let u=1;u<d;++u)c.push(u/d)}if(h.unshift(n[0]),c.unshift(0),h.push(n[n.length-1]),c.push(1),s.fillGradientType===ph.LINEAR_VERTICAL){i=this.context.createLinearGradient(l/2,a,l/2,o+a);const d=e.fontProperties.fontSize+s.strokeThickness;for(let u=0;u<t.length;u++){const f=e.lineHeight*(u-1)+d,m=e.lineHeight*u;let p=m;u>0&&f>m&&(p=(m+f)/2);const g=m+d,v=e.lineHeight*(u+1);let b=g;u+1<t.length&&v<g&&(b=(g+v)/2);const x=(b-p)/o;for(let y=0;y<h.length;y++){let w=0;typeof c[y]=="number"?w=c[y]:w=y/h.length;let _=Math.min(1,Math.max(0,p/o+w*x));_=Number(_.toFixed(5)),i.addColorStop(_,h[y])}}}else{i=this.context.createLinearGradient(a,o/2,l+a,o/2);const d=h.length+1;let u=1;for(let f=0;f<h.length;f++){let m;typeof c[f]=="number"?m=c[f]:m=u/d,i.addColorStop(m,h[f]),u++}}return i}destroy(s){typeof s=="boolean"&&(s={children:s}),s=Object.assign({},eA,s),super.destroy(s),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(s){this.updateText(!0);const t=Oi(this.scale.x)||1;this.scale.x=t*s/this._texture.orig.width,this._width=s}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(s){this.updateText(!0);const t=Oi(this.scale.y)||1;this.scale.y=t*s/this._texture.orig.height,this._height=s}get style(){return this._style}set style(s){s=s||{},s instanceof bi?this._style=s:this._style=new bi(s),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(s){s=String(s??""),this._text!==s&&(this._text=s,this.dirty=!0)}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}};let gh=ku;gh.defaultAutoResolution=!0;class sA{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function nA(s,t){var n;let e=!1;if((n=s==null?void 0:s._textures)!=null&&n.length){for(let i=0;i<s._textures.length;i++)if(s._textures[i]instanceof pt){const r=s._textures[i].baseTexture;t.includes(r)||(t.push(r),e=!0)}}return e}function iA(s,t){if(s.baseTexture instanceof Ct){const e=s.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function rA(s,t){if(s._texture&&s._texture instanceof pt){const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function oA(s,t){return t instanceof gh?(t.updateText(!0),!0):!1}function aA(s,t){if(t instanceof bi){const e=t.toFontString();return qe.measureFont(e),!0}return!1}function lA(s,t){if(s instanceof gh){t.includes(s.style)||t.push(s.style),t.includes(s)||t.push(s);const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function hA(s,t){return s instanceof bi?(t.includes(s)||t.push(s),!0):!1}const hx=class{constructor(s){this.limiter=new sA(hx.uploadsPerFrame),this.renderer=s,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(lA),this.registerFindHook(hA),this.registerFindHook(nA),this.registerFindHook(iA),this.registerFindHook(rA),this.registerUploadHook(oA),this.registerUploadHook(aA)}upload(s){return new Promise(t=>{s&&this.add(s),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Oe.system.addOnce(this.tick,this,_r.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const s=this.queue[0];let t=!1;if(s&&!s._destroyed){for(let e=0,n=this.uploadHooks.length;e<n;e++)if(this.uploadHooks[e](this.uploadHookHelper,s)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Oe.system.addOnce(this.tick,this,_r.UTILITY);else{this.ticking=!1;const s=this.completes.slice(0);this.completes.length=0;for(let t=0,e=s.length;t<e;t++)s[t]()}}registerFindHook(s){return s&&this.addHooks.push(s),this}registerUploadHook(s){return s&&this.uploadHooks.push(s),this}add(s){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](s,this.queue);t++);if(s instanceof Mt)for(let t=s.children.length-1;t>=0;t--)this.add(s.children[t]);return this}destroy(){this.ticking&&Oe.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Dl=hx;Dl.uploadsPerFrame=4;Object.defineProperties(ct,{UPLOADS_PER_FRAME:{get(){return Dl.uploadsPerFrame},set(s){Lt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Dl.uploadsPerFrame=s}}});function cx(s,t){return t instanceof Ct?(t._glTextures[s.CONTEXT_UID]||s.texture.bind(t),!0):!1}function cA(s,t){if(!(t instanceof Fn))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:n}=e;for(let i=0;i<n.length;i++){const{texture:r}=n[i].style;r&&cx(s,r.baseTexture)}return e.batchable||s.geometry.bind(e,t._resolveDirectShader(s)),!0}function uA(s,t){return s instanceof Fn?(t.push(s),!0):!1}class ux extends Dl{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(uA),this.registerUploadHook(cx),this.registerUploadHook(cA)}}ux.extension={name:"prepare",type:ut.RendererSystem};bt.add(ux);var dA=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,fA=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,mA=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Fp=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,pA=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Qa=new se;class dx extends ah{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new A0,this.state=wi.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Kn.from(Fp,pA,e),this.shader=t.context.webGLVersion>1?Kn.from(fA,dA,e):Kn.from(Fp,mA,e)}render(t){const e=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);const r=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;i=n.uvs,i[0]=i[6]=-r,i[1]=i[3]=-a,i[2]=i[4]=1-r,i[5]=i[7]=1-a,n.invalidate();const l=t._texture,o=l.baseTexture,h=o.alphaMode>0,c=t.tileTransform.localTransform,d=t.uvMatrix;let u=o.isPowerOfTwo&&l.frame.width===o.width&&l.frame.height===o.height;u&&(o._glTextures[e.CONTEXT_UID]?u=o.wrapMode!==Li.CLAMP:o.wrapMode===Li.CLAMP&&(o.wrapMode=Li.REPEAT));const f=u?this.simpleShader:this.shader,m=l.width,p=l.height,g=t._width,v=t._height;Qa.set(c.a*m/g,c.b*m/v,c.c*p/g,c.d*p/v,c.tx/g,c.ty/v),Qa.invert(),u?Qa.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=Qa.toArray(!0),f.uniforms.uColor=Kt.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=l,e.shader.bind(f),e.geometry.bind(n),this.state.blendMode=c0(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}dx.extension={name:"tilingSprite",type:ut.RendererPlugin};bt.add(dx);const $o=class{constructor(s,t,e=null){this.linkedSheets=[],this._texture=s instanceof pt?s:null,this.baseTexture=s instanceof Ct?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const n=this.baseTexture.resource;this.resolution=this._updateResolution(e||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(s=null){const{scale:t}=this.data.meta;let e=Ui(s,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(s=>{this._callback=s,this._batchIndex=0,this._frameKeys.length<=$o.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(s){let t=s;const e=$o.BATCH_SIZE;for(;t-s<e&&t<this._frameKeys.length;){const n=this._frameKeys[t],i=this._frames[n],r=i.frame;if(r){let a=null,l=null;const o=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,h=new Dt(0,0,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution);i.rotated?a=new Dt(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):a=new Dt(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new Dt(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[n]=new pt(this.baseTexture,a,h,l,i.rotated?2:0,i.anchor,i.borders),pt.addToCache(this.textures[n],n)}t++}}_processAnimations(){const s=this.data.animations||{};for(const t in s){this.animations[t]=[];for(let e=0;e<s[t].length;e++){const n=s[t][e];this.animations[t].push(this.textures[n])}}}_parseComplete(){const s=this._callback;this._callback=null,this._batchIndex=0,s.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*$o.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*$o.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(s=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,s&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Fu=$o;Fu.BATCH_SIZE=1e3;const gA=["jpg","png","jpeg","avif","webp"];function fx(s,t,e){const n={};if(s.forEach(i=>{n[i]=t}),Object.keys(t.textures).forEach(i=>{n[i]=t.textures[i]}),!e){const i=me.dirname(s[0]);t.linkedSheets.forEach((r,a)=>{const l=fx([`${i}/${t.data.meta.related_multi_packs[a]}`],r,!0);Object.assign(n,l)})}return n}const xA={extension:ut.Asset,cache:{test:s=>s instanceof Fu,getCacheableAssets:(s,t)=>fx(s,t,!1)},resolver:{test:s=>{const e=s.split("?")[0].split("."),n=e.pop(),i=e.pop();return n==="json"&&gA.includes(i)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=ct.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:ut.LoadParser,priority:nn.Normal},async testParse(s,t){return me.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var h,c;let n=me.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let i=n+s.meta.image;i=Iu(i,t.src);const a=(await e.load([i]))[i],l=new Fu(a.baseTexture,s,t.src);await l.parse();const o=(h=s==null?void 0:s.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(o)){const d=[];for(const f of o){if(typeof f!="string")continue;let m=n+f;(c=t.data)!=null&&c.ignoreMultiPack||(m=Iu(m,t.src),d.push(e.load({src:m,data:{ignoreMultiPack:!0}})))}const u=await Promise.all(d);l.linkedSheets=u,u.forEach(f=>{f.linkedSheets=[l].concat(l.linkedSheets.filter(m=>m!==f))})}return l},unload(s){s.destroy(!0)}}};bt.add(xA);class Bl{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class fl{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const r in e){const a=e[r].match(/^[a-z]+/gm)[0],l=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(const h in l){const c=l[h].split("="),d=c[0],u=c[1].replace(/"/gm,""),f=parseFloat(u),m=isNaN(f)?u:f;o[d]=m}n[a].push(o)}const i=new Bl;return n.info.forEach(r=>i.info.push({face:r.face,size:parseInt(r.size,10)})),n.common.forEach(r=>i.common.push({lineHeight:parseInt(r.lineHeight,10)})),n.page.forEach(r=>i.page.push({id:parseInt(r.id,10),file:r.file})),n.char.forEach(r=>i.char.push({id:parseInt(r.id,10),page:parseInt(r.page,10),x:parseInt(r.x,10),y:parseInt(r.y,10),width:parseInt(r.width,10),height:parseInt(r.height,10),xoffset:parseInt(r.xoffset,10),yoffset:parseInt(r.yoffset,10),xadvance:parseInt(r.xadvance,10)})),n.kerning.forEach(r=>i.kerning.push({first:parseInt(r.first,10),second:parseInt(r.second,10),amount:parseInt(r.amount,10)})),n.distanceField.forEach(r=>i.distanceField.push({distanceRange:parseInt(r.distanceRange,10),fieldType:r.fieldType})),i}}class Du{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Bl,n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField");for(let h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(let h=0;h<i.length;h++)e.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(let h=0;h<r.length;h++)e.page.push({id:parseInt(r[h].getAttribute("id"),10)||0,file:r[h].getAttribute("file")});for(let h=0;h<a.length;h++){const c=a[h];e.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let h=0;h<l.length;h++)e.kerning.push({first:parseInt(l[h].getAttribute("first"),10),second:parseInt(l[h].getAttribute("second"),10),amount:parseInt(l[h].getAttribute("amount"),10)});for(let h=0;h<o.length;h++)e.distanceField.push({fieldType:o[h].getAttribute("fieldType"),distanceRange:parseInt(o[h].getAttribute("distanceRange"),10)});return e}}class Bu{static test(t){return typeof t=="string"&&t.includes("<font>")?Du.test(ct.ADAPTER.parseXML(t)):!1}static parse(t){return Du.parse(ct.ADAPTER.parseXML(t))}}const Dc=[fl,Du,Bu];function yA(s){for(let t=0;t<Dc.length;t++)if(Dc[t].test(s))return Dc[t];return null}function bA(s,t,e,n,i,r){const a=e.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l;const o=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,c=s.width/n-o-h*2,d=s.height/n-o-h*2,u=a.slice(),f=e.fillGradientStops.slice();if(!f.length){const m=u.length+1;for(let p=1;p<m;++p)f.push(p/m)}if(u.unshift(a[0]),f.unshift(0),u.push(a[a.length-1]),f.push(1),e.fillGradientType===ph.LINEAR_VERTICAL){l=t.createLinearGradient(c/2,h,c/2,d+h);let m=0;const g=(r.fontProperties.fontSize+e.strokeThickness)/d;for(let v=0;v<i.length;v++){const b=r.lineHeight*v;for(let x=0;x<u.length;x++){let y=0;typeof f[x]=="number"?y=f[x]:y=x/u.length;const w=b/d+y*g;let _=Math.max(m,w);_=Math.min(_,1),l.addColorStop(_,u[x]),m=_}}}else{l=t.createLinearGradient(h,d/2,c+h,d/2);const m=u.length+1;let p=1;for(let g=0;g<u.length;g++){let v;typeof f[g]=="number"?v=f[g]:v=p/m,l.addColorStop(v,u[g]),p++}}return l}function vA(s,t,e,n,i,r,a){const l=e.text,o=e.fontProperties;t.translate(n,i),t.scale(r,r);const h=a.strokeThickness/2,c=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=bA(s,t,a,r,[l],e),t.strokeStyle=a.stroke,a.dropShadow){const d=a.dropShadowColor,u=a.dropShadowBlur*r,f=a.dropShadowDistance*r;t.shadowColor=Kt.shared.setValue(d).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=u,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(l,h,c+e.lineHeight-o.descent),a.fill&&t.fillText(l,h,c+e.lineHeight-o.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function ml(s){return s.codePointAt?s.codePointAt(0):s.charCodeAt(0)}function mx(s){return Array.from?Array.from(s):s.split("")}function wA(s){typeof s=="string"&&(s=[s]);const t=[];for(let e=0,n=s.length;e<n;e++){const i=s[e];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const r=i[0].charCodeAt(0),a=i[1].charCodeAt(0);if(a<r)throw new Error("[BitmapFont]: Invalid character range.");for(let l=r,o=a;l<=o;l++)t.push(String.fromCharCode(l))}else t.push(...mx(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const pn=class{constructor(s,t,e){var h;const[n]=s.info,[i]=s.common,[r]=s.page,[a]=s.distanceField,l=Ui(r.file),o={};this._ownsTextures=e,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/l,this.chars={},this.pageTextures=o;for(let c=0;c<s.page.length;c++){const{id:d,file:u}=s.page[c];o[d]=t instanceof Array?t[c]:t[u],a!=null&&a.fieldType&&a.fieldType!=="none"&&(o[d].baseTexture.alphaMode=sn.NO_PREMULTIPLIED_ALPHA,o[d].baseTexture.mipmap=tn.OFF)}for(let c=0;c<s.char.length;c++){const{id:d,page:u}=s.char[c];let{x:f,y:m,width:p,height:g,xoffset:v,yoffset:b,xadvance:x}=s.char[c];f/=l,m/=l,p/=l,g/=l,v/=l,b/=l,x/=l;const y=new Dt(f+o[u].frame.x/l,m+o[u].frame.y/l,p,g);this.chars[d]={xOffset:v,yOffset:b,xAdvance:x,kerning:{},texture:new pt(o[u].baseTexture,y),page:u}}for(let c=0;c<s.kerning.length;c++){let{first:d,second:u,amount:f}=s.kerning[c];d/=l,u/=l,f/=l,this.chars[u]&&(this.chars[u].kerning[d]=f)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const s in this.chars)this.chars[s].texture.destroy(),this.chars[s].texture=null;for(const s in this.pageTextures)this._ownsTextures&&this.pageTextures[s].destroy(!0),this.pageTextures[s]=null;this.chars=null,this.pageTextures=null}static install(s,t,e){let n;if(s instanceof Bl)n=s;else{const r=yA(s);if(!r)throw new Error("Unrecognized data format for font.");n=r.parse(s)}t instanceof pt&&(t=[t]);const i=new pn(n,t,e);return pn.available[i.font]=i,i}static uninstall(s){const t=pn.available[s];if(!t)throw new Error(`No font found named '${s}'`);t.destroy(),delete pn.available[s]}static from(s,t,e){if(!s)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:i,resolution:r,textureWidth:a,textureHeight:l,...o}=Object.assign({},pn.defaultOptions,e),h=wA(n),c=t instanceof bi?t:new bi(t),d=a,u=new Bl;u.info[0]={face:c.fontFamily,size:c.fontSize},u.common[0]={lineHeight:c.fontSize};let f=0,m=0,p,g,v,b=0;const x=[];for(let w=0;w<h.length;w++){p||(p=ct.ADAPTER.createCanvas(),p.width=a,p.height=l,g=p.getContext("2d"),v=new Ct(p,{resolution:r,...o}),x.push(new pt(v)),u.page.push({id:x.length-1,file:""}));const _=h[w],E=qe.measureText(_,c,!1,p),T=E.width,C=Math.ceil(E.height),R=Math.ceil((c.fontStyle==="italic"?2:1)*T);if(m>=l-C*r){if(m===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${_}')`);--w,p=null,g=null,v=null,m=0,f=0,b=0;continue}if(b=Math.max(C+E.fontProperties.descent,b),R*r+f>=d){if(f===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${_}')`);--w,m+=b*r,m=Math.ceil(m),f=0,b=0;continue}vA(p,g,E,f,m,r,c);const P=ml(E.text);u.char.push({id:P,page:x.length-1,x:f/r,y:m/r,width:R,height:C,xoffset:0,yoffset:0,xadvance:T-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(R+2*i)*r,f=Math.ceil(f)}for(let w=0,_=h.length;w<_;w++){const E=h[w];for(let T=0;T<_;T++){const C=h[T],R=g.measureText(E).width,P=g.measureText(C).width,F=g.measureText(E+C).width-(R+P);F&&u.kerning.push({first:ml(E),second:ml(C),amount:F})}}const y=new pn(u,x,!0);return pn.available[s]!==void 0&&pn.uninstall(s),pn.available[s]=y,y}};let gs=pn;gs.ALPHA=[["a","z"],["A","Z"]," "];gs.NUMERIC=[["0","9"]];gs.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];gs.ASCII=[[" ","~"]];gs.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:pn.ALPHANUMERIC};gs.available={};var _A=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,EA=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Dp=[],Bp=[],Op=[],px=class extends Mt{constructor(s,t={}){super();const{align:e,tint:n,maxWidth:i,letterSpacing:r,fontName:a,fontSize:l}=Object.assign({},px.styleDefaults,t);if(!gs.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tintColor=new Kt(n),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=s,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=r,this._anchor=new Ni(()=>{this.dirty=!0},this,0,0),this._roundPixels=ct.ROUND_PIXELS,this.dirty=!0,this._resolution=ct.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var R;const s=gs.available[this._fontName],t=this.fontSize,e=t/s.size,n=new Ht,i=[],r=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",o=mx(l),h=this._maxWidth*s.size/t,c=s.distanceFieldType==="none"?Dp:Bp;let d=null,u=0,f=0,m=0,p=-1,g=0,v=0,b=0,x=0;for(let P=0;P<o.length;P++){const O=o[P],F=ml(O);if(/(?:\s)/.test(O)&&(p=P,g=u,x++),O==="\r"||O===`
`){r.push(u),a.push(-1),f=Math.max(f,u),++m,++v,n.x=0,n.y+=s.lineHeight,d=null,x=0;continue}const D=s.chars[F];if(!D)continue;d&&D.kerning[d]&&(n.x+=D.kerning[d]);const V=Op.pop()||{texture:pt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ht};V.texture=D.texture,V.line=m,V.charCode=F,V.position.x=Math.round(n.x+D.xOffset+this._letterSpacing/2),V.position.y=Math.round(n.y+D.yOffset),V.prevSpaces=x,i.push(V),u=V.position.x+Math.max(D.xAdvance-D.xOffset,D.texture.orig.width),n.x+=D.xAdvance+this._letterSpacing,b=Math.max(b,D.yOffset+D.texture.height),d=F,p!==-1&&h>0&&n.x>h&&(++v,so(i,1+p-v,1+P-p),P=p,p=-1,r.push(g),a.push(i.length>0?i[i.length-1].prevSpaces:0),f=Math.max(f,g),m++,n.x=0,n.y+=s.lineHeight,d=null,x=0)}const y=o[o.length-1];y!=="\r"&&y!==`
`&&(/(?:\s)/.test(y)&&(u=g),r.push(u),f=Math.max(f,u),a.push(-1));const w=[];for(let P=0;P<=m;P++){let O=0;this._align==="right"?O=f-r[P]:this._align==="center"?O=(f-r[P])/2:this._align==="justify"&&(O=a[P]<0?0:(f-r[P])/a[P]),w.push(O)}const _=i.length,E={},T=[],C=this._activePagesMeshData;c.push(...C);for(let P=0;P<_;P++){const O=i[P].texture,F=O.baseTexture.uid;if(!E[F]){let D=c.pop();if(!D){const X=new ax;let U,j;s.distanceFieldType==="none"?(U=new Pu(pt.EMPTY),j=ft.NORMAL):(U=new Pu(pt.EMPTY,{program:Sn.from(EA,_A),uniforms:{uFWidth:0}}),j=ft.NORMAL_NPM);const z=new Fl(X,U);z.blendMode=j,D={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:z,vertices:null,uvs:null,indices:null}}D.index=0,D.indexCount=0,D.vertexCount=0,D.uvsCount=0,D.total=0;const{_textureCache:V}=this;V[F]=V[F]||new pt(O.baseTexture),D.mesh.texture=V[F],D.mesh.tint=this._tintColor.value,T.push(D),E[F]=D}E[F].total++}for(let P=0;P<C.length;P++)T.includes(C[P])||this.removeChild(C[P].mesh);for(let P=0;P<T.length;P++)T[P].mesh.parent!==this&&this.addChild(T[P].mesh);this._activePagesMeshData=T;for(const P in E){const O=E[P],F=O.total;if(!(((R=O.indices)==null?void 0:R.length)>6*F)||O.vertices.length<Fl.BATCHABLE_SIZE*2)O.vertices=new Float32Array(4*2*F),O.uvs=new Float32Array(4*2*F),O.indices=new Uint16Array(6*F);else{const D=O.total,V=O.vertices;for(let X=D*4*2;X<V.length;X++)V[X]=0}O.mesh.size=6*F}for(let P=0;P<_;P++){const O=i[P];let F=O.position.x+w[O.line]*(this._align==="justify"?O.prevSpaces:1);this._roundPixels&&(F=Math.round(F));const D=F*e,V=O.position.y*e,X=O.texture,U=E[X.baseTexture.uid],j=X.frame,z=X._uvs,N=U.index++;U.indices[N*6+0]=0+N*4,U.indices[N*6+1]=1+N*4,U.indices[N*6+2]=2+N*4,U.indices[N*6+3]=0+N*4,U.indices[N*6+4]=2+N*4,U.indices[N*6+5]=3+N*4,U.vertices[N*8+0]=D,U.vertices[N*8+1]=V,U.vertices[N*8+2]=D+j.width*e,U.vertices[N*8+3]=V,U.vertices[N*8+4]=D+j.width*e,U.vertices[N*8+5]=V+j.height*e,U.vertices[N*8+6]=D,U.vertices[N*8+7]=V+j.height*e,U.uvs[N*8+0]=z.x0,U.uvs[N*8+1]=z.y0,U.uvs[N*8+2]=z.x1,U.uvs[N*8+3]=z.y1,U.uvs[N*8+4]=z.x2,U.uvs[N*8+5]=z.y2,U.uvs[N*8+6]=z.x3,U.uvs[N*8+7]=z.y3}this._textWidth=f*e,this._textHeight=(n.y+s.lineHeight)*e;for(const P in E){const O=E[P];if(this.anchor.x!==0||this.anchor.y!==0){let X=0;const U=this._textWidth*this.anchor.x,j=this._textHeight*this.anchor.y;for(let z=0;z<O.total;z++)O.vertices[X++]-=U,O.vertices[X++]-=j,O.vertices[X++]-=U,O.vertices[X++]-=j,O.vertices[X++]-=U,O.vertices[X++]-=j,O.vertices[X++]-=U,O.vertices[X++]-=j}this._maxLineHeight=b*e;const F=O.mesh.geometry.getBuffer("aVertexPosition"),D=O.mesh.geometry.getBuffer("aTextureCoord"),V=O.mesh.geometry.getIndex();F.data=O.vertices,D.data=O.uvs,V.data=O.indices,F.update(),D.update(),V.update()}for(let P=0;P<i.length;P++)Op.push(i[P]);this._font=s,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:n}=gs.available[this._fontName];if(e!=="none"){const{a:i,b:r,c:a,d:l}=this.worldTransform,o=Math.sqrt(i*i+r*r),h=Math.sqrt(a*a+l*l),c=(Math.abs(o)+Math.abs(h))/2,d=this.fontSize/n,u=s._view.resolution;for(const f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=c*t*d*u}super._render(s)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const s=gs.available[this._fontName];if(!s)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==s&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(s){if(this.tint!==s){this._tintColor.setValue(s);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=s}}get align(){return this._align}set align(s){this._align!==s&&(this._align=s,this.dirty=!0)}get fontName(){return this._fontName}set fontName(s){if(!gs.available[s])throw new Error(`Missing BitmapFont "${s}"`);this._fontName!==s&&(this._fontName=s,this.dirty=!0)}get fontSize(){return this._fontSize??gs.available[this._fontName].size}set fontSize(s){this._fontSize!==s&&(this._fontSize=s,this.dirty=!0)}get anchor(){return this._anchor}set anchor(s){typeof s=="number"?this._anchor.set(s):this._anchor.copyFrom(s)}get text(){return this._text}set text(s){s=String(s??""),this._text!==s&&(this._text=s,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(s){this._maxWidth!==s&&(this._maxWidth=s,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(s){this._letterSpacing!==s&&(this._letterSpacing=s,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(s){s!==this._roundPixels&&(this._roundPixels=s,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}destroy(s){const{_textureCache:t}=this,n=gs.available[this._fontName].distanceFieldType==="none"?Dp:Bp;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>t[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=pt.EMPTY});for(const i in t)t[i].destroy(),delete t[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(s)}};let gx=px;gx.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const SA=[".xml",".fnt"],TA={extension:{type:ut.LoadParser,priority:nn.Normal},name:"loadBitmapFont",test(s){return SA.includes(me.extname(s).toLowerCase())},async testParse(s){return fl.test(s)||Bu.test(s)},async parse(s,t,e){const n=fl.test(s)?fl.parse(s):Bu.parse(s),{src:i}=t,{page:r}=n,a=[];for(let h=0;h<r.length;++h){const c=r[h].file;let d=me.join(me.dirname(i),c);d=Iu(d,i),a.push(d)}const l=await e.load(a),o=a.map(h=>l[h]);return gs.install(n,o,!0)},async load(s,t){return(await ct.ADAPTER.fetch(s)).text()},unload(s){s.destroy()}};bt.add(TA);const Xr=class extends bi{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(s){return new Xr(Object.keys(Xr.defaultOptions).reduce((t,e)=>({...t,[e]:s[e]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(s=>{URL.revokeObjectURL(s.src),s.refs--,s.refs===0&&(s.fontFace&&document.fonts.delete(s.fontFace),delete Xr.availableFonts[s.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(s,t={}){const{availableFonts:e}=Xr;if(e[s]){const n=e[s];return this._fonts.push(n),n.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ct.ADAPTER.fetch(s).then(n=>n.blob()).then(async n=>new Promise((i,r)=>{const a=URL.createObjectURL(n),l=new FileReader;l.onload=()=>i([a,l.result]),l.onerror=r,l.readAsDataURL(n)})).then(async([n,i])=>{const r=Object.assign({family:me.basename(s,me.extname(s)),weight:"normal",style:"normal",src:n,dataSrc:i,refs:1,originalUrl:s,fontFace:null},t);e[s]=r,this._fonts.push(r),this.styleID++;const a=new FontFace(r.family,`url(${r.src})`,{weight:r.weight,style:r.style});r.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...s){const t=s.filter(e=>!this._overrides.includes(e));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...s){const t=s.filter(e=>this._overrides.includes(e));t.length>0&&(this._overrides=this._overrides.filter(e=>!t.includes(e)),this.styleID++)}toCSS(s){return[`transform: scale(${s})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((s,t)=>`${s}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(s){this._stylesheet!==s&&(this._stylesheet=s,this.styleID++)}normalizeColor(s){return Array.isArray(s)&&(s=ll(s)),typeof s=="number"?I_(s):s}dropShadowToCSS(){let s=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,e=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);s.startsWith("#")&&t<1&&(s+=(t*255|0).toString(16).padStart(2,"0"));const i=`${e}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${s}`:`text-shadow: ${i} ${s}`}reset(){Object.assign(this,Xr.defaultOptions)}onBeforeDraw(){const{fontsDirty:s}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&s?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:s}=ct.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(s)}set fillGradientStops(s){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(s){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(s){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(s){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(s){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(s){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(s){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Jo=Xr;Jo.availableFonts={};Jo.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Yr=class extends ve{constructor(s="",t={}){super(pt.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const e=new Image,n=pt.from(e,{scaleMode:ct.SCALE_MODE,resourceOptions:{autoLoad:!1}});n.orig=new Dt,n.trim=new Dt,this.texture=n;const i="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xhtml",a=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject"),o=document.createElementNS(r,"div"),h=document.createElementNS(r,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Yr.defaultMaxWidth,this.maxHeight=Yr.defaultMaxHeight,this._domElement=o,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(o),this._image=e,this._loadImage=new Image,this._autoResolution=Yr.defaultAutoResolution,this._resolution=Yr.defaultResolution??ct.RESOLUTION,this.text=s,this.style=t}measureText(s){var l,o;const{text:t,style:e,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},s);Object.assign(this._domElement,{innerHTML:t,style:e.toCSS(n)}),this._styleElement.textContent=e.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const r=Math.min(this.maxWidth,Math.ceil(i.width)),a=Math.min(this.maxHeight,Math.ceil(i.height));return this._svgRoot.setAttribute("width",r.toString()),this._svgRoot.setAttribute("height",a.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),e!==this._style&&(Object.assign(this._domElement,{style:(l=this._style)==null?void 0:l.toCSS(n)}),this._styleElement.textContent=(o=this._style)==null?void 0:o.toGlobalCSS()),{width:r+e.padding*2,height:a+e.padding*2}}async updateText(s=!0){const{style:t,_image:e,_loadImage:n}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&s)return;const{width:i,height:r}=this.measureText();e.width=n.width=Math.ceil(Math.max(1,i)),e.height=n.height=Math.ceil(Math.max(1,r)),this._loading||(this._loading=!0,await new Promise(a=>{n.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,e.src=n.src,n.onload=null,n.src="",this.updateTexture(),a()};const l=new XMLSerializer().serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`}))}get source(){return this._image}updateTexture(){const{style:s,texture:t,_image:e,resolution:n}=this,{padding:i}=s,{baseTexture:r}=t;t.trim.width=t._frame.width=e.width/n,t.trim.height=t._frame.height=e.height/n,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),r.setRealSize(e.width,e.height,n),this.dirty=!1}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._render(s)}_renderCanvas(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(s)}getLocalBounds(s){return this.updateText(!0),super.getLocalBounds(s)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(s){var e,n,i,r,a;typeof s=="boolean"&&(s={children:s}),s=Object.assign({},Yr.defaultDestroyOptions,s),super.destroy(s);const t=null;this.ownsStyle&&((e=this._style)==null||e.cleanFonts()),this._style=t,(n=this._svgRoot)==null||n.remove(),this._svgRoot=t,(i=this._domElement)==null||i.remove(),this._domElement=t,(r=this._foreignObject)==null||r.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(s){this.updateText(!0);const t=Oi(this.scale.x)||1;this.scale.x=t*s/this._image.width/this.resolution,this._width=s}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(s){this.updateText(!0);const t=Oi(this.scale.y)||1;this.scale.y=t*s/this._image.height/this.resolution,this._height=s}get style(){return this._style}set style(s){this._style!==s&&(s=s||{},s instanceof Jo?(this.ownsStyle=!1,this._style=s):s instanceof bi?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Jo.from(s)):(this.ownsStyle=!0,this._style=new Jo(s)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(s){s=String(s===""||s===null||s===void 0?" ":s),s=this.sanitiseText(s),this._text!==s&&(this._text=s,this.dirty=!0)}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}sanitiseText(s){return s.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let xh=Yr;xh.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};xh.defaultMaxWidth=2024;xh.defaultMaxHeight=2024;xh.defaultAutoResolution=!0;const Np=50,Ve={TOP:0,MIDDLE:1,BOTTOM:2,LEFT:3,CENTER:4,RIGHT:5,STRETCH:6},Ts=class Ts extends Mt{constructor(){super(...arguments);Y(this,"graphics");Y(this,"sourceArea");Y(this,"targetArea");Y(this,"horizontalStickModeId",(()=>Ve.CENTER)());Y(this,"verticalStickModeId",(()=>Ve.MIDDLE)())}static install(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ts.pixiApplication=e,n&&(e.view.style.width="100%",e.view.style.height="100%",window.addEventListener("resize",Ts.onResize)),Ts.onResize()}static uninstall(){window.removeEventListener("resize",Ts.onResize)}static onResize(){var a;const{pixiApplication:{renderer:e,view:{clientWidth:n,clientHeight:i},stage:{children:r}}}=Ts;Ts.width=Math.max(Np,n),Ts.height=Math.max(Np,i),e.resize(n,i);for(const l of r)(a=l.onResize)==null||a.call(l)}setSourceArea(e){let{width:n=123,height:i=123}=e;return this.sourceArea={width:n,height:i},this.adjustToTargetArea()}setTargetArea(e){let{x:n=0,y:i=0,width:r=1,height:a=1}=e;return this.targetArea={x:n,y:i,width:r,height:a},this.adjustToTargetArea()}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:255,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;if(!this.sourceArea)return this;const{width:i,height:r}=this.sourceArea;return this.graphics=this.graphics??this.addChild(new Fn),this.graphics.clear().beginFill(e,n).drawRect(0,0,i,r).endFill(),this.adjustToTargetArea()}stickTop(){return this.verticalStickModeId=Ve.TOP,this.adjustToTargetArea()}stickMiddle(){return this.verticalStickModeId=Ve.MIDDLE,this.adjustToTargetArea()}stickBottom(){return this.verticalStickModeId=Ve.BOTTOM,this.adjustToTargetArea()}stickLeft(){return this.horizontalStickModeId=Ve.LEFT,this.adjustToTargetArea()}stickCenter(){return this.horizontalStickModeId=Ve.CENTER,this.adjustToTargetArea()}stickRight(){return this.horizontalStickModeId=Ve.RIGHT,this.adjustToTargetArea()}stretchHorizontally(){return this.horizontalStickModeId=Ve.STRETCH,this.adjustToTargetArea()}stretchVertically(){return this.verticalStickModeId=Ve.STRETCH,this.adjustToTargetArea()}onResize(){var r;const{width:e,height:n}=Ts,i=e/n;this.updateTargetArea(i),this.adjustToTargetArea(),this.onAdjustedToTargetArea(i);for(const a of this.children)(r=a.onResize)==null||r.call(a)}updateTargetArea(e){}adjustToTargetArea(){var h;const{horizontalStickModeId:e,verticalStickModeId:n,sourceArea:i,targetArea:r,scale:a,position:l,children:o}=this;if(i&&r){const{width:c,height:d}=Ts,u=c*r.width,f=d*r.height,m=u/i.width,p=f/i.height,g=Math.min(m,p),v=Math.max(0,u-i.width*g),b=Math.max(0,f-i.height*g);switch(l.x=r.x*c,l.y=r.y*d,e){case Ve.LEFT:a.x=g;break;case Ve.CENTER:a.x=g,l.x+=v*.5;break;case Ve.RIGHT:a.x=g,l.x+=v;break;case Ve.STRETCH:a.x=m;break}switch(n){case Ve.TOP:a.y=g;break;case Ve.MIDDLE:a.y=g,l.y+=b*.5;break;case Ve.BOTTOM:a.y=g,l.y+=b;break;case Ve.STRETCH:a.y=p;break}}for(const c of o)(h=c.adjustToTargetArea)==null||h.call(c);return this}onAdjustedToTargetArea(e){}};Y(Ts,"width"),Y(Ts,"height"),Y(Ts,"pixiApplication");let os=Ts;const tl=Object.freeze({EASE:0,IN:1,OUT:2,IN_OUT:3});function el(s,t,e,n,i){const r=1-s;return r**3*t+3*r**2*s*e+3*r*s**2*n+s**3*i}function AA(s,t){switch(s){case tl.EASE:return el(t,0,.75,.9,1);case tl.EASE_IN:return el(t,0,0,.58,1);case tl.EASE_OUT:return el(t,0,.42,1,1);case tl.EASE_IN_OUT:return el(t,0,.1,1,1)}return t}let CA=class{constructor(t){Y(this,"target");Y(this,"key");Y(this,"initialValue");Y(this,"finalValue");Y(this,"duration");Y(this,"delay");Y(this,"easing");Y(this,"progress",0);Y(this,"realProgress",0);Y(this,"onStart");Y(this,"onUpdate");Y(this,"onDelay");Y(this,"onDelayFinish");Y(this,"onProgress");Y(this,"onFinish");Y(this,"callbacks",{});Y(this,"elapsedMilliseconds",0);t&&this.setup(t)}setup(t){let{target:e,key:n,initialValue:i=e==null?void 0:e[n],finalValue:r=void 0,duration:a=1,delay:l=0,easing:o=void 0,onStart:h,onUpdate:c,onDelay:d,onDelayFinish:u,onProgress:f,onFinish:m,callbacks:p}=t;return this.key=n,this.initialValue=i,this.finalValue=r,this.duration=a,this.delay=l,this.easing=o,this.target=e,this.onStart=h,this.onUpdate=c,this.onDelay=d,this.onDelayFinish=u,this.onProgress=f,this.onFinish=m,this.callbacks=p,this}wind(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const{target:n,key:i,initialValue:r,finalValue:a,duration:l,delay:o,easing:h,onStart:c,onUpdate:d,onDelay:u,onDelayFinish:f,onProgress:m,onFinish:p,callbacks:g}=this,v=o+l,b=o/v,x=1-b,y=t>=b?(t-b)/x:0;if(e&&(this.progress===0&&t>0&&(c==null||c()),g&&Object.entries(g).forEach(w=>{let[_,E]=w;const T=_/v;(this.progress<T&&t>T||t===1&&T===1&&this.progress<1||t>0&&T===0&&this.progress===0)&&E()}),d==null||d(t),t<b&&(u==null||u(t/b)),b&&this.realProgress===0&&y>0&&(f==null||f()),this.realProgress!==y&&(m==null||m(y)),t===1&&this.progress<1&&(p==null||p())),n)if(typeof n[i]=="number"){const w=a-r;n[i]=r+w*AA(h,y)}else n[i]=t===1?a:r;return this.realProgress=y,this.progress=t,this}windToTime(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const{duration:n,delay:i}=this,r=Math.max(0,Math.min(1,t/(n+i)));return this.wind(r,e),this}};var Ws;let We=(Ws=class{constructor(){Y(this,"animations",[]);Y(this,"animationsCount",0);Y(this,"timeScaleFactors",{});Y(this,"commonScaleFactor",1);Y(this,"isLoopMode",!1);Y(this,"duration");Y(this,"resolve");Y(this,"isPlaying");Y(this,"totalElapsedMilliseconds",0);(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)&&Ws.instances.push(this)}static update(){const t=Date.now(),e=t-(Ws.previousUpdateTimeStamp??Date.now());Ws.instances.forEach(n=>{n.update(e)}),Ws.previousUpdateTimeStamp=t}static drop(){Ws.instances=[]}getNextAnimation(){if(this.animations.length>this.animationsCount)return this.animations[this.animationsCount];const t=new CA({});return this.animations.push(t),t}addAnimation(t){let{target:e,key:n,initialValue:i=void 0,finalValue:r=void 0,duration:a=1,delay:l=0,easing:o=void 0,onStart:h,onUpdate:c,onDelay:d,onDelayFinish:u,onProgress:f,onFinish:m,callbacks:p}=t;const{animations:g}=this,v=this.getNextAnimation();return v.target=e,v.key=n,v.initialValue=i,v.finalValue=r,v.duration=a,v.delay=l,v.easing=o,v.onStart=h,v.onUpdate=c,v.onDelay=d,v.onDelayFinish=u,v.onProgress=f,v.onFinish=m,v.callbacks=p,v.progress=0,v.realProgress=0,this.animationsCount++,v.wind(g[0].progress),g[0].isPlaying&&v.play(),this.validateDuration()}validateDuration(){let t=0;for(let e=0;e<this.animationsCount;e++){const n=this.animations[e],i=((n==null?void 0:n.duration)??0)+((n==null?void 0:n.delay)??0);i>t&&(t=i)}return this.duration=t,this}deleteAllAnimations(){return this.animations=[],this.animationsCount=0,this.dropAllAnimations()}dropAllAnimations(){return this.duration=0,this.animationsCount=0,this.validateDuration(),this.totalElapsedMilliseconds=0,this.isLoopMode=!1,this}getLastAnimation(){return this.animations[this.animationsCount-1]}getLatestAnimation(){const{animations:t}=this;let e=0;for(let n=0;n<this.animationsCount;n++){const i=this.animations[n];i.delay+i.duration>t[e].delay+t[e].duration&&(e=n)}return t[e]}wind(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t*this.duration;if(this.totalElapsedMilliseconds===n)return this;this.totalElapsedMilliseconds=n;for(let i=0;i<this.animationsCount;i++)this.animations[i].windToTime(n,e);return this}windToTime(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.totalElapsedMilliseconds;this.totalElapsedMilliseconds=Math.min(this.duration,t);for(let e=0;e<this.animationsCount;e++)this.animations[e].windToTime(t);return this}windToTimeLoop(t){const e=t%this.duration;return e<this.totalElapsedMilliseconds&&(this.wind(1),this.isLoopMode&&e&&this.wind(0)),this.windToTime(this.isLoopMode?e:0),this}update(t){var i;if(!this.isPlaying)return this;const e=t*this.commonScaleFactor,n=this.totalElapsedMilliseconds+e;return this.isLoopMode?this.windToTimeLoop(n):this.windToTime(n),n>=this.duration&&(this.isLoopMode?this.play(!1):((i=this.resolve)==null||i.call(this),this.resolve=null,this.isPlaying=!1)),this}play(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.isPlaying=!0,t)return new Promise(e=>this.resolve=e)}setLoopMode(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this.isLoopMode=t,this}pause(){return this.isPlaying=!1,this}setTimeScaleFactor(t){let{name:e,value:n}=t;const{timeScaleFactors:i}=this;return i[e]=n,this.commonScaleFactor=1,Object.values(i).forEach(r=>this.commonScaleFactor*=r),this}destroy(){const{instances:t}=Ws;this.animations=null,t.splice(t.indexOf(this),1)}},Y(Ws,"instances",[]),Y(Ws,"previousUpdateTimeStamp"),Ws);class MA extends os{constructor(e){super();Y(this,"portraitView");Y(this,"landscapeView");this.portraitView=this.addChild(new ve(e.background_portrait)),this.portraitView.pivot.set(130,15),this.landscapeView=this.addChild(new ve(e.background_landscape)),this.landscapeView.pivot.set(69,125)}updateTargetArea(e){const{portraitView:n,landscapeView:i}=this;e>1?(n.visible=!1,i.visible=!0,this.setSourceArea({width:638,height:232}).setTargetArea({x:0,y:0,width:1,height:.8})):(n.visible=!0,i.visible=!1,this.setSourceArea({width:280,height:462}).setTargetArea({x:0,y:0,width:1,height:1}))}}const Lp="./";let Ou={};function xx(s){for(const{textures:t}of Object.values(s))if(t)for(const[e,n]of Object.entries(t))s[e]=n;return s}async function IA(){return pi.addBundle("preloading",{preloading_elements:"atlases/preloading_elements.json",default:"fonts/default.otf"}),Ou=xx(await pi.loadBundle("preloading")),Ou}async function RA(s){pi.addBundle("gameAssets",{elements:Lp+"atlases/elements.json",crystals:Lp+"atlases/crystals.json",big_win:"spines/bubble.json",logo:"spines/logo.json",king:"spines/king.json",bg_fx:"spines/bg_fx.json",thief:"spines/thief.json",mouse_and_traps:"spines/mouse_and_traps.json",background_desktop:"jpg/background_desktop.jpg"});const t=xx(await pi.loadBundle("gameAssets",s));return{...Ou,...t}}const Er=72,be=71,As=7,De=7,qr=As*Er,Qo=De*be,rr=1,PA=[[2,3,4,5,6,7],[1,2,3,4,5,6,7],[1,2,3,4,5,6,7],[1,2,3,4,5,6,7],[1,2,3,4,5,6,7],[1,2,3,4,5,6,7],[1,2,3,4,5,6,7]],Vp=1.5,ci=[2,3,4,5,6,7],Sd=[[0,...ci],[0,rr,...ci],[0,rr,...ci],[0,rr,...ci],[0,rr,...ci],[0,rr,...ci],[0,rr,...ci]];function kA(s){let t=Math.trunc(255*Math.min(1,Math.max(0,s))).toString(16);return t.length===1&&(t="0"+t),parseInt("0x"+t+t+t,16)}class FA extends Mt{constructor(e,n){super();Y(this,"bodyView");Y(this,"blurredBodyView");this.initBody(e,n),this.initBlurredBody(e,n)}initBody(e,n){const i=new ve(n["symbol_"+(e-1)+"_0"]);i.anchor.set(.5),this.bodyView=this.addChild(i)}initBlurredBody(e,n){const i=new ve(n["symbol_"+(e-1)+"_blur"]);i.anchor.set(.5),this.blurredBodyView=this.addChild(i)}setVisible(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.visible=e}setBlur(e){this.blurredBodyView.alpha=e,this.bodyView.alpha=1-e}setBrightness(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;const n=Math.min(1,Math.max(.05,e));this.brightness!==n&&(this.brightness=n,this.bodyView.tint=kA(Math.max(.25,this.brightness)))}presentCoefficients(e){this.scale.set(1+.35*Math.abs(Math.sin(Math.PI*e)))}}class DA extends Mt{constructor(e){let{possibleSymbolsIds:n=Sd[1],assets:i}=e;super();Y(this,"symbolsViews",[]);Y(this,"symbolsMap",{});Y(this,"currentSymbolId");Y(this,"blurStrength");Y(this,"timeline",(()=>new We)());Y(this,"corruptionTimeline",(()=>new We)());Y(this,"cascadeTimeline",(()=>new We)());Y(this,"featureTimeline",(()=>new We)());Y(this,"isSecured",!1);this.initSymbols({possibleSymbolsIds:n,assets:i})}initSymbols(e){let{possibleSymbolsIds:n,assets:i}=e;n.forEach(r=>{const a=new FA(r,i);a.visible=!1,a.position.set(Er/2,be/2),this.symbolsViews.push(a),this.symbolsMap[r]=a,this.addChild(a)})}getSymbolView(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.currentSymbolId;const{symbolsMap:n}=this;return n[e]}onPreRendered(){this.symbolsViews.forEach(e=>e.setVisible(!1)),this.presentSymbol(this.currentSymbolId)}preRenderSymbols(){this.symbolsViews.forEach(e=>e.setVisible(!0))}setTimeScale(e){var i;const n={name:"scale",value:e};this.corruptionTimeline.setTimeScaleFactor(n),this.cascadeTimeline.setTimeScaleFactor(n),this.featureTimeline.setTimeScaleFactor(n);for(const r of this.symbolsViews)(i=r==null?void 0:r.setTimeScale)==null||i.call(r,e)}setBlur(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.blurStrength=e,this.getSymbolView().setBlur(e)}setBrightness(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;(n=this.getSymbolView())==null||n.setBrightness(e)}setGlowIntensity(e){this.symbolsViews.forEach(n=>n.flameIntensity=e)}presentSymbol(e){const n=this.getSymbolView();n==null||n.setVisible(!1);const i=this.getSymbolView(e);i.setVisible(),i==null||i.setBlur(this.blurStrength),this.currentSymbolId=e,this.alpha=1}presentCorruption(){var l;const e=this.getSymbolView(),n=.05+.1*Math.random(),i=.1+.15*Math.random()*(Math.random()>.5?-1:1),r=5+20*Math.random()*(Math.random()>.5?-1:1),a=10+20*Math.random()*(Math.random()>.5?-1:1);return(l=this.bubblesBurstView)==null||l.presentSymbolCorruption(this.currentSymbolId),e==null||e.presentCorruption(),this.corruptionTimeline.deleteAllAnimations().addAnimation({duration:1e3,onProgress:o=>{const h=1-o,c=this.getSymbolView(),d=Math.sin(Math.PI*2*(o*3%1))*h,u=Math.sin(Math.PI*2*(o*2%1))*h,f=Math.abs(Math.sin(Math.PI*2*(o*2%1)))*h,m=Math.abs(Math.sin(Math.PI*2*o))*h;c.skew.x=i*d,c.scale.y=1+n*u,c.pivot.x=r*f,c.pivot.y=a*m}}).addAnimation({delay:700,duration:300,onProgress:o=>{const h=1-o;this.alpha=h}}).play()}presentFallIn(e){let{symbolId:n=0,distance:i=0,delay:r=1}=e;if(this.presentSymbol(0),!i)return;const l=this.getSymbolView(n),o=i*be,h=Math.min(350,i*100),c=be/2;return this.cascadeTimeline.deleteAllAnimations().addAnimation({delay:r,duration:h,onDelayFinish:()=>{this.presentSymbol(n)},onProgress:d=>{l.y=-o*(1-d**2)+c}}).addAnimation({delay:h+r,duration:250,onProgress:d=>{const u=Math.sin(Math.PI*d);l.y=u*-be*.25+c}}).windToTime(2).play()}}function Bo(s){const t=PA[s];return t[Math.trunc(Math.random()*t.length)]}function Up(s){return new Array(As).fill(0).map(t=>new Array(De).fill(s))}function Gs(s){return s.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}function io(){const s=new Array(As).fill(0).map(e=>[]);let t=[...ci];for(let e=0;e<s.length;e++)for(let n=0;n<De;n++){t.length||(t=[...ci]);const i=Math.trunc(Math.random()*t.length);s[e][n]=t[i],t.splice(i,1)}return s}class BA extends Mt{constructor(e){let{index:n,assets:i,possibleSymbolsIds:r=Sd[1],initialSymbolsIds:a=new Array(length).fill(0)}=e;super();Y(this,"index");Y(this,"cellsContainer");Y(this,"cellsViews",[]);Y(this,"maskView");Y(this,"targetSymbolsIds");Y(this,"spinTimeline",(()=>new We)());Y(this,"spinAccelerationTimeline",(()=>new We)());Y(this,"spinFinishTimeline",(()=>new We)());Y(this,"featureTimeline",(()=>new We)());this.index=n,this.initCells({assets:i,initialSymbolsIds:[Bo(n),...a,Bo(n)],possibleSymbolsIds:r})}initCells(e){let{assets:n,initialSymbolsIds:i,possibleSymbolsIds:r}=e;const{cellsViews:a,index:l}=this,o=l===2||l===3;this.cellsContainer=this.addChild(new Mt);for(let h=-1;h<De+1;h++){const c=new DA({possibleSymbolsIds:r,assets:n,isSecurable:o});c.y=be*h,c.presentSymbol(i[h+1]),a.push(this.cellsContainer.addChild(c))}}setTimeScale(e){const n={name:"scale",value:e};this.spinTimeline.setTimeScaleFactor(n),this.spinAccelerationTimeline.setTimeScaleFactor(n),this.spinFinishTimeline.setTimeScaleFactor(n),this.featureTimeline.setTimeScaleFactor(n);for(let i=1;i<=De;i++)this.cellsViews[i].setTimeScale(e)}async preRenderSymbols(e){this.cellsViews.forEach(n=>n.preRenderSymbols()),this.setTimeScale(5),await this.presentSpinStart(),await this.presentSpinStop({delay:500,symbolsIds:e}),this.setTimeScale(1)}onPreRendered(){this.cellsViews.forEach(e=>e.onPreRendered())}reset(){const{spinTimeline:e,spinAccelerationTimeline:n,spinFinishTimeline:i,featureTimeline:r}=this;e.isPlaying&&e.wind(1),n.isPlaying&&n.wind(1),i.isPlaying&&i.wind(1),r.isPlaying&&r.wind(1)}async presentSpinStart(e){const{index:n,cellsViews:i,cellsContainer:r}=this,a=i.length-1;await this.spinTimeline.deleteAllAnimations().addAnimation({delay:e||1,duration:300,onDelayFinish:()=>this.targetSymbolsIds=void 0,onProgress:l=>{const o=1-l;this.cellsViews[0].y=-be-be*o,this.cellsViews[a].y=De*be+be*o,r.pivot.y=l**2*be*.5}}).setLoopMode(!1).play(),this.spinAccelerationTimeline.deleteAllAnimations().addAnimation({duration:250,onProgress:l=>{this.spinTimeline.setTimeScaleFactor({name:"acceleration",value:1+l*8}),this.cellsViews.forEach(o=>{o.setBlur(l)})}}).windToTime(1).play(),this.spinTimeline.deleteAllAnimations().addAnimation({duration:300,onProgress:l=>{r.y=l*be*this.scale.y,r.pivot.y>0&&(r.pivot.y=(1-l)*be*.5),this.targetSymbolsIds&&this.targetSymbolsIds.length<=1&&i.forEach(o=>o.setBlur(1-l))},onFinish:()=>{var l;r.y=0;for(let o=i.length-1;o>0;o--)i[o].presentSymbol(i[o-1].currentSymbolId),i[o].scale.set(i[o-1].scale.x);i[0].presentSymbol(((l=this.targetSymbolsIds)==null?void 0:l.pop())??Bo(n)),this.targetSymbolsIds&&!this.targetSymbolsIds.length&&this.spinTimeline.setLoopMode(!1)}}).setLoopMode().play()}async presentSpinStop(e){let{symbolsIds:n=[1,2,3,4,5,6],delay:i}=e;if(!this.spinTimeline.isPlaying)return;await this.featureTimeline.deleteAllAnimations().addAnimation({delay:i}).play(),this.targetSymbolsIds=[Bo(this.index),...n,Bo(this.index)];const r=this.cellsViews.length-1;await this.spinTimeline.play(),await this.spinTimeline.deleteAllAnimations().addAnimation({duration:300,onProgress:a=>{const l=a>.5?1-(a-.5)*2:a*2;this.cellsContainer.pivot.y=l*be*.5,this.cellsViews.forEach(o=>{o.setBlur(0)}),this.cellsViews[0].y=-be-be*a,this.cellsViews[r].y=De*be+be*2*a}}).setTimeScaleFactor({name:"acceleration",value:1}).play()}presentSymbol(e,n){this.cellsViews[n+1].presentSymbol(e)}presentWin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[1,1,1,1];const{cellsViews:n}=this;return Promise.all(e.map((i,r)=>{if(i)return n[r+1].presentWin()}))}presentCascade(e){let{y:n,distance:i,symbolId:r,delay:a}=e;const l=this.cellsViews[n-i+1],o=this.cellsViews[n+1];return l==null||l.presentSymbol(0),o.presentFallIn({symbolId:r,distance:i,delay:a})}}class OA extends Mt{constructor(e){super();Y(this,"sprites");Y(this,"frameIndex",0);Y(this,"progress",0);this.sprites=e.map((n,i)=>{const r=new ve(n);return r.anchor.set(.5),r.visible=!i,this.addChild(r)})}present(e){if(this.progress===e)return;const{sprites:n}=this,i=Math.trunc(e*n.length);this.progress=e,n[this.frameIndex]&&(n[this.frameIndex].visible=!1),this.frameIndex=i,n[i]&&(n[i].visible=!0)}}class NA extends Mt{constructor(e){let{characters:n="0123456789",textures:i,color:r=16777215}=e;super();Y(this,"currentSprite");Y(this,"symbolsSprites",{});Y(this,"spaceSizeReferenceSymbol",".");const a=Object.values(i);n.split("").forEach((l,o)=>{this.symbolsSprites[l]=this.addChild(new ve(a[o])),this.symbolsSprites[l].visible=!1,this.symbolsSprites[l].anchor.set(.5)}),this.setColor(r)}setColor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16777215;Object.values(this.symbolsSprites).forEach(n=>{n.tint=e})}setCharacter(e){const n=this.symbolsSprites[e]??this.symbolsSprites[this.spaceSizeReferenceSymbol]??this.symbolsSprites[0];this.currentSprite!==void 0&&(this.currentSprite.visible=!1),this.currentSprite=n,this.currentSprite.alpha=this.symbolsSprites[e]?1:0,this.currentSprite.visible=!0}}class LA extends Mt{constructor(e){let{availableCharacters:n,textures:i}=e;super();Y(this,"hiddenCharacters",[]);Y(this,"bitmapCharacters",[]);Y(this,"availableCharacters");Y(this,"textures");Y(this,"letterSpacing");Y(this,"text","");Y(this,"color",16777215);Y(this,"sampleHeight",0);Y(this,"fontScaleFactor");Y(this,"blurScaleFactor",1);Y(this,"distortionFactor",0);Y(this,"distortionHeight",0);this.textures=i,this.availableCharacters=n,Object.values(i).forEach(r=>{var a;this.sampleHeight=Math.max(((a=r.trim)==null?void 0:a.height)??r.orig.height,this.sampleHeight)}),this.setFontSize(this.sampleHeight)}getBitmapCharacter(e){if(!this.bitmapCharacters[e]){const n=new NA({characters:this.availableCharacters,textures:this.textures});this.bitmapCharacters[e]=this.addChild(n)}return this.bitmapCharacters[e]}setText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return this.text=e,this.adjust()}setColor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16777215;return this.color=e,this.adjust()}setLetterSpacing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacing=e,this.adjust(),this}setDistortion(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.distortionFactor=e,this}setDistortionHeight(e){return this.distortionHeight=e,this}adjust(){let e=0;for(let n=0;n<this.text.length;n++){const i=this.getBitmapCharacter(n);i.visible=!0,i.scale.set(this.fontScaleFactor),i.setCharacter(this.text[n]),i.setColor(this.color),i.skew.x=0,i.visible=!this.hiddenCharacters.includes(this.text[n]);const r=(i.width<1?this.sampleHeight*this.fontScaleFactor:i.width)*.5;e+=r,i.scale.x=this.fontScaleFactor,i.setColor(this.color),i.x=e,i.y=i.height/2,e+=r+this.letterSpacing}for(let n=this.text.length;n<this.bitmapCharacters.length;n++)this.bitmapCharacters[n].visible=!1,this.bitmapCharacters[n].skew.x=0;return this.finalTextWidth=e-this.letterSpacing,this}onAdjusted(){if(this.distortionFactor)for(let e=0;e<this.text.length;e++){const n=this.getBitmapCharacter(e),i=e/(this.text.length-1),r=.25+(1-i)*.5,a=Math.PI*2*r,l=Math.sin(a);n.skew.x=l*this.distortionFactor,n.y=Math.sin(Math.PI*i)*this.distortionHeight}}setFontSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20;return this.fontScaleFactor=e/this.sampleHeight,this.adjust()}}const ws={LEFT:"left",CENTER:"center",RIGHT:"right",TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"};var _n;let xi=(_n=class extends Mt{constructor(e){let{maximalWidth:n=void 0,maximalHeight:i=void 0,isDynamicCharacterSet:r=!1}=e;super();Y(this,"text");Y(this,"maximalWidth");Y(this,"maximalHeight");Y(this,"style",(()=>({familyName:void 0,fontSize:20,fontColor:16777215,letterSpacing:0,letterFalling:0}))());Y(this,"areaGraphics");Y(this,"horizontalAlignMode",(()=>ws.LEFT)());Y(this,"verticalAlignMode",(()=>ws.TOP)());Y(this,"bitmapText");Y(this,"atlasText");Y(this,"textView");Y(this,"isDynamicCharacterSet");Y(this,"charactersPerLineCount",(()=>1/0)());this.maximalWidth=n,this.maximalHeight=i,this.isDynamicCharacterSet=r,this.setFontName(),this.setText("")}highlightArea(){this.areaGraphics||(this.areaGraphics=this.addChildAt(new Fn,0));const e=this.maximalWidth??this.width,n=this.maximalHeight??this.height;return this.areaGraphics.clear().beginFill(16777215,.25).drawRect(0,0,e,n).drawRect(0,0,e,n).endFill(),this}setText(){var l;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=e+"";if(i===this.text&&!n)return this;if(!_n.isLTRTextDirection){let o="";for(let h=i.length-1;h>=0&&"?!.".includes(i[h]);h--)o+=i[h];i=o+i.substring(0,i.length-o.length)}const r=((l=e.split)==null?void 0:l.call(e,""))??[i??""];this.text=r.join(`
`);const{charactersPerLineCount:a}=this;return a&&(this.text="",r.forEach(o=>{let h="";if(o.length<a)h=o+(r.length>1?`
`:"");else{let c=0,d=0;for(;c<o.length;){let u=o.substring(d,d+a);if(c+a<o.length){for(let f=u.length;f>0;f--)if(u[f]===" "){u=u.substring(0,f);break}}h+=u,d+=u.length,c+=Math.max(0,u.length-1)||a,c<o.length&&(h+=`
`)}}this.text+=h})),this.textView?(this.textView.text=this.text,this.atlasText&&this.atlasText.setText(this.text),this.adjust()):this}setMaximalWidth(e){return this.maximalWidth=e,this.adjust()}setMaximalHeight(e){return this.maximalHeight=e,this.adjust()}setCharactersPerLineCount(e){return this.charactersPerLineCount=e,this.setText(this.text,!0)}setAlignLeft(){return this.setHorizontalAlignMode(_n.isLTRTextDirection?ws.LEFT:ws.RIGHT)}setAlignCenter(){return this.setHorizontalAlignMode(ws.CENTER)}setAlignRight(){return this.setHorizontalAlignMode(_n.isLTRTextDirection?ws.RIGHT:ws.LEFT)}setAlignTop(){return this.setVerticalAlignMode(ws.TOP)}setAlignMiddle(){return this.setVerticalAlignMode(ws.MIDDLE)}setAlignBottom(){return this.setVerticalAlignMode(ws.BOTTOM)}setHorizontalAlignMode(e){if(this.horizontalAlignMode===e)return this;const{textView:n}=this;return n&&(n.style?n.style.align=e:n.align=e),this.horizontalAlignMode=e,this.adjust(),this}setVerticalAlignMode(e){return this.verticalAlignMode===e?this:(this.verticalAlignMode=e,this.adjust(),this)}adjust(){var d,u;if(!this.textView)return this;(d=this.areaGraphics)==null||d.clear(),this.textView.scale.set(1),this.textView.visible=!0;const e=this.textView.finalTextWidth??this.textView.width,n=this.textView.height,i=this.maximalWidth??e,r=this.maximalHeight??n;let a=1,l=1;i&&(a=Math.min(1,i/e)),n&&(l=Math.min(1,r/n));const o=Math.min(a,l);this.textView.scale.set(o);let h=0,c=0;switch(this.horizontalAlignMode){case ws.CENTER:h=(i-e*o)*.5;break;case ws.RIGHT:h=i-e*o;break;default:h=0;break}switch(this.verticalAlignMode){case ws.TOP:c=0;break;case ws.BOTTOM:c=r-this.textView.height*l;break;default:c=r*.5-this.textView.height*.5;break}return this.textView.position.set(h,c),this.areaGraphics&&this.highlightArea(),(u=this.atlasText)==null||u.onAdjusted(),this}setLetterSpacing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.style.letterSpacing=e,this.bitmapText?this.bitmapText.letterSpacing=e:this.atlasText&&this.atlasText.setLetterSpacing(e),this.adjust(),this}setDistortion(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.atlasText&&this.atlasText.setDistortion(e),this.adjust(),this}setDistortionHeight(e){return this.atlasText&&this.atlasText.setDistortionHeight(e),this.adjust(),this}setSymbolsScale(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this.atlasText&&this.atlasText.setSymbolsScale(e),this.adjust(),this}setFontName(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;if(this.style.familyName===e&&!n)return console.log("REJECTED"),this;if(this.style.familyName=e,this.textView&&(this.removeChild(this.textView),this.textView.destroy(),this.textView=null),n&&e&&(this.atlasText=new LA({availableCharacters:e,textures:n}),this.bitmapText=null,this.textView=this.addChild(this.atlasText)),!this.textView)try{if(this.atlasText=null,_n.isLTRTextDirection&&!this.isDynamicCharacterSet)this.bitmapText=new gx("",{fontName:e});else{this.bitmapText=new gh("");const i=_n.fontStyles[e];i&&(this.bitmapText.style=i)}this.textView=this.addChild(this.bitmapText)}catch{}return this.setFontSize(this.style.fontSize).setFontColor(this.style.fontColor).setLetterSpacing(this.style.letterSpacing).setHorizontalAlignMode(this.horizontalAlignMode).setVerticalAlignMode(this.verticalAlignMode).setText(this.text)}setFontSize(e){return this.style.fontSize=e,this.bitmapText?(this.bitmapText.fontSize=e,this.bitmapText.style&&(this.bitmapText.style.fontSize=e)):this.atlasText&&this.atlasText.setFontSize(e),this.adjust()}setFontColor(e){var n;return this.style.fontColor=e,(n=this.atlasText)==null||n.setColor(e),this.bitmapText&&(this.bitmapText.tint=e),this.adjust()}setHiddenCharacters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return this.atlasText?(this.atlasText.hiddenCharacters=e,this):this}},Y(_n,"fontStyles",{}),Y(_n,"isLTRTextDirection",!0),_n);class VA extends Mt{constructor(e){super();Y(this,"backgroundGlowView");Y(this,"textField");this.initBackgroundGlow(e),this.initTextField(e)}initBackgroundGlow(e){const n=new ve(e.payout_background_glow);n.anchor.set(.5),n.scale.set(2),this.backgroundGlowView=this.addChild(n)}initTextField(e){const n=new xi({}).setFontName("0123456789.,",[e.payout_0,e.payout_1,e.payout_2,e.payout_3,e.payout_4,e.payout_5,e.payout_6,e.payout_7,e.payout_8,e.payout_9,e.payout_period,e.payout_period]).setFontSize(100).setText("1234567890.,").setAlignCenter().setAlignMiddle().setHiddenCharacters([","]);this.textField=this.addChild(n)}presentPayout(e){let{width:n=100,height:i=100,payout:r=1e3,progress:a}=e;const{backgroundGlowView:l,textField:o}=this,h=Math.min(1,a*2);l.alpha=Math.min(1,Math.sin(Math.PI*h)*2),l.width=n*1.5,l.height=i*1.75,l.position.set(n/2,i/2),o.setMaximalWidth(n),o.setMaximalHeight(i),o.pivot.x=n/2,o.pivot.y=i/2,o.x=o.pivot.x,o.y=o.pivot.y,o.setText(Gs(r)),o.scale.set(.5+.5*Math.min(1,Math.sin(Math.PI*a)*1.1)),o.alpha=Math.min(1,Math.sin(Math.PI*a)*2.5)}}class UA extends Mt{constructor(e,n){super();Y(this,"framesContainer");Y(this,"framesPoolsViews",(()=>new Array(8).fill(0).map(e=>[]))());Y(this,"payoutsContainer");Y(this,"payoutsViews",[]);Y(this,"assets");Y(this,"overlayView");this.assets=e,this.overlayView=n,this.framesContainer=this.addChild(new Mt),this.payoutsContainer=this.addChild(new Mt)}getFramesPool(e,n){const{framesContainer:i,framesPoolsViews:r,assets:a}=this;if(!r[e][n]){const l=new Array(27).fill(0).map((h,c)=>a["symbol_"+(e-1)+"_"+c]),o=new OA(l);r[e][n]=i.addChild(o)}return r[e][n]}getPayout(e){const{payoutsContainer:n,payoutsViews:i,assets:r}=this;if(!i[e]){const a=new VA(r);i[e]=n.addChild(a)}return i[e]}present(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Er,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:be;const l=new Array(8).fill(0);e.forEach((o,h)=>{let{coordinates:c,payout:d,payoutX:u,payoutY:f,payoutWidth:m,payoutHeight:p}=o;c.forEach(v=>{let[b,x]=v;const y=i[b][x];l[y]++;const w=this.getFramesPool(y,l[y]);w.position.set(b*r,x*a),w.present(n)});const g=this.getPayout(h);g.position.set(r*(u-.5),a*(f-.5)),g.presentPayout({width:m*r,height:p*a,payout:d,progress:Math.max(0,(n-.25)/.75)})})}}class XA extends os{constructor(e){let{initialSymbolsIds:n,assets:i}=e;super();Y(this,"reelsContainer");Y(this,"maskView");Y(this,"reelsViews",[]);Y(this,"cellsViews",[]);Y(this,"highlightTimeline",(()=>new We)());Y(this,"corruptionTimeline",(()=>new We)());Y(this,"winListView");this.setSourceArea({width:qr,height:Qo}),this.setTargetArea({x:0,y:0,width:1,height:1}),this.initReels({initialSymbolsIds:n,assets:i}),this.initCollapsesPool(i),this.initMask(i),this.setMasked()}initReels(e){let{initialSymbolsIds:n,assets:i}=e;const r=new Mt;for(let a=0;a<As;a++){const l=new BA({index:a,initialSymbolsIds:n[a],assets:i,possibleSymbolsIds:Sd[a]});l.x=a*Er,this.reelsViews.push(r.addChildAt(l,0)),this.cellsViews.push(l.cellsViews)}this.reelsContainer=this.addChild(r)}initCollapsesPool(e){const n=new UA(e);n.position.set(Er/2,be/2),this.collapsesPoolView=n,this.reelsContainer.addChild(n)}initMask(e){const n=new Fn().beginFill(16777215).drawRect(0,0,qr,Qo).endFill();this.maskView=this.reelsContainer.addChild(n)}async preRenderSymbols(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:io();await Promise.all(this.reelsViews.map((n,i)=>n.preRenderSymbols(e[i]))),this.reelsViews.forEach(n=>n.onPreRendered())}getCurrentSymbolsIds(){const e=[];for(let n=0;n<As;n++){const i=[];for(let r=0;r<De;r++)i[r]=this.cellsViews[n][r+1].currentSymbolId;e.push(i)}return e}getAllCellsWithSymbolId(e){const{reelsViews:n}=this,i=[];for(let r=0;r<n.length;r++)for(let a=0;a<De;a++){const l=this.cellsViews[r][a+1];l.currentSymbolId===e&&i.push(l)}return i}setBrightness(e){let{key:n=1,map:i=new Array(As).fill(0).map((l,o)=>new Array(De).fill(1)),brightness:r=.25}=e;const{cellsViews:a}=this;for(let l=0;l<i.length;l++){a[l][0].setBrightness(r);for(let o=0;o<i[l].length;o++)i[l][o]===n&&a[l][o+1].setBrightness(r)}}setMasked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const{cellsViews:n}=this;for(let i=0;i<As;i++)n[i][0].visible=e,n[i][n[i].length-1].visible=e;this.maskView.visible=e,this.reelsContainer.mask=e?this.maskView:void 0}async presentSpinStart(){var e;return this.setMasked(),(e=this.winListView)==null||e.presentItemsDrop(),Promise.all(this.reelsViews.map((n,i)=>n.presentSpinStart(i*100)))}presentSpinStop(e){let{targetSymbolsIds:n=io()}=e;return Promise.all(this.reelsViews.map((i,r)=>i.presentSpinStop({symbolsIds:n[r],delay:r*100})))}setupPayoutDescriptors(e,n){const i=n.map(r=>r.map(a=>a));e.forEach(r=>{r.payoutWidth=1,r.payoutHeight=1;const[a,l]=r.coordinates[0];r.payoutX=a,r.payoutY=l});for(let r=0;r<De;r++){let a,l=0,o=0;for(let h=0;h<As;h++){const c=i[h][r];if(a!==void 0&&c!==void 0&&a===c){const d=e[a];l++,d.payoutWidth<l&&(d.payoutWidth=l,d.payoutX=o,d.payoutY=r)}else l=1,o=h,a=c}}e.forEach(r=>{if(r.payoutWidth>1)return;const{payoutY:a}=r,l=[r];e.forEach(o=>{if(o.payoutWidth>1||a!==o.payoutY)return;const h=l[l.length-1];o.payoutX-h.payoutX===1&&(l.push(o),l.length%2===0&&o.payoutY<7?o.payoutY++:l.length%3===0&&o.payoutY>0&&o.payoutY--)}),l.length>1&&l.forEach(o=>{o.isSpecialVerticalSiblingDescriptor=!0})}),e.forEach((r,a)=>{const{payoutX:l,payoutY:o,payoutWidth:h}=r;if(h>=2)return;const c=Math.max(0,l-1),d=Math.min(As-1,l+h),u=e[i[c][o]],f=e[i[d][o]];(!u||u.isSpecialVerticalSiblingDescriptor)&&(i[c][o]=a,r.payoutX--,r.payoutWidth++),(!f||f.isSpecialVerticalSiblingDescriptor)&&(i[d][o]=a,r.payoutWidth++)}),e.forEach((r,a)=>{if(r.isSpecialVerticalSiblingDescriptor)return;const{payoutX:l,payoutY:o,payoutWidth:h}=r;for(let c=o+1;c<7;c++){for(let d=l;d<l+h;d++)if(i[d][c]!==a)return;r.payoutHeight++}})}async presentCascade(e){let{patchMap:n=[[1],[1],[1,2],[3],[5],[]],collapses:i=[{coordinates:[[0,0],[1,0],[2,0],[2,1],[3,0],[4,0]],coefficient:2.5}]}=e;this.setMasked();const r=this.getCurrentSymbolsIds(),a=Up();i.forEach((c,d)=>{let{coordinates:u}=c;u.forEach(f=>{let[m,p]=f;a[m][p]=d})}),this.setupPayoutDescriptors(i,a);const l=Up(0);for(let c=0;c<As;c++){let d=0;for(let u=De-1;u>=0;u--)a[c][u]!==void 0?(d++,l[c][u]=0):l[c][u+d]=d}let o=[];this.setMasked(!1),await this.corruptionTimeline.deleteAllAnimations().addAnimation({duration:1e3,onStart:()=>{var c;(c=this.winListView)==null||c.presentWin(i);for(let d=0;d<l.length;d++)for(let u=De-1;u>=0;u--)a[d][u]!==void 0&&this.cellsViews[d][u+1].presentSymbol(0)},onProgress:c=>{this.collapsesPoolView.present(i,c,r)}}),o.push(this.corruptionTimeline.play());const h=a.map(c=>c.map(d=>d===void 0?1:0));o.push(this.highlightTimeline.deleteAllAnimations().addAnimation({duration:1e3,onProgress:c=>{let d=1;c<.25?d=1-c/.25:c>.75?d=(c-.75)/.25:d=0,this.setBrightness({map:h,key:1,brightness:d})}}).play()),await Promise.all(o),this.setMasked(),o=[];for(let c=0;c<l.length;c++)for(let d=De-1;d>=0;d--){const u=d-l[c][d],f=r[c][u];l[c][d]&&o.push(this.reelsViews[c].presentCascade({y:d,distance:l[c][d],symbolId:f}))}await Promise.all(o),o=[];for(let c=0;c<n.length;c++)for(let d=n[c].length-1;d>=0;d--)o.push(this.reelsViews[c].presentCascade({y:d,distance:De,symbolId:n[c][d],delay:c*50||1}));await Promise.all(o)}setTimeScale(e){var n;for(const i of this.reelsViews)i.setTimeScale(e);this.corruptionTimeline.setTimeScaleFactor({name:"scale",value:e}),this.highlightTimeline.setTimeScaleFactor({name:"scale",value:e}),(n=this.winListView)==null||n.setTimeScale(e)}presentRandomLoseSymbols(){let e=io();for(let n=0;n<As;n++)for(let i=0;i<De;i++)this.cellsViews[n][i+1].presentSymbol(e[n][i])}}const YA={1:6745855,2:16724736,3:16751103,4:10092288,5:16755251,6:3407871,7:3386111};class $A extends Mt{constructor(e){let{assets:n,reelsView:i,coefficients:r,camera:a}=e;super();Y(this,"coefficients");Y(this,"bet");Y(this,"reelsView");Y(this,"contentContainer");Y(this,"panelView");Y(this,"symbolContainer");Y(this,"payoutsContainer");Y(this,"payoutsViews",[]);Y(this,"capturedSymbolParentContainer");Y(this,"capturedSymbolView");Y(this,"capturedSymbolId");Y(this,"timeline",(()=>new We)());Y(this,"camera");Y(this,"isHiding");this.camera=a,this.coefficients=r,this.reelsView=i,this.contentContainer=this.addChild(new Mt),this.initPanel(n),this.initPayouts(),this.initSymbolContainer(),this.contentContainer.visible=!1}initSymbolContainer(){this.symbolContainer=this.contentContainer.addChild(new Mt)}initPanel(e){const n=new ve(e.payouts_panel);n.scale.set(1.23),n.y=-30,this.panelView=this.contentContainer.addChild(n)}initPayouts(){this.payoutsContainer=this.contentContainer.addChild(new Mt);for(let e=0;e<9;e++){const i=this.payoutsContainer.addChild(new xi({maximalWidth:175,maximalHeight:25})).setFontName("default").setFontColor(16777215).setFontSize(200).setAlignMiddle();i.y=e*25+20,this.payoutsViews.push(i)}}hide(){const{timeline:e,reelsView:n,contentContainer:i}=this;if(i.visible&&!this.isHiding)return e.deleteAllAnimations().addAnimation({duration:150,onStart:()=>{this.isHiding=!0},onProgress:r=>{n.setBrightness({brightness:r}),i.alpha=1-r,this.capturedSymbolView.presentCoefficients(1-r)},onFinish:()=>{this.capturedSymbolParentContainer.addChild(this.capturedSymbolView),this.capturedSymbolView=void 0,this.contentContainer.visible=!1,this.isHiding=!1}}).windToTime(1).play()}updatePayoutsTexts(e){const{coefficients:n}=this,i=Math.abs(this.capturedSymbolId);if(i!==void 0)if(n[i]){const r=Object.values(n[i]),a=5-r.length,l=240/r.length;this.payoutsViews.forEach((o,h)=>{const c=r[h],d=Gs(c*this.bet);o.visible=!!c,e&&o.setFontColor(e),o.setText(h+a+5+(h>3?"+":"")+"x: "+d),o.y=l*h+2,o.setMaximalHeight(l)})}else i===rr&&(this.payoutsViews.forEach(r=>r.setText("")),this.payoutsViews[0].y=2,this.payoutsViews[0].setMaximalHeight(240),this.payoutsViews[0].setText("WILD"),e&&this.payoutsViews[0].setFontColor(e))}async presentPayouts(e){let{capturedSymbolView:n,x:i,y:r,symbolId:a}=e;const{timeline:l,reelsView:o,contentContainer:h}=this;h.visible||(i<As/2?(this.payoutsContainer.x=75,this.panelView.x=-30):(this.payoutsContainer.x=-177,this.panelView.x=-213),r<De/2?(this.payoutsContainer.y=6,this.panelView.y=-25):(this.payoutsContainer.y=-180,this.panelView.y=-210),this.capturedSymbolParentContainer=n.parent,this.capturedSymbolView=n,this.capturedSymbolId=a,this.symbolContainer.addChild(n),this.contentContainer.position.set(i*Er,r*be),this.updatePayoutsTexts(YA[a]),await l.deleteAllAnimations().addAnimation({duration:250,onStart:()=>{this.contentContainer.visible=!0},onProgress:c=>{h.alpha=c,o.setBrightness({brightness:1-c}),n.setBrightness(1),this.capturedSymbolView.presentCoefficients(c)}}).play(),l.deleteAllAnimations().addAnimation({duration:5e3,onProgress:c=>{o.cellsViews.forEach(d=>d.forEach(u=>{const f=u.getSymbolView();f!==n&&f.setBrightness(0)})),n.setBrightness(1)}}).setLoopMode().play())}setBet(e){this.bet=e,this.updatePayoutsTexts()}}var Bt=(s=>(s[s.Region=0]="Region",s[s.BoundingBox=1]="BoundingBox",s[s.Mesh=2]="Mesh",s[s.LinkedMesh=3]="LinkedMesh",s[s.Path=4]="Path",s[s.Point=5]="Point",s[s.Clipping=6]="Clipping",s))(Bt||{});class Ol{constructor(t,e=new Array,n=0,i=new DataView(t.buffer)){this.strings=e,this.index=n,this.buffer=i}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),n=e&127;return e&128&&(e=this.readByte(),n|=(e&127)<<7,e&128&&(e=this.readByte(),n|=(e&127)<<14,e&128&&(e=this.readByte(),n|=(e&127)<<21,e&128&&(e=this.readByte(),n|=(e&127)<<28)))),t?n:n>>>1^-(n&1)}readStringRef(){const t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let n=0;n<t;){const i=this.readUnsignedByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((i&31)<<6|this.readByte()&63),n+=2;break;case 14:e+=String.fromCharCode((i&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),n+=3;break;default:e+=String.fromCharCode(i),n++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}var A=(s=>(s[s.setup=0]="setup",s[s.first=1]="first",s[s.replace=2]="replace",s[s.add=3]="add",s))(A||{}),Ft=(s=>(s[s.mixIn=0]="mixIn",s[s.mixOut=1]="mixOut",s))(Ft||{}),fe=(s=>(s[s.Fixed=0]="Fixed",s[s.Percent=1]="Percent",s))(fe||{}),Te=(s=>(s[s.Tangent=0]="Tangent",s[s.Chain=1]="Chain",s[s.ChainScale=2]="ChainScale",s))(Te||{}),Tt=(s=>(s[s.Normal=0]="Normal",s[s.OnlyTranslation=1]="OnlyTranslation",s[s.NoRotationOrReflection=2]="NoRotationOrReflection",s[s.NoScale=3]="NoScale",s[s.NoScaleOrReflection=4]="NoScaleOrReflection",s))(Tt||{});function Xp(s){switch(s.toLowerCase()){case"nearest":return Cs.Nearest;case"linear":return Cs.Linear;case"mipmap":return Cs.MipMap;case"mipmapnearestnearest":return Cs.MipMapNearestNearest;case"mipmaplinearnearest":return Cs.MipMapLinearNearest;case"mipmapnearestlinear":return Cs.MipMapNearestLinear;case"mipmaplinearlinear":return Cs.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${s}`)}}var Cs=(s=>(s[s.Nearest=9728]="Nearest",s[s.Linear=9729]="Linear",s[s.MipMap=9987]="MipMap",s[s.MipMapNearestNearest=9984]="MipMapNearestNearest",s[s.MipMapLinearNearest=9985]="MipMapLinearNearest",s[s.MipMapNearestLinear=9986]="MipMapNearestLinear",s[s.MipMapLinearLinear=9987]="MipMapLinearLinear",s))(Cs||{}),ur=(s=>(s[s.MirroredRepeat=33648]="MirroredRepeat",s[s.ClampToEdge=33071]="ClampToEdge",s[s.Repeat=10497]="Repeat",s))(ur||{});class Nu{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class GA{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class Lu{constructor(t,e,n){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,n)}addTexture(t,e){const n=this.pages;let i=null;for(let a=0;a<n.length;a++)if(n[a].baseTexture===e.baseTexture){i=n[a];break}if(i===null){i=new Yp,i.name="texturePage";const a=e.baseTexture;i.width=a.realWidth,i.height=a.realHeight,i.baseTexture=a,i.minFilter=i.magFilter=Cs.Nearest,i.uWrap=ur.ClampToEdge,i.vWrap=ur.ClampToEdge,n.push(i)}const r=new $p;return r.name=t,r.page=i,r.texture=e,r.index=-1,this.regions.push(r),r}addTextureHash(t,e){for(const n in t)t.hasOwnProperty(n)&&this.addTexture(e&&n.indexOf(".")!==-1?n.substr(0,n.lastIndexOf(".")):n,t[n])}addSpineAtlas(t,e,n){return this.load(t,e,n)}load(t,e,n){if(e==null)throw new Error("textureLoader cannot be null.");const i=new WA(t),r=new Array(4);let a=null;const l={};let o=null;l.size=()=>{a.width=parseInt(r[1]),a.height=parseInt(r[2])},l.format=()=>{},l.filter=()=>{a.minFilter=Xp(r[1]),a.magFilter=Xp(r[2])},l.repeat=()=>{r[1].indexOf("x")!=-1&&(a.uWrap=ur.Repeat),r[1].indexOf("y")!=-1&&(a.vWrap=ur.Repeat)},l.pma=()=>{a.pma=r[1]=="true"};const h={};h.xy=()=>{o.x=parseInt(r[1]),o.y=parseInt(r[2])},h.size=()=>{o.width=parseInt(r[1]),o.height=parseInt(r[2])},h.bounds=()=>{o.x=parseInt(r[1]),o.y=parseInt(r[2]),o.width=parseInt(r[3]),o.height=parseInt(r[4])},h.offset=()=>{o.offsetX=parseInt(r[1]),o.offsetY=parseInt(r[2])},h.orig=()=>{o.originalWidth=parseInt(r[1]),o.originalHeight=parseInt(r[2])},h.offsets=()=>{o.offsetX=parseInt(r[1]),o.offsetY=parseInt(r[2]),o.originalWidth=parseInt(r[3]),o.originalHeight=parseInt(r[4])},h.rotate=()=>{const u=r[1];let f=0;u.toLocaleLowerCase()=="true"?f=6:u.toLocaleLowerCase()=="false"?f=0:f=(720-parseFloat(u))%360/45,o.rotate=f},h.index=()=>{o.index=parseInt(r[1])};let c=i.readLine();for(;c!=null&&c.trim().length==0;)c=i.readLine();for(;!(c==null||c.trim().length==0||i.readEntry(r,c)==0);)c=i.readLine();const d=()=>{for(;;){if(c==null)return n&&n(this);if(c.trim().length==0)a=null,c=i.readLine();else if(a===null){for(a=new Yp,a.name=c.trim();i.readEntry(r,c=i.readLine())!=0;){const u=l[r[0]];u&&u()}this.pages.push(a),e(a.name,u=>{if(u===null)return this.pages.splice(this.pages.indexOf(a),1),n&&n(null);a.baseTexture=u,a.pma&&(u.alphaMode=sn.PMA),u.valid||u.setSize(a.width,a.height),a.setFilters(),(!a.width||!a.height)&&(a.width=u.realWidth,a.height=u.realHeight,(!a.width||!a.height)&&console.log(`ERROR spine atlas page ${a.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),d()});break}else{o=new GA;const u=new $p;u.name=c,u.page=a;let f=null,m=null;for(;;){const y=i.readEntry(r,c=i.readLine());if(y==0)break;const w=h[r[0]];if(w)w();else{f==null&&(f=[],m=[]),f.push(r[0]);const _=[];for(let E=0;E<y;E++)_.push(parseInt(r[E+1]));m.push(_)}}o.originalWidth==0&&o.originalHeight==0&&(o.originalWidth=o.width,o.originalHeight=o.height);const p=a.baseTexture.resolution;o.x/=p,o.y/=p,o.width/=p,o.height/=p,o.originalWidth/=p,o.originalHeight/=p,o.offsetX/=p,o.offsetY/=p;const g=o.rotate%4!==0,v=new Dt(o.x,o.y,g?o.height:o.width,g?o.width:o.height),b=new Dt(0,0,o.originalWidth,o.originalHeight),x=new Dt(o.offsetX,o.originalHeight-o.height-o.offsetY,o.width,o.height);u.texture=new pt(u.page.baseTexture,v,b,x,o.rotate),u.index=o.index,u.texture.updateUvs(),this.regions.push(u)}}};d()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class WA{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;const n=e.indexOf(":");if(n==-1)return 0;t[0]=e.substr(0,n).trim();for(let i=1,r=n+1;;i++){const a=e.indexOf(",",r);if(a==-1)return t[i]=e.substr(r).trim(),i;if(t[i]=e.substr(r,a-r).trim(),r=a+1,i==4)return 4}}}class Yp{constructor(){this.minFilter=Cs.Nearest,this.magFilter=Cs.Nearest,this.uWrap=ur.ClampToEdge,this.vWrap=ur.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==Cs.Linear?t.scaleMode=Os.LINEAR:this.minFilter==Cs.Nearest?t.scaleMode=Os.NEAREST:(t.mipmap=tn.POW2,e==Cs.MipMapNearestNearest?t.scaleMode=Os.NEAREST:t.scaleMode=Os.LINEAR)}}class $p extends Nu{}class yx{constructor(){this.array=new Array}add(t){const e=this.contains(t);return this.array[t|0]=t|0,!e}contains(t){return this.array[t|0]!=null}remove(t){this.array[t|0]=void 0}clear(){this.array.length=0}}class bx{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){const e=this.size;for(let n=0,i=t.length;n<i;n++)this.add(t[n]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const Ir=class{constructor(s=0,t=0,e=0,n=0){this.r=s,this.g=t,this.b=e,this.a=n}set(s,t,e,n){return this.r=s,this.g=t,this.b=e,this.a=n,this.clamp()}setFromColor(s){return this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this}setFromString(s){return s=s.charAt(0)=="#"?s.substr(1):s,this.r=parseInt(s.substr(0,2),16)/255,this.g=parseInt(s.substr(2,2),16)/255,this.b=parseInt(s.substr(4,2),16)/255,this.a=s.length!=8?1:parseInt(s.substr(6,2),16)/255,this}add(s,t,e,n){return this.r+=s,this.g+=t,this.b+=e,this.a+=n,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(s,t){s.r=((t&4278190080)>>>24)/255,s.g=((t&16711680)>>>16)/255,s.b=((t&65280)>>>8)/255,s.a=(t&255)/255}static rgb888ToColor(s,t){s.r=((t&16711680)>>>16)/255,s.g=((t&65280)>>>8)/255,s.b=(t&255)/255}static fromString(s){return new Ir().setFromString(s)}};let at=Ir;at.WHITE=new Ir(1,1,1,1);at.RED=new Ir(1,0,0,1);at.GREEN=new Ir(0,1,0,1);at.BLUE=new Ir(0,0,1,1);at.MAGENTA=new Ir(1,0,1,1);const yi=class{static clamp(s,t,e){return s<t?t:s>e?e:s}static cosDeg(s){return Math.cos(s*yi.degRad)}static sinDeg(s){return Math.sin(s*yi.degRad)}static signum(s){return Math.sign(s)}static toInt(s){return s>0?Math.floor(s):Math.ceil(s)}static cbrt(s){const t=Math.pow(Math.abs(s),.3333333333333333);return s<0?-t:t}static randomTriangular(s,t){return yi.randomTriangularWith(s,t,(s+t)*.5)}static randomTriangularWith(s,t,e){const n=Math.random(),i=t-s;return n<=(e-s)/i?s+Math.sqrt(n*i*(e-s)):t-Math.sqrt((1-n)*i*(t-e))}static isPowerOfTwo(s){return s&&(s&s-1)===0}};let I=yi;I.PI=3.1415927;I.PI2=yi.PI*2;I.radiansToDegrees=180/yi.PI;I.radDeg=yi.radiansToDegrees;I.degreesToRadians=yi.PI/180;I.degRad=yi.degreesToRadians;class HA{apply(t,e,n){return t+(e-t)*this.applyInternal(n)}}class zA extends HA{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(t*2,this.power)/2:Math.pow((t-1)*2,this.power)/(this.power%2==0?-2:2)+1}}class vx extends zA{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}}const $r=class{static arrayCopy(s,t,e,n,i){for(let r=t,a=n;r<t+i;r++,a++)e[a]=s[r]}static arrayFill(s,t,e,n){for(let i=t;i<e;i++)s[i]=n}static setArraySize(s,t,e=0){const n=s.length;if(n==t)return s;if(s.length=t,n<t)for(let i=n;i<t;i++)s[i]=e;return s}static ensureArrayCapacity(s,t,e=0){return s.length>=t?s:$r.setArraySize(s,t,e)}static newArray(s,t){const e=new Array(s);for(let n=0;n<s;n++)e[n]=t;return e}static newFloatArray(s){if($r.SUPPORTS_TYPED_ARRAYS)return new Float32Array(s);const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static newShortArray(s){if($r.SUPPORTS_TYPED_ARRAYS)return new Int16Array(s);const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static toFloatArray(s){return $r.SUPPORTS_TYPED_ARRAYS?new Float32Array(s):s}static toSinglePrecision(s){return $r.SUPPORTS_TYPED_ARRAYS?Math.fround(s):s}static webkit602BugfixHelper(s,t){}static contains(s,t,e=!0){for(let n=0;n<s.length;n++)if(s[n]==t)return!0;return!1}static enumValue(s,t){return s[t[0].toUpperCase()+t.slice(1)]}};let $=$r;$.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class yh{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class fa{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class Td{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new yh(()=>$.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");const n=this.boundingBoxes,i=this.polygons,r=this.polygonPool,a=t.slots,l=a.length;n.length=0,r.freeAll(i),i.length=0;for(let o=0;o<l;o++){const h=a[o];if(!h.bone.active)continue;const c=h.getAttachment();if(c!=null&&c.type===Bt.BoundingBox){const d=c;n.push(d);let u=r.obtain();u.length!=d.worldVerticesLength&&(u=$.newFloatArray(d.worldVerticesLength)),i.push(u),d.computeWorldVertices(h,0,d.worldVerticesLength,u,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const r=this.polygons;for(let a=0,l=r.length;a<l;a++){const o=r[a],h=o;for(let c=0,d=o.length;c<d;c+=2){const u=h[c],f=h[c+1];t=Math.min(t,u),e=Math.min(e,f),n=Math.max(n,u),i=Math.max(i,f)}}this.minX=t,this.minY=e,this.maxX=n,this.maxY=i}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,n,i){const r=this.minX,a=this.minY,l=this.maxX,o=this.maxY;if(t<=r&&n<=r||e<=a&&i<=a||t>=l&&n>=l||e>=o&&i>=o)return!1;const h=(i-e)/(n-t);let c=h*(r-t)+e;if(c>a&&c<o||(c=h*(l-t)+e,c>a&&c<o))return!0;let d=(a-e)/h+t;return d>r&&d<l||(d=(o-e)/h+t,d>r&&d<l)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){const n=this.polygons;for(let i=0,r=n.length;i<r;i++)if(this.containsPointPolygon(n[i],t,e))return this.boundingBoxes[i];return null}containsPointPolygon(t,e,n){const i=t,r=t.length;let a=r-2,l=!1;for(let o=0;o<r;o+=2){const h=i[o+1],c=i[a+1];if(h<n&&c>=n||c<n&&h>=n){const d=i[o];d+(n-h)/(c-h)*(i[a]-d)<e&&(l=!l)}a=o}return l}intersectsSegment(t,e,n,i){const r=this.polygons;for(let a=0,l=r.length;a<l;a++)if(this.intersectsSegmentPolygon(r[a],t,e,n,i))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(t,e,n,i,r){const a=t,l=t.length,o=e-i,h=n-r,c=e*r-n*i;let d=a[l-2],u=a[l-1];for(let f=0;f<l;f+=2){const m=a[f],p=a[f+1],g=d*p-u*m,v=d-m,b=u-p,x=o*b-h*v,y=(c*v-o*g)/x;if((y>=d&&y<=m||y>=m&&y<=d)&&(y>=e&&y<=i||y>=i&&y<=e)){const w=(c*b-h*g)/x;if((w>=u&&w<=p||w>=p&&w<=u)&&(w>=n&&w<=r||w>=r&&w<=n))return!0}d=m,u=p}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");const e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}const jA={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0},Ai=[0,0,0];class qA extends ve{constructor(){super(...arguments),this.region=null,this.attachment=null}}class KA extends KT{constructor(t,e,n,i,r){super(t,e,n,i,r),this.region=null,this.attachment=null}}const wx=class extends Mt{constructor(s){if(super(),!s)throw new Error("The spineData param is required.");if(typeof s=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=s,this.createSkeleton(s),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const n=this.skeleton.slots[t],i=n.getAttachment(),r=this.newContainer();if(this.slotContainers.push(r),this.addChild(r),this.tempClipContainers.push(null),!!i)if(i.type===Bt.Region){const a=i.name,l=this.createSprite(n,i,a);n.currentSprite=l,n.currentSpriteName=a,r.addChild(l)}else if(i.type===Bt.Mesh){const a=this.createMesh(n,i);n.currentMesh=a,n.currentMeshId=i.id,n.currentMeshName=i.name,r.addChild(a)}else i.type===Bt.Clipping&&(this.createGraphics(n,i),r.addChild(n.clippingContainer),r.addChild(n.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(s){var t;s!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),s==null||s.registerSpine(this),this._debug=s)}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,this.updateTransform=s?wx.prototype.autoUpdateTransform:Mt.prototype.updateTransform)}get tint(){return ll(this.tintRgb)}set tint(s){this.tintRgb=M_(s,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:jA.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(s){var h;const t=this.delayLimit;if(s>t&&(s=t),this.state.update(s),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const e=this.skeleton.slots,n=this.color;let i=null,r=null;n?(i=n.light,r=n.dark):i=this.tintRgb;for(let c=0,d=e.length;c<d;c++){const u=e[c],f=u.getAttachment(),m=this.slotContainers[c];if(!f){m.visible=!1;continue}let p=null;f.sequence&&f.sequence.apply(u,f);let g=f.region;const v=f.color;switch(f!=null&&f.type){case Bt.Region:if(m.transform.setFromMatrix(u.bone.matrix),g=f.region,u.currentMesh&&(u.currentMesh.visible=!1,u.currentMesh=null,u.currentMeshId=void 0,u.currentMeshName=void 0),!g){u.currentSprite&&(u.currentSprite.renderable=!1);break}if(!u.currentSpriteName||u.currentSpriteName!==f.name){const y=f.name;if(u.currentSprite&&(u.currentSprite.visible=!1),u.sprites=u.sprites||{},u.sprites[y]!==void 0)u.sprites[y].visible=!0;else{const w=this.createSprite(u,f,y);m.addChild(w)}u.currentSprite=u.sprites[y],u.currentSpriteName=y}u.currentSprite.renderable=!0,u.hackRegion||this.setSpriteRegion(f,u.currentSprite,g),u.currentSprite.color?p=u.currentSprite.color:(Ai[0]=i[0]*u.color.r*v.r,Ai[1]=i[1]*u.color.g*v.g,Ai[2]=i[2]*u.color.b*v.b,u.currentSprite.tint=ll(Ai)),u.currentSprite.blendMode=u.blendMode;break;case Bt.Mesh:if(u.currentSprite){u.currentSprite.visible=!1,u.currentSprite=null,u.currentSpriteName=void 0;const y=new oh;y._parentID=-1,y._worldID=m.transform._worldID,m.transform=y}if(!g){u.currentMesh&&(u.currentMesh.renderable=!1);break}const x=f.id;if(u.currentMeshId===void 0||u.currentMeshId!==x){const y=x;if(u.currentMesh&&(u.currentMesh.visible=!1),u.meshes=u.meshes||{},u.meshes[y]!==void 0)u.meshes[y].visible=!0;else{const w=this.createMesh(u,f);m.addChild(w)}u.currentMesh=u.meshes[y],u.currentMeshName=f.name,u.currentMeshId=y}u.currentMesh.renderable=!0,f.computeWorldVerticesOld(u,u.currentMesh.vertices),u.currentMesh.color?p=u.currentMesh.color:(Ai[0]=i[0]*u.color.r*v.r,Ai[1]=i[1]*u.color.g*v.g,Ai[2]=i[2]*u.color.b*v.b,u.currentMesh.tint=ll(Ai)),u.currentMesh.blendMode=u.blendMode,u.hackRegion||this.setMeshRegion(f,u.currentMesh,g);break;case Bt.Clipping:u.currentGraphics||(this.createGraphics(u,f),m.addChild(u.clippingContainer),m.addChild(u.currentGraphics)),this.updateGraphics(u,f),m.alpha=1,m.visible=!0;continue;default:m.visible=!1;continue}if(m.visible=!0,p){let b=u.color.r*v.r,x=u.color.g*v.g,y=u.color.b*v.b;p.setLight(i[0]*b+r[0]*(1-b),i[1]*x+r[1]*(1-x),i[2]*y+r[2]*(1-y)),u.darkColor?(b=u.darkColor.r,x=u.darkColor.g,y=u.darkColor.b):(b=0,x=0,y=0),p.setDark(i[0]*b+r[0]*(1-b),i[1]*x+r[1]*(1-x),i[2]*y+r[2]*(1-y))}m.alpha=u.color.a}const a=this.skeleton.drawOrder;let l=null,o=null;for(let c=0,d=a.length;c<d;c++){const u=e[a[c].data.index],f=this.slotContainers[a[c].data.index];if(o||f.parent!==null&&f.parent!==this&&(f.parent.removeChild(f),f.parent=this),u.currentGraphics&&u.getAttachment())o=u.clippingContainer,l=u.getAttachment(),o.children.length=0,this.children[c]=f,l.endSlot===u.data&&(l.endSlot=null);else if(o){let m=this.tempClipContainers[c];m||(m=this.tempClipContainers[c]=this.newContainer(),m.visible=!1),this.children[c]=m,f.parent=null,o.addChild(f),l.endSlot==u.data&&(o.renderable=!0,o=null,l=null)}else this.children[c]=f}(h=this._debug)==null||h.renderDebug(this)}setSpriteRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,t.rotation=s.rotation*I.degRad,t.position.x=s.x,t.position.y=s.y,t.alpha=s.color.a,e.size?(t.scale.x=e.size.width/e.originalWidth,t.scale.y=-e.size.height/e.originalHeight):(t.scale.x=s.scaleX*s.width/e.originalWidth,t.scale.y=-s.scaleY*s.height/e.originalHeight))}setMeshRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,e.texture.updateUvs(),t.uvBuffer.update(s.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const s=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(s)}Mt.prototype.updateTransform.call(this)}createSprite(s,t,e){let n=t.region;s.hackAttachment===t&&(n=s.hackRegion);const i=n?n.texture:null,r=this.newSprite(i);return r.anchor.set(.5),n&&this.setSpriteRegion(t,r,t.region),s.sprites=s.sprites||{},s.sprites[e]=r,r}createMesh(s,t){let e=t.region;s.hackAttachment===t&&(e=s.hackRegion,s.hackAttachment=null,s.hackRegion=null);const n=this.newMesh(e?e.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),En.TRIANGLES);return typeof n._canvasPadding<"u"&&(n._canvasPadding=1.5),n.alpha=t.color.a,n.region=t.region,e&&this.setMeshRegion(t,n,e),s.meshes=s.meshes||{},s.meshes[t.id]=n,n}createGraphics(s,t){const e=this.newGraphics(),n=new pr([]);return e.clear(),e.beginFill(16777215,1),e.drawPolygon(n),e.renderable=!1,s.currentGraphics=e,s.clippingContainer=this.newContainer(),s.clippingContainer.mask=s.currentGraphics,e}updateGraphics(s,t){const e=s.currentGraphics.geometry,n=e.graphicsData[0].shape.points,i=t.worldVerticesLength;n.length=i,t.computeWorldVertices(s,0,i,n,0,2),e.invalidate()}hackTextureBySlotIndex(s,t=null,e=null){const n=this.skeleton.slots[s];if(!n)return!1;const i=n.getAttachment();let r=i.region;return t?(r=new Nu,r.texture=t,r.size=e,n.hackRegion=r,n.hackAttachment=i):(n.hackRegion=null,n.hackAttachment=null),n.currentSprite?this.setSpriteRegion(i,n.currentSprite,r):n.currentMesh&&this.setMeshRegion(i,n.currentMesh,r),!0}hackTextureBySlotName(s,t=null,e=null){const n=this.skeleton.findSlotIndex(s);return n==-1?!1:this.hackTextureBySlotIndex(n,t,e)}hackTextureAttachment(s,t,e,n=null){const i=this.skeleton.findSlotIndex(s),r=this.skeleton.getAttachmentByName(s,t);r.region.texture=e;const a=this.skeleton.slots[i];if(!a)return!1;const l=a.getAttachment();if(t===l.name){let o=r.region;return e?(o=new Nu,o.texture=e,o.size=n,a.hackRegion=o,a.hackAttachment=l):(a.hackRegion=null,a.hackAttachment=null),a.currentSprite&&a.currentSprite.region!=o?(this.setSpriteRegion(l,a.currentSprite,o),a.currentSprite.region=o):a.currentMesh&&a.currentMesh.region!=o&&this.setMeshRegion(l,a.currentMesh,o),!0}return!1}newContainer(){return new Mt}newSprite(s){return new qA(s)}newGraphics(){return new Fn}newMesh(s,t,e,n,i){return new KA(s,t,e,n,i)}transformHack(){return 1}hackAttachmentGroups(s,t,e){if(!s)return;const n=[],i=[];for(let r=0,a=this.skeleton.slots.length;r<a;r++){const l=this.skeleton.slots[r],o=l.currentSpriteName||l.currentMeshName||"",h=l.currentSprite||l.currentMesh;o.endsWith(s)?(h.parentGroup=t,i.push(h)):e&&h&&(h.parentGroup=e,n.push(h))}return[n,i]}destroy(s){this.debug=null;for(let t=0,e=this.skeleton.slots.length;t<e;t++){const n=this.skeleton.slots[t];for(const i in n.meshes)n.meshes[i].destroy(s);n.meshes=null;for(const i in n.sprites)n.sprites[i].destroy(s);n.sprites=null}for(let t=0,e=this.slotContainers.length;t<e;t++)this.slotContainers[t].destroy(s);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(s)}};let _o=wx;_o.clippingPolygon=[];Object.defineProperty(_o.prototype,"visible",{get(){return this._visible},set(s){s!==this._visible&&(this._visible=s,s&&(this.lastTime=0))}});const ZA={extension:ut.Asset,loader:{extension:{type:ut.LoadParser,priority:nn.Normal},test(s){return Ns(s,".atlas")},async load(s){return await(await ct.ADAPTER.fetch(s)).text()},testParse(s,t){const e=Ns(t.src,".atlas"),n=typeof s=="string";return Promise.resolve(e&&n)},async parse(s,t,e){const n=t.data;let i=me.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let r=null,a=null;const l=new Promise((c,d)=>{r=c,a=d});let o;const h=c=>{c||a(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),r(o)};if(n.image||n.images){const c=Object.assign(n.image?{default:n.image}:{},n.images);o=new Lu(s,(d,u)=>{const f=c[d]||c.default;f&&f.baseTexture?u(f.baseTexture):u(f)},h)}else o=new Lu(s,_x(e,i,n.imageMetadata),h);return await l},unload(s){s.dispose()}}},_x=(s,t,e)=>async(n,i)=>{const r=me.normalize([...t.split(me.sep),n].join(me.sep)),a=await s.load({src:r,data:e});i(a.baseTexture)};bt.add(ZA);function Gp(s){return s.hasOwnProperty("bones")}function JA(s){return s instanceof ArrayBuffer}class QA{constructor(){}installLoader(){const t=this,e={extension:ut.Asset,loader:{extension:{type:ut.LoadParser,priority:nn.Normal},test(n){return Ns(n,".skel")},async load(n){return await(await ct.ADAPTER.fetch(n)).arrayBuffer()},testParse(n,i){var o;const r=Ns(i.src,".json")&&Gp(n),a=Ns(i.src,".skel")&&JA(n),l=((o=i.data)==null?void 0:o.spineAtlas)===!1;return Promise.resolve(r&&!l||a)},async parse(n,i,r){const a=me.extname(i.src).toLowerCase(),l=me.basename(i.src,a);let o=me.dirname(i.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");const h=Ns(i.src,".json")&&Gp(n);let c=null,d=n;h?c=t.createJsonParser():(c=t.createBinaryParser(),d=new Uint8Array(n));const u=i.data||{},f=(u==null?void 0:u.spineSkeletonScale)??null;f&&(c.scale=f);const m=u.spineAtlas;if(m&&m.pages)return t.parseData(c,m,d);const p=u.atlasRawData;if(p){let b=null,x=null;const y=new Promise((E,T)=>{b=E,x=T}),w=new Lu(p,_x(r,o,u.imageMetadata),E=>{E||x(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),b(w)}),_=await y;return t.parseData(c,_,d)}let g=u.spineAtlasFile;g||(g=`${o+l}.atlas`);const v=await r.load({src:g,data:u,alias:u.spineAtlasAlias});return t.parseData(c,v,d)}}};return bt.add(e),e}}let Ad=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const Ex=class extends Ad{constructor(t){super(t),this.id=(Ex.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,i,r,a){n=r+(n>>1)*a;const l=t.bone.skeleton,o=t.deform;let h=this.vertices;const c=this.bones;if(c==null){o.length>0&&(h=o);const m=t.bone.matrix,p=m.tx,g=m.ty,v=m.a,b=m.c,x=m.b,y=m.d;for(let w=e,_=r;_<n;w+=2,_+=a){const E=h[w],T=h[w+1];i[_]=E*v+T*b+p,i[_+1]=E*x+T*y+g}return}let d=0,u=0;for(let m=0;m<e;m+=2){const p=c[d];d+=p+1,u+=p}const f=l.bones;if(o.length==0)for(let m=r,p=u*3;m<n;m+=a){let g=0,v=0,b=c[d++];for(b+=d;d<b;d++,p+=3){const x=f[c[d]].matrix,y=h[p],w=h[p+1],_=h[p+2];g+=(y*x.a+w*x.c+x.tx)*_,v+=(y*x.b+w*x.d+x.ty)*_}i[m]=g,i[m+1]=v}else{const m=o;for(let p=r,g=u*3,v=u<<1;p<n;p+=a){let b=0,x=0,y=c[d++];for(y+=d;d<y;d++,g+=3,v+=2){const w=f[c[d]].matrix,_=h[g]+m[v],E=h[g+1]+m[v+1],T=h[g+2];b+=(_*w.a+E*w.c+w.tx)*T,x+=(_*w.b+E*w.d+w.ty)*T}i[p]=b,i[p+1]=x}}}copyTo(t){this.bones!=null?(t.bones=new Array(this.bones.length),$.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices!=null?(t.vertices=$.newFloatArray(this.vertices.length),$.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}};let Hi=Ex;Hi.nextID=0;let Sx=class Tx extends Hi{constructor(t){super(t),this.type=Bt.BoundingBox,this.color=new at(1,1,1,1)}copy(){const t=new Tx(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}},Ax=class Cx extends Hi{constructor(t){super(t),this.type=Bt.Clipping,this.color=new at(.2275,.2275,.8078,1)}copy(){const t=new Cx(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}},bh=class Vu extends Hi{constructor(t){super(t),this.type=Bt.Mesh,this.color=new at(1,1,1,1),this.tempColor=new at(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();const t=new Vu(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),$.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),$.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,this.edges!=null&&(t.edges=new Array(this.edges.length),$.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){const t=new Vu(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(this.parentMesh!=null?this.parentMesh:this),t}},ma=class Mx extends Hi{constructor(t){super(t),this.type=Bt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new at(1,1,1,1)}copy(){const t=new Mx(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),$.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}},Ix=class Rx extends Hi{constructor(t){super(t),this.type=Bt.Point,this.color=new at(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=I.cosDeg(this.rotation),i=I.sinDeg(this.rotation),r=n*e.a+i*e.c,a=n*e.b+i*e.d;return Math.atan2(a,r)*I.radDeg}copy(){const t=new Rx(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}},Cd=class{constructor(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new at,this.darkColor=t.darkColor==null?null:new at,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const Ue=class extends Ad{constructor(t){super(t),this.type=Bt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new at(1,1,1,1),this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new at(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,r=n+this.region.width*t,a=i+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=n*o+this.x,d=n*h,u=i*o+this.y,f=i*h,m=r*o+this.x,p=r*h,g=a*o+this.y,v=a*h,b=this.offset;b[Ue.OX1]=c-f,b[Ue.OY1]=u+d,b[Ue.OX2]=c-v,b[Ue.OY2]=g+d,b[Ue.OX3]=m-v,b[Ue.OY3]=g+p,b[Ue.OX4]=m-f,b[Ue.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,n,i){const r=this.offset,a=t instanceof Cd?t.bone.matrix:t.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,d=a.b,u=a.d;let f=0,m=0;f=r[Ue.OX1],m=r[Ue.OY1],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[Ue.OX2],m=r[Ue.OY2],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[Ue.OX3],m=r[Ue.OY3],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[Ue.OX4],m=r[Ue.OY4],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o}copy(){const t=new Ue(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,$.arrayCopy(this.uvs,0,t.uvs,0,8),$.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}};let Rt=Ue;Rt.OX1=0;Rt.OY1=1;Rt.OX2=2;Rt.OY2=3;Rt.OX3=4;Rt.OY3=5;Rt.OX4=6;Rt.OY4=7;Rt.X1=0;Rt.Y1=1;Rt.C1R=2;Rt.C1G=3;Rt.C1B=4;Rt.C1A=5;Rt.U1=6;Rt.V1=7;Rt.X2=8;Rt.Y2=9;Rt.C2R=10;Rt.C2G=11;Rt.C2B=12;Rt.C2A=13;Rt.U2=14;Rt.V2=15;Rt.X3=16;Rt.Y3=17;Rt.C3R=18;Rt.C3G=19;Rt.C3B=20;Rt.C3A=21;Rt.U3=22;Rt.V3=23;Rt.X4=24;Rt.Y4=25;Rt.C4R=26;Rt.C4G=27;Rt.C4B=28;Rt.C4A=29;Rt.U4=30;Rt.V4=31;let tC=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,n,i){t.x+=I.randomTriangular(-this.jitterX,this.jitterY),t.y+=I.randomTriangular(-this.jitterX,this.jitterY)}end(){}};const Px=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,n,i){const r=this.angle*I.degreesToRadians,a=t.x-this.worldX,l=t.y-this.worldY,o=Math.sqrt(a*a+l*l);if(o<this.radius){const h=Px.interpolation.apply(0,r,(this.radius-o)/this.radius),c=Math.cos(h),d=Math.sin(h);t.x=c*a-d*l+this.worldX,t.y=d*a+c*l+this.worldY}}end(){}};let kx=Px;kx.interpolation=new vx(2);let Ae=class{constructor(t,e,n){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=n}hasTimeline(t){return this.timelineIds[t]==!0}apply(t,e,n,i,r,a,l,o){if(t==null)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(n%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,d=h.length;c<d;c++)h[c].apply(t,e,n,r,a,l,o)}static binarySearch(t,e,n=1){let i=0,r=t.length/n-2;if(r==0)return n;let a=r>>>1;for(;;){if(t[(a+1)*n]<=e?i=a+1:r=a,i==r)return(i+1)*n;a=i+r>>>1}}static linearSearch(t,e,n){for(let i=0,r=t.length-n;i<=r;i+=n)if(t[i]>e)return i;return-1}};var Fx=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))(Fx||{});const _e=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=$.newFloatArray((t-1)*_e.BEZIER_SIZE)}getFrameCount(){return this.curves.length/_e.BEZIER_SIZE+1}setLinear(t){this.curves[t*_e.BEZIER_SIZE]=_e.LINEAR}setStepped(t){this.curves[t*_e.BEZIER_SIZE]=_e.STEPPED}getCurveType(t){const e=t*_e.BEZIER_SIZE;if(e==this.curves.length)return _e.LINEAR;const n=this.curves[e];return n==_e.LINEAR?_e.LINEAR:n==_e.STEPPED?_e.STEPPED:_e.BEZIER}setCurve(t,e,n,i,r){const a=(-e*2+i)*.03,l=(-n*2+r)*.03,o=((e-i)*3+1)*.006,h=((n-r)*3+1)*.006;let c=a*2+o,d=l*2+h,u=e*.3+a+o*.16666667,f=n*.3+l+h*.16666667,m=t*_e.BEZIER_SIZE;const p=this.curves;p[m++]=_e.BEZIER;let g=u,v=f;for(let b=m+_e.BEZIER_SIZE-1;m<b;m+=2)p[m]=g,p[m+1]=v,u+=c,f+=d,c+=o,d+=h,g+=u,v+=f}getCurvePercent(t,e){e=I.clamp(e,0,1);const n=this.curves;let i=t*_e.BEZIER_SIZE;const r=n[i];if(r==_e.LINEAR)return e;if(r==_e.STEPPED)return 0;i++;let a=0;for(let o=i,h=i+_e.BEZIER_SIZE-1;i<h;i+=2)if(a=n[i],a>=e){let c,d;return i==o?(c=0,d=0):(c=n[i-2],d=n[i-1]),d+(n[i+1]-d)*(e-c)/(a-c)}const l=n[i-1];return l+(1-l)*(e-a)/(1-a)}};let Is=_e;Is.LINEAR=0;Is.STEPPED=1;Is.BEZIER=2;Is.BEZIER_SIZE=10*2-1;const Ci=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+Ci.ROTATION]=n}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.rotation=h.data.rotation;return;case A.first:const p=h.data.rotation-h.rotation;h.rotation+=(p-(16384-(16384.499999999996-p/360|0))*360)*r}return}if(n>=o[o.length-Ci.ENTRIES]){let p=o[o.length+Ci.PREV_ROTATION];switch(a){case A.setup:h.rotation=h.data.rotation+p*r;break;case A.first:case A.replace:p+=h.data.rotation-h.rotation,p-=(16384-(16384.499999999996-p/360|0))*360;case A.add:h.rotation+=p*r}return}const c=Ae.binarySearch(o,n,Ci.ENTRIES),d=o[c+Ci.PREV_ROTATION],u=o[c],f=this.getCurvePercent((c>>1)-1,1-(n-u)/(o[c+Ci.PREV_TIME]-u));let m=o[c+Ci.ROTATION]-d;switch(m=d+(m-(16384-(16384.499999999996-m/360|0))*360)*f,a){case A.setup:h.rotation=h.data.rotation+(m-(16384-(16384.499999999996-m/360|0))*360)*r;break;case A.first:case A.replace:m+=h.data.rotation-h.rotation;case A.add:h.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*r}}};let je=Ci;je.ENTRIES=2;je.PREV_TIME=-2;je.PREV_ROTATION=-1;je.ROTATION=1;const cs=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*cs.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,n,i){t*=cs.ENTRIES,this.frames[t]=e,this.frames[t+cs.X]=n,this.frames[t+cs.Y]=i}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.x=h.data.x,h.y=h.data.y;return;case A.first:h.x+=(h.data.x-h.x)*r,h.y+=(h.data.y-h.y)*r}return}let c=0,d=0;if(n>=o[o.length-cs.ENTRIES])c=o[o.length+cs.PREV_X],d=o[o.length+cs.PREV_Y];else{const u=Ae.binarySearch(o,n,cs.ENTRIES);c=o[u+cs.PREV_X],d=o[u+cs.PREV_Y];const f=o[u],m=this.getCurvePercent(u/cs.ENTRIES-1,1-(n-f)/(o[u+cs.PREV_TIME]-f));c+=(o[u+cs.X]-c)*m,d+=(o[u+cs.Y]-d)*m}switch(a){case A.setup:h.x=h.data.x+c*r,h.y=h.data.y+d*r;break;case A.first:case A.replace:h.x+=(h.data.x+c-h.x)*r,h.y+=(h.data.y+d-h.y)*r;break;case A.add:h.x+=c*r,h.y+=d*r}}};let Vs=cs;Vs.ENTRIES=3;Vs.PREV_TIME=-3;Vs.PREV_X=-2;Vs.PREV_Y=-1;Vs.X=1;Vs.Y=2;let Md=class hn extends Vs{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case A.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,d=0;if(n>=o[o.length-hn.ENTRIES])c=o[o.length+hn.PREV_X]*h.data.scaleX,d=o[o.length+hn.PREV_Y]*h.data.scaleY;else{const u=Ae.binarySearch(o,n,hn.ENTRIES);c=o[u+hn.PREV_X],d=o[u+hn.PREV_Y];const f=o[u],m=this.getCurvePercent(u/hn.ENTRIES-1,1-(n-f)/(o[u+hn.PREV_TIME]-f));c=(c+(o[u+hn.X]-c)*m)*h.data.scaleX,d=(d+(o[u+hn.Y]-d)*m)*h.data.scaleY}if(r==1)a==A.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=d-h.data.scaleY):(h.scaleX=c,h.scaleY=d);else{let u=0,f=0;if(l==Ft.mixOut)switch(a){case A.setup:u=h.data.scaleX,f=h.data.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-u)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-f)*r;break;case A.first:case A.replace:u=h.scaleX,f=h.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-u)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-f)*r;break;case A.add:u=h.scaleX,f=h.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-h.data.scaleX)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-h.data.scaleY)*r}else switch(a){case A.setup:u=Math.abs(h.data.scaleX)*I.signum(c),f=Math.abs(h.data.scaleY)*I.signum(d),h.scaleX=u+(c-u)*r,h.scaleY=f+(d-f)*r;break;case A.first:case A.replace:u=Math.abs(h.scaleX)*I.signum(c),f=Math.abs(h.scaleY)*I.signum(d),h.scaleX=u+(c-u)*r,h.scaleY=f+(d-f)*r;break;case A.add:u=I.signum(c),f=I.signum(d),h.scaleX=Math.abs(h.scaleX)*u+(c-Math.abs(h.data.scaleX)*u)*r,h.scaleY=Math.abs(h.scaleY)*f+(d-Math.abs(h.data.scaleY)*f)*r}}}},Id=class cn extends Vs{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case A.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,d=0;if(n>=o[o.length-cn.ENTRIES])c=o[o.length+cn.PREV_X],d=o[o.length+cn.PREV_Y];else{const u=Ae.binarySearch(o,n,cn.ENTRIES);c=o[u+cn.PREV_X],d=o[u+cn.PREV_Y];const f=o[u],m=this.getCurvePercent(u/cn.ENTRIES-1,1-(n-f)/(o[u+cn.PREV_TIME]-f));c=c+(o[u+cn.X]-c)*m,d=d+(o[u+cn.Y]-d)*m}switch(a){case A.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+d*r;break;case A.first:case A.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+d-h.shearY)*r;break;case A.add:h.shearX+=c*r,h.shearY+=d*r}}};const oe=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*oe.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,n,i,r,a){t*=oe.ENTRIES,this.frames[t]=e,this.frames[t+oe.R]=n,this.frames[t+oe.G]=i,this.frames[t+oe.B]=r,this.frames[t+oe.A]=a}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.color.setFromColor(o.data.color);return;case A.first:const m=o.color,p=o.data.color;m.add((p.r-m.r)*r,(p.g-m.g)*r,(p.b-m.b)*r,(p.a-m.a)*r)}return}let c=0,d=0,u=0,f=0;if(n>=h[h.length-oe.ENTRIES]){const m=h.length;c=h[m+oe.PREV_R],d=h[m+oe.PREV_G],u=h[m+oe.PREV_B],f=h[m+oe.PREV_A]}else{const m=Ae.binarySearch(h,n,oe.ENTRIES);c=h[m+oe.PREV_R],d=h[m+oe.PREV_G],u=h[m+oe.PREV_B],f=h[m+oe.PREV_A];const p=h[m],g=this.getCurvePercent(m/oe.ENTRIES-1,1-(n-p)/(h[m+oe.PREV_TIME]-p));c+=(h[m+oe.R]-c)*g,d+=(h[m+oe.G]-d)*g,u+=(h[m+oe.B]-u)*g,f+=(h[m+oe.A]-f)*g}if(r==1)o.color.set(c,d,u,f);else{const m=o.color;a==A.setup&&m.setFromColor(o.data.color),m.add((c-m.r)*r,(d-m.g)*r,(u-m.b)*r,(f-m.a)*r)}}};let bs=oe;bs.ENTRIES=5;bs.PREV_TIME=-5;bs.PREV_R=-4;bs.PREV_G=-3;bs.PREV_B=-2;bs.PREV_A=-1;bs.R=1;bs.G=2;bs.B=3;bs.A=4;const Xt=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*Xt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,n,i,r,a,l,o,h){t*=Xt.ENTRIES,this.frames[t]=e,this.frames[t+Xt.R]=n,this.frames[t+Xt.G]=i,this.frames[t+Xt.B]=r,this.frames[t+Xt.A]=a,this.frames[t+Xt.R2]=l,this.frames[t+Xt.G2]=o,this.frames[t+Xt.B2]=h}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.color.setFromColor(o.data.color),o.darkColor.setFromColor(o.data.darkColor);return;case A.first:const v=o.color,b=o.darkColor,x=o.data.color,y=o.data.darkColor;v.add((x.r-v.r)*r,(x.g-v.g)*r,(x.b-v.b)*r,(x.a-v.a)*r),b.add((y.r-b.r)*r,(y.g-b.g)*r,(y.b-b.b)*r,0)}return}let c=0,d=0,u=0,f=0,m=0,p=0,g=0;if(n>=h[h.length-Xt.ENTRIES]){const v=h.length;c=h[v+Xt.PREV_R],d=h[v+Xt.PREV_G],u=h[v+Xt.PREV_B],f=h[v+Xt.PREV_A],m=h[v+Xt.PREV_R2],p=h[v+Xt.PREV_G2],g=h[v+Xt.PREV_B2]}else{const v=Ae.binarySearch(h,n,Xt.ENTRIES);c=h[v+Xt.PREV_R],d=h[v+Xt.PREV_G],u=h[v+Xt.PREV_B],f=h[v+Xt.PREV_A],m=h[v+Xt.PREV_R2],p=h[v+Xt.PREV_G2],g=h[v+Xt.PREV_B2];const b=h[v],x=this.getCurvePercent(v/Xt.ENTRIES-1,1-(n-b)/(h[v+Xt.PREV_TIME]-b));c+=(h[v+Xt.R]-c)*x,d+=(h[v+Xt.G]-d)*x,u+=(h[v+Xt.B]-u)*x,f+=(h[v+Xt.A]-f)*x,m+=(h[v+Xt.R2]-m)*x,p+=(h[v+Xt.G2]-p)*x,g+=(h[v+Xt.B2]-g)*x}if(r==1)o.color.set(c,d,u,f),o.darkColor.set(m,p,g,1);else{const v=o.color,b=o.darkColor;a==A.setup&&(v.setFromColor(o.data.color),b.setFromColor(o.data.darkColor)),v.add((c-v.r)*r,(d-v.g)*r,(u-v.b)*r,(f-v.a)*r),b.add((m-b.r)*r,(p-b.g)*r,(g-b.b)*r,0)}}};let Ce=Xt;Ce.ENTRIES=8;Ce.PREV_TIME=-8;Ce.PREV_R=-7;Ce.PREV_G=-6;Ce.PREV_B=-5;Ce.PREV_A=-4;Ce.PREV_R2=-3;Ce.PREV_G2=-2;Ce.PREV_B2=-1;Ce.R=1;Ce.G=2;Ce.B=3;Ce.A=4;Ce.R2=5;Ce.G2=6;Ce.B2=7;let dr=class{constructor(t){this.frames=$.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;if(l==Ft.mixOut){a==A.setup&&this.setAttachment(t,o,o.data.attachmentName);return}const h=this.frames;if(n<h[0]){(a==A.setup||a==A.first)&&this.setAttachment(t,o,o.data.attachmentName);return}let c=0;n>=h[h.length-1]?c=h.length-1:c=Ae.binarySearch(h,n,1)-1;const d=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}setAttachment(t,e,n){e.setAttachment(n==null?null:t.getAttachment(this.slotIndex,n))}},Wp=null,Rd=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t),this.frameVertices=new Array(t),Wp==null&&(Wp=$.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,n){this.frames[t]=e,this.frameVertices[t]=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.getAttachment();if(!(h instanceof Hi)||h.deformAttachment!=this.attachment)return;const c=o.deform;c.length==0&&(a=A.setup);const d=this.frameVertices,u=d[0].length,f=this.frames;if(n<f[0]){const y=h;switch(a){case A.setup:c.length=0;return;case A.first:if(r==1){c.length=0;break}const w=$.setArraySize(c,u);if(y.bones==null){const _=y.vertices;for(let E=0;E<u;E++)w[E]+=(_[E]-w[E])*r}else{r=1-r;for(let _=0;_<u;_++)w[_]*=r}}return}const m=$.setArraySize(c,u);if(n>=f[f.length-1]){const y=d[f.length-1];if(r==1)if(a==A.add){const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++)m[E]+=y[E]-_[E]}else for(let _=0;_<u;_++)m[_]+=y[_]}else $.arrayCopy(y,0,m,0,u);else switch(a){case A.setup:{const _=h;if(_.bones==null){const E=_.vertices;for(let T=0;T<u;T++){const C=E[T];m[T]=C+(y[T]-C)*r}}else for(let E=0;E<u;E++)m[E]=y[E]*r;break}case A.first:case A.replace:for(let _=0;_<u;_++)m[_]+=(y[_]-m[_])*r;break;case A.add:const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++)m[E]+=(y[E]-_[E])*r}else for(let _=0;_<u;_++)m[_]+=y[_]*r}return}const p=Ae.binarySearch(f,n),g=d[p-1],v=d[p],b=f[p],x=this.getCurvePercent(p-1,1-(n-b)/(f[p-1]-b));if(r==1)if(a==A.add){const y=h;if(y.bones==null){const w=y.vertices;for(let _=0;_<u;_++){const E=g[_];m[_]+=E+(v[_]-E)*x-w[_]}}else for(let w=0;w<u;w++){const _=g[w];m[w]+=_+(v[w]-_)*x}}else for(let y=0;y<u;y++){const w=g[y];m[y]=w+(v[y]-w)*x}else switch(a){case A.setup:{const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++){const T=g[E],C=_[E];m[E]=C+(T+(v[E]-T)*x-C)*r}}else for(let _=0;_<u;_++){const E=g[_];m[_]=(E+(v[_]-E)*x)*r}break}case A.first:case A.replace:for(let w=0;w<u;w++){const _=g[w];m[w]+=(_+(v[w]-_)*x-m[w])*r}break;case A.add:const y=h;if(y.bones==null){const w=y.vertices;for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(v[_]-E)*x-w[_])*r}}else for(let w=0;w<u;w++){const _=g[w];m[w]+=(_+(v[w]-_)*x)*r}}}},vh=class{constructor(t){this.frames=$.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,i,r,a,l){if(i==null)return;const o=this.frames,h=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,i,r,a,l),e=-1;else if(e>=o[h-1])return;if(n<o[0])return;let c=0;if(e<o[0])c=0;else{c=Ae.binarySearch(o,e);const d=o[c];for(;c>0&&o[c-1]==d;)c--}for(;c<h&&n>=o[c];c++)i.push(this.events[c])}},ro=class{constructor(t){this.frames=$.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,i,r,a,l){const o=t.drawOrder,h=t.slots;if(l==Ft.mixOut&&a==A.setup){$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const c=this.frames;if(n<c[0]){(a==A.setup||a==A.first)&&$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let d=0;n>=c[c.length-1]?d=c.length-1:d=Ae.binarySearch(c,n)-1;const u=this.drawOrders[d];if(u==null)$.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=u.length;f<m;f++)o[f]=h[u[f]]}};const Wt=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*Wt.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,n,i,r,a,l){t*=Wt.ENTRIES,this.frames[t]=e,this.frames[t+Wt.MIX]=n,this.frames[t+Wt.SOFTNESS]=i,this.frames[t+Wt.BEND_DIRECTION]=r,this.frames[t+Wt.COMPRESS]=a?1:0,this.frames[t+Wt.STRETCH]=l?1:0}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.ikConstraints[this.ikConstraintIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch;return;case A.first:h.mix+=(h.data.mix-h.mix)*r,h.softness+=(h.data.softness-h.softness)*r,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}return}if(n>=o[o.length-Wt.ENTRIES]){a==A.setup?(h.mix=h.data.mix+(o[o.length+Wt.PREV_MIX]-h.data.mix)*r,h.softness=h.data.softness+(o[o.length+Wt.PREV_SOFTNESS]-h.data.softness)*r,l==Ft.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=o[o.length+Wt.PREV_BEND_DIRECTION],h.compress=o[o.length+Wt.PREV_COMPRESS]!=0,h.stretch=o[o.length+Wt.PREV_STRETCH]!=0)):(h.mix+=(o[o.length+Wt.PREV_MIX]-h.mix)*r,h.softness+=(o[o.length+Wt.PREV_SOFTNESS]-h.softness)*r,l==Ft.mixIn&&(h.bendDirection=o[o.length+Wt.PREV_BEND_DIRECTION],h.compress=o[o.length+Wt.PREV_COMPRESS]!=0,h.stretch=o[o.length+Wt.PREV_STRETCH]!=0));return}const c=Ae.binarySearch(o,n,Wt.ENTRIES),d=o[c+Wt.PREV_MIX],u=o[c+Wt.PREV_SOFTNESS],f=o[c],m=this.getCurvePercent(c/Wt.ENTRIES-1,1-(n-f)/(o[c+Wt.PREV_TIME]-f));a==A.setup?(h.mix=h.data.mix+(d+(o[c+Wt.MIX]-d)*m-h.data.mix)*r,h.softness=h.data.softness+(u+(o[c+Wt.SOFTNESS]-u)*m-h.data.softness)*r,l==Ft.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=o[c+Wt.PREV_BEND_DIRECTION],h.compress=o[c+Wt.PREV_COMPRESS]!=0,h.stretch=o[c+Wt.PREV_STRETCH]!=0)):(h.mix+=(d+(o[c+Wt.MIX]-d)*m-h.mix)*r,h.softness+=(u+(o[c+Wt.SOFTNESS]-u)*m-h.softness)*r,l==Ft.mixIn&&(h.bendDirection=o[c+Wt.PREV_BEND_DIRECTION],h.compress=o[c+Wt.PREV_COMPRESS]!=0,h.stretch=o[c+Wt.PREV_STRETCH]!=0))}};let Qe=Wt;Qe.ENTRIES=6;Qe.PREV_TIME=-6;Qe.PREV_MIX=-5;Qe.PREV_SOFTNESS=-4;Qe.PREV_BEND_DIRECTION=-3;Qe.PREV_COMPRESS=-2;Qe.PREV_STRETCH=-1;Qe.MIX=1;Qe.SOFTNESS=2;Qe.BEND_DIRECTION=3;Qe.COMPRESS=4;Qe.STRETCH=5;const ae=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*ae.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,n,i,r,a){t*=ae.ENTRIES,this.frames[t]=e,this.frames[t+ae.ROTATE]=n,this.frames[t+ae.TRANSLATE]=i,this.frames[t+ae.SCALE]=r,this.frames[t+ae.SHEAR]=a}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.transformConstraints[this.transformConstraintIndex];if(!h.active)return;if(n<o[0]){const m=h.data;switch(a){case A.setup:h.rotateMix=m.rotateMix,h.translateMix=m.translateMix,h.scaleMix=m.scaleMix,h.shearMix=m.shearMix;return;case A.first:h.rotateMix+=(m.rotateMix-h.rotateMix)*r,h.translateMix+=(m.translateMix-h.translateMix)*r,h.scaleMix+=(m.scaleMix-h.scaleMix)*r,h.shearMix+=(m.shearMix-h.shearMix)*r}return}let c=0,d=0,u=0,f=0;if(n>=o[o.length-ae.ENTRIES]){const m=o.length;c=o[m+ae.PREV_ROTATE],d=o[m+ae.PREV_TRANSLATE],u=o[m+ae.PREV_SCALE],f=o[m+ae.PREV_SHEAR]}else{const m=Ae.binarySearch(o,n,ae.ENTRIES);c=o[m+ae.PREV_ROTATE],d=o[m+ae.PREV_TRANSLATE],u=o[m+ae.PREV_SCALE],f=o[m+ae.PREV_SHEAR];const p=o[m],g=this.getCurvePercent(m/ae.ENTRIES-1,1-(n-p)/(o[m+ae.PREV_TIME]-p));c+=(o[m+ae.ROTATE]-c)*g,d+=(o[m+ae.TRANSLATE]-d)*g,u+=(o[m+ae.SCALE]-u)*g,f+=(o[m+ae.SHEAR]-f)*g}if(a==A.setup){const m=h.data;h.rotateMix=m.rotateMix+(c-m.rotateMix)*r,h.translateMix=m.translateMix+(d-m.translateMix)*r,h.scaleMix=m.scaleMix+(u-m.scaleMix)*r,h.shearMix=m.shearMix+(f-m.shearMix)*r}else h.rotateMix+=(c-h.rotateMix)*r,h.translateMix+=(d-h.translateMix)*r,h.scaleMix+=(u-h.scaleMix)*r,h.shearMix+=(f-h.shearMix)*r}};let vs=ae;vs.ENTRIES=5;vs.PREV_TIME=-5;vs.PREV_ROTATE=-4;vs.PREV_TRANSLATE=-3;vs.PREV_SCALE=-2;vs.PREV_SHEAR=-1;vs.ROTATE=1;vs.TRANSLATE=2;vs.SCALE=3;vs.SHEAR=4;const un=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*un.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,n){t*=un.ENTRIES,this.frames[t]=e,this.frames[t+un.VALUE]=n}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.position=h.data.position;return;case A.first:h.position+=(h.data.position-h.position)*r}return}let c=0;if(n>=o[o.length-un.ENTRIES])c=o[o.length+un.PREV_VALUE];else{const d=Ae.binarySearch(o,n,un.ENTRIES);c=o[d+un.PREV_VALUE];const u=o[d],f=this.getCurvePercent(d/un.ENTRIES-1,1-(n-u)/(o[d+un.PREV_TIME]-u));c+=(o[d+un.VALUE]-c)*f}a==A.setup?h.position=h.data.position+(c-h.data.position)*r:h.position+=(c-h.position)*r}};let Zn=un;Zn.ENTRIES=2;Zn.PREV_TIME=-2;Zn.PREV_VALUE=-1;Zn.VALUE=1;let Pd=class Mi extends Zn{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.spacing=h.data.spacing;return;case A.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(n>=o[o.length-Mi.ENTRIES])c=o[o.length+Mi.PREV_VALUE];else{const d=Ae.binarySearch(o,n,Mi.ENTRIES);c=o[d+Mi.PREV_VALUE];const u=o[d],f=this.getCurvePercent(d/Mi.ENTRIES-1,1-(n-u)/(o[d+Mi.PREV_TIME]-u));c+=(o[d+Mi.VALUE]-c)*f}a==A.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const us=class extends Is{constructor(t){super(t),this.frames=$.newFloatArray(t*us.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,n,i){t*=us.ENTRIES,this.frames[t]=e,this.frames[t+us.ROTATE]=n,this.frames[t+us.TRANSLATE]=i}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(n<o[0]){switch(a){case A.setup:h.rotateMix=h.data.rotateMix,h.translateMix=h.data.translateMix;return;case A.first:h.rotateMix+=(h.data.rotateMix-h.rotateMix)*r,h.translateMix+=(h.data.translateMix-h.translateMix)*r}return}let c=0,d=0;if(n>=o[o.length-us.ENTRIES])c=o[o.length+us.PREV_ROTATE],d=o[o.length+us.PREV_TRANSLATE];else{const u=Ae.binarySearch(o,n,us.ENTRIES);c=o[u+us.PREV_ROTATE],d=o[u+us.PREV_TRANSLATE];const f=o[u],m=this.getCurvePercent(u/us.ENTRIES-1,1-(n-f)/(o[u+us.PREV_TIME]-f));c+=(o[u+us.ROTATE]-c)*m,d+=(o[u+us.TRANSLATE]-d)*m}a==A.setup?(h.rotateMix=h.data.rotateMix+(c-h.data.rotateMix)*r,h.translateMix=h.data.translateMix+(d-h.data.translateMix)*r):(h.rotateMix+=(c-h.rotateMix)*r,h.translateMix+=(d-h.translateMix)*r)}};let Rn=us;Rn.ENTRIES=3;Rn.PREV_TIME=-3;Rn.PREV_ROTATE=-2;Rn.PREV_TRANSLATE=-1;Rn.ROTATE=1;Rn.TRANSLATE=2;const le=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new kd(this),this.propertyIDs=new yx,this.animationsChanged=!1,this.trackEntryPool=new yh(()=>new wh),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let a=t*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}let l=r.next;if(l!=null){const o=r.trackLast-l.delay;if(o>=0){for(l.delay=0,l.trackTime+=r.timeScale==0?0:(o/r.timeScale+t)*l.timeScale,r.trackTime+=a,this.setCurrent(n,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){e[n]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,t)){let o=r.mixingFrom;for(r.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}r.trackTime+=a}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(n==null)return!0;const i=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((n.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=n.mixingFrom,n.mixingFrom!=null&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let i=!1;for(let l=0,o=n.length;l<o;l++){const h=n[l];if(h==null||h.delay>0)continue;i=!0;const c=l==0?A.first:h.mixBlend;let d=h.alpha;h.mixingFrom!=null?d*=this.applyMixingFrom(h,t,c):h.trackTime>=h.trackEnd&&h.next==null&&(d=0);const u=h.animationLast,f=h.getAnimationTime(),m=h.animation.timelines.length,p=h.animation.timelines;if(l==0&&d==1||c==A.add)for(let g=0;g<m;g++){const v=p[g];v instanceof dr?this.applyAttachmentTimeline(v,t,f,c,!0):v.apply(t,u,f,e,d,c,Ft.mixIn)}else{const g=h.timelineMode,v=h.timelinesRotation.length==0;v&&$.setArraySize(h.timelinesRotation,m<<1,null);const b=h.timelinesRotation;for(let x=0;x<m;x++){const y=p[x],w=g[x]==le.SUBSEQUENT?c:A.setup;y instanceof je?this.applyRotateTimeline(y,t,f,d,w,b,x<<1,v):y instanceof dr?this.applyAttachmentTimeline(y,t,f,c,!0):y.apply(t,u,f,e,d,w,Ft.mixIn)}}this.queueEvents(h,f),e.length=0,h.nextAnimationLast=f,h.nextTrackLast=h.trackTime}const r=this.unkeyedState+le.SETUP,a=t.slots;for(let l=0,o=t.slots.length;l<o;l++){const h=a[l];if(h.attachmentState==r){const c=h.data.attachmentName;h.setAttachment(c==null?null:t.getAttachment(h.data.index,c))}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(t,e,n){const i=t.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,e,n);let r=0;t.mixDuration==0?(r=1,n==A.first&&(n=A.setup)):(r=t.mixTime/t.mixDuration,r>1&&(r=1),n!=A.first&&(n=i.mixBlend));const a=r<i.eventThreshold?this.events:null,l=r<i.attachmentThreshold,o=r<i.drawOrderThreshold,h=i.animationLast,c=i.getAnimationTime(),d=i.animation.timelines.length,u=i.animation.timelines,f=i.alpha*t.interruptAlpha,m=f*(1-r);if(n==A.add)for(let p=0;p<d;p++)u[p].apply(e,h,c,a,m,n,Ft.mixOut);else{const p=i.timelineMode,g=i.timelineHoldMix,v=i.timelinesRotation.length==0;v&&$.setArraySize(i.timelinesRotation,d<<1,null);const b=i.timelinesRotation;i.totalAlpha=0;for(let x=0;x<d;x++){const y=u[x];let w=Ft.mixOut,_,E=0;switch(p[x]){case le.SUBSEQUENT:if(!o&&y instanceof ro)continue;_=n,E=m;break;case le.FIRST:_=A.setup,E=m;break;case le.HOLD_SUBSEQUENT:_=n,E=f;break;case le.HOLD_FIRST:_=A.setup,E=f;break;default:_=A.setup;const T=g[x];E=f*Math.max(0,1-T.mixTime/T.mixDuration);break}i.totalAlpha+=E,y instanceof je?this.applyRotateTimeline(y,e,c,E,_,b,x<<1,v):y instanceof dr?this.applyAttachmentTimeline(y,e,c,_,l):(o&&y instanceof ro&&_==A.setup&&(w=Ft.mixIn),y.apply(e,h,c,a,E,_,w))}}return t.mixDuration>0&&this.queueEvents(i,c),this.events.length=0,i.nextAnimationLast=c,i.nextTrackLast=i.trackTime,r}applyAttachmentTimeline(t,e,n,i,r){const a=e.slots[t.slotIndex];if(!a.bone.active)return;const l=t.frames;if(n<l[0])(i==A.setup||i==A.first)&&this.setAttachment(e,a,a.data.attachmentName,r);else{let o;n>=l[l.length-1]?o=l.length-1:o=Ae.binarySearch(l,n)-1,this.setAttachment(e,a,t.attachmentNames[o],r)}a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+le.SETUP)}setAttachment(t,e,n,i){e.setAttachment(n==null?null:t.getAttachment(e.data.index,n)),i&&(e.attachmentState=this.unkeyedState+le.CURRENT)}applyRotateTimeline(t,e,n,i,r,a,l,o){if(o&&(a[l]=0),i==1){t.apply(e,0,n,null,1,r,Ft.mixIn);return}const h=t,c=h.frames,d=e.bones[h.boneIndex];if(!d.active)return;let u=0,f=0;if(n<c[0])switch(r){case A.setup:d.rotation=d.data.rotation;default:return;case A.first:u=d.rotation,f=d.data.rotation}else if(u=r==A.setup?d.data.rotation:d.rotation,n>=c[c.length-je.ENTRIES])f=d.data.rotation+c[c.length+je.PREV_ROTATION];else{const g=Ae.binarySearch(c,n,je.ENTRIES),v=c[g+je.PREV_ROTATION],b=c[g],x=h.getCurvePercent((g>>1)-1,1-(n-b)/(c[g+je.PREV_TIME]-b));f=c[g+je.ROTATION]-v,f-=(16384-(16384.499999999996-f/360|0))*360,f=v+f*x+d.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-u;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=a[l];else{let g=0,v=0;o?(g=0,v=p):(g=a[l],v=a[l+1]);const b=p>0;let x=g>=0;I.signum(v)!=I.signum(p)&&Math.abs(v)<=90&&(Math.abs(g)>180&&(g+=360*I.signum(g)),x=b),m=p+g-g%360,x!=b&&(m+=360*I.signum(g)),a[l]=m}a[l+1]=p,u+=m*i,d.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(t,e){const n=t.animationStart,i=t.animationEnd,r=i-n,a=t.trackLast%r,l=this.events;let o=0;const h=l.length;for(;o<h;o++){const d=l[o];if(d.time<a)break;d.time>i||this.queue.event(t,d)}let c=!1;for(t.loop?c=r==0||a>t.trackTime%r:c=e>=i&&t.animationLast<i,c&&this.queue.complete(t);o<h;o++)l[o].time<n||this.queue.event(t,l[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let n=e;for(;;){const i=n.mixingFrom;if(i==null)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const i=this.expandToIndex(t);this.tracks[t]=e,i!=null&&(n&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n){const i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,i,n)}setAnimationWith(t,e,n){if(e==null)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(t);r!=null&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,i=!1):this.disposeNext(r));const a=this.trackEntry(t,e,n,r);return this.setCurrent(t,a,i),this.queue.drain(),a}addAnimation(t,e,n,i){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,r,n,i)}addAnimationWith(t,e,n,i){if(e==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r!=null)for(;r.next!=null;)r=r.next;const a=this.trackEntry(t,e,n,r);if(r==null)this.setCurrent(t,a,!0),this.queue.drain();else if(r.next=a,i<=0){const l=r.animationEnd-r.animationStart;l!=0?(r.loop?i+=l*(1+(r.trackTime/l|0)):i+=Math.max(l,r.trackTime),i-=this.data.getMix(r.animation,e)):i=r.trackTime}return a.delay=i,a}setEmptyAnimation(t,e){const n=this.setAnimationWith(t,le.emptyAnimation,!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e,n){n<=0&&(n-=e);const i=this.addAnimationWith(t,le.emptyAnimation,!1,n);return i.mixDuration=e,i.trackEnd=e,i}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let n=0,i=this.tracks.length;n<i;n++){const r=this.tracks[n];r!=null&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:($.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,i){const r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=n,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=i==null?0:this.data.getMix(i.animation,e),r.mixBlend=A.replace,r}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let n=this.tracks[t];if(n!=null){for(;n.mixingFrom!=null;)n=n.mixingFrom;do(n.mixingFrom==null||n.mixBlend!=A.add)&&this.computeHold(n),n=n.mixingTo;while(n!=null)}}}computeHold(t){const e=t.mixingTo,n=t.animation.timelines,i=t.animation.timelines.length,r=$.setArraySize(t.timelineMode,i);t.timelineHoldMix.length=0;const a=$.setArraySize(t.timelineHoldMix,i),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<i;o++)r[o]=l.add(n[o].getPropertyId())?le.HOLD_FIRST:le.HOLD_SUBSEQUENT;return}t:for(let o=0;o<i;o++){const h=n[o],c=h.getPropertyId();if(!l.add(c))r[o]=le.SUBSEQUENT;else if(e==null||h instanceof dr||h instanceof ro||h instanceof vh||!e.animation.hasTimeline(c))r[o]=le.FIRST;else{for(let d=e.mixingTo;d!=null;d=d.mixingTo)if(!d.animation.hasTimeline(c)){if(t.mixDuration>0){r[o]=le.HOLD_MIX,a[o]=d;continue t}break}r[o]=le.HOLD_FIRST}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){le.deprecatedWarning1||(le.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,i){le.deprecatedWarning2||(le.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,i)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return le.deprecatedWarning3||(le.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let $s=le;$s.emptyAnimation=new Ae("<empty>",[],0);$s.SUBSEQUENT=0;$s.FIRST=1;$s.HOLD_SUBSEQUENT=2;$s.HOLD_FIRST=3;$s.HOLD_MIX=4;$s.SETUP=1;$s.CURRENT=2;$s.deprecatedWarning1=!1;$s.deprecatedWarning2=!1;$s.deprecatedWarning3=!1;const ri=class{constructor(){this.mixBlend=A.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return ri.deprecatedWarning1||(ri.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){ri.deprecatedWarning1||(ri.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return ri.deprecatedWarning2||(ri.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){ri.deprecatedWarning2||(ri.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let wh=ri;wh.deprecatedWarning1=!1;wh.deprecatedWarning2=!1;const Uu=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(_s.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(_s.interrupt),this.objects.push(t)}end(t){this.objects.push(_s.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(_s.dispose),this.objects.push(t)}complete(t){this.objects.push(_s.complete),this.objects.push(t)}event(t,e){this.objects.push(_s.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return Uu.deprecatedWarning1||(Uu.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const i=t[n],r=t[n+1];switch(i){case _s.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let o=0;o<e.length;o++)e[o].start&&e[o].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case _s.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(r);break;case _s.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let o=0;o<e.length;o++)e[o].end&&e[o].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case _s.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(r);this.animState.trackEntryPool.free(r);break;case _s.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let o=0;o<e.length;o++)e[o].complete&&e[o].complete(r);const a=I.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,a),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,a);break;case _s.event:const l=t[n+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,l);for(let o=0;o<e.length;o++)e[o].event&&e[o].event(r,l);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,l);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let kd=Uu;kd.deprecatedWarning1=!1;var _s=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(_s||{});let eC=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};const Xu=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const i=this.skeletonData.findAnimation(t);if(i==null)throw new Error(`Animation not found: ${t}`);const r=this.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);this.setMixWith(i,r,n)}setMixByName(t,e,n){Xu.deprecatedWarning1||(Xu.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,n)}setMixWith(t,e,n){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");const i=`${t.name}.${e.name}`;this.animationToMixTime[i]=n}getMix(t,e){const n=`${t.name}.${e.name}`,i=this.animationToMixTime[n];return i===void 0?this.defaultMix:i}};let Fd=Xu;Fd.deprecatedWarning1=!1;let Dd=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,n){const i=this.atlas.findRegion(n);if(i==null)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);const r=new Rt(e);return r.region=i,r}newMeshAttachment(t,e,n){const i=this.atlas.findRegion(n);if(i==null)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);const r=new bh(e);return r.region=i,r}newBoundingBoxAttachment(t,e){return new Sx(e)}newPathAttachment(t,e){return new ma(e)}newPointAttachment(t,e){return new Ix(e)}newClippingAttachment(t,e){return new Ax(e)}},Yu=class{constructor(t,e,n){if(this.matrix=new se,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,i,r,a,l){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=r,this.ashearX=a,this.ashearY=l,this.appliedValid=!0;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(o==null){const g=this.skeleton,v=n+90+l;h.a=I.cosDeg(n+a)*i*c,h.c=I.cosDeg(v)*r*c,h.b=I.sinDeg(n+a)*i*d,h.d=I.sinDeg(v)*r*d,h.tx=t*c+g.x,h.ty=e*d+g.y;return}let u=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=u*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case Tt.Normal:{const g=n+90+l,v=I.cosDeg(n+a)*i,b=I.cosDeg(g)*r,x=I.sinDeg(n+a)*i,y=I.sinDeg(g)*r;h.a=u*v+f*x,h.c=u*b+f*y,h.b=m*v+p*x,h.d=m*b+p*y;return}case Tt.OnlyTranslation:{const g=n+90+l;h.a=I.cosDeg(n+a)*i,h.c=I.cosDeg(g)*r,h.b=I.sinDeg(n+a)*i,h.d=I.sinDeg(g)*r;break}case Tt.NoRotationOrReflection:{let g=u*u+m*m,v=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,u/=this.skeleton.scaleX,m/=this.skeleton.scaleY,f=m*g,p=u*g,v=Math.atan2(m,u)*I.radDeg):(u=0,m=0,v=90-Math.atan2(p,f)*I.radDeg);const b=n+a-v,x=n+l-v+90,y=I.cosDeg(b)*i,w=I.cosDeg(x)*r,_=I.sinDeg(b)*i,E=I.sinDeg(x)*r;h.a=u*y-f*_,h.c=u*w-f*E,h.b=m*y+p*_,h.d=m*w+p*E;break}case Tt.NoScale:case Tt.NoScaleOrReflection:{const g=I.cosDeg(n),v=I.sinDeg(n);let b=(u*g+f*v)/c,x=(m*g+p*v)/d,y=Math.sqrt(b*b+x*x);y>1e-5&&(y=1/y),b*=y,x*=y,y=Math.sqrt(b*b+x*x),this.data.transformMode==Tt.NoScale&&u*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(y=-y);const w=Math.PI/2+Math.atan2(x,b),_=Math.cos(w)*y,E=Math.sin(w)*y,T=I.cosDeg(a)*i,C=I.cosDeg(90+l)*r,R=I.sinDeg(a)*i,P=I.sinDeg(90+l)*r;h.a=b*T+_*R,h.c=b*C+_*P,h.b=x*T+E*R,h.d=x*C+E*P;break}}h.a*=c,h.c*=c,h.b*=d,h.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*I.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*I.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*I.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*I.radDeg;return}const n=t.matrix,i=1/(n.a*n.d-n.b*n.c),r=e.tx-n.tx,a=e.ty-n.ty;this.ax=r*n.d*i-a*n.c*i,this.ay=a*n.a*i-r*n.b*i;const l=i*n.d,o=i*n.a,h=i*n.c,c=i*n.b,d=l*e.a-h*e.b,u=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*I.radDeg,this.arotation=Math.atan2(f,d)*I.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*I.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=1/(n*a-i*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*i*l,t.y=h*n*l-o*r*l,t}localToWorld(t){const e=this.matrix,n=t.x,i=t.y;return t.x=n*e.a+i*e.c+e.tx,t.y=n*e.b+i*e.d+e.ty,t}worldToLocalRotation(t){const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*n,i.d*n-i.c*e)*I.radDeg}localToWorldRotation(t){const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(n*i.b+e*i.d,n*i.a+e*i.c)*I.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=I.cosDeg(t),o=I.sinDeg(t);e.a=l*n-o*r,e.c=l*i-o*a,e.b=o*n+l*r,e.d=o*i+l*a,this.appliedValid=!1}},Bd=class{constructor(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Tt.Normal,this.skinRequired=!1,this.color=new at,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}},_h=class{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}},Od=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},Nd=class{constructor(t){this.name=t}},Dx=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}}apply1(t,e,n,i,r,a,l){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,h=o.a;let c=o.c;const d=o.b;let u=o.d,f=-t.ashearX-t.arotation,m=0,p=0;switch(t.data.transformMode){case Tt.OnlyTranslation:m=e-t.worldX,p=n-t.worldY;break;case Tt.NoRotationOrReflection:const b=Math.abs(h*u-c*d)/(h*h+d*d),x=h/t.skeleton.scaleX,y=d/t.skeleton.scaleY;c=-y*b*t.skeleton.scaleX,u=x*b*t.skeleton.scaleY,f+=Math.atan2(y,x)*I.radDeg;default:const w=e-o.tx,_=n-o.ty,E=h*u-c*d;m=(w*u-_*c)/E-t.ax,p=(_*h-w*d)/E-t.ay}f+=Math.atan2(p,m)*I.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let g=t.ascaleX,v=t.ascaleY;if(i||r){switch(t.data.transformMode){case Tt.NoScale:case Tt.NoScaleOrReflection:m=e-t.worldX,p=n-t.worldY}const b=t.data.length*g,x=Math.sqrt(m*m+p*p);if(i&&x<b||r&&x>b&&b>1e-4){const y=(x/b-1)*l+1;g*=y,a&&(v*=y)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,g,v,t.ashearX,t.ashearY)}apply2(t,e,n,i,r,a,l,o){if(o==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const h=t.ax,c=t.ay;let d=t.ascaleX,u=d,f=t.ascaleY,m=e.ascaleX;const p=t.matrix;let g=0,v=0,b=0;d<0?(d=-d,g=180,b=-1):(g=0,b=1),f<0&&(f=-f,b=-b),m<0?(m=-m,v=180):v=0;const x=e.ax;let y=0,w=0,_=0,E=p.a,T=p.c,C=p.b,R=p.d;const P=Math.abs(d-f)<=1e-4;P?(y=e.ay,w=E*x+T*y+p.tx,_=C*x+R*y+p.ty):(y=0,w=E*x+p.tx,_=C*x+p.ty);const O=t.parent.matrix;E=O.a,T=O.c,C=O.b,R=O.d;const F=1/(E*R-T*C);let D=w-O.tx,V=_-O.ty;const X=(D*R-V*T)*F-h,U=(V*E-D*C)*F-c,j=Math.sqrt(X*X+U*U);let z=e.data.length*m,N,G;if(j<1e-4){this.apply1(t,n,i,!1,a,!1,o),e.updateWorldTransformWith(x,y,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}D=n-O.tx,V=i-O.ty;let q=(D*R-V*T)*F-h,K=(V*E-D*C)*F-c,Q=q*q+K*K;if(l!=0){l*=d*(m+1)/2;const vt=Math.sqrt(Q),At=vt-j-z*d+l;if(At>0){let _t=Math.min(1,At/(l*2))-1;_t=(At-l*(1-_t*_t))/vt,q-=_t*q,K-=_t*K,Q=q*q+K*K}}t:if(P){z*=d;let vt=(Q-j*j-z*z)/(2*j*z);vt<-1?vt=-1:vt>1&&(vt=1,a&&(u*=(Math.sqrt(Q)/(j+z)-1)*o+1)),G=Math.acos(vt)*r,E=j+z*vt,T=z*Math.sin(G),N=Math.atan2(K*E-q*T,q*E+K*T)}else{E=d*z,T=f*z;const vt=E*E,At=T*T,_t=Math.atan2(K,q);C=At*j*j+vt*Q-vt*At;const Et=-2*At*j,St=At-vt;if(R=Et*Et-4*St*C,R>=0){let it=Math.sqrt(R);Et<0&&(it=-it),it=-(Et+it)/2;const ot=it/St,nt=C/it,gt=Math.abs(ot)<Math.abs(nt)?ot:nt;if(gt*gt<=Q){V=Math.sqrt(Q-gt*gt)*r,N=_t-Math.atan2(V,gt),G=Math.atan2(V/f,(gt-j)/d);break t}}let Ot=I.PI,k=j-E,L=k*k,H=0,et=0,Z=j+E,st=Z*Z,rt=0;C=-E*j/(vt-At),C>=-1&&C<=1&&(C=Math.acos(C),D=E*Math.cos(C)+j,V=T*Math.sin(C),R=D*D+V*V,R<L&&(Ot=C,L=R,k=D,H=V),R>st&&(et=C,st=R,Z=D,rt=V)),Q<=(L+st)/2?(N=_t-Math.atan2(H*r,k),G=Ot*r):(N=_t-Math.atan2(rt*r,Z),G=et*r)}const tt=Math.atan2(y,x)*b;let ht=t.arotation;N=(N-tt)*I.radDeg+g-ht,N>180?N-=360:N<-180&&(N+=360),t.updateWorldTransformWith(h,c,ht+N*o,u,t.ascaleY,0,0),ht=e.arotation,G=((G+tt)*I.radDeg-e.ashearX)*b+v-ht,G>180?G-=360:G<-180&&(G+=360),e.updateWorldTransformWith(x,y,ht+G*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},Ld=class extends _h{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},Vd=class extends _h{constructor(t){super(t,0,!1),this.bones=new Array}};var Ge=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(Ge||{});const or=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,i=t.bones.length;n<i;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof ma))return;const e=this.rotateMix,n=this.translateMix,i=n>0,r=e>0;if(!i&&!r)return;const a=this.data,l=a.spacingMode,o=l==Ge.Length,h=a.rotateMode,c=h==Te.Tangent,d=h==Te.ChainScale,u=this.bones.length,f=c?u:u+1,m=this.bones,p=$.setArraySize(this.spaces,f);let g=null;const v=this.spacing;if(d||o){d&&(g=$.setArraySize(this.lengths,u));for(let E=0,T=f-1;E<T;){const C=m[E],R=C.data.length;if(R<or.epsilon)d&&(g[E]=0),p[++E]=0;else{const P=R*C.matrix.a,O=R*C.matrix.b,F=Math.sqrt(P*P+O*O);d&&(g[E]=F),p[++E]=(o?R+v:v)*F/R}}}else for(let E=1;E<f;E++)p[E]=v;const b=this.computeWorldPositions(t,f,c,a.positionMode==fe.Percent,l==Ge.Percent);let x=b[0],y=b[1],w=a.offsetRotation,_=!1;if(w==0)_=h==Te.Chain;else{_=!1;const E=this.target.bone.matrix;w*=E.a*E.d-E.b*E.c>0?I.degRad:-I.degRad}for(let E=0,T=3;E<u;E++,T+=3){const C=m[E],R=C.matrix;R.tx+=(x-R.tx)*n,R.ty+=(y-R.ty)*n;const P=b[T],O=b[T+1],F=P-x,D=O-y;if(d){const V=g[E];if(V!=0){const X=(Math.sqrt(F*F+D*D)/V-1)*e+1;R.a*=X,R.b*=X}}if(x=P,y=O,r){const V=R.a,X=R.c,U=R.b,j=R.d;let z=0,N=0,G=0;if(c&&(c?z=b[T-1]:p[E+1]==0?z=b[T+2]:z=Math.atan2(D,F)),z-=Math.atan2(U,V),_){N=Math.cos(z),G=Math.sin(z);const q=C.data.length;x+=(q*(N*V-G*U)-F)*e,y+=(q*(G*V+N*U)-D)*e}else z+=w;z>I.PI?z-=I.PI2:z<-I.PI&&(z+=I.PI2),z*=e,N=Math.cos(z),G=Math.sin(z),R.a=N*V-G*U,R.c=N*X-G*j,R.b=G*V+N*U,R.d=G*X+N*j}C.appliedValid=!1}}computeWorldPositions(t,e,n,i,r){const a=this.target;let l=this.position;const o=this.spaces,h=$.setArraySize(this.positions,e*3+2);let c=null;const d=t.closed;let u=t.worldVerticesLength,f=u/6,m=or.NONE;if(!t.constantSpeed){const z=t.lengths;f-=d?1:2;const N=z[f];if(i&&(l*=N),r)for(let G=0;G<e;G++)o[G]*=N;c=$.setArraySize(this.world,8);for(let G=0,q=0,K=0;G<e;G++,q+=3){const Q=o[G];l+=Q;let tt=l;if(d)tt%=N,tt<0&&(tt+=N),K=0;else if(tt<0){m!=or.BEFORE&&(m=or.BEFORE,t.computeWorldVertices(a,2,4,c,0,2)),this.addBeforePosition(tt,c,0,h,q);continue}else if(tt>N){m!=or.AFTER&&(m=or.AFTER,t.computeWorldVertices(a,u-6,4,c,0,2)),this.addAfterPosition(tt-N,c,0,h,q);continue}for(;;K++){const ht=z[K];if(!(tt>ht)){if(K==0)tt/=ht;else{const vt=z[K-1];tt=(tt-vt)/(ht-vt)}break}}K!=m&&(m=K,d&&K==f?(t.computeWorldVertices(a,u-4,4,c,0,2),t.computeWorldVertices(a,0,4,c,4,2)):t.computeWorldVertices(a,K*6+2,8,c,0,2)),this.addCurvePosition(tt,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,q,n||G>0&&Q==0)}return h}d?(u+=2,c=$.setArraySize(this.world,u),t.computeWorldVertices(a,2,u-4,c,0,2),t.computeWorldVertices(a,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(f--,u-=4,c=$.setArraySize(this.world,u),t.computeWorldVertices(a,2,u,c,0,2));const p=$.setArraySize(this.curves,f);let g=0,v=c[0],b=c[1],x=0,y=0,w=0,_=0,E=0,T=0,C=0,R=0,P=0,O=0,F=0,D=0,V=0,X=0;for(let z=0,N=2;z<f;z++,N+=6)x=c[N],y=c[N+1],w=c[N+2],_=c[N+3],E=c[N+4],T=c[N+5],C=(v-x*2+w)*.1875,R=(b-y*2+_)*.1875,P=((x-w)*3-v+E)*.09375,O=((y-_)*3-b+T)*.09375,F=C*2+P,D=R*2+O,V=(x-v)*.75+C+P*.16666667,X=(y-b)*.75+R+O*.16666667,g+=Math.sqrt(V*V+X*X),V+=F,X+=D,F+=P,D+=O,g+=Math.sqrt(V*V+X*X),V+=F,X+=D,g+=Math.sqrt(V*V+X*X),V+=F+P,X+=D+O,g+=Math.sqrt(V*V+X*X),p[z]=g,v=E,b=T;if(i&&(l*=g),r)for(let z=0;z<e;z++)o[z]*=g;const U=this.segments;let j=0;for(let z=0,N=0,G=0,q=0;z<e;z++,N+=3){const K=o[z];l+=K;let Q=l;if(d)Q%=g,Q<0&&(Q+=g),G=0;else if(Q<0){this.addBeforePosition(Q,c,0,h,N);continue}else if(Q>g){this.addAfterPosition(Q-g,c,u-4,h,N);continue}for(;;G++){const tt=p[G];if(!(Q>tt)){if(G==0)Q/=tt;else{const ht=p[G-1];Q=(Q-ht)/(tt-ht)}break}}if(G!=m){m=G;let tt=G*6;for(v=c[tt],b=c[tt+1],x=c[tt+2],y=c[tt+3],w=c[tt+4],_=c[tt+5],E=c[tt+6],T=c[tt+7],C=(v-x*2+w)*.03,R=(b-y*2+_)*.03,P=((x-w)*3-v+E)*.006,O=((y-_)*3-b+T)*.006,F=C*2+P,D=R*2+O,V=(x-v)*.3+C+P*.16666667,X=(y-b)*.3+R+O*.16666667,j=Math.sqrt(V*V+X*X),U[0]=j,tt=1;tt<8;tt++)V+=F,X+=D,F+=P,D+=O,j+=Math.sqrt(V*V+X*X),U[tt]=j;V+=F,X+=D,j+=Math.sqrt(V*V+X*X),U[8]=j,V+=F+P,X+=D+O,j+=Math.sqrt(V*V+X*X),U[9]=j,q=0}for(Q*=j;;q++){const tt=U[q];if(!(Q>tt)){if(q==0)Q/=tt;else{const ht=U[q-1];Q=q+(Q-ht)/(tt-ht)}break}}this.addCurvePosition(Q*.1,v,b,x,y,w,_,E,T,h,N,n||z>0&&K==0)}return h}addBeforePosition(t,e,n,i,r){const a=e[n],l=e[n+1],o=e[n+2]-a,h=e[n+3]-l,c=Math.atan2(h,o);i[r]=a+t*Math.cos(c),i[r+1]=l+t*Math.sin(c),i[r+2]=c}addAfterPosition(t,e,n,i,r){const a=e[n+2],l=e[n+3],o=a-e[n],h=l-e[n+1],c=Math.atan2(h,o);i[r]=a+t*Math.cos(c),i[r+1]=l+t*Math.sin(c),i[r+2]=c}addCurvePosition(t,e,n,i,r,a,l,o,h,c,d,u){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,v=g*p,b=p*t,x=b*3,y=p*x,w=x*t,_=e*v+i*y+a*w+o*m,E=n*v+r*y+l*w+h*m;c[d]=_,c[d+1]=E,u&&(c[d+2]=Math.atan2(E-(n*g+r*b*2+l*f),_-(e*g+i*b*2+a*f)))}};let Eo=or;Eo.NONE=-1;Eo.BEFORE=-2;Eo.AFTER=-3;Eo.epsilon=1e-5;let Bx=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new fa,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,d=l*c-o*h>0?I.degRad:-I.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let b=!1;const x=v.matrix;if(t!=0){const y=x.a,w=x.c,_=x.b,E=x.d;let T=Math.atan2(h,l)-Math.atan2(_,y)+u;T>I.PI?T-=I.PI2:T<-I.PI&&(T+=I.PI2),T*=t;const C=Math.cos(T),R=Math.sin(T);x.a=C*y-R*_,x.c=C*w-R*E,x.b=R*y+C*_,x.d=R*w+C*E,b=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=(y.x-x.tx)*e,x.ty+=(y.y-x.ty)*e,b=!0}if(n>0){let y=Math.sqrt(x.a*x.a+x.b*x.b),w=Math.sqrt(l*l+h*h);y>1e-5&&(y=(y+(w-y+this.data.offsetScaleX)*n)/y),x.a*=y,x.b*=y,y=Math.sqrt(x.c*x.c+x.d*x.d),w=Math.sqrt(o*o+c*c),y>1e-5&&(y=(y+(w-y+this.data.offsetScaleY)*n)/y),x.c*=y,x.d*=y,b=!0}if(i>0){const y=x.c,w=x.d,_=Math.atan2(w,y);let E=Math.atan2(c,o)-Math.atan2(h,l)-(_-Math.atan2(x.b,x.a));E>I.PI?E-=I.PI2:E<-I.PI&&(E+=I.PI2),E=_+(E+f)*i;const T=Math.sqrt(y*y+w*w);x.c=Math.cos(E)*T,x.d=Math.sin(E)*T,b=!0}b&&(v.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,d=l*c-o*h>0?I.degRad:-I.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let b=!1;const x=v.matrix;if(t!=0){const y=x.a,w=x.c,_=x.b,E=x.d;let T=Math.atan2(h,l)+u;T>I.PI?T-=I.PI2:T<-I.PI&&(T+=I.PI2),T*=t;const C=Math.cos(T),R=Math.sin(T);x.a=C*y-R*_,x.c=C*w-R*E,x.b=R*y+C*_,x.d=R*w+C*E,b=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=y.x*e,x.ty+=y.y*e,b=!0}if(n>0){let y=(Math.sqrt(l*l+h*h)-1+this.data.offsetScaleX)*n+1;x.a*=y,x.b*=y,y=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*n+1,x.c*=y,x.d*=y,b=!0}if(i>0){let y=Math.atan2(c,o)-Math.atan2(h,l);y>I.PI?y-=I.PI2:y<-I.PI&&(y+=I.PI2);const w=x.c,_=x.d;y=Math.atan2(_,w)+(y-I.PI/2+f)*i;const E=Math.sqrt(w*w+_*_);x.c=Math.cos(y)*E,x.d=Math.sin(y)*E,b=!0}b&&(v.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=r.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let d=h.ax,u=h.ay;e!=0&&(d+=(r.ax-d+this.data.offsetX)*e,u+=(r.ay-u+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;n>0&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*n)/f),m>1e-5&&(m=(m+(r.ascaleY-m+this.data.offsetScaleY)*n)/m));const p=h.ashearY;if(i>0){let g=r.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*i}h.updateWorldTransformWith(d,u,c,f,m,h.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(r.arotation+this.data.offsetRotation)*t);let d=h.ax,u=h.ay;e!=0&&(d+=(r.ax+this.data.offsetX)*e,u+=(r.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;n>0&&(f>1e-5&&(f*=(r.ascaleX-1+this.data.offsetScaleX)*n+1),m>1e-5&&(m*=(r.ascaleY-1+this.data.offsetScaleY)*n+1));let p=h.ashearY;i>0&&(p+=(r.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(d,u,c,f,m,h.ashearX,p)}}};const Go=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let i;if(n.parent==null)i=new Yu(n,this,null);else{const r=this.bones[n.parent.index];i=new Yu(n,this,r),r.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],i=this.bones[n.boneData.index],r=new Cd(n,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new Dx(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new Bx(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new Eo(n,this))}this.color=new at(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let c=0,d=e.length;c<d;c++){const u=e[c];u.sorted=u.data.skinRequired,u.active=!u.sorted}if(this.skin!=null){const c=this.skin.bones;for(let d=0,u=this.skin.bones.length;d<u;d++){let f=this.bones[c[d].index];do f.sorted=!1,f.active=!0,f=f.parent;while(f!=null)}}const n=this.ikConstraints,i=this.transformConstraints,r=this.pathConstraints,a=n.length,l=i.length,o=r.length,h=a+l+o;t:for(let c=0;c<h;c++){for(let d=0;d<a;d++){const u=n[d];if(u.data.order==c){this.sortIkConstraint(u);continue t}}for(let d=0;d<l;d++){const u=i[d];if(u.data.order==c){this.sortTransformConstraint(u);continue t}}for(let d=0;d<o;d++){const u=r[d];if(u.data.order==c){this.sortPathConstraint(u);continue t}}}for(let c=0,d=e.length;c<d;c++)this.sortBone(e[c])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const n=t.bones,i=n[0];if(this.sortBone(i),n.length>1){const r=n[n.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(i.children),n[n.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,n=e.data.index,i=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,n,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(let o=0,h=this.data.skins.length;o<h;o++)this.sortPathConstraintAttachment(this.data.skins[o],n,i);const r=e.getAttachment();r instanceof ma&&this.sortPathConstraintAttachmentWith(r,i);const a=t.bones,l=a.length;for(let o=0;o<l;o++)this.sortBone(a[o]);this._updateCache.push(t);for(let o=0;o<l;o++)this.sortReset(a[o].children);for(let o=0;o<l;o++)a[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let i=0;i<n;i++){const r=e[i];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let i=0;i<n;i++)this.sortBone(e[i]);this._updateCache.push(t);for(let i=0;i<n;i++)this.sortReset(e[i].children);for(let i=0;i<n;i++)e[i].sorted=!0}sortPathConstraintAttachment(t,e,n){const i=t.attachments[e];if(i)for(const r in i)this.sortPathConstraintAttachmentWith(i[r],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof ma))return;const n=t.bones;if(n==null)this.sortBone(e);else{const i=this.bones;let r=0;for(;r<n.length;){const a=n[r++];for(let l=r+a;r<l;r++){const o=n[r];this.sortBone(i[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(){const t=this.updateCacheReset;for(let n=0,i=t.length;n<i;n++){const r=t[n];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}const e=this._updateCache;for(let n=0,i=e.length;n<i;n++)e[n].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let r=0,a=t.length;r<a;r++)t[r].setToSetupPose();const e=this.ikConstraints;for(let r=0,a=e.length;r<a;r++){const l=e[r];l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}const n=this.transformConstraints;for(let r=0,a=n.length;r<a;r++){const l=n[r],o=l.data;l.rotateMix=o.rotateMix,l.translateMix=o.translateMix,l.scaleMix=o.scaleMix,l.shearMix=o.shearMix}const i=this.pathConstraints;for(let r=0,a=i.length;r<a;r++){const l=i[r],o=l.data;l.position=o.position,l.spacing=o.spacing,l.rotateMix=o.rotateMix,l.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;$.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n],a=r.data.attachmentName;if(a!=null){const l=t.getAttachment(n,a);l!=null&&r.setAttachment(l)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const n=this.skin.getAttachment(t,e);if(n!=null)return n}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const n=this.slots;for(let i=0,r=n.length;i<r;i++){const a=n[i];if(a.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(i,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);a.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}getBounds(t,e,n=new Array(2)){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const i=this.drawOrder;let r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let h=0,c=i.length;h<c;h++){const d=i[h];if(!d.bone.active)continue;let u=0,f=null;const m=d.getAttachment();if(m instanceof Rt)u=8,f=$.setArraySize(n,u,0),m.computeWorldVertices(d.bone,f,0,2);else if(m instanceof bh){const p=m;u=p.worldVerticesLength,f=$.setArraySize(n,u,0),p.computeWorldVertices(d,0,u,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const v=f[p],b=f[p+1];r=Math.min(r,v),a=Math.min(a,b),l=Math.max(l,v),o=Math.max(o,b)}}t.set(r,a),e.set(l-r,o-a)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){Go.deprecatedWarning1||(Go.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){Go.deprecatedWarning1||(Go.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let Ud=Go;Ud.deprecatedWarning1=!1;let Xd=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}},Yd=class{constructor(t,e,n){if(this.color=new at(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(n==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}},$d=class extends _h{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},$u=class{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}},Nl=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(n==null)throw new Error("attachment cannot be null.");const i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n}addSkin(t){for(let n=0;n<t.bones.length;n++){const i=t.bones[n];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==i){r=!0;break}r||this.bones.push(i)}for(let n=0;n<t.constraints.length;n++){const i=t.constraints[n];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==i){r=!0;break}r||this.constraints.push(i)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const i=e[n];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let n=0;n<t.bones.length;n++){const i=t.bones[n];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==i){r=!0;break}r||this.bones.push(i)}for(let n=0;n<t.constraints.length;n++){const i=t.constraints[n];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==i){r=!0;break}r||this.constraints.push(i)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const i=e[n];i.attachment!=null&&(i.attachment instanceof bh?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&(n[e]=null)}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const i in n){const r=n[i];r&&t.push(new $u(e,i,r))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const i in n){const r=n[i];r&&e.push(new $u(t,i,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let i=0;i<t.slots.length;i++){const r=t.slots[i],a=r.getAttachment();if(a&&n<e.attachments.length){const l=e.attachments[n];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(n,o);c!=null&&r.setAttachment(c);break}}}n++}}};const xe=class{constructor(s){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=s}readSkeletonData(s){const t=this.scale,e=new Xd;e.name="";const n=new Ol(s);e.hash=n.readString(),e.version=n.readString(),e.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),e.x=n.readFloat(),e.y=n.readFloat(),e.width=n.readFloat(),e.height=n.readFloat();const i=n.readBoolean();i&&(e.fps=n.readFloat(),e.imagesPath=n.readString(),e.audioPath=n.readString());let r=0;r=n.readInt(!0);for(let l=0;l<r;l++)n.strings.push(n.readString());r=n.readInt(!0);for(let l=0;l<r;l++){const o=n.readString(),h=l==0?null:e.bones[n.readInt(!0)],c=new Bd(l,o,h);c.rotation=n.readFloat(),c.x=n.readFloat()*t,c.y=n.readFloat()*t,c.scaleX=n.readFloat(),c.scaleY=n.readFloat(),c.shearX=n.readFloat(),c.shearY=n.readFloat(),c.length=n.readFloat()*t,c.transformMode=xe.TransformModeValues[n.readInt(!0)],c.skinRequired=n.readBoolean(),i&&at.rgba8888ToColor(c.color,n.readInt32()),e.bones.push(c)}r=n.readInt(!0);for(let l=0;l<r;l++){const o=n.readString(),h=e.bones[n.readInt(!0)],c=new Yd(l,o,h);at.rgba8888ToColor(c.color,n.readInt32());const d=n.readInt32();d!=-1&&at.rgb888ToColor(c.darkColor=new at,d),c.attachmentName=n.readStringRef(),c.blendMode=xe.BlendModeValues[n.readInt(!0)],e.slots.push(c)}r=n.readInt(!0);for(let l=0,o;l<r;l++){const h=new Ld(n.readString());h.order=n.readInt(!0),h.skinRequired=n.readBoolean(),o=n.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[n.readInt(!0)]);h.target=e.bones[n.readInt(!0)],h.mix=n.readFloat(),h.softness=n.readFloat()*t,h.bendDirection=n.readByte(),h.compress=n.readBoolean(),h.stretch=n.readBoolean(),h.uniform=n.readBoolean(),e.ikConstraints.push(h)}r=n.readInt(!0);for(let l=0,o;l<r;l++){const h=new $d(n.readString());h.order=n.readInt(!0),h.skinRequired=n.readBoolean(),o=n.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[n.readInt(!0)]);h.target=e.bones[n.readInt(!0)],h.local=n.readBoolean(),h.relative=n.readBoolean(),h.offsetRotation=n.readFloat(),h.offsetX=n.readFloat()*t,h.offsetY=n.readFloat()*t,h.offsetScaleX=n.readFloat(),h.offsetScaleY=n.readFloat(),h.offsetShearY=n.readFloat(),h.rotateMix=n.readFloat(),h.translateMix=n.readFloat(),h.scaleMix=n.readFloat(),h.shearMix=n.readFloat(),e.transformConstraints.push(h)}r=n.readInt(!0);for(let l=0,o;l<r;l++){const h=new Vd(n.readString());h.order=n.readInt(!0),h.skinRequired=n.readBoolean(),o=n.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[n.readInt(!0)]);h.target=e.slots[n.readInt(!0)],h.positionMode=xe.PositionModeValues[n.readInt(!0)],h.spacingMode=xe.SpacingModeValues[n.readInt(!0)],h.rotateMode=xe.RotateModeValues[n.readInt(!0)],h.offsetRotation=n.readFloat(),h.position=n.readFloat(),h.positionMode==fe.Fixed&&(h.position*=t),h.spacing=n.readFloat(),(h.spacingMode==Ge.Length||h.spacingMode==Ge.Fixed)&&(h.spacing*=t),h.rotateMix=n.readFloat(),h.translateMix=n.readFloat(),e.pathConstraints.push(h)}const a=this.readSkin(n,e,!0,i);a!=null&&(e.defaultSkin=a,e.skins.push(a));{let l=e.skins.length;for($.setArraySize(e.skins,r=l+n.readInt(!0));l<r;l++)e.skins[l]=this.readSkin(n,e,!1,i)}r=this.linkedMeshes.length;for(let l=0;l<r;l++){const o=this.linkedMeshes[l],h=o.skin==null?e.defaultSkin:e.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}this.linkedMeshes.length=0,r=n.readInt(!0);for(let l=0;l<r;l++){const o=new Nd(n.readStringRef());o.intValue=n.readInt(!1),o.floatValue=n.readFloat(),o.stringValue=n.readString(),o.audioPath=n.readString(),o.audioPath!=null&&(o.volume=n.readFloat(),o.balance=n.readFloat()),e.events.push(o)}r=n.readInt(!0);for(let l=0;l<r;l++)e.animations.push(this.readAnimation(n,n.readString(),e));return e}readSkin(s,t,e,n){let i=null,r=0;if(e){if(r=s.readInt(!0),r==0)return null;i=new Nl("default")}else{i=new Nl(s.readStringRef()),i.bones.length=s.readInt(!0);for(let a=0,l=i.bones.length;a<l;a++)i.bones[a]=t.bones[s.readInt(!0)];for(let a=0,l=s.readInt(!0);a<l;a++)i.constraints.push(t.ikConstraints[s.readInt(!0)]);for(let a=0,l=s.readInt(!0);a<l;a++)i.constraints.push(t.transformConstraints[s.readInt(!0)]);for(let a=0,l=s.readInt(!0);a<l;a++)i.constraints.push(t.pathConstraints[s.readInt(!0)]);r=s.readInt(!0)}for(let a=0;a<r;a++){const l=s.readInt(!0);for(let o=0,h=s.readInt(!0);o<h;o++){const c=s.readStringRef(),d=this.readAttachment(s,t,i,l,c,n);d!=null&&i.setAttachment(l,c,d)}}return i}readAttachment(s,t,e,n,i,r){const a=this.scale;let l=s.readStringRef();l==null&&(l=i);const o=s.readByte();switch(xe.AttachmentTypeValues[o]){case Bt.Region:{let c=s.readStringRef();const d=s.readFloat(),u=s.readFloat(),f=s.readFloat(),m=s.readFloat(),p=s.readFloat(),g=s.readFloat(),v=s.readFloat(),b=s.readInt32();c==null&&(c=l);const x=this.attachmentLoader.newRegionAttachment(e,l,c);return x==null?null:(x.path=c,x.x=u*a,x.y=f*a,x.scaleX=m,x.scaleY=p,x.rotation=d,x.width=g*a,x.height=v*a,at.rgba8888ToColor(x.color,b),x)}case Bt.BoundingBox:{const c=s.readInt(!0),d=this.readVertices(s,c),u=r?s.readInt32():0,f=this.attachmentLoader.newBoundingBoxAttachment(e,l);return f==null?null:(f.worldVerticesLength=c<<1,f.vertices=d.vertices,f.bones=d.bones,r&&at.rgba8888ToColor(f.color,u),f)}case Bt.Mesh:{let c=s.readStringRef();const d=s.readInt32(),u=s.readInt(!0),f=this.readFloatArray(s,u<<1,1),m=this.readShortArray(s),p=this.readVertices(s,u),g=s.readInt(!0);let v=null,b=0,x=0;r&&(v=this.readShortArray(s),b=s.readFloat(),x=s.readFloat()),c==null&&(c=l);const y=this.attachmentLoader.newMeshAttachment(e,l,c);return y==null?null:(y.path=c,at.rgba8888ToColor(y.color,d),y.bones=p.bones,y.vertices=p.vertices,y.worldVerticesLength=u<<1,y.triangles=m,y.regionUVs=new Float32Array(f),y.hullLength=g<<1,r&&(y.edges=v,y.width=b*a,y.height=x*a),y)}case Bt.LinkedMesh:{let c=s.readStringRef();const d=s.readInt32(),u=s.readStringRef(),f=s.readStringRef(),m=s.readBoolean();let p=0,g=0;r&&(p=s.readFloat(),g=s.readFloat()),c==null&&(c=l);const v=this.attachmentLoader.newMeshAttachment(e,l,c);return v==null?null:(v.path=c,at.rgba8888ToColor(v.color,d),r&&(v.width=p*a,v.height=g*a),this.linkedMeshes.push(new sC(v,u,n,f,m)),v)}case Bt.Path:{const c=s.readBoolean(),d=s.readBoolean(),u=s.readInt(!0),f=this.readVertices(s,u),m=$.newArray(u/3,0);for(let v=0,b=m.length;v<b;v++)m[v]=s.readFloat()*a;const p=r?s.readInt32():0,g=this.attachmentLoader.newPathAttachment(e,l);return g==null?null:(g.closed=c,g.constantSpeed=d,g.worldVerticesLength=u<<1,g.vertices=f.vertices,g.bones=f.bones,g.lengths=m,r&&at.rgba8888ToColor(g.color,p),g)}case Bt.Point:{const c=s.readFloat(),d=s.readFloat(),u=s.readFloat(),f=r?s.readInt32():0,m=this.attachmentLoader.newPointAttachment(e,l);return m==null?null:(m.x=d*a,m.y=u*a,m.rotation=c,r&&at.rgba8888ToColor(m.color,f),m)}case Bt.Clipping:{const c=s.readInt(!0),d=s.readInt(!0),u=this.readVertices(s,d),f=r?s.readInt32():0,m=this.attachmentLoader.newClippingAttachment(e,l);return m==null?null:(m.endSlot=t.slots[c],m.worldVerticesLength=d<<1,m.vertices=u.vertices,m.bones=u.bones,r&&at.rgba8888ToColor(m.color,f),m)}}return null}readVertices(s,t){const e=t<<1,n=new nC,i=this.scale;if(!s.readBoolean())return n.vertices=this.readFloatArray(s,e,i),n;const r=new Array,a=new Array;for(let l=0;l<t;l++){const o=s.readInt(!0);a.push(o);for(let h=0;h<o;h++)a.push(s.readInt(!0)),r.push(s.readFloat()*i),r.push(s.readFloat()*i),r.push(s.readFloat())}return n.vertices=$.toFloatArray(r),n.bones=a,n}readFloatArray(s,t,e){const n=new Array(t);if(e==1)for(let i=0;i<t;i++)n[i]=s.readFloat();else for(let i=0;i<t;i++)n[i]=s.readFloat()*e;return n}readShortArray(s){const t=s.readInt(!0),e=new Array(t);for(let n=0;n<t;n++)e[n]=s.readShort();return e}readAnimation(s,t,e){const n=new Array,i=this.scale;let r=0;const a=new at,l=new at;for(let c=0,d=s.readInt(!0);c<d;c++){const u=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readByte(),g=s.readInt(!0);switch(p){case xe.SLOT_ATTACHMENT:{const v=new dr(g);v.slotIndex=u;for(let b=0;b<g;b++)v.setFrame(b,s.readFloat(),s.readStringRef());n.push(v),r=Math.max(r,v.frames[g-1]);break}case xe.SLOT_COLOR:{const v=new bs(g);v.slotIndex=u;for(let b=0;b<g;b++){const x=s.readFloat();at.rgba8888ToColor(a,s.readInt32()),v.setFrame(b,x,a.r,a.g,a.b,a.a),b<g-1&&this.readCurve(s,b,v)}n.push(v),r=Math.max(r,v.frames[(g-1)*bs.ENTRIES]);break}case xe.SLOT_TWO_COLOR:{const v=new Ce(g);v.slotIndex=u;for(let b=0;b<g;b++){const x=s.readFloat();at.rgba8888ToColor(a,s.readInt32()),at.rgb888ToColor(l,s.readInt32()),v.setFrame(b,x,a.r,a.g,a.b,a.a,l.r,l.g,l.b),b<g-1&&this.readCurve(s,b,v)}n.push(v),r=Math.max(r,v.frames[(g-1)*Ce.ENTRIES]);break}}}}for(let c=0,d=s.readInt(!0);c<d;c++){const u=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readByte(),g=s.readInt(!0);switch(p){case xe.BONE_ROTATE:{const v=new je(g);v.boneIndex=u;for(let b=0;b<g;b++)v.setFrame(b,s.readFloat(),s.readFloat()),b<g-1&&this.readCurve(s,b,v);n.push(v),r=Math.max(r,v.frames[(g-1)*je.ENTRIES]);break}case xe.BONE_TRANSLATE:case xe.BONE_SCALE:case xe.BONE_SHEAR:{let v,b=1;p==xe.BONE_SCALE?v=new Md(g):p==xe.BONE_SHEAR?v=new Id(g):(v=new Vs(g),b=i),v.boneIndex=u;for(let x=0;x<g;x++)v.setFrame(x,s.readFloat(),s.readFloat()*b,s.readFloat()*b),x<g-1&&this.readCurve(s,x,v);n.push(v),r=Math.max(r,v.frames[(g-1)*Vs.ENTRIES]);break}}}}for(let c=0,d=s.readInt(!0);c<d;c++){const u=s.readInt(!0),f=s.readInt(!0),m=new Qe(f);m.ikConstraintIndex=u;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat()*i,s.readByte(),s.readBoolean(),s.readBoolean()),p<f-1&&this.readCurve(s,p,m);n.push(m),r=Math.max(r,m.frames[(f-1)*Qe.ENTRIES])}for(let c=0,d=s.readInt(!0);c<d;c++){const u=s.readInt(!0),f=s.readInt(!0),m=new vs(f);m.transformConstraintIndex=u;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat()),p<f-1&&this.readCurve(s,p,m);n.push(m),r=Math.max(r,m.frames[(f-1)*vs.ENTRIES])}for(let c=0,d=s.readInt(!0);c<d;c++){const u=s.readInt(!0),f=e.pathConstraints[u];for(let m=0,p=s.readInt(!0);m<p;m++){const g=s.readByte(),v=s.readInt(!0);switch(g){case xe.PATH_POSITION:case xe.PATH_SPACING:{let b,x=1;g==xe.PATH_SPACING?(b=new Pd(v),(f.spacingMode==Ge.Length||f.spacingMode==Ge.Fixed)&&(x=i)):(b=new Zn(v),f.positionMode==fe.Fixed&&(x=i)),b.pathConstraintIndex=u;for(let y=0;y<v;y++)b.setFrame(y,s.readFloat(),s.readFloat()*x),y<v-1&&this.readCurve(s,y,b);n.push(b),r=Math.max(r,b.frames[(v-1)*Zn.ENTRIES]);break}case xe.PATH_MIX:{const b=new Rn(v);b.pathConstraintIndex=u;for(let x=0;x<v;x++)b.setFrame(x,s.readFloat(),s.readFloat(),s.readFloat()),x<v-1&&this.readCurve(s,x,b);n.push(b),r=Math.max(r,b.frames[(v-1)*Rn.ENTRIES]);break}}}}for(let c=0,d=s.readInt(!0);c<d;c++){const u=e.skins[s.readInt(!0)];for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readInt(!0);for(let g=0,v=s.readInt(!0);g<v;g++){const b=u.getAttachment(p,s.readStringRef()),x=b.bones!=null,y=b.vertices,w=x?y.length/3*2:y.length,_=s.readInt(!0),E=new Rd(_);E.slotIndex=p,E.attachment=b;for(let T=0;T<_;T++){const C=s.readFloat();let R,P=s.readInt(!0);if(P==0)R=x?$.newFloatArray(w):y;else{R=$.newFloatArray(w);const O=s.readInt(!0);if(P+=O,i==1)for(let F=O;F<P;F++)R[F]=s.readFloat();else for(let F=O;F<P;F++)R[F]=s.readFloat()*i;if(!x)for(let F=0,D=R.length;F<D;F++)R[F]+=y[F]}E.setFrame(T,C,R),T<_-1&&this.readCurve(s,T,E)}n.push(E),r=Math.max(r,E.frames[_-1])}}}const o=s.readInt(!0);if(o>0){const c=new ro(o),d=e.slots.length;for(let u=0;u<o;u++){const f=s.readFloat(),m=s.readInt(!0),p=$.newArray(d,0);for(let x=d-1;x>=0;x--)p[x]=-1;const g=$.newArray(d-m,0);let v=0,b=0;for(let x=0;x<m;x++){const y=s.readInt(!0);for(;v!=y;)g[b++]=v++;p[v+s.readInt(!0)]=v++}for(;v<d;)g[b++]=v++;for(let x=d-1;x>=0;x--)p[x]==-1&&(p[x]=g[--b]);c.setFrame(u,f,p)}n.push(c),r=Math.max(r,c.frames[o-1])}const h=s.readInt(!0);if(h>0){const c=new vh(h);for(let d=0;d<h;d++){const u=s.readFloat(),f=e.events[s.readInt(!0)],m=new Od(u,f);m.intValue=s.readInt(!1),m.floatValue=s.readFloat(),m.stringValue=s.readBoolean()?s.readString():f.stringValue,m.data.audioPath!=null&&(m.volume=s.readFloat(),m.balance=s.readFloat()),c.setFrame(d,m)}n.push(c),r=Math.max(r,c.frames[h-1])}return new Ae(t,n,r)}readCurve(s,t,e){switch(s.readByte()){case xe.CURVE_STEPPED:e.setStepped(t);break;case xe.CURVE_BEZIER:this.setCurve(e,t,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat());break}}setCurve(s,t,e,n,i,r){s.setCurve(t,e,n,i,r)}};let Me=xe;Me.AttachmentTypeValues=[0,1,2,3,4,5,6];Me.TransformModeValues=[Tt.Normal,Tt.OnlyTranslation,Tt.NoRotationOrReflection,Tt.NoScale,Tt.NoScaleOrReflection];Me.PositionModeValues=[fe.Fixed,fe.Percent];Me.SpacingModeValues=[Ge.Length,Ge.Fixed,Ge.Percent];Me.RotateModeValues=[Te.Tangent,Te.Chain,Te.ChainScale];Me.BlendModeValues=[ft.NORMAL,ft.ADD,ft.MULTIPLY,ft.SCREEN];Me.BONE_ROTATE=0;Me.BONE_TRANSLATE=1;Me.BONE_SCALE=2;Me.BONE_SHEAR=3;Me.SLOT_ATTACHMENT=0;Me.SLOT_COLOR=1;Me.SLOT_TWO_COLOR=2;Me.PATH_POSITION=0;Me.PATH_SPACING=1;Me.PATH_MIX=2;Me.CURVE_LINEAR=0;Me.CURVE_STEPPED=1;Me.CURVE_BEZIER=2;let sC=class{constructor(t,e,n,i,r){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=r}},nC=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},iC=class extends Td{},Ox=class Gr{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new Xd,i=typeof t=="string"?JSON.parse(t):t,r=i.skeleton;if(r!=null){if(n.hash=r.hash,n.version=r.spine,n.version.substr(0,3)!=="3.8"){const a=`Spine 3.8 loader cant load version ${r.spine}. Please configure your pixi-spine bundle`;console.error(a)}n.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height,n.fps=r.fps,n.imagesPath=r.images}if(i.bones)for(let a=0;a<i.bones.length;a++){const l=i.bones[a];let o=null;const h=this.getValue(l,"parent",null);if(h!=null&&(o=n.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new Bd(n.bones.length,l.name,o);c.length=this.getValue(l,"length",0)*e,c.x=this.getValue(l,"x",0)*e,c.y=this.getValue(l,"y",0)*e,c.rotation=this.getValue(l,"rotation",0),c.scaleX=this.getValue(l,"scaleX",1),c.scaleY=this.getValue(l,"scaleY",1),c.shearX=this.getValue(l,"shearX",0),c.shearY=this.getValue(l,"shearY",0),c.transformMode=Gr.transformModeFromString(this.getValue(l,"transform","normal")),c.skinRequired=this.getValue(l,"skin",!1),n.bones.push(c)}if(i.slots)for(let a=0;a<i.slots.length;a++){const l=i.slots[a],o=l.name,h=l.bone,c=n.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);const d=new Yd(n.slots.length,o,c),u=this.getValue(l,"color",null);u!=null&&d.color.setFromString(u);const f=this.getValue(l,"dark",null);f!=null&&(d.darkColor=new at(1,1,1,1),d.darkColor.setFromString(f)),d.attachmentName=this.getValue(l,"attachment",null),d.blendMode=Gr.blendModeFromString(this.getValue(l,"blend","normal")),n.slots.push(d)}if(i.ik)for(let a=0;a<i.ik.length;a++){const l=i.ik[a],o=new Ld(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`IK bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.mix=this.getValue(l,"mix",1),o.softness=this.getValue(l,"softness",0)*e,o.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,o.compress=this.getValue(l,"compress",!1),o.stretch=this.getValue(l,"stretch",!1),o.uniform=this.getValue(l,"uniform",!1),n.ikConstraints.push(o)}if(i.transform)for(let a=0;a<i.transform.length;a++){const l=i.transform[a],o=new $d(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(l,"local",!1),o.relative=this.getValue(l,"relative",!1),o.offsetRotation=this.getValue(l,"rotation",0),o.offsetX=this.getValue(l,"x",0)*e,o.offsetY=this.getValue(l,"y",0)*e,o.offsetScaleX=this.getValue(l,"scaleX",0),o.offsetScaleY=this.getValue(l,"scaleY",0),o.offsetShearY=this.getValue(l,"shearY",0),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),o.scaleMix=this.getValue(l,"scaleMix",1),o.shearMix=this.getValue(l,"shearMix",1),n.transformConstraints.push(o)}if(i.path)for(let a=0;a<i.path.length;a++){const l=i.path[a],o=new Vd(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=Gr.positionModeFromString(this.getValue(l,"positionMode","percent")),o.spacingMode=Gr.spacingModeFromString(this.getValue(l,"spacingMode","length")),o.rotateMode=Gr.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),o.offsetRotation=this.getValue(l,"rotation",0),o.position=this.getValue(l,"position",0),o.positionMode==fe.Fixed&&(o.position*=e),o.spacing=this.getValue(l,"spacing",0),(o.spacingMode==Ge.Length||o.spacingMode==Ge.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),n.pathConstraints.push(o)}if(i.skins)for(let a=0;a<i.skins.length;a++){const l=i.skins[a],o=new Nl(l.name);if(l.bones)for(let h=0;h<l.bones.length;h++){const c=n.findBone(l.bones[h]);if(c==null)throw new Error(`Skin bone not found: ${l.bones[a]}`);o.bones.push(c)}if(l.ik)for(let h=0;h<l.ik.length;h++){const c=n.findIkConstraint(l.ik[h]);if(c==null)throw new Error(`Skin IK constraint not found: ${l.ik[a]}`);o.constraints.push(c)}if(l.transform)for(let h=0;h<l.transform.length;h++){const c=n.findTransformConstraint(l.transform[h]);if(c==null)throw new Error(`Skin transform constraint not found: ${l.transform[a]}`);o.constraints.push(c)}if(l.path)for(let h=0;h<l.path.length;h++){const c=n.findPathConstraint(l.path[h]);if(c==null)throw new Error(`Skin path constraint not found: ${l.path[a]}`);o.constraints.push(c)}for(const h in l.attachments){const c=n.findSlot(h);if(c==null)throw new Error(`Slot not found: ${h}`);const d=l.attachments[h];for(const u in d){const f=this.readAttachment(d[u],o,c.index,u,n);f!=null&&o.setAttachment(c.index,u,f)}}n.skins.push(o),o.name=="default"&&(n.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin==null?n.defaultSkin:n.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,i.events)for(const a in i.events){const l=i.events[a],o=new Nd(a);o.intValue=this.getValue(l,"int",0),o.floatValue=this.getValue(l,"float",0),o.stringValue=this.getValue(l,"string",""),o.audioPath=this.getValue(l,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(l,"volume",1),o.balance=this.getValue(l,"balance",0)),n.events.push(o)}if(i.animations)for(const a in i.animations){const l=i.animations[a];this.readAnimation(l,a,n)}return n}readAttachment(t,e,n,i,r){const a=this.scale;switch(i=this.getValue(t,"name",i),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",i),h=this.attachmentLoader.newRegionAttachment(e,i,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*a,h.y=this.getValue(t,"y",0)*a,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*a,h.height=t.height*a;const c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",i),h=this.attachmentLoader.newMeshAttachment(e,i,o);if(h==null)return null;h.path=o;const c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c),h.width=this.getValue(t,"width",0)*a,h.height=this.getValue(t,"height",0)*a;const d=this.getValue(t,"parent",null);if(d!=null)return this.linkedMeshes.push(new rC(h,this.getValue(t,"skin",null),n,d,this.getValue(t,"deform",!0))),h;const u=t.uvs;return this.readVertices(t,h,u.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(u),h.edges=this.getValue(t,"edges",null),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{const o=this.attachmentLoader.newPathAttachment(e,i);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const h=t.vertexCount;this.readVertices(t,o,h<<1);const c=$.newArray(h/3,0);for(let u=0;u<t.lengths.length;u++)c[u]=t.lengths[u]*a;o.lengths=c;const d=this.getValue(t,"color",null);return d!=null&&o.color.setFromString(d),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,i);if(o==null)return null;o.x=this.getValue(t,"x",0)*a,o.y=this.getValue(t,"y",0)*a,o.rotation=this.getValue(t,"rotation",0);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,i);if(o==null)return null;const h=this.getValue(t,"end",null);if(h!=null){const u=r.findSlot(h);if(u==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=u}const c=t.vertexCount;this.readVertices(t,o,c<<1);const d=this.getValue(t,"color",null);return d!=null&&o.color.setFromString(d),o}}return null}readVertices(t,e,n){const i=this.scale;e.worldVerticesLength=n;const r=t.vertices;if(n==r.length){const o=$.toFloatArray(r);if(i!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=i;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let d=o+c*4;o<d;o+=4)l.push(r[o]),a.push(r[o+1]*i),a.push(r[o+2]*i),a.push(r[o+3])}e.bones=l,e.vertices=$.toFloatArray(a)}readAnimation(t,e,n){const i=this.scale,r=new Array;let a=0;if(t.slots)for(const o in t.slots){const h=t.slots[o],c=n.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(const d in h){const u=h[d];if(d=="attachment"){const f=new dr(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m++,this.getValue(g,"time",0),g.name)}r.push(f),a=Math.max(a,f.frames[f.getFrameCount()-1])}else if(d=="color"){const f=new bs(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p],v=new at;v.setFromString(g.color||"ffffffff"),f.setFrame(m,this.getValue(g,"time",0),v.r,v.g,v.b,v.a),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*bs.ENTRIES])}else if(d=="twoColor"){const f=new Ce(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p],v=new at,b=new at;v.setFromString(g.light),b.setFromString(g.dark),f.setFrame(m,this.getValue(g,"time",0),v.r,v.g,v.b,v.a,b.r,b.g,b.b),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Ce.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${d} (${o})`)}}if(t.bones)for(const o in t.bones){const h=t.bones[o],c=n.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(const d in h){const u=h[d];if(d==="rotate"){const f=new je(u.length);f.boneIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m,this.getValue(g,"time",0),this.getValue(g,"angle",0)),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*je.ENTRIES])}else if(d==="translate"||d==="scale"||d==="shear"){let f=null,m=1,p=0;d==="scale"?(f=new Md(u.length),p=1):d==="shear"?f=new Id(u.length):(f=new Vs(u.length),m=i),f.boneIndex=c;let g=0;for(let v=0;v<u.length;v++){const b=u[v],x=this.getValue(b,"x",p),y=this.getValue(b,"y",p);f.setFrame(g,this.getValue(b,"time",0),x*m,y*m),this.readCurve(b,f,g),g++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Vs.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${d} (${o})`)}}if(t.ik)for(const o in t.ik){const h=t.ik[o],c=n.findIkConstraint(o),d=new Qe(h.length);d.ikConstraintIndex=n.ikConstraints.indexOf(c);let u=0;for(let f=0;f<h.length;f++){const m=h[f];d.setFrame(u,this.getValue(m,"time",0),this.getValue(m,"mix",1),this.getValue(m,"softness",0)*i,this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,d,u),u++}r.push(d),a=Math.max(a,d.frames[(d.getFrameCount()-1)*Qe.ENTRIES])}if(t.transform)for(const o in t.transform){const h=t.transform[o],c=n.findTransformConstraint(o),d=new vs(h.length);d.transformConstraintIndex=n.transformConstraints.indexOf(c);let u=0;for(let f=0;f<h.length;f++){const m=h[f];d.setFrame(u,this.getValue(m,"time",0),this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,d,u),u++}r.push(d),a=Math.max(a,d.frames[(d.getFrameCount()-1)*vs.ENTRIES])}if(t.path)for(const o in t.path){const h=t.path[o],c=n.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);const d=n.pathConstraints[c];for(const u in h){const f=h[u];if(u==="position"||u==="spacing"){let m=null,p=1;u==="spacing"?(m=new Pd(f.length),(d.spacingMode==Ge.Length||d.spacingMode==Ge.Fixed)&&(p=i)):(m=new Zn(f.length),d.positionMode==fe.Fixed&&(p=i)),m.pathConstraintIndex=c;let g=0;for(let v=0;v<f.length;v++){const b=f[v];m.setFrame(g,this.getValue(b,"time",0),this.getValue(b,u,0)*p),this.readCurve(b,m,g),g++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*Zn.ENTRIES])}else if(u==="mix"){const m=new Rn(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){const v=f[g];m.setFrame(p,this.getValue(v,"time",0),this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,m,p),p++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*Rn.ENTRIES])}}}if(t.deform)for(const o in t.deform){const h=t.deform[o],c=n.findSkin(o);if(c!=null)for(const d in h){const u=h[d],f=n.findSlotIndex(d);if(f==-1)throw new Error(`Slot not found: ${u.name}`);for(const m in u){const p=u[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const v=g.bones!=null,b=g.vertices,x=v?b.length/3*2:b.length,y=new Rd(p.length);y.slotIndex=f,y.attachment=g;let w=0;for(let _=0;_<p.length;_++){const E=p[_];let T;const C=this.getValue(E,"vertices",null);if(C==null)T=v?$.newFloatArray(x):b;else{T=$.newFloatArray(x);const R=this.getValue(E,"offset",0);if($.arrayCopy(C,0,T,R,C.length),i!=1)for(let P=R,O=P+C.length;P<O;P++)T[P]*=i;if(!v)for(let P=0;P<x;P++)T[P]+=b[P]}y.setFrame(w,this.getValue(E,"time",0),T),this.readCurve(E,y,w),w++}r.push(y),a=Math.max(a,y.frames[y.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const o=new ro(l.length),h=n.slots.length;let c=0;for(let d=0;d<l.length;d++){const u=l[d];let f=null;const m=this.getValue(u,"offsets",null);if(m!=null){f=$.newArray(h,-1);const p=$.newArray(h-m.length,0);let g=0,v=0;for(let b=0;b<m.length;b++){const x=m[b],y=n.findSlotIndex(x.slot);if(y==-1)throw new Error(`Slot not found: ${x.slot}`);for(;g!=y;)p[v++]=g++;f[g+x.offset]=g++}for(;g<h;)p[v++]=g++;for(let b=h-1;b>=0;b--)f[b]==-1&&(f[b]=p[--v])}o.setFrame(c++,this.getValue(u,"time",0),f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(t.events){const o=new vh(t.events.length);let h=0;for(let c=0;c<t.events.length;c++){const d=t.events[c],u=n.findEvent(d.name);if(u==null)throw new Error(`Event not found: ${d.name}`);const f=new Od($.toSinglePrecision(this.getValue(d,"time",0)),u);f.intValue=this.getValue(d,"int",u.intValue),f.floatValue=this.getValue(d,"float",u.floatValue),f.stringValue=this.getValue(d,"string",u.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(d,"volume",1),f.balance=this.getValue(d,"balance",0)),o.setFrame(h++,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new Ae(e,r,a))}readCurve(t,e,n){if(t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(n);else{const i=t.curve;e.setCurve(n,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,n){return t[e]!==void 0?t[e]:n}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return ft.NORMAL;if(t=="additive")return ft.ADD;if(t=="multiply")return ft.MULTIPLY;if(t=="screen")return ft.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return fe.Fixed;if(t=="percent")return fe.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return Ge.Length;if(t=="fixed")return Ge.Fixed;if(t=="percent")return Ge.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return Te.Tangent;if(t=="chain")return Te.Chain;if(t=="chainscale")return Te.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Tt.Normal;if(t=="onlytranslation")return Tt.OnlyTranslation;if(t=="norotationorreflection")return Tt.NoRotationOrReflection;if(t=="noscale")return Tt.NoScale;if(t=="noscaleorreflection")return Tt.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},rC=class{constructor(t,e,n,i,r){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=r}},oC=class extends _o{createSkeleton(t){this.skeleton=new Ud(t),this.skeleton.updateWorldTransform(),this.stateData=new Fd(t),this.state=new $s(this.stateData)}};const aC=Object.freeze(Object.defineProperty({__proto__:null,Animation:Ae,AnimationState:$s,AnimationStateAdapter:eC,AnimationStateData:Fd,AtlasAttachmentLoader:Dd,Attachment:Ad,AttachmentTimeline:dr,Bone:Yu,BoneData:Bd,BoundingBoxAttachment:Sx,ClippingAttachment:Ax,ColorTimeline:bs,ConstraintData:_h,CurveTimeline:Is,DeformTimeline:Rd,DrawOrderTimeline:ro,Event:Od,EventData:Nd,EventQueue:kd,EventTimeline:vh,EventType:_s,IkConstraint:Dx,IkConstraintData:Ld,IkConstraintTimeline:Qe,JitterEffect:tC,MeshAttachment:bh,PathAttachment:ma,PathConstraint:Eo,PathConstraintData:Vd,PathConstraintMixTimeline:Rn,PathConstraintPositionTimeline:Zn,PathConstraintSpacingTimeline:Pd,PointAttachment:Ix,RegionAttachment:Rt,RotateTimeline:je,ScaleTimeline:Md,ShearTimeline:Id,Skeleton:Ud,SkeletonBinary:Me,SkeletonBounds:iC,SkeletonData:Xd,SkeletonJson:Ox,Skin:Nl,SkinEntry:$u,Slot:Cd,SlotData:Yd,SpacingMode:Ge,Spine:oC,SwirlEffect:kx,TimelineType:Fx,TrackEntry:wh,TransformConstraint:Bx,TransformConstraintData:$d,TransformConstraintTimeline:vs,TranslateTimeline:Vs,TwoColorTimeline:Ce,VertexAttachment:Hi},Symbol.toStringTag,{value:"Module"}));let Gd=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const Nx=class extends Gd{constructor(t){super(t),this.id=(Nx.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,i,r,a){n=r+(n>>1)*a;const l=t.bone.skeleton,o=t.attachmentVertices;let h=this.vertices;const c=this.bones;if(c==null){o.length>0&&(h=o);const m=t.bone.matrix,p=m.tx,g=m.ty,v=m.a,b=m.c,x=m.b,y=m.d;for(let w=e,_=r;_<n;w+=2,_+=a){const E=h[w],T=h[w+1];i[_]=E*v+T*b+p,i[_+1]=E*x+T*y+g}return}let d=0,u=0;for(let m=0;m<e;m+=2){const p=c[d];d+=p+1,u+=p}const f=l.bones;if(o.length==0)for(let m=r,p=u*3;m<n;m+=a){let g=0,v=0,b=c[d++];for(b+=d;d<b;d++,p+=3){const x=f[c[d]].matrix,y=h[p],w=h[p+1],_=h[p+2];g+=(y*x.a+w*x.c+x.tx)*_,v+=(y*x.b+w*x.d+x.ty)*_}i[m]=g,i[m+1]=v}else{const m=o;for(let p=r,g=u*3,v=u<<1;p<n;p+=a){let b=0,x=0,y=c[d++];for(y+=d;d<y;d++,g+=3,v+=2){const w=f[c[d]].matrix,_=h[g]+m[v],E=h[g+1]+m[v+1],T=h[g+2];b+=(_*w.a+E*w.c+w.tx)*T,x+=(_*w.b+E*w.d+w.ty)*T}i[p]=b,i[p+1]=x}}}applyDeform(t){return this==t}};let zi=Nx;zi.nextID=0;let Lx=class extends zi{constructor(t){super(t),this.type=Bt.BoundingBox,this.color=new at(1,1,1,1)}},Vx=class extends zi{constructor(t){super(t),this.type=Bt.Clipping,this.color=new at(.2275,.2275,.8078,1)}},Wd=class extends zi{constructor(t){super(t),this.type=Bt.Mesh,this.color=new at(1,1,1,1),this.inheritDeform=!1,this.tempColor=new at(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},pa=class extends zi{constructor(t){super(t),this.type=Bt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new at(1,1,1,1)}},Ux=class extends zi{constructor(t){super(t),this.type=Bt.Point,this.color=new at(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=I.cosDeg(this.rotation),i=I.sinDeg(this.rotation),r=n*e.a+i*e.c,a=n*e.b+i*e.d;return Math.atan2(a,r)*I.radDeg}},Hd=class{constructor(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new at,this.darkColor=t.darkColor==null?null:new at,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const ze=class extends Gd{constructor(t){super(t),this.type=Bt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new at(1,1,1,1),this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new at(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,r=n+this.region.width*t,a=i+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=n*o+this.x,d=n*h,u=i*o+this.y,f=i*h,m=r*o+this.x,p=r*h,g=a*o+this.y,v=a*h,b=this.offset;b[ze.OX1]=c-f,b[ze.OY1]=u+d,b[ze.OX2]=c-v,b[ze.OY2]=g+d,b[ze.OX3]=m-v,b[ze.OY3]=g+p,b[ze.OX4]=m-f,b[ze.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,n,i){const r=this.offset,a=t instanceof Hd?t.bone.matrix:t.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,d=a.b,u=a.d;let f=0,m=0;f=r[ze.OX1],m=r[ze.OY1],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[ze.OX2],m=r[ze.OY2],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[ze.OX3],m=r[ze.OY3],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o,n+=i,f=r[ze.OX4],m=r[ze.OY4],e[n]=f*h+m*c+l,e[n+1]=f*d+m*u+o}};let Pt=ze;Pt.OX1=0;Pt.OY1=1;Pt.OX2=2;Pt.OY2=3;Pt.OX3=4;Pt.OY3=5;Pt.OX4=6;Pt.OY4=7;Pt.X1=0;Pt.Y1=1;Pt.C1R=2;Pt.C1G=3;Pt.C1B=4;Pt.C1A=5;Pt.U1=6;Pt.V1=7;Pt.X2=8;Pt.Y2=9;Pt.C2R=10;Pt.C2G=11;Pt.C2B=12;Pt.C2A=13;Pt.U2=14;Pt.V2=15;Pt.X3=16;Pt.Y3=17;Pt.C3R=18;Pt.C3G=19;Pt.C3B=20;Pt.C3A=21;Pt.U3=22;Pt.V3=23;Pt.X4=24;Pt.Y4=25;Pt.C4R=26;Pt.C4G=27;Pt.C4B=28;Pt.C4A=29;Pt.U4=30;Pt.V4=31;class lC{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,n,i){t.x+=I.randomTriangular(-this.jitterX,this.jitterY),t.y+=I.randomTriangular(-this.jitterX,this.jitterY)}end(){}}const Xx=class{constructor(s){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=s}begin(s){this.worldX=s.x+this.centerX,this.worldY=s.y+this.centerY}transform(s,t,e,n){const i=this.angle*I.degreesToRadians,r=s.x-this.worldX,a=s.y-this.worldY,l=Math.sqrt(r*r+a*a);if(l<this.radius){const o=Xx.interpolation.apply(0,i,(this.radius-l)/this.radius),h=Math.cos(o),c=Math.sin(o);s.x=h*r-c*a+this.worldX,s.y=c*r+h*a+this.worldY}}end(){}};let Yx=Xx;Yx.interpolation=new vx(2);let Le=class{constructor(t,e,n){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=n}apply(t,e,n,i,r,a,l,o){if(t==null)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(n%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,d=h.length;c<d;c++)h[c].apply(t,e,n,r,a,l,o)}static binarySearch(t,e,n=1){let i=0,r=t.length/n-2;if(r==0)return n;let a=r>>>1;for(;;){if(t[(a+1)*n]<=e?i=a+1:r=a,i==r)return(i+1)*n;a=i+r>>>1}}static linearSearch(t,e,n){for(let i=0,r=t.length-n;i<=r;i+=n)if(t[i]>e)return i;return-1}};var $x=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))($x||{});const Ee=class{constructor(s){if(s<=0)throw new Error(`frameCount must be > 0: ${s}`);this.curves=$.newFloatArray((s-1)*Ee.BEZIER_SIZE)}getFrameCount(){return this.curves.length/Ee.BEZIER_SIZE+1}setLinear(s){this.curves[s*Ee.BEZIER_SIZE]=Ee.LINEAR}setStepped(s){this.curves[s*Ee.BEZIER_SIZE]=Ee.STEPPED}getCurveType(s){const t=s*Ee.BEZIER_SIZE;if(t==this.curves.length)return Ee.LINEAR;const e=this.curves[t];return e==Ee.LINEAR?Ee.LINEAR:e==Ee.STEPPED?Ee.STEPPED:Ee.BEZIER}setCurve(s,t,e,n,i){const r=(-t*2+n)*.03,a=(-e*2+i)*.03,l=((t-n)*3+1)*.006,o=((e-i)*3+1)*.006;let h=r*2+l,c=a*2+o,d=t*.3+r+l*.16666667,u=e*.3+a+o*.16666667,f=s*Ee.BEZIER_SIZE;const m=this.curves;m[f++]=Ee.BEZIER;let p=d,g=u;for(let v=f+Ee.BEZIER_SIZE-1;f<v;f+=2)m[f]=p,m[f+1]=g,d+=h,u+=c,h+=l,c+=o,p+=d,g+=u}getCurvePercent(s,t){t=I.clamp(t,0,1);const e=this.curves;let n=s*Ee.BEZIER_SIZE;const i=e[n];if(i==Ee.LINEAR)return t;if(i==Ee.STEPPED)return 0;n++;let r=0;for(let l=n,o=n+Ee.BEZIER_SIZE-1;n<o;n+=2)if(r=e[n],r>=t){let h,c;return n==l?(h=0,c=0):(h=e[n-2],c=e[n-1]),c+(e[n+1]-c)*(t-h)/(r-h)}const a=e[n-1];return a+(1-a)*(t-r)/(1-r)}};let Rs=Ee;Rs.LINEAR=0;Rs.STEPPED=1;Rs.BEZIER=2;Rs.BEZIER_SIZE=10*2-1;const Ii=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(s,t,e){s<<=1,this.frames[s]=t,this.frames[s+Ii.ROTATION]=e}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.bones[this.boneIndex];if(e<l[0]){switch(r){case A.setup:o.rotation=o.data.rotation;return;case A.first:const m=o.data.rotation-o.rotation;o.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*i}return}if(e>=l[l.length-Ii.ENTRIES]){let m=l[l.length+Ii.PREV_ROTATION];switch(r){case A.setup:o.rotation=o.data.rotation+m*i;break;case A.first:case A.replace:m+=o.data.rotation-o.rotation,m-=(16384-(16384.499999999996-m/360|0))*360;case A.add:o.rotation+=m*i}return}const h=Le.binarySearch(l,e,Ii.ENTRIES),c=l[h+Ii.PREV_ROTATION],d=l[h],u=this.getCurvePercent((h>>1)-1,1-(e-d)/(l[h+Ii.PREV_TIME]-d));let f=l[h+Ii.ROTATION]-c;switch(f=c+(f-(16384-(16384.499999999996-f/360|0))*360)*u,r){case A.setup:o.rotation=o.data.rotation+(f-(16384-(16384.499999999996-f/360|0))*360)*i;break;case A.first:case A.replace:f+=o.data.rotation-o.rotation;case A.add:o.rotation+=(f-(16384-(16384.499999999996-f/360|0))*360)*i}}};let ps=Ii;ps.ENTRIES=2;ps.PREV_TIME=-2;ps.PREV_ROTATION=-1;ps.ROTATION=1;const ds=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*ds.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(s,t,e,n){s*=ds.ENTRIES,this.frames[s]=t,this.frames[s+ds.X]=e,this.frames[s+ds.Y]=n}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.bones[this.boneIndex];if(e<l[0]){switch(r){case A.setup:o.x=o.data.x,o.y=o.data.y;return;case A.first:o.x+=(o.data.x-o.x)*i,o.y+=(o.data.y-o.y)*i}return}let h=0,c=0;if(e>=l[l.length-ds.ENTRIES])h=l[l.length+ds.PREV_X],c=l[l.length+ds.PREV_Y];else{const d=Le.binarySearch(l,e,ds.ENTRIES);h=l[d+ds.PREV_X],c=l[d+ds.PREV_Y];const u=l[d],f=this.getCurvePercent(d/ds.ENTRIES-1,1-(e-u)/(l[d+ds.PREV_TIME]-u));h+=(l[d+ds.X]-h)*f,c+=(l[d+ds.Y]-c)*f}switch(r){case A.setup:o.x=o.data.x+h*i,o.y=o.data.y+c*i;break;case A.first:case A.replace:o.x+=(o.data.x+h-o.x)*i,o.y+=(o.data.y+c-o.y)*i;break;case A.add:o.x+=h*i,o.y+=c*i}}};let Pn=ds;Pn.ENTRIES=3;Pn.PREV_TIME=-3;Pn.PREV_X=-2;Pn.PREV_Y=-1;Pn.X=1;Pn.Y=2;let Gx=class dn extends Pn{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(n<o[0]){switch(a){case A.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case A.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,d=0;if(n>=o[o.length-dn.ENTRIES])c=o[o.length+dn.PREV_X]*h.data.scaleX,d=o[o.length+dn.PREV_Y]*h.data.scaleY;else{const u=Le.binarySearch(o,n,dn.ENTRIES);c=o[u+dn.PREV_X],d=o[u+dn.PREV_Y];const f=o[u],m=this.getCurvePercent(u/dn.ENTRIES-1,1-(n-f)/(o[u+dn.PREV_TIME]-f));c=(c+(o[u+dn.X]-c)*m)*h.data.scaleX,d=(d+(o[u+dn.Y]-d)*m)*h.data.scaleY}if(r==1)a==A.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=d-h.data.scaleY):(h.scaleX=c,h.scaleY=d);else{let u=0,f=0;if(l==Ft.mixOut)switch(a){case A.setup:u=h.data.scaleX,f=h.data.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-u)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-f)*r;break;case A.first:case A.replace:u=h.scaleX,f=h.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-u)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-f)*r;break;case A.add:u=h.scaleX,f=h.scaleY,h.scaleX=u+(Math.abs(c)*I.signum(u)-h.data.scaleX)*r,h.scaleY=f+(Math.abs(d)*I.signum(f)-h.data.scaleY)*r}else switch(a){case A.setup:u=Math.abs(h.data.scaleX)*I.signum(c),f=Math.abs(h.data.scaleY)*I.signum(d),h.scaleX=u+(c-u)*r,h.scaleY=f+(d-f)*r;break;case A.first:case A.replace:u=Math.abs(h.scaleX)*I.signum(c),f=Math.abs(h.scaleY)*I.signum(d),h.scaleX=u+(c-u)*r,h.scaleY=f+(d-f)*r;break;case A.add:u=I.signum(c),f=I.signum(d),h.scaleX=Math.abs(h.scaleX)*u+(c-Math.abs(h.data.scaleX)*u)*r,h.scaleY=Math.abs(h.scaleY)*f+(d-Math.abs(h.data.scaleY)*f)*r}}}},Wx=class fn extends Pn{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(n<o[0]){switch(a){case A.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case A.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,d=0;if(n>=o[o.length-fn.ENTRIES])c=o[o.length+fn.PREV_X],d=o[o.length+fn.PREV_Y];else{const u=Le.binarySearch(o,n,fn.ENTRIES);c=o[u+fn.PREV_X],d=o[u+fn.PREV_Y];const f=o[u],m=this.getCurvePercent(u/fn.ENTRIES-1,1-(n-f)/(o[u+fn.PREV_TIME]-f));c=c+(o[u+fn.X]-c)*m,d=d+(o[u+fn.Y]-d)*m}switch(a){case A.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+d*r;break;case A.first:case A.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+d-h.shearY)*r;break;case A.add:h.shearX+=c*r,h.shearY+=d*r}}};const he=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*he.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(s,t,e,n,i,r){s*=he.ENTRIES,this.frames[s]=t,this.frames[s+he.R]=e,this.frames[s+he.G]=n,this.frames[s+he.B]=i,this.frames[s+he.A]=r}apply(s,t,e,n,i,r,a){const l=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(r){case A.setup:l.color.setFromColor(l.data.color);return;case A.first:const f=l.color,m=l.data.color;f.add((m.r-f.r)*i,(m.g-f.g)*i,(m.b-f.b)*i,(m.a-f.a)*i)}return}let h=0,c=0,d=0,u=0;if(e>=o[o.length-he.ENTRIES]){const f=o.length;h=o[f+he.PREV_R],c=o[f+he.PREV_G],d=o[f+he.PREV_B],u=o[f+he.PREV_A]}else{const f=Le.binarySearch(o,e,he.ENTRIES);h=o[f+he.PREV_R],c=o[f+he.PREV_G],d=o[f+he.PREV_B],u=o[f+he.PREV_A];const m=o[f],p=this.getCurvePercent(f/he.ENTRIES-1,1-(e-m)/(o[f+he.PREV_TIME]-m));h+=(o[f+he.R]-h)*p,c+=(o[f+he.G]-c)*p,d+=(o[f+he.B]-d)*p,u+=(o[f+he.A]-u)*p}if(i==1)l.color.set(h,c,d,u);else{const f=l.color;r==A.setup&&f.setFromColor(l.data.color),f.add((h-f.r)*i,(c-f.g)*i,(d-f.b)*i,(u-f.a)*i)}}};let Us=he;Us.ENTRIES=5;Us.PREV_TIME=-5;Us.PREV_R=-4;Us.PREV_G=-3;Us.PREV_B=-2;Us.PREV_A=-1;Us.R=1;Us.G=2;Us.B=3;Us.A=4;const Yt=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*Yt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(s,t,e,n,i,r,a,l,o){s*=Yt.ENTRIES,this.frames[s]=t,this.frames[s+Yt.R]=e,this.frames[s+Yt.G]=n,this.frames[s+Yt.B]=i,this.frames[s+Yt.A]=r,this.frames[s+Yt.R2]=a,this.frames[s+Yt.G2]=l,this.frames[s+Yt.B2]=o}apply(s,t,e,n,i,r,a){const l=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(r){case A.setup:l.color.setFromColor(l.data.color),l.darkColor.setFromColor(l.data.darkColor);return;case A.first:const g=l.color,v=l.darkColor,b=l.data.color,x=l.data.darkColor;g.add((b.r-g.r)*i,(b.g-g.g)*i,(b.b-g.b)*i,(b.a-g.a)*i),v.add((x.r-v.r)*i,(x.g-v.g)*i,(x.b-v.b)*i,0)}return}let h=0,c=0,d=0,u=0,f=0,m=0,p=0;if(e>=o[o.length-Yt.ENTRIES]){const g=o.length;h=o[g+Yt.PREV_R],c=o[g+Yt.PREV_G],d=o[g+Yt.PREV_B],u=o[g+Yt.PREV_A],f=o[g+Yt.PREV_R2],m=o[g+Yt.PREV_G2],p=o[g+Yt.PREV_B2]}else{const g=Le.binarySearch(o,e,Yt.ENTRIES);h=o[g+Yt.PREV_R],c=o[g+Yt.PREV_G],d=o[g+Yt.PREV_B],u=o[g+Yt.PREV_A],f=o[g+Yt.PREV_R2],m=o[g+Yt.PREV_G2],p=o[g+Yt.PREV_B2];const v=o[g],b=this.getCurvePercent(g/Yt.ENTRIES-1,1-(e-v)/(o[g+Yt.PREV_TIME]-v));h+=(o[g+Yt.R]-h)*b,c+=(o[g+Yt.G]-c)*b,d+=(o[g+Yt.B]-d)*b,u+=(o[g+Yt.A]-u)*b,f+=(o[g+Yt.R2]-f)*b,m+=(o[g+Yt.G2]-m)*b,p+=(o[g+Yt.B2]-p)*b}if(i==1)l.color.set(h,c,d,u),l.darkColor.set(f,m,p,1);else{const g=l.color,v=l.darkColor;r==A.setup&&(g.setFromColor(l.data.color),v.setFromColor(l.data.darkColor)),g.add((h-g.r)*i,(c-g.g)*i,(d-g.b)*i,(u-g.a)*i),v.add((f-v.r)*i,(m-v.g)*i,(p-v.b)*i,0)}}};let Ne=Yt;Ne.ENTRIES=8;Ne.PREV_TIME=-8;Ne.PREV_R=-7;Ne.PREV_G=-6;Ne.PREV_B=-5;Ne.PREV_A=-4;Ne.PREV_R2=-3;Ne.PREV_G2=-2;Ne.PREV_B2=-1;Ne.R=1;Ne.G=2;Ne.B=3;Ne.A=4;Ne.R2=5;Ne.G2=6;Ne.B2=7;let Ll=class{constructor(t){this.frames=$.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(l==Ft.mixOut&&a==A.setup){const u=o.data.attachmentName;o.setAttachment(u==null?null:t.getAttachment(this.slotIndex,u));return}const h=this.frames;if(n<h[0]){if(a==A.setup||a==A.first){const u=o.data.attachmentName;o.setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}return}let c=0;n>=h[h.length-1]?c=h.length-1:c=Le.binarySearch(h,n,1)-1;const d=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}},Hp=null,Hx=class extends Rs{constructor(t){super(t),this.frames=$.newFloatArray(t),this.frameVertices=new Array(t),Hp==null&&(Hp=$.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,n){this.frames[t]=e,this.frameVertices[t]=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex],h=o.getAttachment();if(!(h instanceof zi)||!h.applyDeform(this.attachment))return;const c=o.attachmentVertices;c.length==0&&(a=A.setup);const d=this.frameVertices,u=d[0].length,f=this.frames;if(n<f[0]){const y=h;switch(a){case A.setup:c.length=0;return;case A.first:if(r==1){c.length=0;break}const w=$.setArraySize(c,u);if(y.bones==null){const _=y.vertices;for(let E=0;E<u;E++)w[E]+=(_[E]-w[E])*r}else{r=1-r;for(let _=0;_<u;_++)w[_]*=r}}return}const m=$.setArraySize(c,u);if(n>=f[f.length-1]){const y=d[f.length-1];if(r==1)if(a==A.add){const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++)m[E]+=y[E]-_[E]}else for(let _=0;_<u;_++)m[_]+=y[_]}else $.arrayCopy(y,0,m,0,u);else switch(a){case A.setup:{const _=h;if(_.bones==null){const E=_.vertices;for(let T=0;T<u;T++){const C=E[T];m[T]=C+(y[T]-C)*r}}else for(let E=0;E<u;E++)m[E]=y[E]*r;break}case A.first:case A.replace:for(let _=0;_<u;_++)m[_]+=(y[_]-m[_])*r;case A.add:const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++)m[E]+=(y[E]-_[E])*r}else for(let _=0;_<u;_++)m[_]+=y[_]*r}return}const p=Le.binarySearch(f,n),g=d[p-1],v=d[p],b=f[p],x=this.getCurvePercent(p-1,1-(n-b)/(f[p-1]-b));if(r==1)if(a==A.add){const y=h;if(y.bones==null){const w=y.vertices;for(let _=0;_<u;_++){const E=g[_];m[_]+=E+(v[_]-E)*x-w[_]}}else for(let w=0;w<u;w++){const _=g[w];m[w]+=_+(v[w]-_)*x}}else for(let y=0;y<u;y++){const w=g[y];m[y]=w+(v[y]-w)*x}else switch(a){case A.setup:{const w=h;if(w.bones==null){const _=w.vertices;for(let E=0;E<u;E++){const T=g[E],C=_[E];m[E]=C+(T+(v[E]-T)*x-C)*r}}else for(let _=0;_<u;_++){const E=g[_];m[_]=(E+(v[_]-E)*x)*r}break}case A.first:case A.replace:for(let w=0;w<u;w++){const _=g[w];m[w]+=(_+(v[w]-_)*x-m[w])*r}break;case A.add:const y=h;if(y.bones==null){const w=y.vertices;for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(v[_]-E)*x-w[_])*r}}else for(let w=0;w<u;w++){const _=g[w];m[w]+=(_+(v[w]-_)*x)*r}}}},zx=class{constructor(t){this.frames=$.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,i,r,a,l){if(i==null)return;const o=this.frames,h=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,i,r,a,l),e=-1;else if(e>=o[h-1])return;if(n<o[0])return;let c=0;if(e<o[0])c=0;else{c=Le.binarySearch(o,e);const d=o[c];for(;c>0&&o[c-1]==d;)c--}for(;c<h&&n>=o[c];c++)i.push(this.events[c])}},Vl=class{constructor(t){this.frames=$.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,i,r,a,l){const o=t.drawOrder,h=t.slots;if(l==Ft.mixOut&&a==A.setup){$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const c=this.frames;if(n<c[0]){(a==A.setup||a==A.first)&&$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let d=0;n>=c[c.length-1]?d=c.length-1:d=Le.binarySearch(c,n)-1;const u=this.drawOrders[d];if(u==null)$.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=u.length;f<m;f++)o[f]=h[u[f]]}};const Qt=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*Qt.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(s,t,e,n,i,r){s*=Qt.ENTRIES,this.frames[s]=t,this.frames[s+Qt.MIX]=e,this.frames[s+Qt.BEND_DIRECTION]=n,this.frames[s+Qt.COMPRESS]=i?1:0,this.frames[s+Qt.STRETCH]=r?1:0}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.ikConstraints[this.ikConstraintIndex];if(e<l[0]){switch(r){case A.setup:o.mix=o.data.mix,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case A.first:o.mix+=(o.data.mix-o.mix)*i,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}if(e>=l[l.length-Qt.ENTRIES]){r==A.setup?(o.mix=o.data.mix+(l[l.length+Qt.PREV_MIX]-o.data.mix)*i,a==Ft.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[l.length+Qt.PREV_BEND_DIRECTION],o.compress=l[l.length+Qt.PREV_COMPRESS]!=0,o.stretch=l[l.length+Qt.PREV_STRETCH]!=0)):(o.mix+=(l[l.length+Qt.PREV_MIX]-o.mix)*i,a==Ft.mixIn&&(o.bendDirection=l[l.length+Qt.PREV_BEND_DIRECTION],o.compress=l[l.length+Qt.PREV_COMPRESS]!=0,o.stretch=l[l.length+Qt.PREV_STRETCH]!=0));return}const h=Le.binarySearch(l,e,Qt.ENTRIES),c=l[h+Qt.PREV_MIX],d=l[h],u=this.getCurvePercent(h/Qt.ENTRIES-1,1-(e-d)/(l[h+Qt.PREV_TIME]-d));r==A.setup?(o.mix=o.data.mix+(c+(l[h+Qt.MIX]-c)*u-o.data.mix)*i,a==Ft.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[h+Qt.PREV_BEND_DIRECTION],o.compress=l[h+Qt.PREV_COMPRESS]!=0,o.stretch=l[h+Qt.PREV_STRETCH]!=0)):(o.mix+=(c+(l[h+Qt.MIX]-c)*u-o.mix)*i,a==Ft.mixIn&&(o.bendDirection=l[h+Qt.PREV_BEND_DIRECTION],o.compress=l[h+Qt.PREV_COMPRESS]!=0,o.stretch=l[h+Qt.PREV_STRETCH]!=0))}};let Xs=Qt;Xs.ENTRIES=5;Xs.PREV_TIME=-5;Xs.PREV_MIX=-4;Xs.PREV_BEND_DIRECTION=-3;Xs.PREV_COMPRESS=-2;Xs.PREV_STRETCH=-1;Xs.MIX=1;Xs.BEND_DIRECTION=2;Xs.COMPRESS=3;Xs.STRETCH=4;const ce=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*ce.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(s,t,e,n,i,r){s*=ce.ENTRIES,this.frames[s]=t,this.frames[s+ce.ROTATE]=e,this.frames[s+ce.TRANSLATE]=n,this.frames[s+ce.SCALE]=i,this.frames[s+ce.SHEAR]=r}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.transformConstraints[this.transformConstraintIndex];if(e<l[0]){const f=o.data;switch(r){case A.setup:o.rotateMix=f.rotateMix,o.translateMix=f.translateMix,o.scaleMix=f.scaleMix,o.shearMix=f.shearMix;return;case A.first:o.rotateMix+=(f.rotateMix-o.rotateMix)*i,o.translateMix+=(f.translateMix-o.translateMix)*i,o.scaleMix+=(f.scaleMix-o.scaleMix)*i,o.shearMix+=(f.shearMix-o.shearMix)*i}return}let h=0,c=0,d=0,u=0;if(e>=l[l.length-ce.ENTRIES]){const f=l.length;h=l[f+ce.PREV_ROTATE],c=l[f+ce.PREV_TRANSLATE],d=l[f+ce.PREV_SCALE],u=l[f+ce.PREV_SHEAR]}else{const f=Le.binarySearch(l,e,ce.ENTRIES);h=l[f+ce.PREV_ROTATE],c=l[f+ce.PREV_TRANSLATE],d=l[f+ce.PREV_SCALE],u=l[f+ce.PREV_SHEAR];const m=l[f],p=this.getCurvePercent(f/ce.ENTRIES-1,1-(e-m)/(l[f+ce.PREV_TIME]-m));h+=(l[f+ce.ROTATE]-h)*p,c+=(l[f+ce.TRANSLATE]-c)*p,d+=(l[f+ce.SCALE]-d)*p,u+=(l[f+ce.SHEAR]-u)*p}if(r==A.setup){const f=o.data;o.rotateMix=f.rotateMix+(h-f.rotateMix)*i,o.translateMix=f.translateMix+(c-f.translateMix)*i,o.scaleMix=f.scaleMix+(d-f.scaleMix)*i,o.shearMix=f.shearMix+(u-f.shearMix)*i}else o.rotateMix+=(h-o.rotateMix)*i,o.translateMix+=(c-o.translateMix)*i,o.scaleMix+=(d-o.scaleMix)*i,o.shearMix+=(u-o.shearMix)*i}};let Ys=ce;Ys.ENTRIES=5;Ys.PREV_TIME=-5;Ys.PREV_ROTATE=-4;Ys.PREV_TRANSLATE=-3;Ys.PREV_SCALE=-2;Ys.PREV_SHEAR=-1;Ys.ROTATE=1;Ys.TRANSLATE=2;Ys.SCALE=3;Ys.SHEAR=4;const mn=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*mn.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(s,t,e){s*=mn.ENTRIES,this.frames[s]=t,this.frames[s+mn.VALUE]=e}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(r){case A.setup:o.position=o.data.position;return;case A.first:o.position+=(o.data.position-o.position)*i}return}let h=0;if(e>=l[l.length-mn.ENTRIES])h=l[l.length+mn.PREV_VALUE];else{const c=Le.binarySearch(l,e,mn.ENTRIES);h=l[c+mn.PREV_VALUE];const d=l[c],u=this.getCurvePercent(c/mn.ENTRIES-1,1-(e-d)/(l[c+mn.PREV_TIME]-d));h+=(l[c+mn.VALUE]-h)*u}r==A.setup?o.position=o.data.position+(h-o.data.position)*i:o.position+=(h-o.position)*i}};let $i=mn;$i.ENTRIES=2;$i.PREV_TIME=-2;$i.PREV_VALUE=-1;$i.VALUE=1;let jx=class Ri extends $i{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,n,i,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(n<o[0]){switch(a){case A.setup:h.spacing=h.data.spacing;return;case A.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(n>=o[o.length-Ri.ENTRIES])c=o[o.length+Ri.PREV_VALUE];else{const d=Le.binarySearch(o,n,Ri.ENTRIES);c=o[d+Ri.PREV_VALUE];const u=o[d],f=this.getCurvePercent(d/Ri.ENTRIES-1,1-(n-u)/(o[d+Ri.PREV_TIME]-u));c+=(o[d+Ri.VALUE]-c)*f}a==A.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const fs=class extends Rs{constructor(s){super(s),this.frames=$.newFloatArray(s*fs.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(s,t,e,n){s*=fs.ENTRIES,this.frames[s]=t,this.frames[s+fs.ROTATE]=e,this.frames[s+fs.TRANSLATE]=n}apply(s,t,e,n,i,r,a){const l=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(r){case A.setup:o.rotateMix=o.data.rotateMix,o.translateMix=o.data.translateMix;return;case A.first:o.rotateMix+=(o.data.rotateMix-o.rotateMix)*i,o.translateMix+=(o.data.translateMix-o.translateMix)*i}return}let h=0,c=0;if(e>=l[l.length-fs.ENTRIES])h=l[l.length+fs.PREV_ROTATE],c=l[l.length+fs.PREV_TRANSLATE];else{const d=Le.binarySearch(l,e,fs.ENTRIES);h=l[d+fs.PREV_ROTATE],c=l[d+fs.PREV_TRANSLATE];const u=l[d],f=this.getCurvePercent(d/fs.ENTRIES-1,1-(e-u)/(l[d+fs.PREV_TIME]-u));h+=(l[d+fs.ROTATE]-h)*f,c+=(l[d+fs.TRANSLATE]-c)*f}r==A.setup?(o.rotateMix=o.data.rotateMix+(h-o.data.rotateMix)*i,o.translateMix=o.data.translateMix+(c-o.data.translateMix)*i):(o.rotateMix+=(h-o.rotateMix)*i,o.translateMix+=(c-o.translateMix)*i)}};let vi=fs;vi.ENTRIES=3;vi.PREV_TIME=-3;vi.PREV_ROTATE=-2;vi.PREV_TRANSLATE=-1;vi.ROTATE=1;vi.TRANSLATE=2;const Xe=class{constructor(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new zd(this),this.propertyIDs=new yx,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new yh(()=>new Eh),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let a=t*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}let l=r.next;if(l!=null){const o=r.trackLast-l.delay;if(o>=0){for(l.delay=0,l.trackTime=r.timeScale==0?0:(o/r.timeScale+t)*l.timeScale,r.trackTime+=a,this.setCurrent(n,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){e[n]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,t)){let o=r.mixingFrom;for(r.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}r.trackTime+=a}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(n==null)return!0;const i=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((n.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=n.mixingFrom,n.mixingFrom!=null&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let i=!1;for(let r=0,a=n.length;r<a;r++){const l=n[r];if(l==null||l.delay>0)continue;i=!0;const o=r==0?A.first:l.mixBlend;let h=l.alpha;l.mixingFrom!=null?h*=this.applyMixingFrom(l,t,o):l.trackTime>=l.trackEnd&&l.next==null&&(h=0);const c=l.animationLast,d=l.getAnimationTime(),u=l.animation.timelines.length,f=l.animation.timelines;if(r==0&&h==1||o==A.add)for(let m=0;m<u;m++)f[m].apply(t,c,d,e,h,o,Ft.mixIn);else{const m=l.timelineMode,p=l.timelinesRotation.length==0;p&&$.setArraySize(l.timelinesRotation,u<<1,null);const g=l.timelinesRotation;for(let v=0;v<u;v++){const b=f[v],x=m[v]==Xe.SUBSEQUENT?o:A.setup;b instanceof ps?this.applyRotateTimeline(b,t,d,h,x,g,v<<1,p):b.apply(t,c,d,e,h,x,Ft.mixIn)}}this.queueEvents(l,d),e.length=0,l.nextAnimationLast=d,l.nextTrackLast=l.trackTime}return this.queue.drain(),i}applyMixingFrom(t,e,n){const i=t.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,e,n);let r=0;t.mixDuration==0?(r=1,n==A.first&&(n=A.setup)):(r=t.mixTime/t.mixDuration,r>1&&(r=1),n!=A.first&&(n=i.mixBlend));const a=r<i.eventThreshold?this.events:null,l=r<i.attachmentThreshold,o=r<i.drawOrderThreshold,h=i.animationLast,c=i.getAnimationTime(),d=i.animation.timelines.length,u=i.animation.timelines,f=i.alpha*t.interruptAlpha,m=f*(1-r);if(n==A.add)for(let p=0;p<d;p++)u[p].apply(e,h,c,a,m,n,Ft.mixOut);else{const p=i.timelineMode,g=i.timelineHoldMix,v=i.timelinesRotation.length==0;v&&$.setArraySize(i.timelinesRotation,d<<1,null);const b=i.timelinesRotation;i.totalAlpha=0;for(let x=0;x<d;x++){const y=u[x];let w=Ft.mixOut,_,E=0;switch(p[x]){case Xe.SUBSEQUENT:if(!l&&y instanceof Ll||!o&&y instanceof Vl)continue;_=n,E=m;break;case Xe.FIRST:_=A.setup,E=m;break;case Xe.HOLD:_=A.setup,E=f;break;default:_=A.setup;const T=g[x];E=f*Math.max(0,1-T.mixTime/T.mixDuration);break}i.totalAlpha+=E,y instanceof ps?this.applyRotateTimeline(y,e,c,E,_,b,x<<1,v):(_==A.setup&&(y instanceof Ll?l&&(w=Ft.mixOut):y instanceof Vl&&o&&(w=Ft.mixOut)),y.apply(e,h,c,a,E,_,w))}}return t.mixDuration>0&&this.queueEvents(i,c),this.events.length=0,i.nextAnimationLast=c,i.nextTrackLast=i.trackTime,r}applyRotateTimeline(t,e,n,i,r,a,l,o){if(o&&(a[l]=0),i==1){t.apply(e,0,n,null,1,r,Ft.mixIn);return}const h=t,c=h.frames,d=e.bones[h.boneIndex];let u=0,f=0;if(n<c[0])switch(r){case A.setup:d.rotation=d.data.rotation;default:return;case A.first:u=d.rotation,f=d.data.rotation}else if(u=r==A.setup?d.data.rotation:d.rotation,n>=c[c.length-ps.ENTRIES])f=d.data.rotation+c[c.length+ps.PREV_ROTATION];else{const g=Le.binarySearch(c,n,ps.ENTRIES),v=c[g+ps.PREV_ROTATION],b=c[g],x=h.getCurvePercent((g>>1)-1,1-(n-b)/(c[g+ps.PREV_TIME]-b));f=c[g+ps.ROTATION]-v,f-=(16384-(16384.499999999996-f/360|0))*360,f=v+f*x+d.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-u;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=a[l];else{let g=0,v=0;o?(g=0,v=p):(g=a[l],v=a[l+1]);const b=p>0;let x=g>=0;I.signum(v)!=I.signum(p)&&Math.abs(v)<=90&&(Math.abs(g)>180&&(g+=360*I.signum(g)),x=b),m=p+g-g%360,x!=b&&(m+=360*I.signum(g)),a[l]=m}a[l+1]=p,u+=m*i,d.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(t,e){const n=t.animationStart,i=t.animationEnd,r=i-n,a=t.trackLast%r,l=this.events;let o=0;const h=l.length;for(;o<h;o++){const d=l[o];if(d.time<a)break;d.time>i||this.queue.event(t,d)}let c=!1;for(t.loop?c=r==0||a>t.trackTime%r:c=e>=i&&t.animationLast<i,c&&this.queue.complete(t);o<h;o++)l[o].time<n||this.queue.event(t,l[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let n=e;for(;;){const i=n.mixingFrom;if(i==null)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const i=this.expandToIndex(t);this.tracks[t]=e,i!=null&&(n&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n){const i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,i,n)}setAnimationWith(t,e,n){if(e==null)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(t);r!=null&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,i=!1):this.disposeNext(r));const a=this.trackEntry(t,e,n,r);return this.setCurrent(t,a,i),this.queue.drain(),a}addAnimation(t,e,n,i){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,r,n,i)}addAnimationWith(t,e,n,i){if(e==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r!=null)for(;r.next!=null;)r=r.next;const a=this.trackEntry(t,e,n,r);if(r==null)this.setCurrent(t,a,!0),this.queue.drain();else if(r.next=a,i<=0){const l=r.animationEnd-r.animationStart;l!=0?(r.loop?i+=l*(1+(r.trackTime/l|0)):i+=Math.max(l,r.trackTime),i-=this.data.getMix(r.animation,e)):i=r.trackTime}return a.delay=i,a}setEmptyAnimation(t,e){const n=this.setAnimationWith(t,Xe.emptyAnimation,!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e,n){n<=0&&(n-=e);const i=this.addAnimationWith(t,Xe.emptyAnimation,!1,n);return i.mixDuration=e,i.trackEnd=e,i}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let n=0,i=this.tracks.length;n<i;n++){const r=this.tracks[n];r!=null&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:($.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,i){const r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=n,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=i==null?0:this.data.getMix(i.animation,e),r}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let n=this.tracks[t];if(n!=null){for(;n.mixingFrom!=null;)n=n.mixingFrom;do(n.mixingFrom==null||n.mixBlend!=A.add)&&this.setTimelineModes(n),n=n.mixingTo;while(n!=null)}}}setTimelineModes(t){const e=t.mixingTo,n=t.animation.timelines,i=t.animation.timelines.length,r=$.setArraySize(t.timelineMode,i);t.timelineHoldMix.length=0;const a=$.setArraySize(t.timelineHoldMix,i),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<i;o++)l.add(n[o].getPropertyId()),r[o]=Xe.HOLD;return}t:for(let o=0;o<i;o++){const h=n[o].getPropertyId();if(!l.add(h))r[o]=Xe.SUBSEQUENT;else if(e==null||!this.hasTimeline(e,h))r[o]=Xe.FIRST;else{for(let c=e.mixingTo;c!=null;c=c.mixingTo)if(!this.hasTimeline(c,h)){if(t.mixDuration>0){r[o]=Xe.HOLD_MIX,a[o]=c;continue t}break}r[o]=Xe.HOLD}}}hasTimeline(t,e){const n=t.animation.timelines;for(let i=0,r=n.length;i<r;i++)if(n[i].getPropertyId()==e)return!0;return!1}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){Xe.deprecatedWarning1||(Xe.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,i){Xe.deprecatedWarning2||(Xe.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,i)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return Xe.deprecatedWarning3||(Xe.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let Qn=Xe;Qn.emptyAnimation=new Le("<empty>",[],0);Qn.SUBSEQUENT=0;Qn.FIRST=1;Qn.HOLD=2;Qn.HOLD_MIX=3;Qn.deprecatedWarning1=!1;Qn.deprecatedWarning2=!1;Qn.deprecatedWarning3=!1;const oi=class{constructor(){this.mixBlend=A.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return oi.deprecatedWarning1||(oi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){oi.deprecatedWarning1||(oi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return oi.deprecatedWarning2||(oi.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){oi.deprecatedWarning2||(oi.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Eh=oi;Eh.deprecatedWarning1=!1;Eh.deprecatedWarning2=!1;const Gu=class{constructor(s){this.objects=[],this.drainDisabled=!1,this.animState=s}start(s){this.objects.push(Es.start),this.objects.push(s),this.animState.animationsChanged=!0}interrupt(s){this.objects.push(Es.interrupt),this.objects.push(s)}end(s){this.objects.push(Es.end),this.objects.push(s),this.animState.animationsChanged=!0}dispose(s){this.objects.push(Es.dispose),this.objects.push(s)}complete(s){this.objects.push(Es.complete),this.objects.push(s)}event(s,t){this.objects.push(Es.event),this.objects.push(s),this.objects.push(t)}deprecateStuff(){return Gu.deprecatedWarning1||(Gu.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const s=this.objects,t=this.animState.listeners;for(let e=0;e<s.length;e+=2){const n=s[e],i=s[e+1];switch(n){case Es.start:i.listener!=null&&i.listener.start&&i.listener.start(i);for(let l=0;l<t.length;l++)t[l].start&&t[l].start(i);i.onStart&&this.deprecateStuff()&&i.onStart(i.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(i.trackIndex);break;case Es.interrupt:i.listener!=null&&i.listener.interrupt&&i.listener.interrupt(i);for(let l=0;l<t.length;l++)t[l].interrupt&&t[l].interrupt(i);break;case Es.end:i.listener!=null&&i.listener.end&&i.listener.end(i);for(let l=0;l<t.length;l++)t[l].end&&t[l].end(i);i.onEnd&&this.deprecateStuff()&&i.onEnd(i.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(i.trackIndex);case Es.dispose:i.listener!=null&&i.listener.dispose&&i.listener.dispose(i);for(let l=0;l<t.length;l++)t[l].dispose&&t[l].dispose(i);this.animState.trackEntryPool.free(i);break;case Es.complete:i.listener!=null&&i.listener.complete&&i.listener.complete(i);for(let l=0;l<t.length;l++)t[l].complete&&t[l].complete(i);const r=I.toInt(i.loopsCount());i.onComplete&&this.deprecateStuff()&&i.onComplete(i.trackIndex,r),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(i.trackIndex,r);break;case Es.event:const a=s[e+++2];i.listener!=null&&i.listener.event&&i.listener.event(i,a);for(let l=0;l<t.length;l++)t[l].event&&t[l].event(i,a);i.onEvent&&this.deprecateStuff()&&i.onEvent(i.trackIndex,a),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(i.trackIndex,a);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let zd=Gu;zd.deprecatedWarning1=!1;var Es=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(Es||{});class hC{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const Wu=class{constructor(s){if(this.animationToMixTime={},this.defaultMix=0,s==null)throw new Error("skeletonData cannot be null.");this.skeletonData=s}setMix(s,t,e){const n=this.skeletonData.findAnimation(s);if(n==null)throw new Error(`Animation not found: ${s}`);const i=this.skeletonData.findAnimation(t);if(i==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(n,i,e)}setMixByName(s,t,e){Wu.deprecatedWarning1||(Wu.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(s,t,e)}setMixWith(s,t,e){if(s==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");const n=`${s.name}.${t.name}`;this.animationToMixTime[n]=e}getMix(s,t){const e=`${s.name}.${t.name}`,n=this.animationToMixTime[e];return n===void 0?this.defaultMix:n}};let jd=Wu;jd.deprecatedWarning1=!1;let qx=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,n){const i=this.atlas.findRegion(n);if(i==null)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);const r=new Pt(e);return r.region=i,r}newMeshAttachment(t,e,n){const i=this.atlas.findRegion(n);if(i==null)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);const r=new Wd(e);return r.region=i,r}newBoundingBoxAttachment(t,e){return new Lx(e)}newPathAttachment(t,e){return new pa(e)}newPointAttachment(t,e){return new Ux(e)}newClippingAttachment(t,e){return new Vx(e)}},Hu=class{constructor(t,e,n){if(this.matrix=new se,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,i,r,a,l){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=r,this.ashearX=a,this.ashearY=l,this.appliedValid=!0;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(o==null){const g=this.skeleton,v=n+90+l;h.a=I.cosDeg(n+a)*i*c,h.c=I.cosDeg(v)*r*c,h.b=I.sinDeg(n+a)*i*d,h.d=I.sinDeg(v)*r*d,h.tx=t*c+g.x,h.ty=e*d+g.y;return}let u=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=u*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case Tt.Normal:{const g=n+90+l,v=I.cosDeg(n+a)*i,b=I.cosDeg(g)*r,x=I.sinDeg(n+a)*i,y=I.sinDeg(g)*r;h.a=u*v+f*x,h.c=u*b+f*y,h.b=m*v+p*x,h.d=m*b+p*y;return}case Tt.OnlyTranslation:{const g=n+90+l;h.a=I.cosDeg(n+a)*i,h.c=I.cosDeg(g)*r,h.b=I.sinDeg(n+a)*i,h.d=I.sinDeg(g)*r;break}case Tt.NoRotationOrReflection:{let g=u*u+m*m,v=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,f=m*g,p=u*g,v=Math.atan2(m,u)*I.radDeg):(u=0,m=0,v=90-Math.atan2(p,f)*I.radDeg);const b=n+a-v,x=n+l-v+90,y=I.cosDeg(b)*i,w=I.cosDeg(x)*r,_=I.sinDeg(b)*i,E=I.sinDeg(x)*r;h.a=u*y-f*_,h.c=u*w-f*E,h.b=m*y+p*_,h.d=m*w+p*E;break}case Tt.NoScale:case Tt.NoScaleOrReflection:{const g=I.cosDeg(n),v=I.sinDeg(n);let b=(u*g+f*v)/c,x=(m*g+p*v)/d,y=Math.sqrt(b*b+x*x);y>1e-5&&(y=1/y),b*=y,x*=y,y=Math.sqrt(b*b+x*x),this.data.transformMode==Tt.NoScale&&u*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(y=-y);const w=Math.PI/2+Math.atan2(x,b),_=Math.cos(w)*y,E=Math.sin(w)*y,T=I.cosDeg(a)*i,C=I.cosDeg(90+l)*r,R=I.sinDeg(a)*i,P=I.sinDeg(90+l)*r;h.a=b*T+_*R,h.c=b*C+_*P,h.b=x*T+E*R,h.d=x*C+E*P;break}}h.a*=c,h.c*=c,h.b*=d,h.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*I.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*I.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*I.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*I.radDeg;return}const n=t.matrix,i=1/(n.a*n.d-n.b*n.c),r=e.tx-n.tx,a=e.ty-n.ty;this.ax=r*n.d*i-a*n.c*i,this.ay=a*n.a*i-r*n.b*i;const l=i*n.d,o=i*n.a,h=i*n.c,c=i*n.b,d=l*e.a-h*e.b,u=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*I.radDeg,this.arotation=Math.atan2(f,d)*I.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*I.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=1/(n*a-i*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*i*l,t.y=h*n*l-o*r*l,t}localToWorld(t){const e=this.matrix,n=t.x,i=t.y;return t.x=n*e.a+i*e.c+e.tx,t.y=n*e.b+i*e.d+e.ty,t}worldToLocalRotation(t){const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*n,i.d*n-i.c*e)*I.radDeg}localToWorldRotation(t){const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(n*i.b+e*i.d,n*i.a+e*i.c)*I.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=I.cosDeg(t),o=I.sinDeg(t);e.a=l*n-o*r,e.c=l*i-o*a,e.b=o*n+l*r,e.d=o*i+l*a,this.appliedValid=!1}},Kx=class{constructor(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Tt.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}},Zx=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},Jx=class{constructor(t){this.name=t}},Qx=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}}apply1(t,e,n,i,r,a,l){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,h=1/(o.a*o.d-o.b*o.c),c=e-o.tx,d=n-o.ty,u=(c*o.d-d*o.c)*h-t.ax,f=(d*o.a-c*o.b)*h-t.ay;let m=Math.atan2(f,u)*I.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let p=t.ascaleX,g=t.ascaleY;if(i||r){const v=t.data.length*p,b=Math.sqrt(u*u+f*f);if(i&&b<v||r&&b>v&&v>1e-4){const x=(b/v-1)*l+1;p*=x,a&&(g*=x)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*l,p,g,t.ashearX,t.ashearY)}apply2(t,e,n,i,r,a,l){if(l==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const o=t.ax,h=t.ay;let c=t.ascaleX,d=c,u=t.ascaleY,f=e.ascaleX;const m=t.matrix;let p=0,g=0,v=0;c<0?(c=-c,p=180,v=-1):(p=0,v=1),u<0&&(u=-u,v=-v),f<0?(f=-f,g=180):g=0;const b=e.ax;let x=0,y=0,w=0,_=m.a,E=m.c,T=m.b,C=m.d;const R=Math.abs(c-u)<=1e-4;R?(x=e.ay,y=_*b+E*x+m.tx,w=T*b+C*x+m.ty):(x=0,y=_*b+m.tx,w=T*b+m.ty);const P=t.parent.matrix;_=P.a,E=P.c,T=P.b,C=P.d;const O=1/(_*C-E*T);let F=n-P.tx,D=i-P.ty;const V=(F*C-D*E)*O-o,X=(D*_-F*T)*O-h,U=V*V+X*X;F=y-P.tx,D=w-P.ty;const j=(F*C-D*E)*O-o,z=(D*_-F*T)*O-h,N=Math.sqrt(j*j+z*z);let G=e.data.length*f,q=0,K=0;t:if(R){G*=c;let ht=(U-N*N-G*G)/(2*N*G);ht<-1?ht=-1:ht>1&&(ht=1,a&&N+G>1e-4&&(d*=(Math.sqrt(U)/(N+G)-1)*l+1)),K=Math.acos(ht)*r,_=N+G*ht,E=G*Math.sin(K),q=Math.atan2(X*_-V*E,V*_+X*E)}else{_=c*G,E=u*G;const ht=_*_,vt=E*E,At=Math.atan2(X,V);T=vt*N*N+ht*U-ht*vt;const _t=-2*vt*N,Et=vt-ht;if(C=_t*_t-4*Et*T,C>=0){let rt=Math.sqrt(C);_t<0&&(rt=-rt),rt=-(_t+rt)/2;const it=rt/Et,ot=T/rt,nt=Math.abs(it)<Math.abs(ot)?it:ot;if(nt*nt<=U){D=Math.sqrt(U-nt*nt)*r,q=At-Math.atan2(D,nt),K=Math.atan2(D/u,(nt-N)/c);break t}}let St=I.PI,Ot=N-_,k=Ot*Ot,L=0,H=0,et=N+_,Z=et*et,st=0;T=-_*N/(ht-vt),T>=-1&&T<=1&&(T=Math.acos(T),F=_*Math.cos(T)+N,D=E*Math.sin(T),C=F*F+D*D,C<k&&(St=T,k=C,Ot=F,L=D),C>Z&&(H=T,Z=C,et=F,st=D)),U<=(k+Z)/2?(q=At-Math.atan2(L*r,Ot),K=St*r):(q=At-Math.atan2(st*r,et),K=H*r)}const Q=Math.atan2(x,b)*v;let tt=t.arotation;q=(q-Q)*I.radDeg+p-tt,q>180?q-=360:q<-180&&(q+=360),t.updateWorldTransformWith(o,h,tt+q*l,d,t.ascaleY,0,0),tt=e.arotation,K=((K+Q)*I.radDeg-e.ashearX)*v+g-tt,K>180?K-=360:K<-180&&(K+=360),e.updateWorldTransformWith(b,x,tt+K*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},ty=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}},ey=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}};var bn=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(bn||{});const ar=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,i=t.bones.length;n<i;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof pa))return;const e=this.rotateMix,n=this.translateMix,i=n>0,r=e>0;if(!i&&!r)return;const a=this.data,l=a.spacingMode,o=l==bn.Length,h=a.rotateMode,c=h==Te.Tangent,d=h==Te.ChainScale,u=this.bones.length,f=c?u:u+1,m=this.bones,p=$.setArraySize(this.spaces,f);let g=null;const v=this.spacing;if(d||o){d&&(g=$.setArraySize(this.lengths,u));for(let E=0,T=f-1;E<T;){const C=m[E],R=C.data.length;if(R<ar.epsilon)d&&(g[E]=0),p[++E]=0;else{const P=R*C.matrix.a,O=R*C.matrix.b,F=Math.sqrt(P*P+O*O);d&&(g[E]=F),p[++E]=(o?R+v:v)*F/R}}}else for(let E=1;E<f;E++)p[E]=v;const b=this.computeWorldPositions(t,f,c,a.positionMode==fe.Percent,l==bn.Percent);let x=b[0],y=b[1],w=a.offsetRotation,_=!1;if(w==0)_=h==Te.Chain;else{_=!1;const E=this.target.bone.matrix;w*=E.a*E.d-E.b*E.c>0?I.degRad:-I.degRad}for(let E=0,T=3;E<u;E++,T+=3){const C=m[E],R=C.matrix;R.tx+=(x-R.tx)*n,R.ty+=(y-R.ty)*n;const P=b[T],O=b[T+1],F=P-x,D=O-y;if(d){const V=g[E];if(V!=0){const X=(Math.sqrt(F*F+D*D)/V-1)*e+1;R.a*=X,R.b*=X}}if(x=P,y=O,r){const V=R.a,X=R.c,U=R.b,j=R.d;let z=0,N=0,G=0;if(c&&(c?z=b[T-1]:p[E+1]==0?z=b[T+2]:z=Math.atan2(D,F)),z-=Math.atan2(U,V),_){N=Math.cos(z),G=Math.sin(z);const q=C.data.length;x+=(q*(N*V-G*U)-F)*e,y+=(q*(G*V+N*U)-D)*e}else z+=w;z>I.PI?z-=I.PI2:z<-I.PI&&(z+=I.PI2),z*=e,N=Math.cos(z),G=Math.sin(z),R.a=N*V-G*U,R.c=N*X-G*j,R.b=G*V+N*U,R.d=G*X+N*j}C.appliedValid=!1}}computeWorldPositions(t,e,n,i,r){const a=this.target;let l=this.position;const o=this.spaces,h=$.setArraySize(this.positions,e*3+2);let c=null;const d=t.closed;let u=t.worldVerticesLength,f=u/6,m=ar.NONE;if(!t.constantSpeed){const z=t.lengths;f-=d?1:2;const N=z[f];if(i&&(l*=N),r)for(let G=0;G<e;G++)o[G]*=N;c=$.setArraySize(this.world,8);for(let G=0,q=0,K=0;G<e;G++,q+=3){const Q=o[G];l+=Q;let tt=l;if(d)tt%=N,tt<0&&(tt+=N),K=0;else if(tt<0){m!=ar.BEFORE&&(m=ar.BEFORE,t.computeWorldVertices(a,2,4,c,0,2)),this.addBeforePosition(tt,c,0,h,q);continue}else if(tt>N){m!=ar.AFTER&&(m=ar.AFTER,t.computeWorldVertices(a,u-6,4,c,0,2)),this.addAfterPosition(tt-N,c,0,h,q);continue}for(;;K++){const ht=z[K];if(!(tt>ht)){if(K==0)tt/=ht;else{const vt=z[K-1];tt=(tt-vt)/(ht-vt)}break}}K!=m&&(m=K,d&&K==f?(t.computeWorldVertices(a,u-4,4,c,0,2),t.computeWorldVertices(a,0,4,c,4,2)):t.computeWorldVertices(a,K*6+2,8,c,0,2)),this.addCurvePosition(tt,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,q,n||G>0&&Q==0)}return h}d?(u+=2,c=$.setArraySize(this.world,u),t.computeWorldVertices(a,2,u-4,c,0,2),t.computeWorldVertices(a,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(f--,u-=4,c=$.setArraySize(this.world,u),t.computeWorldVertices(a,2,u,c,0,2));const p=$.setArraySize(this.curves,f);let g=0,v=c[0],b=c[1],x=0,y=0,w=0,_=0,E=0,T=0,C=0,R=0,P=0,O=0,F=0,D=0,V=0,X=0;for(let z=0,N=2;z<f;z++,N+=6)x=c[N],y=c[N+1],w=c[N+2],_=c[N+3],E=c[N+4],T=c[N+5],C=(v-x*2+w)*.1875,R=(b-y*2+_)*.1875,P=((x-w)*3-v+E)*.09375,O=((y-_)*3-b+T)*.09375,F=C*2+P,D=R*2+O,V=(x-v)*.75+C+P*.16666667,X=(y-b)*.75+R+O*.16666667,g+=Math.sqrt(V*V+X*X),V+=F,X+=D,F+=P,D+=O,g+=Math.sqrt(V*V+X*X),V+=F,X+=D,g+=Math.sqrt(V*V+X*X),V+=F+P,X+=D+O,g+=Math.sqrt(V*V+X*X),p[z]=g,v=E,b=T;if(i&&(l*=g),r)for(let z=0;z<e;z++)o[z]*=g;const U=this.segments;let j=0;for(let z=0,N=0,G=0,q=0;z<e;z++,N+=3){const K=o[z];l+=K;let Q=l;if(d)Q%=g,Q<0&&(Q+=g),G=0;else if(Q<0){this.addBeforePosition(Q,c,0,h,N);continue}else if(Q>g){this.addAfterPosition(Q-g,c,u-4,h,N);continue}for(;;G++){const tt=p[G];if(!(Q>tt)){if(G==0)Q/=tt;else{const ht=p[G-1];Q=(Q-ht)/(tt-ht)}break}}if(G!=m){m=G;let tt=G*6;for(v=c[tt],b=c[tt+1],x=c[tt+2],y=c[tt+3],w=c[tt+4],_=c[tt+5],E=c[tt+6],T=c[tt+7],C=(v-x*2+w)*.03,R=(b-y*2+_)*.03,P=((x-w)*3-v+E)*.006,O=((y-_)*3-b+T)*.006,F=C*2+P,D=R*2+O,V=(x-v)*.3+C+P*.16666667,X=(y-b)*.3+R+O*.16666667,j=Math.sqrt(V*V+X*X),U[0]=j,tt=1;tt<8;tt++)V+=F,X+=D,F+=P,D+=O,j+=Math.sqrt(V*V+X*X),U[tt]=j;V+=F,X+=D,j+=Math.sqrt(V*V+X*X),U[8]=j,V+=F+P,X+=D+O,j+=Math.sqrt(V*V+X*X),U[9]=j,q=0}for(Q*=j;;q++){const tt=U[q];if(!(Q>tt)){if(q==0)Q/=tt;else{const ht=U[q-1];Q=q+(Q-ht)/(tt-ht)}break}}this.addCurvePosition(Q*.1,v,b,x,y,w,_,E,T,h,N,n||z>0&&K==0)}return h}addBeforePosition(t,e,n,i,r){const a=e[n],l=e[n+1],o=e[n+2]-a,h=e[n+3]-l,c=Math.atan2(h,o);i[r]=a+t*Math.cos(c),i[r+1]=l+t*Math.sin(c),i[r+2]=c}addAfterPosition(t,e,n,i,r){const a=e[n+2],l=e[n+3],o=a-e[n],h=l-e[n+1],c=Math.atan2(h,o);i[r]=a+t*Math.cos(c),i[r+1]=l+t*Math.sin(c),i[r+2]=c}addCurvePosition(t,e,n,i,r,a,l,o,h,c,d,u){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,v=g*p,b=p*t,x=b*3,y=p*x,w=x*t,_=e*v+i*y+a*w+o*m,E=n*v+r*y+l*w+h*m;c[d]=_,c[d+1]=E,u&&(c[d+2]=Math.atan2(E-(n*g+r*b*2+l*f),_-(e*g+i*b*2+a*f)))}getOrder(){return this.data.order}};let So=ar;So.NONE=-1;So.BEFORE=-2;So.AFTER=-3;So.epsilon=1e-5;let sy=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new fa,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,d=l*c-o*h>0?I.degRad:-I.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let b=!1;const x=v.matrix;if(t!=0){const y=x.a,w=x.c,_=x.b,E=x.d;let T=Math.atan2(h,l)-Math.atan2(_,y)+u;T>I.PI?T-=I.PI2:T<-I.PI&&(T+=I.PI2),T*=t;const C=Math.cos(T),R=Math.sin(T);x.a=C*y-R*_,x.c=C*w-R*E,x.b=R*y+C*_,x.d=R*w+C*E,b=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=(y.x-x.tx)*e,x.ty+=(y.y-x.ty)*e,b=!0}if(n>0){let y=Math.sqrt(x.a*x.a+x.b*x.b),w=Math.sqrt(l*l+h*h);y>1e-5&&(y=(y+(w-y+this.data.offsetScaleX)*n)/y),x.a*=y,x.b*=y,y=Math.sqrt(x.c*x.c+x.d*x.d),w=Math.sqrt(o*o+c*c),y>1e-5&&(y=(y+(w-y+this.data.offsetScaleY)*n)/y),x.c*=y,x.d*=y,b=!0}if(i>0){const y=x.c,w=x.d,_=Math.atan2(w,y);let E=Math.atan2(c,o)-Math.atan2(h,l)-(_-Math.atan2(x.b,x.a));E>I.PI?E-=I.PI2:E<-I.PI&&(E+=I.PI2),E=_+(E+f)*i;const T=Math.sqrt(y*y+w*w);x.c=Math.cos(E)*T,x.d=Math.sin(E)*T,b=!0}b&&(v.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,d=l*c-o*h>0?I.degRad:-I.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let b=!1;const x=v.matrix;if(t!=0){const y=x.a,w=x.c,_=x.b,E=x.d;let T=Math.atan2(h,l)+u;T>I.PI?T-=I.PI2:T<-I.PI&&(T+=I.PI2),T*=t;const C=Math.cos(T),R=Math.sin(T);x.a=C*y-R*_,x.c=C*w-R*E,x.b=R*y+C*_,x.d=R*w+C*E,b=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=y.x*e,x.ty+=y.y*e,b=!0}if(n>0){let y=(Math.sqrt(l*l+h*h)-1+this.data.offsetScaleX)*n+1;x.a*=y,x.b*=y,y=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*n+1,x.c*=y,x.d*=y,b=!0}if(i>0){let y=Math.atan2(c,o)-Math.atan2(h,l);y>I.PI?y-=I.PI2:y<-I.PI&&(y+=I.PI2);const w=x.c,_=x.d;y=Math.atan2(_,w)+(y-I.PI/2+f)*i;const E=Math.sqrt(w*w+_*_);x.c=Math.cos(y)*E,x.d=Math.sin(y)*E,b=!0}b&&(v.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=r.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let d=h.ax,u=h.ay;e!=0&&(d+=(r.ax-d+this.data.offsetX)*e,u+=(r.ay-u+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;n>0&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*n)/f),m>1e-5&&(m=(m+(r.ascaleY-m+this.data.offsetScaleY)*n)/m));const p=h.ashearY;if(i>0){let g=r.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*i}h.updateWorldTransformWith(d,u,c,f,m,h.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(r.arotation+this.data.offsetRotation)*t);let d=h.ax,u=h.ay;e!=0&&(d+=(r.ax+this.data.offsetX)*e,u+=(r.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;n>0&&(f>1e-5&&(f*=(r.ascaleX-1+this.data.offsetScaleX)*n+1),m>1e-5&&(m*=(r.ascaleY-1+this.data.offsetScaleY)*n+1));let p=h.ashearY;i>0&&(p+=(r.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(d,u,c,f,m,h.ashearX,p)}}getOrder(){return this.data.order}};const Wo=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let i;if(n.parent==null)i=new Hu(n,this,null);else{const r=this.bones[n.parent.index];i=new Hu(n,this,r),r.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],i=this.bones[n.boneData.index],r=new Hd(n,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new Qx(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new sy(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new So(n,this))}this.color=new at(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let c=0,d=e.length;c<d;c++)e[c].sorted=!1;const n=this.ikConstraints,i=this.transformConstraints,r=this.pathConstraints,a=n.length,l=i.length,o=r.length,h=a+l+o;t:for(let c=0;c<h;c++){for(let d=0;d<a;d++){const u=n[d];if(u.data.order==c){this.sortIkConstraint(u);continue t}}for(let d=0;d<l;d++){const u=i[d];if(u.data.order==c){this.sortTransformConstraint(u);continue t}}for(let d=0;d<o;d++){const u=r[d];if(u.data.order==c){this.sortPathConstraint(u);continue t}}}for(let c=0,d=e.length;c<d;c++)this.sortBone(e[c])}sortIkConstraint(t){const e=t.target;this.sortBone(e);const n=t.bones,i=n[0];if(this.sortBone(i),n.length>1){const r=n[n.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(i.children),n[n.length-1].sorted=!0}sortPathConstraint(t){const e=t.target,n=e.data.index,i=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,n,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(let o=0,h=this.data.skins.length;o<h;o++)this.sortPathConstraintAttachment(this.data.skins[o],n,i);const r=e.getAttachment();r instanceof pa&&this.sortPathConstraintAttachmentWith(r,i);const a=t.bones,l=a.length;for(let o=0;o<l;o++)this.sortBone(a[o]);this._updateCache.push(t);for(let o=0;o<l;o++)this.sortReset(a[o].children);for(let o=0;o<l;o++)a[o].sorted=!0}sortTransformConstraint(t){this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let i=0;i<n;i++){const r=e[i];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let i=0;i<n;i++)this.sortBone(e[i]);this._updateCache.push(t);for(let i=0;i<n;i++)this.sortReset(e[i].children);for(let i=0;i<n;i++)e[i].sorted=!0}sortPathConstraintAttachment(t,e,n){const i=t.attachments[e];if(i)for(const r in i)this.sortPathConstraintAttachmentWith(i[r],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof pa))return;const n=t.bones;if(n==null)this.sortBone(e);else{const i=this.bones;let r=0;for(;r<n.length;){const a=n[r++];for(let l=r+a;r<l;r++){const o=n[r];this.sortBone(i[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const i=t[e];i.sorted&&this.sortReset(i.children),i.sorted=!1}}updateWorldTransform(){const t=this.updateCacheReset;for(let n=0,i=t.length;n<i;n++){const r=t[n];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}const e=this._updateCache;for(let n=0,i=e.length;n<i;n++)e[n].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let r=0,a=t.length;r<a;r++)t[r].setToSetupPose();const e=this.ikConstraints;for(let r=0,a=e.length;r<a;r++){const l=e[r];l.bendDirection=l.data.bendDirection,l.mix=l.data.mix}const n=this.transformConstraints;for(let r=0,a=n.length;r<a;r++){const l=n[r],o=l.data;l.rotateMix=o.rotateMix,l.translateMix=o.translateMix,l.scaleMix=o.scaleMix,l.shearMix=o.shearMix}const i=this.pathConstraints;for(let r=0,a=i.length;r<a;r++){const l=i[r],o=l.data;l.position=o.position,l.spacing=o.spacing,l.rotateMix=o.rotateMix,l.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;$.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n],a=r.data.attachmentName;if(a!=null){const l=t.getAttachment(n,a);l!=null&&r.setAttachment(l)}}}this.skin=t}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const n=this.skin.getAttachment(t,e);if(n!=null)return n}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const n=this.slots;for(let i=0,r=n.length;i<r;i++){const a=n[i];if(a.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(i,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);a.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==t)return r}return null}getBounds(t,e,n){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const i=this.drawOrder;let r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let h=0,c=i.length;h<c;h++){const d=i[h];let u=0,f=null;const m=d.getAttachment();if(m instanceof Pt)u=8,f=$.setArraySize(n,u,0),m.computeWorldVertices(d.bone,f,0,2);else if(m instanceof Wd){const p=m;u=p.worldVerticesLength,f=$.setArraySize(n,u,0),p.computeWorldVertices(d,0,u,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const v=f[p],b=f[p+1];r=Math.min(r,v),a=Math.min(a,b),l=Math.max(l,v),o=Math.max(o,b)}}t.set(r,a),e.set(l-r,o-a)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){Wo.deprecatedWarning1||(Wo.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){Wo.deprecatedWarning1||(Wo.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let qd=Wo;qd.deprecatedWarning1=!1;let cC=class extends Td{},ny=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}},iy=class{constructor(t,e,n){if(this.color=new at(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(n==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}},ry=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}},oy=class{constructor(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,n){if(n==null)throw new Error("attachment cannot be null.");const i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}attachAll(t,e){let n=0;for(let i=0;i<t.slots.length;i++){const r=t.slots[i],a=r.getAttachment();if(a&&n<e.attachments.length){const l=e.attachments[n];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(n,o);c!=null&&r.setAttachment(c);break}}}n++}}},ay=class Wr{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new ny,i=typeof t=="string"?JSON.parse(t):t,r=i.skeleton;if(r!=null&&(n.hash=r.hash,n.version=r.spine,n.width=r.width,n.height=r.height,n.fps=r.fps,n.imagesPath=r.images),i.bones)for(let a=0;a<i.bones.length;a++){const l=i.bones[a];let o=null;const h=this.getValue(l,"parent",null);if(h!=null&&(o=n.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new Kx(n.bones.length,l.name,o);c.length=this.getValue(l,"length",0)*e,c.x=this.getValue(l,"x",0)*e,c.y=this.getValue(l,"y",0)*e,c.rotation=this.getValue(l,"rotation",0),c.scaleX=this.getValue(l,"scaleX",1),c.scaleY=this.getValue(l,"scaleY",1),c.shearX=this.getValue(l,"shearX",0),c.shearY=this.getValue(l,"shearY",0),c.transformMode=Wr.transformModeFromString(this.getValue(l,"transform","normal")),n.bones.push(c)}if(i.slots)for(let a=0;a<i.slots.length;a++){const l=i.slots[a],o=l.name,h=l.bone,c=n.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);const d=new iy(n.slots.length,o,c),u=this.getValue(l,"color",null);u!=null&&d.color.setFromString(u);const f=this.getValue(l,"dark",null);f!=null&&(d.darkColor=new at(1,1,1,1),d.darkColor.setFromString(f)),d.attachmentName=this.getValue(l,"attachment",null),d.blendMode=Wr.blendModeFromString(this.getValue(l,"blend","normal")),n.slots.push(d)}if(i.ik)for(let a=0;a<i.ik.length;a++){const l=i.ik[a],o=new ty(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`IK bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,o.mix=this.getValue(l,"mix",1),n.ikConstraints.push(o)}if(i.transform)for(let a=0;a<i.transform.length;a++){const l=i.transform[a],o=new ry(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(l,"local",!1),o.relative=this.getValue(l,"relative",!1),o.offsetRotation=this.getValue(l,"rotation",0),o.offsetX=this.getValue(l,"x",0)*e,o.offsetY=this.getValue(l,"y",0)*e,o.offsetScaleX=this.getValue(l,"scaleX",0),o.offsetScaleY=this.getValue(l,"scaleY",0),o.offsetShearY=this.getValue(l,"shearY",0),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),o.scaleMix=this.getValue(l,"scaleMix",1),o.shearMix=this.getValue(l,"shearMix",1),n.transformConstraints.push(o)}if(i.path)for(let a=0;a<i.path.length;a++){const l=i.path[a],o=new ey(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const d=l.bones[c],u=n.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);o.bones.push(u)}const h=l.target;if(o.target=n.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=Wr.positionModeFromString(this.getValue(l,"positionMode","percent")),o.spacingMode=Wr.spacingModeFromString(this.getValue(l,"spacingMode","length")),o.rotateMode=Wr.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),o.offsetRotation=this.getValue(l,"rotation",0),o.position=this.getValue(l,"position",0),o.positionMode==fe.Fixed&&(o.position*=e),o.spacing=this.getValue(l,"spacing",0),(o.spacingMode==bn.Length||o.spacingMode==bn.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),n.pathConstraints.push(o)}if(i.skins)for(const a in i.skins){const l=i.skins[a],o=new oy(a);for(const h in l){const c=n.findSlotIndex(h);if(c==-1)throw new Error(`Slot not found: ${h}`);const d=l[h];for(const u in d){const f=this.readAttachment(d[u],o,c,u,n);f!=null&&o.addAttachment(c,u,f)}}n.skins.push(o),o.name=="default"&&(n.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin==null?n.defaultSkin:n.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,i.events)for(const a in i.events){const l=i.events[a],o=new Jx(a);o.intValue=this.getValue(l,"int",0),o.floatValue=this.getValue(l,"float",0),o.stringValue=this.getValue(l,"string",""),o.audioPath=this.getValue(l,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(l,"volume",1),o.balance=this.getValue(l,"balance",0)),n.events.push(o)}if(i.animations)for(const a in i.animations){const l=i.animations[a];this.readAnimation(l,a,n)}return n}readAttachment(t,e,n,i,r){const a=this.scale;switch(i=this.getValue(t,"name",i),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",i),h=this.attachmentLoader.newRegionAttachment(e,i,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*a,h.y=this.getValue(t,"y",0)*a,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*a,h.height=t.height*a;const c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",i),h=this.attachmentLoader.newMeshAttachment(e,i,o);if(h==null)return null;h.path=o;const c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c);const d=this.getValue(t,"parent",null);if(d!=null)return h.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new uC(h,this.getValue(t,"skin",null),n,d)),h;const u=t.uvs;return this.readVertices(t,h,u.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(u),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{const o=this.attachmentLoader.newPathAttachment(e,i);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const h=t.vertexCount;this.readVertices(t,o,h<<1);const c=$.newArray(h/3,0);for(let u=0;u<t.lengths.length;u++)c[u]=t.lengths[u]*a;o.lengths=c;const d=this.getValue(t,"color",null);return d!=null&&o.color.setFromString(d),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,i);if(o==null)return null;o.x=this.getValue(t,"x",0)*a,o.y=this.getValue(t,"y",0)*a,o.rotation=this.getValue(t,"rotation",0);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,i);if(o==null)return null;const h=this.getValue(t,"end",null);if(h!=null){const u=r.findSlot(h);if(u==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=u}const c=t.vertexCount;this.readVertices(t,o,c<<1);const d=this.getValue(t,"color",null);return d!=null&&o.color.setFromString(d),o}}return null}readVertices(t,e,n){const i=this.scale;e.worldVerticesLength=n;const r=t.vertices;if(n==r.length){const o=$.toFloatArray(r);if(i!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=i;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let d=o+c*4;o<d;o+=4)l.push(r[o]),a.push(r[o+1]*i),a.push(r[o+2]*i),a.push(r[o+3])}e.bones=l,e.vertices=$.toFloatArray(a)}readAnimation(t,e,n){const i=this.scale,r=new Array;let a=0;if(t.slots)for(const o in t.slots){const h=t.slots[o],c=n.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(const d in h){const u=h[d];if(d=="attachment"){const f=new Ll(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m++,g.time,g.name)}r.push(f),a=Math.max(a,f.frames[f.getFrameCount()-1])}else if(d=="color"){const f=new Us(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p],v=new at;v.setFromString(g.color||"ffffffff"),f.setFrame(m,g.time,v.r,v.g,v.b,v.a),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Us.ENTRIES])}else if(d=="twoColor"){const f=new Ne(u.length);f.slotIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p],v=new at,b=new at;v.setFromString(g.light),b.setFromString(g.dark),f.setFrame(m,g.time,v.r,v.g,v.b,v.a,b.r,b.g,b.b),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Ne.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${d} (${o})`)}}if(t.bones)for(const o in t.bones){const h=t.bones[o],c=n.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(const d in h){const u=h[d];if(d==="rotate"){const f=new ps(u.length);f.boneIndex=c;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m,g.time,g.angle),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*ps.ENTRIES])}else if(d==="translate"||d==="scale"||d==="shear"){let f=null,m=1;d==="scale"?f=new Gx(u.length):d==="shear"?f=new Wx(u.length):(f=new Pn(u.length),m=i),f.boneIndex=c;let p=0;for(let g=0;g<u.length;g++){const v=u[g],b=this.getValue(v,"x",0),x=this.getValue(v,"y",0);f.setFrame(p,v.time,b*m,x*m),this.readCurve(v,f,p),p++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Pn.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${d} (${o})`)}}if(t.ik)for(const o in t.ik){const h=t.ik[o],c=n.findIkConstraint(o),d=new Xs(h.length);d.ikConstraintIndex=n.ikConstraints.indexOf(c);let u=0;for(let f=0;f<h.length;f++){const m=h[f];d.setFrame(u,m.time,this.getValue(m,"mix",1),this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,d,u),u++}r.push(d),a=Math.max(a,d.frames[(d.getFrameCount()-1)*Xs.ENTRIES])}if(t.transform)for(const o in t.transform){const h=t.transform[o],c=n.findTransformConstraint(o),d=new Ys(h.length);d.transformConstraintIndex=n.transformConstraints.indexOf(c);let u=0;for(let f=0;f<h.length;f++){const m=h[f];d.setFrame(u,m.time,this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,d,u),u++}r.push(d),a=Math.max(a,d.frames[(d.getFrameCount()-1)*Ys.ENTRIES])}if(t.paths)for(const o in t.paths){const h=t.paths[o],c=n.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);const d=n.pathConstraints[c];for(const u in h){const f=h[u];if(u==="position"||u==="spacing"){let m=null,p=1;u==="spacing"?(m=new jx(f.length),(d.spacingMode==bn.Length||d.spacingMode==bn.Fixed)&&(p=i)):(m=new $i(f.length),d.positionMode==fe.Fixed&&(p=i)),m.pathConstraintIndex=c;let g=0;for(let v=0;v<f.length;v++){const b=f[v];m.setFrame(g,b.time,this.getValue(b,u,0)*p),this.readCurve(b,m,g),g++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*$i.ENTRIES])}else if(u==="mix"){const m=new vi(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){const v=f[g];m.setFrame(p,v.time,this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,m,p),p++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*vi.ENTRIES])}}}if(t.deform)for(const o in t.deform){const h=t.deform[o],c=n.findSkin(o);if(c!=null)for(const d in h){const u=h[d],f=n.findSlotIndex(d);if(f==-1)throw new Error(`Slot not found: ${u.name}`);for(const m in u){const p=u[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const v=g.bones!=null,b=g.vertices,x=v?b.length/3*2:b.length,y=new Hx(p.length);y.slotIndex=f,y.attachment=g;let w=0;for(let _=0;_<p.length;_++){const E=p[_];let T;const C=this.getValue(E,"vertices",null);if(C==null)T=v?$.newFloatArray(x):b;else{T=$.newFloatArray(x);const R=this.getValue(E,"offset",0);if($.arrayCopy(C,0,T,R,C.length),i!=1)for(let P=R,O=P+C.length;P<O;P++)T[P]*=i;if(!v)for(let P=0;P<x;P++)T[P]+=b[P]}y.setFrame(w,E.time,T),this.readCurve(E,y,w),w++}r.push(y),a=Math.max(a,y.frames[y.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const o=new Vl(l.length),h=n.slots.length;let c=0;for(let d=0;d<l.length;d++){const u=l[d];let f=null;const m=this.getValue(u,"offsets",null);if(m!=null){f=$.newArray(h,-1);const p=$.newArray(h-m.length,0);let g=0,v=0;for(let b=0;b<m.length;b++){const x=m[b],y=n.findSlotIndex(x.slot);if(y==-1)throw new Error(`Slot not found: ${x.slot}`);for(;g!=y;)p[v++]=g++;f[g+x.offset]=g++}for(;g<h;)p[v++]=g++;for(let b=h-1;b>=0;b--)f[b]==-1&&(f[b]=p[--v])}o.setFrame(c++,u.time,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(t.events){const o=new zx(t.events.length);let h=0;for(let c=0;c<t.events.length;c++){const d=t.events[c],u=n.findEvent(d.name);if(u==null)throw new Error(`Event not found: ${d.name}`);const f=new Zx($.toSinglePrecision(d.time),u);f.intValue=this.getValue(d,"int",u.intValue),f.floatValue=this.getValue(d,"float",u.floatValue),f.stringValue=this.getValue(d,"string",u.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(d,"volume",1),f.balance=this.getValue(d,"balance",0)),o.setFrame(h++,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new Le(e,r,a))}readCurve(t,e,n){if(t.curve){if(t.curve==="stepped")e.setStepped(n);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){const i=t.curve;e.setCurve(n,i[0],i[1],i[2],i[3])}}}getValue(t,e,n){return t[e]!==void 0?t[e]:n}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return ft.NORMAL;if(t=="additive")return ft.ADD;if(t=="multiply")return ft.MULTIPLY;if(t=="screen")return ft.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return fe.Fixed;if(t=="percent")return fe.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return bn.Length;if(t=="fixed")return bn.Fixed;if(t=="percent")return bn.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return Te.Tangent;if(t=="chain")return Te.Chain;if(t=="chainscale")return Te.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Tt.Normal;if(t=="onlytranslation")return Tt.OnlyTranslation;if(t=="norotationorreflection")return Tt.NoRotationOrReflection;if(t=="noscale")return Tt.NoScale;if(t=="noscaleorreflection")return Tt.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},uC=class{constructor(t,e,n,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i}},dC=class extends _o{createSkeleton(t){this.skeleton=new qd(t),this.skeleton.updateWorldTransform(),this.stateData=new jd(t),this.state=new Qn(this.stateData)}};const fC=Object.freeze(Object.defineProperty({__proto__:null,Animation:Le,AnimationState:Qn,AnimationStateAdapter2:hC,AnimationStateData:jd,AtlasAttachmentLoader:qx,Attachment:Gd,AttachmentTimeline:Ll,Bone:Hu,BoneData:Kx,BoundingBoxAttachment:Lx,ClippingAttachment:Vx,ColorTimeline:Us,CurveTimeline:Rs,DeformTimeline:Hx,DrawOrderTimeline:Vl,Event:Zx,EventData:Jx,EventQueue:zd,EventTimeline:zx,EventType:Es,IkConstraint:Qx,IkConstraintData:ty,IkConstraintTimeline:Xs,JitterEffect:lC,MeshAttachment:Wd,PathAttachment:pa,PathConstraint:So,PathConstraintData:ey,PathConstraintMixTimeline:vi,PathConstraintPositionTimeline:$i,PathConstraintSpacingTimeline:jx,PointAttachment:Ux,RegionAttachment:Pt,RotateTimeline:ps,ScaleTimeline:Gx,ShearTimeline:Wx,Skeleton:qd,SkeletonBounds:cC,SkeletonData:ny,SkeletonJson:ay,Skin:oy,Slot:Hd,SlotData:iy,SpacingMode:bn,Spine:dC,SwirlEffect:Yx,TimelineType:$x,TrackEntry:Eh,TransformConstraint:sy,TransformConstraintData:ry,TransformConstraintTimeline:Ys,TranslateTimeline:Pn,TwoColorTimeline:Ne,VertexAttachment:zi},Symbol.toStringTag,{value:"Module"}));class Kd{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const ly=class extends Kd{constructor(s){super(s),this.id=ly.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(s,t){this.computeWorldVertices(s,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(s,t,e,n,i,r){e=i+(e>>1)*r;const a=s.bone.skeleton,l=s.deform;let o=this.vertices;const h=this.bones;if(!h){l.length>0&&(o=l);const f=s.bone.matrix,m=f.tx,p=f.ty,g=f.a,v=f.c,b=f.b,x=f.d;for(let y=t,w=i;w<e;y+=2,w+=r){const _=o[y],E=o[y+1];n[w]=_*g+E*v+m,n[w+1]=_*b+E*x+p}return}let c=0,d=0;for(let f=0;f<t;f+=2){const m=h[c];c+=m+1,d+=m}const u=a.bones;if(l.length==0)for(let f=i,m=d*3;f<e;f+=r){let p=0,g=0,v=h[c++];for(v+=c;c<v;c++,m+=3){const b=u[h[c]].matrix,x=o[m],y=o[m+1],w=o[m+2];p+=(x*b.a+y*b.c+b.tx)*w,g+=(x*b.b+y*b.d+b.ty)*w}n[f]=p,n[f+1]=g}else{const f=l;for(let m=i,p=d*3,g=d<<1;m<e;m+=r){let v=0,b=0,x=h[c++];for(x+=c;c<x;c++,p+=3,g+=2){const y=u[h[c]].matrix,w=o[p]+f[g],_=o[p+1]+f[g+1],E=o[p+2];v+=(w*y.a+_*y.c+y.tx)*E,b+=(w*y.b+_*y.d+y.ty)*E}n[m]=v,n[m+1]=b}}}copyTo(s){this.bones?(s.bones=new Array(this.bones.length),$.arrayCopy(this.bones,0,s.bones,0,this.bones.length)):s.bones=null,this.vertices&&(s.vertices=$.newFloatArray(this.vertices.length),$.arrayCopy(this.vertices,0,s.vertices,0,this.vertices.length)),s.worldVerticesLength=this.worldVerticesLength,s.timelineAttachment=this.timelineAttachment}};let kn=ly;kn.nextID=0;class Sh extends kn{constructor(t){super(t),this.type=Bt.BoundingBox,this.color=new at(1,1,1,1)}copy(){const t=new Sh(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class Th extends kn{constructor(t){super(t),this.type=Bt.Clipping,this.endSlot=null,this.color=new at(.2275,.2275,.8078,1)}copy(){const t=new Th(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Sr extends kn{constructor(t,e){super(t),this.type=Bt.Mesh,this.region=null,this.triangles=[],this.color=new at(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new at(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new Sr(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),$.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),$.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),$.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,n,i,r,a){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,n,i,r,a)}newLinkedMesh(){const t=new Sr(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class Tr extends kn{constructor(t){super(t),this.type=Bt.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new at(1,1,1,1)}copy(){const t=new Tr(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),$.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class Ah extends kn{constructor(t){super(t),this.type=Bt.Point,this.x=0,this.y=0,this.rotation=0,this.color=new at(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=I.cosDeg(this.rotation),i=I.sinDeg(this.rotation),r=n*e.a+i*e.c,a=n*e.b+i*e.d;return Math.atan2(a,r)*I.radDeg}copy(){const t=new Ah(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const hy=class extends Kd{constructor(s,t){super(s),this.type=Bt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new at(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new at(1,1,1,1),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");const s=this.region,t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,r=n+this.region.width*t,a=i+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=this.x,d=this.y,u=n*o+c,f=n*h,m=i*o+d,p=i*h,g=r*o+c,v=r*h,b=a*o+d,x=a*h,y=this.offset;y[0]=u-p,y[1]=m+f,y[2]=u-x,y[3]=b+f,y[4]=g-x,y[5]=b+v,y[6]=g-p,y[7]=m+v;const w=this.uvs;s.degrees==90?(w[2]=s.u,w[3]=s.v2,w[4]=s.u,w[5]=s.v,w[6]=s.u2,w[7]=s.v,w[0]=s.u2,w[1]=s.v2):(w[0]=s.u,w[1]=s.v2,w[2]=s.u,w[3]=s.v,w[4]=s.u2,w[5]=s.v,w[6]=s.u2,w[7]=s.v2)}computeWorldVertices(s,t,e,n){this.sequence!=null&&this.sequence.apply(s,this);const i=s.bone,r=this.offset,a=i.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,d=a.b,u=a.d;let f=0,m=0;f=r[0],m=r[1],t[e]=f*h+m*c+l,t[e+1]=f*d+m*u+o,e+=n,f=r[2],m=r[3],t[e]=f*h+m*c+l,t[e+1]=f*d+m*u+o,e+=n,f=r[4],m=r[5],t[e]=f*h+m*c+l,t[e+1]=f*d+m*u+o,e+=n,f=r[6],m=r[7],t[e]=f*h+m*c+l,t[e+1]=f*d+m*u+o}copy(){const s=new hy(this.name,this.path);return s.region=this.region,s.rendererObject=this.rendererObject,s.x=this.x,s.y=this.y,s.scaleX=this.scaleX,s.scaleY=this.scaleY,s.rotation=this.rotation,s.width=this.width,s.height=this.height,$.arrayCopy(this.uvs,0,s.uvs,0,8),$.arrayCopy(this.offset,0,s.offset,0,8),s.color.setFromColor(this.color),s.sequence=this.sequence!=null?this.sequence.copy():null,s}};let Gt=hy;Gt.X1=0;Gt.Y1=1;Gt.C1R=2;Gt.C1G=3;Gt.C1B=4;Gt.C1A=5;Gt.U1=6;Gt.V1=7;Gt.X2=8;Gt.Y2=9;Gt.C2R=10;Gt.C2G=11;Gt.C2B=12;Gt.C2A=13;Gt.U2=14;Gt.V2=15;Gt.X3=16;Gt.Y3=17;Gt.C3R=18;Gt.C3G=19;Gt.C3B=20;Gt.C3A=21;Gt.U3=22;Gt.V3=23;Gt.X4=24;Gt.Y4=25;Gt.C4R=26;Gt.C4G=27;Gt.C4B=28;Gt.C4A=29;Gt.U4=30;Gt.V4=31;const pl=class{constructor(s){this.id=pl.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(s)}copy(){const s=new pl(this.regions.length);return $.arrayCopy(this.regions,0,s.regions,0,this.regions.length),s.start=this.start,s.digits=this.digits,s.setupIndex=this.setupIndex,s}apply(s,t){let e=s.sequenceIndex;e==-1&&(e=this.setupIndex),e>=this.regions.length&&(e=this.regions.length-1);const n=this.regions[e];t.region!=n&&(t.region=n)}getPath(s,t){let e=s;const n=(this.start+t).toString();for(let i=this.digits-n.length;i>0;i--)e+="0";return e+=n,e}static nextID(){return pl._nextID++}};let Ch=pl;Ch._nextID=0;var Wn=(s=>(s[s.hold=0]="hold",s[s.once=1]="once",s[s.loop=2]="loop",s[s.pingpong=3]="pingpong",s[s.onceReverse=4]="onceReverse",s[s.loopReverse=5]="loopReverse",s[s.pingpongReverse=6]="pingpongReverse",s))(Wn||{});const Zd=[0,1,2,3,4,5,6];class Mh{constructor(t,e,n){if(this.timelines=[],this.timelineIds=new bx,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=n}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,n,i,r,a,l,o){if(!t)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(n%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,d=h.length;c<d;c++)h[c].apply(t,e,n,r,a,l,o)}}const zt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};class we{constructor(t,e){this.propertyIds=e,this.frames=$.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const n=t.length;for(let i=1;i<n;i++)if(t[i]>e)return i-1;return n-1}static search(t,e,n){const i=t.length;for(let r=n;r<i;r+=n)if(t[r]>e)return r-n;return i-n}}class Dn extends we{constructor(t,e,n){super(t,n),this.curves=$.newFloatArray(t+e*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+t*18;if(this.curves.length>e){const n=$.newFloatArray(e);$.arrayCopy(this.curves,0,n,0,e),this.curves=n}}setBezier(t,e,n,i,r,a,l,o,h,c,d){const u=this.curves;let f=this.getFrameCount()+t*18;n==0&&(u[e]=2+f);const m=(i-a*2+o)*.03,p=(r-l*2+h)*.03,g=((a-o)*3-i+c)*.006,v=((l-h)*3-r+d)*.006;let b=m*2+g,x=p*2+v,y=(a-i)*.3+m+g*.16666667,w=(l-r)*.3+p+v*.16666667,_=i+y,E=r+w;for(let T=f+18;f<T;f+=2)u[f]=_,u[f+1]=E,y+=b,w+=x,b+=g,x+=v,_+=y,E+=w}getBezierValue(t,e,n,i){const r=this.curves;if(r[i]>t){const h=this.frames[e],c=this.frames[e+n];return c+(t-h)/(r[i]-h)*(r[i+1]-c)}const a=i+18;for(i+=2;i<a;i+=2)if(r[i]>=t){const h=r[i-2],c=r[i-1];return c+(t-h)/(r[i]-h)*(r[i+1]-c)}e+=this.getFrameEntries();const l=r[a-2],o=r[a-1];return o+(t-l)/(this.frames[e]-l)*(this.frames[e+n]-o)}}class Bn extends Dn{constructor(t,e,n){super(t,e,[n])}getFrameEntries(){return 2}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+1]=n}getCurveValue(t){const e=this.frames;let n=e.length-2;for(let r=2;r<=n;r+=2)if(e[r]>t){n=r-2;break}const i=this.curves[n>>1];switch(i){case 0:const r=e[n],a=e[n+1];return a+(t-r)/(e[n+2]-r)*(e[n+2+1]-a);case 1:return e[n+1]}return this.getBezierValue(t,n,1,i-2)}}class Ih extends Dn{constructor(t,e,n,i){super(t,e,[n,i])}getFrameEntries(){return 3}setFrame(t,e,n,i){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i}}class ga extends Bn{constructor(t,e,n){super(t,e,`${zt.rotate}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.rotation=o.data.rotation;return;case A.first:o.rotation+=(o.data.rotation-o.rotation)*r}return}let c=this.getCurveValue(n);switch(a){case A.setup:o.rotation=o.data.rotation+c*r;break;case A.first:case A.replace:c+=o.data.rotation-o.rotation;case A.add:o.rotation+=c*r}}}class Jd extends Ih{constructor(t,e,n){super(t,e,`${zt.x}|${n}`,`${zt.y}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.x=o.data.x,o.y=o.data.y;return;case A.first:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}return}let c=0,d=0;const u=we.search(h,n,3),f=this.curves[u/3];switch(f){case 0:const m=h[u];c=h[u+1],d=h[u+2];const p=(n-m)/(h[u+3]-m);c+=(h[u+3+1]-c)*p,d+=(h[u+3+2]-d)*p;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(n,u,1,f-2),d=this.getBezierValue(n,u,2,f+18-2)}switch(a){case A.setup:o.x=o.data.x+c*r,o.y=o.data.y+d*r;break;case A.first:case A.replace:o.x+=(o.data.x+c-o.x)*r,o.y+=(o.data.y+d-o.y)*r;break;case A.add:o.x+=c*r,o.y+=d*r}}}class Qd extends Bn{constructor(t,e,n){super(t,e,`${zt.x}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.x=o.data.x;return;case A.first:o.x+=(o.data.x-o.x)*r}return}const c=this.getCurveValue(n);switch(a){case A.setup:o.x=o.data.x+c*r;break;case A.first:case A.replace:o.x+=(o.data.x+c-o.x)*r;break;case A.add:o.x+=c*r}}}class tf extends Bn{constructor(t,e,n){super(t,e,`${zt.y}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.y=o.data.y;return;case A.first:o.y+=(o.data.y-o.y)*r}return}const c=this.getCurveValue(n);switch(a){case A.setup:o.y=o.data.y+c*r;break;case A.first:case A.replace:o.y+=(o.data.y+c-o.y)*r;break;case A.add:o.y+=c*r}}}class ef extends Ih{constructor(t,e,n){super(t,e,`${zt.scaleX}|${n}`,`${zt.scaleY}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.scaleX=o.data.scaleX,o.scaleY=o.data.scaleY;return;case A.first:o.scaleX+=(o.data.scaleX-o.scaleX)*r,o.scaleY+=(o.data.scaleY-o.scaleY)*r}return}let c,d;const u=we.search(h,n,3),f=this.curves[u/3];switch(f){case 0:const m=h[u];c=h[u+1],d=h[u+2];const p=(n-m)/(h[u+3]-m);c+=(h[u+3+1]-c)*p,d+=(h[u+3+2]-d)*p;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(n,u,1,f-2),d=this.getBezierValue(n,u,2,f+18-2)}if(c*=o.data.scaleX,d*=o.data.scaleY,r==1)a==A.add?(o.scaleX+=c-o.data.scaleX,o.scaleY+=d-o.data.scaleY):(o.scaleX=c,o.scaleY=d);else{let m=0,p=0;if(l==Ft.mixOut)switch(a){case A.setup:m=o.data.scaleX,p=o.data.scaleY,o.scaleX=m+(Math.abs(c)*I.signum(m)-m)*r,o.scaleY=p+(Math.abs(d)*I.signum(p)-p)*r;break;case A.first:case A.replace:m=o.scaleX,p=o.scaleY,o.scaleX=m+(Math.abs(c)*I.signum(m)-m)*r,o.scaleY=p+(Math.abs(d)*I.signum(p)-p)*r;break;case A.add:o.scaleX+=(c-o.data.scaleX)*r,o.scaleY+=(d-o.data.scaleY)*r}else switch(a){case A.setup:m=Math.abs(o.data.scaleX)*I.signum(c),p=Math.abs(o.data.scaleY)*I.signum(d),o.scaleX=m+(c-m)*r,o.scaleY=p+(d-p)*r;break;case A.first:case A.replace:m=Math.abs(o.scaleX)*I.signum(c),p=Math.abs(o.scaleY)*I.signum(d),o.scaleX=m+(c-m)*r,o.scaleY=p+(d-p)*r;break;case A.add:o.scaleX+=(c-o.data.scaleX)*r,o.scaleY+=(d-o.data.scaleY)*r}}}}class sf extends Bn{constructor(t,e,n){super(t,e,`${zt.scaleX}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.scaleX=o.data.scaleX;return;case A.first:o.scaleX+=(o.data.scaleX-o.scaleX)*r}return}const c=this.getCurveValue(n)*o.data.scaleX;if(r==1)a==A.add?o.scaleX+=c-o.data.scaleX:o.scaleX=c;else{let d=0;if(l==Ft.mixOut)switch(a){case A.setup:d=o.data.scaleX,o.scaleX=d+(Math.abs(c)*I.signum(d)-d)*r;break;case A.first:case A.replace:d=o.scaleX,o.scaleX=d+(Math.abs(c)*I.signum(d)-d)*r;break;case A.add:o.scaleX+=(c-o.data.scaleX)*r}else switch(a){case A.setup:d=Math.abs(o.data.scaleX)*I.signum(c),o.scaleX=d+(c-d)*r;break;case A.first:case A.replace:d=Math.abs(o.scaleX)*I.signum(c),o.scaleX=d+(c-d)*r;break;case A.add:o.scaleX+=(c-o.data.scaleX)*r}}}}class nf extends Bn{constructor(t,e,n){super(t,e,`${zt.scaleY}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.scaleY=o.data.scaleY;return;case A.first:o.scaleY+=(o.data.scaleY-o.scaleY)*r}return}const c=this.getCurveValue(n)*o.data.scaleY;if(r==1)a==A.add?o.scaleY+=c-o.data.scaleY:o.scaleY=c;else{let d=0;if(l==Ft.mixOut)switch(a){case A.setup:d=o.data.scaleY,o.scaleY=d+(Math.abs(c)*I.signum(d)-d)*r;break;case A.first:case A.replace:d=o.scaleY,o.scaleY=d+(Math.abs(c)*I.signum(d)-d)*r;break;case A.add:o.scaleY+=(c-o.data.scaleY)*r}else switch(a){case A.setup:d=Math.abs(o.data.scaleY)*I.signum(c),o.scaleY=d+(c-d)*r;break;case A.first:case A.replace:d=Math.abs(o.scaleY)*I.signum(c),o.scaleY=d+(c-d)*r;break;case A.add:o.scaleY+=(c-o.data.scaleY)*r}}}}class rf extends Ih{constructor(t,e,n){super(t,e,`${zt.shearX}|${n}`,`${zt.shearY}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.shearX=o.data.shearX,o.shearY=o.data.shearY;return;case A.first:o.shearX+=(o.data.shearX-o.shearX)*r,o.shearY+=(o.data.shearY-o.shearY)*r}return}let c=0,d=0;const u=we.search(h,n,3),f=this.curves[u/3];switch(f){case 0:const m=h[u];c=h[u+1],d=h[u+2];const p=(n-m)/(h[u+3]-m);c+=(h[u+3+1]-c)*p,d+=(h[u+3+2]-d)*p;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(n,u,1,f-2),d=this.getBezierValue(n,u,2,f+18-2)}switch(a){case A.setup:o.shearX=o.data.shearX+c*r,o.shearY=o.data.shearY+d*r;break;case A.first:case A.replace:o.shearX+=(o.data.shearX+c-o.shearX)*r,o.shearY+=(o.data.shearY+d-o.shearY)*r;break;case A.add:o.shearX+=c*r,o.shearY+=d*r}}}class of extends Bn{constructor(t,e,n){super(t,e,`${zt.shearX}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.shearX=o.data.shearX;return;case A.first:o.shearX+=(o.data.shearX-o.shearX)*r}return}const c=this.getCurveValue(n);switch(a){case A.setup:o.shearX=o.data.shearX+c*r;break;case A.first:case A.replace:o.shearX+=(o.data.shearX+c-o.shearX)*r;break;case A.add:o.shearX+=c*r}}}class af extends Bn{constructor(t,e,n){super(t,e,`${zt.shearY}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,i,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.shearY=o.data.shearY;return;case A.first:o.shearY+=(o.data.shearY-o.shearY)*r}return}const c=this.getCurveValue(n);switch(a){case A.setup:o.shearY=o.data.shearY+c*r;break;case A.first:case A.replace:o.shearY+=(o.data.shearY+c-o.shearY)*r;break;case A.add:o.shearY+=c*r}}}class lf extends Dn{constructor(t,e,n){super(t,e,[`${zt.rgb}|${n}`,`${zt.alpha}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 5}setFrame(t,e,n,i,r,a){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=a}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color;if(n<h[0]){const v=o.data.color;switch(a){case A.setup:c.setFromColor(v);return;case A.first:c.add((v.r-c.r)*r,(v.g-c.g)*r,(v.b-c.b)*r,(v.a-c.a)*r)}return}let d=0,u=0,f=0,m=0;const p=we.search(h,n,5),g=this.curves[p/5];switch(g){case 0:const v=h[p];d=h[p+1],u=h[p+2],f=h[p+3],m=h[p+4];const b=(n-v)/(h[p+5]-v);d+=(h[p+5+1]-d)*b,u+=(h[p+5+2]-u)*b,f+=(h[p+5+3]-f)*b,m+=(h[p+5+4]-m)*b;break;case 1:d=h[p+1],u=h[p+2],f=h[p+3],m=h[p+4];break;default:d=this.getBezierValue(n,p,1,g-2),u=this.getBezierValue(n,p,2,g+18-2),f=this.getBezierValue(n,p,3,g+18*2-2),m=this.getBezierValue(n,p,4,g+18*3-2)}r==1?c.set(d,u,f,m):(a==A.setup&&c.setFromColor(o.data.color),c.add((d-c.r)*r,(u-c.g)*r,(f-c.b)*r,(m-c.a)*r))}}class hf extends Dn{constructor(t,e,n){super(t,e,[`${zt.rgb}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,i,r){t<<=2,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color;if(n<h[0]){const g=o.data.color;switch(a){case A.setup:c.r=g.r,c.g=g.g,c.b=g.b;return;case A.first:c.r+=(g.r-c.r)*r,c.g+=(g.g-c.g)*r,c.b+=(g.b-c.b)*r}return}let d=0,u=0,f=0;const m=we.search(h,n,4),p=this.curves[m>>2];switch(p){case 0:const g=h[m];d=h[m+1],u=h[m+2],f=h[m+3];const v=(n-g)/(h[m+4]-g);d+=(h[m+4+1]-d)*v,u+=(h[m+4+2]-u)*v,f+=(h[m+4+3]-f)*v;break;case 1:d=h[m+1],u=h[m+2],f=h[m+3];break;default:d=this.getBezierValue(n,m,1,p-2),u=this.getBezierValue(n,m,2,p+18-2),f=this.getBezierValue(n,m,3,p+18*2-2)}if(r==1)c.r=d,c.g=u,c.b=f;else{if(a==A.setup){const g=o.data.color;c.r=g.r,c.g=g.g,c.b=g.b}c.r+=(d-c.r)*r,c.g+=(u-c.g)*r,c.b+=(f-c.b)*r}}}class cf extends Bn{constructor(t,e,n){super(t,e,`${zt.alpha}|${n}`),this.slotIndex=0,this.slotIndex=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.color;if(n<this.frames[0]){const d=o.data.color;switch(a){case A.setup:h.a=d.a;return;case A.first:h.a+=(d.a-h.a)*r}return}const c=this.getCurveValue(n);r==1?h.a=c:(a==A.setup&&(h.a=o.data.color.a),h.a+=(c-h.a)*r)}}class uf extends Dn{constructor(t,e,n){super(t,e,[`${zt.rgb}|${n}`,`${zt.alpha}|${n}`,`${zt.rgb2}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 8}setFrame(t,e,n,i,r,a,l,o,h){t<<=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=a,this.frames[t+5]=l,this.frames[t+6]=o,this.frames[t+7]=h}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color,d=o.darkColor;if(n<h[0]){const w=o.data.color,_=o.data.darkColor;switch(a){case A.setup:c.setFromColor(w),d.r=_.r,d.g=_.g,d.b=_.b;return;case A.first:c.add((w.r-c.r)*r,(w.g-c.g)*r,(w.b-c.b)*r,(w.a-c.a)*r),d.r+=(_.r-d.r)*r,d.g+=(_.g-d.g)*r,d.b+=(_.b-d.b)*r}return}let u=0,f=0,m=0,p=0,g=0,v=0,b=0;const x=we.search(h,n,8),y=this.curves[x>>3];switch(y){case 0:const w=h[x];u=h[x+1],f=h[x+2],m=h[x+3],p=h[x+4],g=h[x+5],v=h[x+6],b=h[x+7];const _=(n-w)/(h[x+8]-w);u+=(h[x+8+1]-u)*_,f+=(h[x+8+2]-f)*_,m+=(h[x+8+3]-m)*_,p+=(h[x+8+4]-p)*_,g+=(h[x+8+5]-g)*_,v+=(h[x+8+6]-v)*_,b+=(h[x+8+7]-b)*_;break;case 1:u=h[x+1],f=h[x+2],m=h[x+3],p=h[x+4],g=h[x+5],v=h[x+6],b=h[x+7];break;default:u=this.getBezierValue(n,x,1,y-2),f=this.getBezierValue(n,x,2,y+18-2),m=this.getBezierValue(n,x,3,y+18*2-2),p=this.getBezierValue(n,x,4,y+18*3-2),g=this.getBezierValue(n,x,5,y+18*4-2),v=this.getBezierValue(n,x,6,y+18*5-2),b=this.getBezierValue(n,x,7,y+18*6-2)}if(r==1)c.set(u,f,m,p),d.r=g,d.g=v,d.b=b;else{if(a==A.setup){c.setFromColor(o.data.color);const w=o.data.darkColor;d.r=w.r,d.g=w.g,d.b=w.b}c.add((u-c.r)*r,(f-c.g)*r,(m-c.b)*r,(p-c.a)*r),d.r+=(g-d.r)*r,d.g+=(v-d.g)*r,d.b+=(b-d.b)*r}}}class df extends Dn{constructor(t,e,n){super(t,e,[`${zt.rgb}|${n}`,`${zt.rgb2}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,i,r,a,l,o){t*=7,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=a,this.frames[t+5]=l,this.frames[t+6]=o}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color,d=o.darkColor;if(n<h[0]){const y=o.data.color,w=o.data.darkColor;switch(a){case A.setup:c.r=y.r,c.g=y.g,c.b=y.b,d.r=w.r,d.g=w.g,d.b=w.b;return;case A.first:c.r+=(y.r-c.r)*r,c.g+=(y.g-c.g)*r,c.b+=(y.b-c.b)*r,d.r+=(w.r-d.r)*r,d.g+=(w.g-d.g)*r,d.b+=(w.b-d.b)*r}return}let u=0,f=0,m=0,p=0,g=0,v=0;const b=we.search(h,n,7),x=this.curves[b/7];switch(x){case 0:const y=h[b];u=h[b+1],f=h[b+2],m=h[b+3],p=h[b+4],g=h[b+5],v=h[b+6];const w=(n-y)/(h[b+7]-y);u+=(h[b+7+1]-u)*w,f+=(h[b+7+2]-f)*w,m+=(h[b+7+3]-m)*w,p+=(h[b+7+4]-p)*w,g+=(h[b+7+5]-g)*w,v+=(h[b+7+6]-v)*w;break;case 1:u=h[b+1],f=h[b+2],m=h[b+3],p=h[b+4],g=h[b+5],v=h[b+6];break;default:u=this.getBezierValue(n,b,1,x-2),f=this.getBezierValue(n,b,2,x+18-2),m=this.getBezierValue(n,b,3,x+18*2-2),p=this.getBezierValue(n,b,4,x+18*3-2),g=this.getBezierValue(n,b,5,x+18*4-2),v=this.getBezierValue(n,b,6,x+18*5-2)}if(r==1)c.r=u,c.g=f,c.b=m,d.r=p,d.g=g,d.b=v;else{if(a==A.setup){const y=o.data.color,w=o.data.darkColor;c.r=y.r,c.g=y.g,c.b=y.b,d.r=w.r,d.g=w.g,d.b=w.b}c.r+=(u-c.r)*r,c.g+=(f-c.g)*r,c.b+=(m-c.b)*r,d.r+=(p-d.r)*r,d.g+=(g-d.g)*r,d.b+=(v-d.b)*r}}}class fr extends we{constructor(t,e){super(t,[`${zt.attachment}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(o.bone.active){if(l==Ft.mixOut){a==A.setup&&this.setAttachment(t,o,o.data.attachmentName);return}if(n<this.frames[0]){(a==A.setup||a==A.first)&&this.setAttachment(t,o,o.data.attachmentName);return}this.setAttachment(t,o,this.attachmentNames[we.search1(this.frames,n)])}}setAttachment(t,e,n){e.setAttachment(n?t.getAttachment(this.slotIndex,n):null)}}class ff extends Dn{constructor(t,e,n,i){super(t,e,[`${zt.deform}|${n}|${i.id}`]),this.slotIndex=0,this.slotIndex=n,this.attachment=i,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.vertices[t]=n}setBezier(t,e,n,i,r,a,l,o,h,c,d){const u=this.curves;let f=this.getFrameCount()+t*18;n==0&&(u[e]=2+f);const m=(i-a*2+o)*.03,p=h*.03-l*.06,g=((a-o)*3-i+c)*.006,v=(l-h+.33333333)*.018;let b=m*2+g,x=p*2+v,y=(a-i)*.3+m+g*.16666667,w=l*.3+p+v*.16666667,_=i+y,E=w;for(let T=f+18;f<T;f+=2)u[f]=_,u[f+1]=E,y+=b,w+=x,b+=g,x+=v,_+=y,E+=w}getCurvePercent(t,e){const n=this.curves;let i=n[e];switch(i){case 0:const o=this.frames[e];return(t-o)/(this.frames[e+this.getFrameEntries()]-o);case 1:return 0}if(i-=2,n[i]>t){const o=this.frames[e];return n[i+1]*(t-o)/(n[i]-o)}const r=i+18;for(i+=2;i<r;i+=2)if(n[i]>=t){const o=n[i-2],h=n[i-1];return h+(t-o)/(n[i]-o)*(n[i+1]-h)}const a=n[r-2],l=n[r-1];return l+(1-l)*(t-a)/(this.frames[e+this.getFrameEntries()]-a)}apply(t,e,n,i,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.getAttachment();if(!h||!(h instanceof kn)||h.timelineAttachment!=this.attachment)return;const c=o.deform;c.length==0&&(a=A.setup);const d=this.vertices,u=d[0].length,f=this.frames;if(n<f[0]){switch(a){case A.setup:c.length=0;return;case A.first:if(r==1){c.length=0;return}c.length=u;const b=h;if(b.bones){r=1-r;for(let x=0;x<u;x++)c[x]*=r}else{const x=b.vertices;for(let y=0;y<u;y++)c[y]+=(x[y]-c[y])*r}}return}if(c.length=u,n>=f[f.length-1]){const b=d[f.length-1];if(r==1)if(a==A.add){const x=h;if(x.bones)for(let y=0;y<u;y++)c[y]+=b[y];else{const y=x.vertices;for(let w=0;w<u;w++)c[w]+=b[w]-y[w]}}else $.arrayCopy(b,0,c,0,u);else switch(a){case A.setup:{const y=h;if(y.bones)for(let w=0;w<u;w++)c[w]=b[w]*r;else{const w=y.vertices;for(let _=0;_<u;_++){const E=w[_];c[_]=E+(b[_]-E)*r}}break}case A.first:case A.replace:for(let y=0;y<u;y++)c[y]+=(b[y]-c[y])*r;break;case A.add:const x=h;if(x.bones)for(let y=0;y<u;y++)c[y]+=b[y]*r;else{const y=x.vertices;for(let w=0;w<u;w++)c[w]+=(b[w]-y[w])*r}}return}const m=we.search1(f,n),p=this.getCurvePercent(n,m),g=d[m],v=d[m+1];if(r==1)if(a==A.add){const b=h;if(b.bones)for(let x=0;x<u;x++){const y=g[x];c[x]+=y+(v[x]-y)*p}else{const x=b.vertices;for(let y=0;y<u;y++){const w=g[y];c[y]+=w+(v[y]-w)*p-x[y]}}}else for(let b=0;b<u;b++){const x=g[b];c[b]=x+(v[b]-x)*p}else switch(a){case A.setup:{const x=h;if(x.bones)for(let y=0;y<u;y++){const w=g[y];c[y]=(w+(v[y]-w)*p)*r}else{const y=x.vertices;for(let w=0;w<u;w++){const _=g[w],E=y[w];c[w]=E+(_+(v[w]-_)*p-E)*r}}break}case A.first:case A.replace:for(let x=0;x<u;x++){const y=g[x];c[x]+=(y+(v[x]-y)*p-c[x])*r}break;case A.add:const b=h;if(b.bones)for(let x=0;x<u;x++){const y=g[x];c[x]+=(y+(v[x]-y)*p)*r}else{const x=b.vertices;for(let y=0;y<u;y++){const w=g[y];c[y]+=(w+(v[y]-w)*p-x[y])*r}}}}}const cy=class extends we{constructor(s){super(s,cy.propertyIds),this.events=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t){this.frames[s]=t.time,this.events[s]=t}apply(s,t,e,n,i,r,a){if(!n)return;const l=this.frames,o=this.frames.length;if(t>e)this.apply(s,t,Number.MAX_VALUE,n,i,r,a),t=-1;else if(t>=l[o-1])return;if(e<l[0])return;let h=0;if(t<l[0])h=0;else{h=we.search1(l,t)+1;const c=l[h];for(;h>0&&l[h-1]==c;)h--}for(;h<o&&e>=l[h];h++)n.push(this.events[h])}};let Ia=cy;Ia.propertyIds=[`${zt.event}`];const uy=class extends we{constructor(s){super(s,uy.propertyIds),this.drawOrders=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t,e){this.frames[s]=t,this.drawOrders[s]=e}apply(s,t,e,n,i,r,a){if(a==Ft.mixOut){r==A.setup&&$.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}if(e<this.frames[0]){(r==A.setup||r==A.first)&&$.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}const l=we.search1(this.frames,e),o=this.drawOrders[l];if(!o)$.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);else{const h=s.drawOrder,c=s.slots;for(let d=0,u=o.length;d<u;d++)h[d]=c[o[d]]}}};let xr=uy;xr.propertyIds=[`${zt.drawOrder}`];class mf extends Dn{constructor(t,e,n){super(t,e,[`${zt.ikConstraint}|${n}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=n}getFrameEntries(){return 6}setFrame(t,e,n,i,r,a,l){t*=6,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=a?1:0,this.frames[t+5]=l?1:0}apply(t,e,n,i,r,a,l){const o=t.ikConstraints[this.ikConstraintIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case A.first:o.mix+=(o.data.mix-o.mix)*r,o.softness+=(o.data.softness-o.softness)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let c=0,d=0;const u=we.search(h,n,6),f=this.curves[u/6];switch(f){case 0:const m=h[u];c=h[u+1],d=h[u+2];const p=(n-m)/(h[u+6]-m);c+=(h[u+6+1]-c)*p,d+=(h[u+6+2]-d)*p;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(n,u,1,f-2),d=this.getBezierValue(n,u,2,f+18-2)}a==A.setup?(o.mix=o.data.mix+(c-o.data.mix)*r,o.softness=o.data.softness+(d-o.data.softness)*r,l==Ft.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=h[u+3],o.compress=h[u+4]!=0,o.stretch=h[u+5]!=0)):(o.mix+=(c-o.mix)*r,o.softness+=(d-o.softness)*r,l==Ft.mixIn&&(o.bendDirection=h[u+3],o.compress=h[u+4]!=0,o.stretch=h[u+5]!=0))}}class pf extends Dn{constructor(t,e,n){super(t,e,[`${zt.transformConstraint}|${n}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,i,r,a,l,o){const h=this.frames;t*=7,h[t]=e,h[t+1]=n,h[t+2]=i,h[t+3]=r,h[t+4]=a,h[t+5]=l,h[t+6]=o}apply(t,e,n,i,r,a,l){const o=t.transformConstraints[this.transformConstraintIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){const b=o.data;switch(a){case A.setup:o.mixRotate=b.mixRotate,o.mixX=b.mixX,o.mixY=b.mixY,o.mixScaleX=b.mixScaleX,o.mixScaleY=b.mixScaleY,o.mixShearY=b.mixShearY;return;case A.first:o.mixRotate+=(b.mixRotate-o.mixRotate)*r,o.mixX+=(b.mixX-o.mixX)*r,o.mixY+=(b.mixY-o.mixY)*r,o.mixScaleX+=(b.mixScaleX-o.mixScaleX)*r,o.mixScaleY+=(b.mixScaleY-o.mixScaleY)*r,o.mixShearY+=(b.mixShearY-o.mixShearY)*r}return}let c,d,u,f,m,p;const g=we.search(h,n,7),v=this.curves[g/7];switch(v){case 0:const b=h[g];c=h[g+1],d=h[g+2],u=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];const x=(n-b)/(h[g+7]-b);c+=(h[g+7+1]-c)*x,d+=(h[g+7+2]-d)*x,u+=(h[g+7+3]-u)*x,f+=(h[g+7+4]-f)*x,m+=(h[g+7+5]-m)*x,p+=(h[g+7+6]-p)*x;break;case 1:c=h[g+1],d=h[g+2],u=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];break;default:c=this.getBezierValue(n,g,1,v-2),d=this.getBezierValue(n,g,2,v+18-2),u=this.getBezierValue(n,g,3,v+18*2-2),f=this.getBezierValue(n,g,4,v+18*3-2),m=this.getBezierValue(n,g,5,v+18*4-2),p=this.getBezierValue(n,g,6,v+18*5-2)}if(a==A.setup){const b=o.data;o.mixRotate=b.mixRotate+(c-b.mixRotate)*r,o.mixX=b.mixX+(d-b.mixX)*r,o.mixY=b.mixY+(u-b.mixY)*r,o.mixScaleX=b.mixScaleX+(f-b.mixScaleX)*r,o.mixScaleY=b.mixScaleY+(m-b.mixScaleY)*r,o.mixShearY=b.mixShearY+(p-b.mixShearY)*r}else o.mixRotate+=(c-o.mixRotate)*r,o.mixX+=(d-o.mixX)*r,o.mixY+=(u-o.mixY)*r,o.mixScaleX+=(f-o.mixScaleX)*r,o.mixScaleY+=(m-o.mixScaleY)*r,o.mixShearY+=(p-o.mixShearY)*r}}class gf extends Bn{constructor(t,e,n){super(t,e,`${zt.pathConstraintPosition}|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,i,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.position=o.data.position;return;case A.first:o.position+=(o.data.position-o.position)*r}return}const c=this.getCurveValue(n);a==A.setup?o.position=o.data.position+(c-o.data.position)*r:o.position+=(c-o.position)*r}}class xf extends Bn{constructor(t,e,n){super(t,e,`${zt.pathConstraintSpacing}|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,i,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.spacing=o.data.spacing;return;case A.first:o.spacing+=(o.data.spacing-o.spacing)*r}return}const c=this.getCurveValue(n);a==A.setup?o.spacing=o.data.spacing+(c-o.data.spacing)*r:o.spacing+=(c-o.spacing)*r}}class yf extends Dn{constructor(t,e,n){super(t,e,[`${zt.pathConstraintMix}|${n}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,i,r){const a=this.frames;t<<=2,a[t]=e,a[t+1]=n,a[t+2]=i,a[t+3]=r}apply(t,e,n,i,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(n<h[0]){switch(a){case A.setup:o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,o.mixY=o.data.mixY;return;case A.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*r,o.mixX+=(o.data.mixX-o.mixX)*r,o.mixY+=(o.data.mixY-o.mixY)*r}return}let c,d,u;const f=we.search(h,n,4),m=this.curves[f>>2];switch(m){case 0:const p=h[f];c=h[f+1],d=h[f+2],u=h[f+3];const g=(n-p)/(h[f+4]-p);c+=(h[f+4+1]-c)*g,d+=(h[f+4+2]-d)*g,u+=(h[f+4+3]-u)*g;break;case 1:c=h[f+1],d=h[f+2],u=h[f+3];break;default:c=this.getBezierValue(n,f,1,m-2),d=this.getBezierValue(n,f,2,m+18-2),u=this.getBezierValue(n,f,3,m+18*2-2)}if(a==A.setup){const p=o.data;o.mixRotate=p.mixRotate+(c-p.mixRotate)*r,o.mixX=p.mixX+(d-p.mixX)*r,o.mixY=p.mixY+(u-p.mixY)*r}else o.mixRotate+=(c-o.mixRotate)*r,o.mixX+=(d-o.mixX)*r,o.mixY+=(u-o.mixY)*r}}const Pi=class extends we{constructor(s,t,e){super(s,[`${zt.sequence}|${t}|${e.sequence.id}`]),this.slotIndex=t,this.attachment=e}getFrameEntries(){return Pi.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(s,t,e,n,i){const r=this.frames;s*=Pi.ENTRIES,r[s]=t,r[s+Pi.MODE]=e|n<<4,r[s+Pi.DELAY]=i}apply(s,t,e,n,i,r,a){const l=s.slots[this.slotIndex];if(!l.bone.active)return;const o=l.attachment,h=this.attachment;if(o!=h&&(!(o instanceof kn)||o.timelineAttachment!=h))return;const c=this.frames;if(e<c[0]){(r==A.setup||r==A.first)&&(l.sequenceIndex=-1);return}const d=we.search(c,e,Pi.ENTRIES),u=c[d],f=c[d+Pi.MODE],m=c[d+Pi.DELAY];if(!this.attachment.sequence)return;let p=f>>4;const g=this.attachment.sequence.regions.length,v=Zd[f&15];if(v!=Wn.hold)switch(p+=(e-u)/m+1e-5|0,v){case Wn.once:p=Math.min(g-1,p);break;case Wn.loop:p%=g;break;case Wn.pingpong:{const b=(g<<1)-2;p=b==0?0:p%b,p>=g&&(p=b-p);break}case Wn.onceReverse:p=Math.max(g-1-p,0);break;case Wn.loopReverse:p=g-1-p%g;break;case Wn.pingpongReverse:{const b=(g<<1)-2;p=b==0?0:(p+g-1)%b,p>=g&&(p=b-p)}}l.sequenceIndex=p}};let To=Pi;To.ENTRIES=3;To.MODE=1;To.DELAY=2;const Yn=class{constructor(s){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new dy(this),this.propertyIDs=new bx,this.animationsChanged=!1,this.trackEntryPool=new yh(()=>new Rh),this.data=s}static emptyAnimation(){return Yn._emptyAnimation}update(s){s*=this.timeScale;const t=this.tracks;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(!i)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let r=s*i.timeScale;if(i.delay>0){if(i.delay-=r,i.delay>0)continue;r=-i.delay,i.delay=0}let a=i.next;if(a){const l=i.trackLast-a.delay;if(l>=0){for(a.delay=0,a.trackTime+=i.timeScale==0?0:(l/i.timeScale+s)*a.timeScale,i.trackTime+=r,this.setCurrent(e,a,!0);a.mixingFrom;)a.mixTime+=s,a=a.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&!i.mixingFrom){t[e]=null,this.queue.end(i),this.clearNext(i);continue}if(i.mixingFrom&&this.updateMixingFrom(i,s)){let l=i.mixingFrom;for(i.mixingFrom=null,l&&(l.mixingTo=null);l;)this.queue.end(l),l=l.mixingFrom}i.trackTime+=r}this.queue.drain()}updateMixingFrom(s,t){const e=s.mixingFrom;if(!e)return!0;const n=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,s.mixTime>0&&s.mixTime>=s.mixDuration?((e.totalAlpha==0||s.mixDuration==0)&&(s.mixingFrom=e.mixingFrom,e.mixingFrom&&(e.mixingFrom.mixingTo=s),s.interruptAlpha=e.interruptAlpha,this.queue.end(e)),n):(e.trackTime+=t*e.timeScale,s.mixTime+=t,!1)}apply(s){if(!s)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const t=this.events,e=this.tracks;let n=!1;for(let a=0,l=e.length;a<l;a++){const o=e[a];if(!o||o.delay>0)continue;n=!0;const h=a==0?A.first:o.mixBlend;let c=o.alpha;o.mixingFrom?c*=this.applyMixingFrom(o,s,h):o.trackTime>=o.trackEnd&&!o.next&&(c=0);const d=o.animationLast,u=o.getAnimationTime();let f=u,m=t;o.reverse&&(f=o.animation.duration-f,m=null);const p=o.animation.timelines,g=p.length;if(a==0&&c==1||h==A.add)for(let v=0;v<g;v++){const b=p[v];b instanceof fr?this.applyAttachmentTimeline(b,s,f,h,!0):b.apply(s,d,f,m,c,h,Ft.mixIn)}else{const v=o.timelineMode,b=o.shortestRotation,x=!b&&o.timelinesRotation.length!=g<<1;x&&(o.timelinesRotation.length=g<<1);for(let y=0;y<g;y++){const w=p[y],_=v[y]==Bc?h:A.setup;!b&&w instanceof ga?this.applyRotateTimeline(w,s,f,c,_,o.timelinesRotation,y<<1,x):w instanceof fr?this.applyAttachmentTimeline(w,s,f,h,!0):w.apply(s,d,f,m,c,_,Ft.mixIn)}}this.queueEvents(o,u),t.length=0,o.nextAnimationLast=u,o.nextTrackLast=o.trackTime}const i=this.unkeyedState+qp,r=s.slots;for(let a=0,l=s.slots.length;a<l;a++){const o=r[a];if(o.attachmentState==i){const h=o.data.attachmentName;o.setAttachment(h?s.getAttachment(o.data.index,h):null)}}return this.unkeyedState+=2,this.queue.drain(),n}applyMixingFrom(s,t,e){const n=s.mixingFrom;n.mixingFrom&&this.applyMixingFrom(n,t,e);let i=0;s.mixDuration==0?(i=1,e==A.first&&(e=A.setup)):(i=s.mixTime/s.mixDuration,i>1&&(i=1),e!=A.first&&(e=n.mixBlend));const r=i<n.attachmentThreshold,a=i<n.drawOrderThreshold,l=n.animation.timelines,o=l.length,h=n.alpha*s.interruptAlpha,c=h*(1-i),d=n.animationLast,u=n.getAnimationTime();let f=u,m=null;if(n.reverse?f=n.animation.duration-f:i<n.eventThreshold&&(m=this.events),e==A.add)for(let p=0;p<o;p++)l[p].apply(t,d,f,m,c,e,Ft.mixOut);else{const p=n.timelineMode,g=n.timelineHoldMix,v=n.shortestRotation,b=!v&&n.timelinesRotation.length!=o<<1;b&&(n.timelinesRotation.length=o<<1),n.totalAlpha=0;for(let x=0;x<o;x++){const y=l[x];let w=Ft.mixOut,_,E=0;switch(p[x]){case Bc:if(!a&&y instanceof xr)continue;_=e,E=c;break;case zp:_=A.setup,E=c;break;case jp:_=e,E=h;break;case Oc:_=A.setup,E=h;break;default:_=A.setup;const T=g[x];E=h*Math.max(0,1-T.mixTime/T.mixDuration);break}n.totalAlpha+=E,!v&&y instanceof ga?this.applyRotateTimeline(y,t,f,E,_,n.timelinesRotation,x<<1,b):y instanceof fr?this.applyAttachmentTimeline(y,t,f,_,r):(a&&y instanceof xr&&_==A.setup&&(w=Ft.mixIn),y.apply(t,d,f,m,E,_,w))}}return s.mixDuration>0&&this.queueEvents(n,u),this.events.length=0,n.nextAnimationLast=u,n.nextTrackLast=n.trackTime,i}applyAttachmentTimeline(s,t,e,n,i){const r=t.slots[s.slotIndex];r.bone.active&&(e<s.frames[0]?(n==A.setup||n==A.first)&&this.setAttachment(t,r,r.data.attachmentName,i):this.setAttachment(t,r,s.attachmentNames[we.search1(s.frames,e)],i),r.attachmentState<=this.unkeyedState&&(r.attachmentState=this.unkeyedState+qp))}setAttachment(s,t,e,n){t.setAttachment(e?s.getAttachment(t.data.index,e):null),n&&(t.attachmentState=this.unkeyedState+gC)}applyRotateTimeline(s,t,e,n,i,r,a,l){if(l&&(r[a]=0),n==1){s.apply(t,0,e,null,1,i,Ft.mixIn);return}const o=t.bones[s.boneIndex];if(!o.active)return;const h=s.frames;let c=0,d=0;if(e<h[0])switch(i){case A.setup:o.rotation=o.data.rotation;default:return;case A.first:c=o.rotation,d=o.data.rotation}else c=i==A.setup?o.data.rotation:o.rotation,d=o.data.rotation+s.getCurveValue(e);let u=0,f=d-c;if(f-=(16384-(16384.499999999996-f/360|0))*360,f==0)u=r[a];else{let m=0,p=0;l?(m=0,p=f):(m=r[a],p=r[a+1]);const g=f>0;let v=m>=0;I.signum(p)!=I.signum(f)&&Math.abs(p)<=90&&(Math.abs(m)>180&&(m+=360*I.signum(m)),v=g),u=f+m-m%360,v!=g&&(u+=360*I.signum(m)),r[a]=u}r[a+1]=f,o.rotation=c+u*n}queueEvents(s,t){const e=s.animationStart,n=s.animationEnd,i=n-e,r=s.trackLast%i,a=this.events;let l=0;const o=a.length;for(;l<o;l++){const c=a[l];if(c.time<r)break;c.time>n||this.queue.event(s,c)}let h=!1;for(s.loop?h=i==0||r>s.trackTime%i:h=t>=n&&s.animationLast<n,h&&this.queue.complete(s);l<o;l++){const c=a[l];c.time<e||this.queue.event(s,c)}}clearTracks(){const s=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=s,this.queue.drain()}clearTrack(s){if(s>=this.tracks.length)return;const t=this.tracks[s];if(!t)return;this.queue.end(t),this.clearNext(t);let e=t;for(;;){const n=e.mixingFrom;if(!n)break;this.queue.end(n),e.mixingFrom=null,e.mixingTo=null,e=n}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(s,t,e){const n=this.expandToIndex(s);this.tracks[s]=t,t.previous=null,n&&(e&&this.queue.interrupt(n),t.mixingFrom=n,n.mixingTo=t,t.mixTime=0,n.mixingFrom&&n.mixDuration>0&&(t.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(t)}setAnimation(s,t,e=!1){const n=this.data.skeletonData.findAnimation(t);if(!n)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(s,n,e)}setAnimationWith(s,t,e=!1){if(!t)throw new Error("animation cannot be null.");let n=!0,i=this.expandToIndex(s);i&&(i.nextTrackLast==-1?(this.tracks[s]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.clearNext(i),i=i.mixingFrom,n=!1):this.clearNext(i));const r=this.trackEntry(s,t,e,i);return this.setCurrent(s,r,n),this.queue.drain(),r}addAnimation(s,t,e=!1,n=0){const i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(s,i,e,n)}addAnimationWith(s,t,e=!1,n=0){if(!t)throw new Error("animation cannot be null.");let i=this.expandToIndex(s);if(i)for(;i.next;)i=i.next;const r=this.trackEntry(s,t,e,i);return i?(i.next=r,r.previous=i,n<=0&&(n+=i.getTrackComplete()-r.mixDuration)):(this.setCurrent(s,r,!0),this.queue.drain()),r.delay=n,r}setEmptyAnimation(s,t=0){const e=this.setAnimationWith(s,Yn.emptyAnimation(),!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(s,t=0,e=0){const n=this.addAnimationWith(s,Yn.emptyAnimation(),!1,e);return e<=0&&(n.delay+=n.mixDuration-t),n.mixDuration=t,n.trackEnd=t,n}setEmptyAnimations(s=0){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++){const i=this.tracks[e];i&&this.setEmptyAnimation(i.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(s){return s<this.tracks.length?this.tracks[s]:($.ensureArrayCapacity(this.tracks,s+1,null),this.tracks.length=s+1,null)}trackEntry(s,t,e,n){const i=this.trackEntryPool.obtain();return i.reset(),i.trackIndex=s,i.animation=t,i.loop=e,i.holdPrevious=!1,i.reverse=!1,i.shortestRotation=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=t.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.mixTime=0,i.mixDuration=n?this.data.getMix(n.animation,t):0,i.interruptAlpha=1,i.totalAlpha=0,i.mixBlend=A.replace,i}clearNext(s){let t=s.next;for(;t;)this.queue.dispose(t),t=t.next;s.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const s=this.tracks;for(let t=0,e=s.length;t<e;t++){let n=s[t];if(n){for(;n.mixingFrom;)n=n.mixingFrom;do(!n.mixingTo||n.mixBlend!=A.add)&&this.computeHold(n),n=n.mixingTo;while(n)}}}computeHold(s){const t=s.mixingTo,e=s.animation.timelines,n=s.animation.timelines.length,i=s.timelineMode;i.length=n;const r=s.timelineHoldMix;r.length=0;const a=this.propertyIDs;if(t&&t.holdPrevious){for(let l=0;l<n;l++)i[l]=a.addAll(e[l].getPropertyIds())?Oc:jp;return}t:for(let l=0;l<n;l++){const o=e[l],h=o.getPropertyIds();if(!a.addAll(h))i[l]=Bc;else if(!t||o instanceof fr||o instanceof xr||o instanceof Ia||!t.animation.hasTimeline(h))i[l]=zp;else{for(let c=t.mixingTo;c;c=c.mixingTo)if(!c.animation.hasTimeline(h)){if(s.mixDuration>0){i[l]=pC,r[l]=c;continue t}break}i[l]=Oc}}}getCurrent(s){return s>=this.tracks.length?null:this.tracks[s]}addListener(s){if(!s)throw new Error("listener cannot be null.");this.listeners.push(s)}removeListener(s){const t=this.listeners.indexOf(s);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(s,t,e){Yn.deprecatedWarning1||(Yn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(s,t,e)}addAnimationByName(s,t,e,n){Yn.deprecatedWarning2||(Yn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(s,t,e,n)}hasAnimation(s){return this.data.skeletonData.findAnimation(s)!==null}hasAnimationByName(s){return Yn.deprecatedWarning3||(Yn.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(s)}};let Ao=Yn;Ao._emptyAnimation=new Mh("<empty>",[],0);Ao.deprecatedWarning1=!1;Ao.deprecatedWarning2=!1;Ao.deprecatedWarning3=!1;const ai=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=A.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const s=this.animationEnd-this.animationStart;return s==0?this.animationStart:this.trackTime%s+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(s){this.animationLast=s,this.nextAnimationLast=s}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const s=this.animationEnd-this.animationStart;if(s!=0){if(this.loop)return s*(1+(this.trackTime/s|0));if(this.trackTime<s)return s}return this.trackTime}get time(){return ai.deprecatedWarning1||(ai.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(s){ai.deprecatedWarning1||(ai.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=s}get endTime(){return ai.deprecatedWarning2||(ai.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(s){ai.deprecatedWarning2||(ai.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=s}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Rh=ai;Rh.deprecatedWarning1=!1;Rh.deprecatedWarning2=!1;class dy{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(Ss.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(Ss.interrupt),this.objects.push(t)}end(t){this.objects.push(Ss.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(Ss.dispose),this.objects.push(t)}complete(t){this.objects.push(Ss.complete),this.objects.push(t)}event(t,e){this.objects.push(Ss.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const i=t[n],r=t[n+1];switch(i){case Ss.start:r.listener&&r.listener.start&&r.listener.start(r);for(let l=0;l<e.length;l++){const o=e[l];o.start&&o.start(r)}break;case Ss.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(let l=0;l<e.length;l++){const o=e[l];o.interrupt&&o.interrupt(r)}break;case Ss.end:r.listener&&r.listener.end&&r.listener.end(r);for(let l=0;l<e.length;l++){const o=e[l];o.end&&o.end(r)}case Ss.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(let l=0;l<e.length;l++){const o=e[l];o.dispose&&o.dispose(r)}this.animState.trackEntryPool.free(r);break;case Ss.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(let l=0;l<e.length;l++){const o=e[l];o.complete&&o.complete(r)}break;case Ss.event:const a=t[n+++2];r.listener&&r.listener.event&&r.listener.event(r,a);for(let l=0;l<e.length;l++){const o=e[l];o.event&&o.event(r,a)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Ss=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(Ss||{});class mC{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const Bc=0,zp=1,jp=2,Oc=3,pC=4,qp=1,gC=2;class fy{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const i=this.skeletonData.findAnimation(t);if(!i)throw new Error(`Animation not found: ${t}`);const r=this.skeletonData.findAnimation(e);if(!r)throw new Error(`Animation not found: ${e}`);this.setMixWith(i,r,n)}setMixWith(t,e,n){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const i=`${t.name}.${e.name}`;this.animationToMixTime[i]=n}getMix(t,e){const n=`${t.name}.${e.name}`,i=this.animationToMixTime[n];return i===void 0?this.defaultMix:i}}class bf{constructor(t){this.atlas=t}loadSequence(t,e,n){const i=n.regions;for(let r=0,a=i.length;r<a;r++){const l=n.getPath(e,r),o=this.atlas.findRegion(l);if(o==null)throw new Error(`Region not found in atlas: ${l} (sequence: ${t})`);i[r]=o,i[r].renderObject=i[r]}}newRegionAttachment(t,e,n,i){const r=new Gt(e,n);if(i!=null)this.loadSequence(e,n,i);else{const a=this.atlas.findRegion(n);if(!a)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);a.renderObject=a,r.region=a}return r}newMeshAttachment(t,e,n,i){const r=new Sr(e,n);if(i!=null)this.loadSequence(e,n,i);else{const a=this.atlas.findRegion(n);if(!a)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);a.renderObject=a,r.region=a}return r}newBoundingBoxAttachment(t,e){return new Sh(e)}newPathAttachment(t,e){return new Tr(e)}newPointAttachment(t,e){return new Ah(e)}newClippingAttachment(t,e){return new Th(e)}}class zu{constructor(t,e,n){if(this.matrix=new se,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,i,r,a,l){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=r,this.ashearX=a,this.ashearY=l;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(!o){const g=this.skeleton,v=n+90+l;h.a=I.cosDeg(n+a)*i*c,h.c=I.cosDeg(v)*r*c,h.b=I.sinDeg(n+a)*i*d,h.d=I.sinDeg(v)*r*d,h.tx=t*c+g.x,h.ty=e*d+g.y;return}let u=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=u*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case Tt.Normal:{const g=n+90+l,v=I.cosDeg(n+a)*i,b=I.cosDeg(g)*r,x=I.sinDeg(n+a)*i,y=I.sinDeg(g)*r;h.a=u*v+f*x,h.c=u*b+f*y,h.b=m*v+p*x,h.d=m*b+p*y;return}case Tt.OnlyTranslation:{const g=n+90+l;h.a=I.cosDeg(n+a)*i,h.c=I.cosDeg(g)*r,h.b=I.sinDeg(n+a)*i,h.d=I.sinDeg(g)*r;break}case Tt.NoRotationOrReflection:{let g=u*u+m*m,v=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,u/=c,m/=d,f=m*g,p=u*g,v=Math.atan2(m,u)*I.radDeg):(u=0,m=0,v=90-Math.atan2(p,f)*I.radDeg);const b=n+a-v,x=n+l-v+90,y=I.cosDeg(b)*i,w=I.cosDeg(x)*r,_=I.sinDeg(b)*i,E=I.sinDeg(x)*r;h.a=u*y-f*_,h.c=u*w-f*E,h.b=m*y+p*_,h.d=m*w+p*E;break}case Tt.NoScale:case Tt.NoScaleOrReflection:{const g=I.cosDeg(n),v=I.sinDeg(n);let b=(u*g+f*v)/c,x=(m*g+p*v)/d,y=Math.sqrt(b*b+x*x);y>1e-5&&(y=1/y),b*=y,x*=y,y=Math.sqrt(b*b+x*x),this.data.transformMode==Tt.NoScale&&u*p-f*m<0!=(c<0!=d<0)&&(y=-y);const w=Math.PI/2+Math.atan2(x,b),_=Math.cos(w)*y,E=Math.sin(w)*y,T=I.cosDeg(a)*i,C=I.cosDeg(90+l)*r,R=I.sinDeg(a)*i,P=I.sinDeg(90+l)*r;h.a=b*T+_*R,h.c=b*C+_*P,h.b=x*T+E*R,h.d=x*C+E*P;break}}h.a*=c,h.c*=c,h.b*=d,h.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*I.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*I.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*I.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*I.radDeg;return}const n=t.matrix,i=1/(n.a*n.d-n.b*n.c),r=e.tx-n.tx,a=e.ty-n.ty;this.ax=r*n.d*i-a*n.c*i,this.ay=a*n.a*i-r*n.b*i;const l=i*n.d,o=i*n.a,h=i*n.c,c=i*n.b,d=l*e.a-h*e.b,u=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*I.radDeg,this.arotation=Math.atan2(f,d)*I.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*I.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=1/(n*a-i*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*i*l,t.y=h*n*l-o*r*l,t}localToWorld(t){const e=this.matrix,n=t.x,i=t.y;return t.x=n*e.a+i*e.c+e.tx,t.y=n*e.b+i*e.d+e.ty,t}worldToLocalRotation(t){const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*n,i.d*n-i.c*e)*I.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=I.sinDeg(t),n=I.cosDeg(t),i=this.matrix;return Math.atan2(n*i.b+e*i.d,n*i.a+e*i.c)*I.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,i=e.c,r=e.b,a=e.d,l=I.cosDeg(t),o=I.sinDeg(t);e.a=l*n-o*r,e.c=l*i-o*a,e.b=o*n+l*r,e.d=o*i+l*a}}class vf{constructor(t,e,n){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Tt.Normal,this.skinRequired=!1,this.color=new at,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}}class Ph{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}}let wf=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class _f{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class my{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++){const r=e.findBone(t.bones[i].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[i].name}`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=n}isActive(){return this.active}update(){if(this.mix==0)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,n,i,r,a,l){const o=t.parent.matrix;if(!o)throw new Error("IK bone must have parent.");const h=o.a;let c=o.c;const d=o.b;let u=o.d,f=-t.ashearX-t.arotation,m=0,p=0;const g=t.skeleton.scaleX,v=-t.skeleton.scaleY;switch(t.data.transformMode){case Tt.OnlyTranslation:m=e-t.worldX,p=n-t.worldY,p=-p;break;case Tt.NoRotationOrReflection:const y=Math.abs(h*u-c*d)/(h*h+d*d),w=h/g,_=d/v;c=-_*y*g,u=w*y*v,f+=Math.atan2(_,w)*I.radDeg;default:const E=e-o.tx,T=n-o.ty,C=h*u-c*d;m=(E*u-T*c)/C-t.ax,p=(T*h-E*d)/C-t.ay}f+=Math.atan2(p,m)*I.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let b=t.ascaleX,x=t.ascaleY;if(i||r){switch(t.data.transformMode){case Tt.NoScale:case Tt.NoScaleOrReflection:m=e-t.worldX,p=n-t.worldY}const y=t.data.length*b,w=Math.sqrt(m*m+p*p);if(i&&w<y||r&&w>y&&y>1e-4){const _=(w/y-1)*l+1;b*=_,a&&(x*=_)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,b,x,t.ashearX,t.ashearY)}apply2(t,e,n,i,r,a,l,o,h){const c=t.ax,d=t.ay;let u=t.ascaleX,f=t.ascaleY,m=u,p=f,g=e.ascaleX;const v=t.matrix;let b=0,x=0,y=0;u<0?(u=-u,b=180,y=-1):(b=0,y=1),f<0&&(f=-f,y=-y),g<0?(g=-g,x=180):x=0;const w=e.ax;let _=0,E=0,T=0,C=v.a,R=v.c,P=v.b,O=v.d;const F=Math.abs(u-f)<=1e-4;!F||a?(_=0,E=C*w+v.tx,T=P*w+v.ty):(_=e.ay,E=C*w+R*_+v.tx,T=P*w+O*_+v.ty);const D=t.parent.matrix;if(!D)throw new Error("IK parent must itself have a parent.");C=D.a,R=D.c,P=D.b,O=D.d;const V=1/(C*O-R*P);let X=E-D.tx,U=T-D.ty;const j=(X*O-U*R)*V-c,z=(U*C-X*P)*V-d,N=Math.sqrt(j*j+z*z);let G=e.data.length*g,q,K;if(N<1e-4){this.apply1(t,n,i,!1,a,!1,h),e.updateWorldTransformWith(w,_,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}X=n-D.tx,U=i-D.ty;let Q=(X*O-U*R)*V-c,tt=(U*C-X*P)*V-d,ht=Q*Q+tt*tt;if(o!=0){o*=u*(g+1)*.5;const _t=Math.sqrt(ht),Et=_t-N-G*u+o;if(Et>0){let St=Math.min(1,Et/(o*2))-1;St=(Et-o*(1-St*St))/_t,Q-=St*Q,tt-=St*tt,ht=Q*Q+tt*tt}}t:if(F){G*=u;let _t=(ht-N*N-G*G)/(2*N*G);_t<-1?(_t=-1,K=Math.PI*r):_t>1?(_t=1,K=0,a&&(C=(Math.sqrt(ht)/(N+G)-1)*h+1,m*=C,l&&(p*=C))):K=Math.acos(_t)*r,C=N+G*_t,R=G*Math.sin(K),q=Math.atan2(tt*C-Q*R,Q*C+tt*R)}else{C=u*G,R=f*G;const _t=C*C,Et=R*R,St=Math.atan2(tt,Q);P=Et*N*N+_t*ht-_t*Et;const Ot=-2*Et*N,k=Et-_t;if(O=Ot*Ot-4*k*P,O>=0){let nt=Math.sqrt(O);Ot<0&&(nt=-nt),nt=-(Ot+nt)*.5;const gt=nt/k,S=P/nt,M=Math.abs(gt)<Math.abs(S)?gt:S;if(M*M<=ht){U=Math.sqrt(ht-M*M)*r,q=St-Math.atan2(U,M),K=Math.atan2(U/f,(M-N)/u);break t}}let L=I.PI,H=N-C,et=H*H,Z=0,st=0,rt=N+C,it=rt*rt,ot=0;P=-C*N/(_t-Et),P>=-1&&P<=1&&(P=Math.acos(P),X=C*Math.cos(P)+N,U=R*Math.sin(P),O=X*X+U*U,O<et&&(L=P,et=O,H=X,Z=U),O>it&&(st=P,it=O,rt=X,ot=U)),ht<=(et+it)*.5?(q=St-Math.atan2(Z*r,H),K=L*r):(q=St-Math.atan2(ot*r,rt),K=st*r)}const vt=Math.atan2(_,w)*y;let At=t.arotation;q=(q-vt)*I.radDeg+b-At,q>180?q-=360:q<-180&&(q+=360),t.updateWorldTransformWith(c,d,At+q*h,m,p,0,0),At=e.arotation,K=((K+vt)*I.radDeg-e.ashearX)*y+x-At,K>180?K-=360:K<-180&&(K+=360),e.updateWorldTransformWith(w,_,At+K*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class Ef extends Ph{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Sf extends Ph{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=fe.Fixed,this.spacingMode=Be.Fixed,this.rotateMode=Te.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Be=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s[s.Proportional=3]="Proportional",s))(Be||{});const li=class{constructor(s,t){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!s)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let n=0,i=s.bones.length;n<i;n++){const r=t.findBone(s.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${s.bones[n].name}.`);this.bones.push(r)}const e=t.findSlot(s.target.name);if(!e)throw new Error(`Couldn't find target bone ${s.target.name}`);this.target=e,this.position=s.position,this.spacing=s.spacing,this.mixRotate=s.mixRotate,this.mixX=s.mixX,this.mixY=s.mixY}isActive(){return this.active}update(){const s=this.target.getAttachment();if(!(s instanceof Tr))return;const t=this.mixRotate,e=this.mixX,n=this.mixY;if(t==0&&e==0&&n==0)return;const i=this.data,r=i.rotateMode==Te.Tangent,a=i.rotateMode==Te.ChainScale,l=this.bones,o=l.length,h=r?o:o+1,c=$.setArraySize(this.spaces,h),d=a?this.lengths=$.setArraySize(this.lengths,o):[],u=this.spacing;switch(i.spacingMode){case Be.Percent:if(a)for(let y=0,w=h-1;y<w;y++){const _=l[y],E=_.data.length;if(E<li.epsilon)d[y]=0;else{const T=E*_.matrix.a,C=E*_.matrix.b;d[y]=Math.sqrt(T*T+C*C)}}$.arrayFill(c,1,h,u);break;case Be.Proportional:let b=0;for(let y=0,w=h-1;y<w;){const _=l[y],E=_.data.length;if(E<li.epsilon)a&&(d[y]=0),c[++y]=u;else{const T=E*_.matrix.a,C=E*_.matrix.b,R=Math.sqrt(T*T+C*C);a&&(d[y]=R),c[++y]=R,b+=R}}if(b>0){b=h/b*u;for(let y=1;y<h;y++)c[y]*=b}break;default:const x=i.spacingMode==Be.Length;for(let y=0,w=h-1;y<w;){const _=l[y],E=_.data.length;if(E<li.epsilon)a&&(d[y]=0),c[++y]=u;else{const T=E*_.matrix.a,C=E*_.matrix.b,R=Math.sqrt(T*T+C*C);a&&(d[y]=R),c[++y]=(x?E+u:u)*R/E}}}const f=this.computeWorldPositions(s,h,r);let m=f[0],p=f[1],g=i.offsetRotation,v=!1;if(g==0)v=i.rotateMode==Te.Chain;else{v=!1;const b=this.target.bone.matrix;g*=b.a*b.d-b.b*b.c>0?I.degRad:-I.degRad}for(let b=0,x=3;b<o;b++,x+=3){const y=l[b],w=y.matrix;w.tx+=(m-w.tx)*e,w.ty+=(p-w.ty)*n;const _=f[x],E=f[x+1],T=_-m,C=E-p;if(a){const R=d[b];if(R!=0){const P=(Math.sqrt(T*T+C*C)/R-1)*t+1;w.a*=P,w.b*=P}}if(m=_,p=E,t>0){const R=w.a,P=w.c,O=w.b,F=w.d;let D=0,V=0,X=0;if(r?D=f[x-1]:c[b+1]==0?D=f[x+2]:D=Math.atan2(C,T),D-=Math.atan2(O,R),v){V=Math.cos(D),X=Math.sin(D);const U=y.data.length;m+=(U*(V*R-X*O)-T)*t,p+=(U*(X*R+V*O)-C)*t}else D+=g;D>I.PI?D-=I.PI2:D<-I.PI&&(D+=I.PI2),D*=t,V=Math.cos(D),X=Math.sin(D),w.a=V*R-X*O,w.c=V*P-X*F,w.b=X*R+V*O,w.d=X*P+V*F}y.updateAppliedTransform()}}computeWorldPositions(s,t,e){const n=this.target;let i=this.position;const r=this.spaces,a=$.setArraySize(this.positions,t*3+2);let l=this.world;const o=s.closed;let h=s.worldVerticesLength,c=h/6,d=li.NONE;if(!s.constantSpeed){const U=s.lengths;c-=o?1:2;const j=U[c];this.data.positionMode==fe.Percent&&(i*=j);let z;switch(this.data.spacingMode){case Be.Percent:z=j;break;case Be.Proportional:z=j/t;break;default:z=1}l=$.setArraySize(this.world,8);for(let N=0,G=0,q=0;N<t;N++,G+=3){const K=r[N]*z;i+=K;let Q=i;if(o)Q%=j,Q<0&&(Q+=j),q=0;else if(Q<0){d!=li.BEFORE&&(d=li.BEFORE,s.computeWorldVertices(n,2,4,l,0,2)),this.addBeforePosition(Q,l,0,a,G);continue}else if(Q>j){d!=li.AFTER&&(d=li.AFTER,s.computeWorldVertices(n,h-6,4,l,0,2)),this.addAfterPosition(Q-j,l,0,a,G);continue}for(;;q++){const tt=U[q];if(!(Q>tt)){if(q==0)Q/=tt;else{const ht=U[q-1];Q=(Q-ht)/(tt-ht)}break}}q!=d&&(d=q,o&&q==c?(s.computeWorldVertices(n,h-4,4,l,0,2),s.computeWorldVertices(n,0,4,l,4,2)):s.computeWorldVertices(n,q*6+2,8,l,0,2)),this.addCurvePosition(Q,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],a,G,e||N>0&&K==0)}return a}o?(h+=2,l=$.setArraySize(this.world,h),s.computeWorldVertices(n,2,h-4,l,0,2),s.computeWorldVertices(n,0,2,l,h-4,2),l[h-2]=l[0],l[h-1]=l[1]):(c--,h-=4,l=$.setArraySize(this.world,h),s.computeWorldVertices(n,2,h,l,0,2));const u=$.setArraySize(this.curves,c);let f=0,m=l[0],p=l[1],g=0,v=0,b=0,x=0,y=0,w=0,_=0,E=0,T=0,C=0,R=0,P=0,O=0,F=0;for(let U=0,j=2;U<c;U++,j+=6)g=l[j],v=l[j+1],b=l[j+2],x=l[j+3],y=l[j+4],w=l[j+5],_=(m-g*2+b)*.1875,E=(p-v*2+x)*.1875,T=((g-b)*3-m+y)*.09375,C=((v-x)*3-p+w)*.09375,R=_*2+T,P=E*2+C,O=(g-m)*.75+_+T*.16666667,F=(v-p)*.75+E+C*.16666667,f+=Math.sqrt(O*O+F*F),O+=R,F+=P,R+=T,P+=C,f+=Math.sqrt(O*O+F*F),O+=R,F+=P,f+=Math.sqrt(O*O+F*F),O+=R+T,F+=P+C,f+=Math.sqrt(O*O+F*F),u[U]=f,m=y,p=w;this.data.positionMode==fe.Percent&&(i*=f);let D;switch(this.data.spacingMode){case Be.Percent:D=f;break;case Be.Proportional:D=f/t;break;default:D=1}const V=this.segments;let X=0;for(let U=0,j=0,z=0,N=0;U<t;U++,j+=3){const G=r[U]*D;i+=G;let q=i;if(o)q%=f,q<0&&(q+=f),z=0;else if(q<0){this.addBeforePosition(q,l,0,a,j);continue}else if(q>f){this.addAfterPosition(q-f,l,h-4,a,j);continue}for(;;z++){const K=u[z];if(!(q>K)){if(z==0)q/=K;else{const Q=u[z-1];q=(q-Q)/(K-Q)}break}}if(z!=d){d=z;let K=z*6;for(m=l[K],p=l[K+1],g=l[K+2],v=l[K+3],b=l[K+4],x=l[K+5],y=l[K+6],w=l[K+7],_=(m-g*2+b)*.03,E=(p-v*2+x)*.03,T=((g-b)*3-m+y)*.006,C=((v-x)*3-p+w)*.006,R=_*2+T,P=E*2+C,O=(g-m)*.3+_+T*.16666667,F=(v-p)*.3+E+C*.16666667,X=Math.sqrt(O*O+F*F),V[0]=X,K=1;K<8;K++)O+=R,F+=P,R+=T,P+=C,X+=Math.sqrt(O*O+F*F),V[K]=X;O+=R,F+=P,X+=Math.sqrt(O*O+F*F),V[8]=X,O+=R+T,F+=P+C,X+=Math.sqrt(O*O+F*F),V[9]=X,N=0}for(q*=X;;N++){const K=V[N];if(!(q>K)){if(N==0)q/=K;else{const Q=V[N-1];q=N+(q-Q)/(K-Q)}break}}this.addCurvePosition(q*.1,m,p,g,v,b,x,y,w,a,j,e||U>0&&G==0)}return a}addBeforePosition(s,t,e,n,i){const r=t[e],a=t[e+1],l=t[e+2]-r,o=t[e+3]-a,h=Math.atan2(o,l);n[i]=r+s*Math.cos(h),n[i+1]=a+s*Math.sin(h),n[i+2]=h}addAfterPosition(s,t,e,n,i){const r=t[e+2],a=t[e+3],l=r-t[e],o=a-t[e+1],h=Math.atan2(o,l);n[i]=r+s*Math.cos(h),n[i+1]=a+s*Math.sin(h),n[i+2]=h}addCurvePosition(s,t,e,n,i,r,a,l,o,h,c,d){if(s==0||isNaN(s)){h[c]=t,h[c+1]=e,h[c+2]=Math.atan2(i-e,n-t);return}const u=s*s,f=u*s,m=1-s,p=m*m,g=p*m,v=m*s,b=v*3,x=m*b,y=b*s,w=t*g+n*x+r*y+l*f,_=e*g+i*x+a*y+o*f;h[c]=w,h[c+1]=_,d&&(s<.001?h[c+2]=Math.atan2(i-e,n-t):h[c+2]=Math.atan2(_-(e*p+i*v*2+a*u),w-(t*p+n*v*2+r*u)))}};let Co=li;Co.NONE=-1;Co.BEFORE=-2;Co.AFTER=-3;Co.epsilon=1e-5;class py{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new at,this.darkColor=t.darkColor?new at:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof kn)||!(this.attachment instanceof kn)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class gy{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new fa,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let i=0;i<t.bones.length;i++){const r=e.findBone(t.bones[i].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[i].name}.`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=n}isActive(){return this.active}update(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=e!=0||n!=0,o=this.target,h=o.matrix,c=h.a,d=h.c,u=h.b,f=h.d,m=c*f-d*u>0?I.degRad:-I.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,v=this.bones;for(let b=0,x=v.length;b<x;b++){const y=v[b],w=y.matrix;if(t!=0){const _=w.a,E=w.c,T=w.b,C=w.d;let R=Math.atan2(u,c)-Math.atan2(T,_)+p;R>I.PI?R-=I.PI2:R<-I.PI&&(R+=I.PI2),R*=t;const P=Math.cos(R),O=Math.sin(R);w.a=P*_-O*T,w.c=P*E-O*C,w.b=O*_+P*T,w.d=O*E+P*C}if(l){const _=this.temp;o.localToWorld(_.set(this.data.offsetX,this.data.offsetY)),w.tx+=(_.x-w.tx)*e,w.ty+=(_.y-w.ty)*n}if(i!=0){let _=Math.sqrt(w.a*w.a+w.b*w.b);_!=0&&(_=(_+(Math.sqrt(c*c+u*u)-_+this.data.offsetScaleX)*i)/_),w.a*=_,w.b*=_}if(r!=0){let _=Math.sqrt(w.c*w.c+w.d*w.d);_!=0&&(_=(_+(Math.sqrt(d*d+f*f)-_+this.data.offsetScaleY)*r)/_),w.c*=_,w.d*=_}if(a>0){const _=w.c,E=w.d,T=Math.atan2(E,_);let C=Math.atan2(f,d)-Math.atan2(u,c)-(T-Math.atan2(w.b,w.a));C>I.PI?C-=I.PI2:C<-I.PI&&(C+=I.PI2),C=T+(C+g)*a;const R=Math.sqrt(_*_+E*E);w.c=Math.cos(C)*R,w.d=Math.sin(C)*R}y.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=e!=0||n!=0,o=this.target,h=o.matrix,c=h.a,d=h.c,u=h.b,f=h.d,m=c*f-d*u>0?I.degRad:-I.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,v=this.bones;for(let b=0,x=v.length;b<x;b++){const y=v[b],w=y.matrix;if(t!=0){const _=w.a,E=w.c,T=w.b,C=w.d;let R=Math.atan2(u,c)+p;R>I.PI?R-=I.PI2:R<-I.PI&&(R+=I.PI2),R*=t;const P=Math.cos(R),O=Math.sin(R);w.a=P*_-O*T,w.c=P*E-O*C,w.b=O*_+P*T,w.d=O*E+P*C}if(l){const _=this.temp;o.localToWorld(_.set(this.data.offsetX,this.data.offsetY)),w.tx+=_.x*e,w.ty+=_.y*n}if(i!=0){const _=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*i+1;w.a*=_,w.b*=_}if(r!=0){const _=(Math.sqrt(d*d+f*f)-1+this.data.offsetScaleY)*r+1;w.c*=_,w.d*=_}if(a>0){let _=Math.atan2(f,d)-Math.atan2(u,c);_>I.PI?_-=I.PI2:_<-I.PI&&(_+=I.PI2);const E=w.c,T=w.d;_=Math.atan2(T,E)+(_-I.PI/2+g)*a;const C=Math.sqrt(E*E+T*T);w.c=Math.cos(_)*C,w.d=Math.sin(_)*C}y.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){const d=o[h];let u=d.arotation;if(t!=0){let b=l.arotation-u+this.data.offsetRotation;b-=(16384-(16384.499999999996-b/360|0))*360,u+=b*t}let f=d.ax,m=d.ay;f+=(l.ax-f+this.data.offsetX)*e,m+=(l.ay-m+this.data.offsetY)*n;let p=d.ascaleX,g=d.ascaleY;i!=0&&p!=0&&(p=(p+(l.ascaleX-p+this.data.offsetScaleX)*i)/p),r!=0&&g!=0&&(g=(g+(l.ascaleY-g+this.data.offsetScaleY)*r)/g);let v=d.ashearY;if(a!=0){let b=l.ashearY-v+this.data.offsetShearY;b-=(16384-(16384.499999999996-b/360|0))*360,v+=b*a}d.updateWorldTransformWith(f,m,u,p,g,d.ashearX,v)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){const d=o[h],u=d.arotation+(l.arotation+this.data.offsetRotation)*t,f=d.ax+(l.ax+this.data.offsetX)*e,m=d.ay+(l.ay+this.data.offsetY)*n,p=d.ascaleX*((l.ascaleX-1+this.data.offsetScaleX)*i+1),g=d.ascaleY*((l.ascaleY-1+this.data.offsetScaleY)*r+1),v=d.ashearY+(l.ashearY+this.data.offsetShearY)*a;d.updateWorldTransformWith(f,m,u,p,g,d.ashearX,v)}}}const Ho=class{constructor(s){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!s)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let t=0;t<s.bones.length;t++){const e=s.bones[t];let n;if(!e.parent)n=new zu(e,this,null);else{const i=this.bones[e.parent.index];n=new zu(e,this,i),i.children.push(n)}this.bones.push(n)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){const e=s.slots[t],n=this.bones[e.boneData.index],i=new py(e,n);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){const e=s.ikConstraints[t];this.ikConstraints.push(new my(e,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){const e=s.transformConstraints[t];this.transformConstraints.push(new gy(e,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){const e=s.pathConstraints[t];this.pathConstraints.push(new Co(e,this))}this.color=new at(1,1,1,1),this.updateCache()}updateCache(){const s=this._updateCache;s.length=0;const t=this.bones;for(let h=0,c=t.length;h<c;h++){const d=t[h];d.sorted=d.data.skinRequired,d.active=!d.sorted}if(this.skin){const h=this.skin.bones;for(let c=0,d=this.skin.bones.length;c<d;c++){let u=this.bones[h[c].index];do u.sorted=!1,u.active=!0,u=u.parent;while(u)}}const e=this.ikConstraints,n=this.transformConstraints,i=this.pathConstraints,r=e.length,a=n.length,l=i.length,o=r+a+l;t:for(let h=0;h<o;h++){for(let c=0;c<r;c++){const d=e[c];if(d.data.order==h){this.sortIkConstraint(d);continue t}}for(let c=0;c<a;c++){const d=n[c];if(d.data.order==h){this.sortTransformConstraint(d);continue t}}for(let c=0;c<l;c++){const d=i[c];if(d.data.order==h){this.sortPathConstraint(d);continue t}}}for(let h=0,c=t.length;h<c;h++)this.sortBone(t[h])}sortIkConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&$.contains(this.skin.constraints,s.data,!0)),!s.active)return;const t=s.target;this.sortBone(t);const e=s.bones,n=e[0];if(this.sortBone(n),e.length==1)this._updateCache.push(s),this.sortReset(n.children);else{const i=e[e.length-1];this.sortBone(i),this._updateCache.push(s),this.sortReset(n.children),i.sorted=!0}}sortPathConstraint(s){if(s.active=s.target.bone.isActive()&&(!s.data.skinRequired||this.skin&&$.contains(this.skin.constraints,s.data,!0)),!s.active)return;const t=s.target,e=t.data.index,n=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,e,n),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,n);for(let l=0,o=this.data.skins.length;l<o;l++)this.sortPathConstraintAttachment(this.data.skins[l],e,n);const i=t.getAttachment();i instanceof Tr&&this.sortPathConstraintAttachmentWith(i,n);const r=s.bones,a=r.length;for(let l=0;l<a;l++)this.sortBone(r[l]);this._updateCache.push(s);for(let l=0;l<a;l++)this.sortReset(r[l].children);for(let l=0;l<a;l++)r[l].sorted=!0}sortTransformConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&$.contains(this.skin.constraints,s.data,!0)),!s.active)return;this.sortBone(s.target);const t=s.bones,e=t.length;if(s.data.local)for(let n=0;n<e;n++){const i=t[n];this.sortBone(i.parent),this.sortBone(i)}else for(let n=0;n<e;n++)this.sortBone(t[n]);this._updateCache.push(s);for(let n=0;n<e;n++)this.sortReset(t[n].children);for(let n=0;n<e;n++)t[n].sorted=!0}sortPathConstraintAttachment(s,t,e){const n=s.attachments[t];if(n)for(const i in n)this.sortPathConstraintAttachmentWith(n[i],e)}sortPathConstraintAttachmentWith(s,t){if(!(s instanceof Tr))return;const e=s.bones;if(!e)this.sortBone(t);else{const n=this.bones;for(let i=0,r=e.length;i<r;){let a=e[i++];for(a+=i;i<a;)this.sortBone(n[e[i++]])}}}sortBone(s){if(!s||s.sorted)return;const t=s.parent;t&&this.sortBone(t),s.sorted=!0,this._updateCache.push(s)}sortReset(s){for(let t=0,e=s.length;t<e;t++){const n=s[t];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const s=this.bones;for(let e=0,n=s.length;e<n;e++){const i=s[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY}const t=this._updateCache;for(let e=0,n=t.length;e<n;e++)t[e].update()}updateWorldTransformWith(s){const t=this.getRootBone(),e=s.matrix.a,n=s.matrix.c,i=s.matrix.b,r=s.matrix.d;t.matrix.tx=e*this.x+n*this.y+s.worldX,t.matrix.ty=i*this.x+r*this.y+s.worldY;const a=t.rotation+90+t.shearY,l=I.cosDeg(t.rotation+t.shearX)*t.scaleX,o=I.cosDeg(a)*t.scaleY,h=I.sinDeg(t.rotation+t.shearX)*t.scaleX,c=I.sinDeg(a)*t.scaleY,d=this.scaleX,u=-this.scaleY;t.matrix.a=(e*l+n*h)*d,t.matrix.c=(e*o+n*c)*d,t.matrix.b=(i*l+r*h)*u,t.matrix.d=(i*o+r*c)*u;const f=this._updateCache;for(let m=0,p=f.length;m<p;m++){const g=f[m];g!=t&&g.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const s=this.bones;for(let i=0,r=s.length;i<r;i++)s[i].setToSetupPose();const t=this.ikConstraints;for(let i=0,r=t.length;i<r;i++){const a=t[i];a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}const e=this.transformConstraints;for(let i=0,r=e.length;i<r;i++){const a=e[i],l=a.data;a.mixRotate=l.mixRotate,a.mixX=l.mixX,a.mixY=l.mixY,a.mixScaleX=l.mixScaleX,a.mixScaleY=l.mixScaleY,a.mixShearY=l.mixShearY}const n=this.pathConstraints;for(let i=0,r=n.length;i<r;i++){const a=n[i],l=a.data;a.position=l.position,a.spacing=l.spacing,a.mixRotate=l.mixRotate,a.mixX=l.mixX,a.mixY=l.mixY}}setSlotsToSetupPose(){const s=this.slots;$.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(s){if(!s)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(i.data.name==s)return i}return null}findBoneIndex(s){if(!s)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,n=t.length;e<n;e++)if(t[e].data.name==s)return e;return-1}findSlot(s){if(!s)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(i.data.name==s)return i}return null}findSlotIndex(s){if(!s)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,n=t.length;e<n;e++)if(t[e].data.name==s)return e;return-1}setSkinByName(s){const t=this.data.findSkin(s);if(!t)throw new Error(`Skin not found: ${s}`);this.setSkin(t)}setSkin(s){if(s!=this.skin){if(s)if(this.skin)s.attachAll(this,this.skin);else{const t=this.slots;for(let e=0,n=t.length;e<n;e++){const i=t[e],r=i.data.attachmentName;if(r){const a=s.getAttachment(e,r);a&&i.setAttachment(a)}}}this.skin=s,this.updateCache()}}getAttachmentByName(s,t){const e=this.data.findSlot(s);if(!e)throw new Error(`Can't find slot with name ${s}`);return this.getAttachment(e.index,t)}getAttachment(s,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){const e=this.skin.getAttachment(s,t);if(e)return e}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(s,t):null}setAttachment(s,t){if(!s)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.data.name==s){let a=null;if(t&&(a=this.getAttachment(n,t),!a))throw new Error(`Attachment not found: ${t}, for slot: ${s}`);r.setAttachment(a);return}}throw new Error(`Slot not found: ${s}`)}findIkConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(i.data.name==s)return i}return null}findTransformConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(i.data.name==s)return i}return null}findPathConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let e=0,n=t.length;e<n;e++){const i=t[e];if(i.data.name==s)return i}return null}getBoundsRect(){const s=new fa,t=new fa;return this.getBounds(s,t),{x:s.x,y:s.y,width:t.x,height:t.y}}getBounds(s,t,e=new Array(2)){if(!s)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");const n=this.drawOrder;let i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let o=0,h=n.length;o<h;o++){const c=n[o];if(!c.bone.active)continue;let d=0,u=null;const f=c.getAttachment();if(f instanceof Gt)d=8,u=$.setArraySize(e,d,0),f.computeWorldVertices(c,u,0,2);else if(f instanceof Sr){const m=f;d=m.worldVerticesLength,u=$.setArraySize(e,d,0),m.computeWorldVertices(c,0,d,u,0,2)}if(u)for(let m=0,p=u.length;m<p;m+=2){const g=u[m],v=u[m+1];i=Math.min(i,g),r=Math.min(r,v),a=Math.max(a,g),l=Math.max(l,v)}}s.set(i,r),t.set(a-i,l-r)}get flipX(){return this.scaleX==-1}set flipX(s){Ho.deprecatedWarning1||(Ho.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=s?1:-1}get flipY(){return this.scaleY==-1}set flipY(s){Ho.deprecatedWarning1||(Ho.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=s?1:-1}};let Tf=Ho;Tf.deprecatedWarning1=!1;class Af{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1}}class Cf{constructor(t,e,n){if(this.index=0,this.color=new at(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=ft.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}}class Mf extends Ph{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class ju{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}}class Ul{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(!n)throw new Error("attachment cannot be null.");const i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n}addSkin(t){for(let n=0;n<t.bones.length;n++){const i=t.bones[n];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==i){r=!0;break}r||this.bones.push(i)}for(let n=0;n<t.constraints.length;n++){const i=t.constraints[n];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==i){r=!0;break}r||this.constraints.push(i)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const i=e[n];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let n=0;n<t.bones.length;n++){const i=t.bones[n];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==i){r=!0;break}r||this.bones.push(i)}for(let n=0;n<t.constraints.length;n++){const i=t.constraints[n];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==i){r=!0;break}r||this.constraints.push(i)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const i=e[n];i.attachment&&(i.attachment instanceof Sr?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&delete n[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const i in n){const r=n[i];r&&t.push(new ju(e,i,r))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const i in n){const r=n[i];r&&e.push(new ju(t,i,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let i=0;i<t.slots.length;i++){const r=t.slots[i],a=r.getAttachment();if(a&&n<e.attachments.length){const l=e.attachments[n];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(n,o);c&&r.setAttachment(c);break}}}n++}}}class If{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new Af;n.name="";const i=new Ol(t),r=i.readInt32(),a=i.readInt32();n.hash=a==0&&r==0?null:a.toString(16)+r.toString(16),n.version=i.readString();const l=n.version.substr(0,3);if(l!=="4.0"&&l!=="4.1"){const d=`Spine 4.1 loader cant load version ${n.version}. Please configure your pixi-spine bundle`;console.error(d)}this.ver40=l==="4.0",n.x=i.readFloat(),n.y=i.readFloat(),n.width=i.readFloat(),n.height=i.readFloat();const o=i.readBoolean();o&&(n.fps=i.readFloat(),n.imagesPath=i.readString(),n.audioPath=i.readString());let h=0;h=i.readInt(!0);for(let d=0;d<h;d++){const u=i.readString();if(!u)throw new Error("String in string table must not be null.");i.strings.push(u)}h=i.readInt(!0);for(let d=0;d<h;d++){const u=i.readString();if(!u)throw new Error("Bone name must not be null.");const f=d==0?null:n.bones[i.readInt(!0)],m=new vf(d,u,f);m.rotation=i.readFloat(),m.x=i.readFloat()*e,m.y=i.readFloat()*e,m.scaleX=i.readFloat(),m.scaleY=i.readFloat(),m.shearX=i.readFloat(),m.shearY=i.readFloat(),m.length=i.readFloat()*e,m.transformMode=i.readInt(!0),m.skinRequired=i.readBoolean(),o&&at.rgba8888ToColor(m.color,i.readInt32()),n.bones.push(m)}h=i.readInt(!0);for(let d=0;d<h;d++){const u=i.readString();if(!u)throw new Error("Slot name must not be null.");const f=n.bones[i.readInt(!0)],m=new Cf(d,u,f);at.rgba8888ToColor(m.color,i.readInt32());const p=i.readInt32();p!=-1&&at.rgb888ToColor(m.darkColor=new at,p),m.attachmentName=i.readStringRef(),m.blendMode=i.readInt(!0),n.slots.push(m)}h=i.readInt(!0);for(let d=0,u;d<h;d++){const f=i.readString();if(!f)throw new Error("IK constraint data name must not be null.");const m=new Ef(f);m.order=i.readInt(!0),m.skinRequired=i.readBoolean(),u=i.readInt(!0);for(let p=0;p<u;p++)m.bones.push(n.bones[i.readInt(!0)]);m.target=n.bones[i.readInt(!0)],m.mix=i.readFloat(),m.softness=i.readFloat()*e,m.bendDirection=i.readByte(),m.compress=i.readBoolean(),m.stretch=i.readBoolean(),m.uniform=i.readBoolean(),n.ikConstraints.push(m)}h=i.readInt(!0);for(let d=0,u;d<h;d++){const f=i.readString();if(!f)throw new Error("Transform constraint data name must not be null.");const m=new Mf(f);m.order=i.readInt(!0),m.skinRequired=i.readBoolean(),u=i.readInt(!0);for(let p=0;p<u;p++)m.bones.push(n.bones[i.readInt(!0)]);m.target=n.bones[i.readInt(!0)],m.local=i.readBoolean(),m.relative=i.readBoolean(),m.offsetRotation=i.readFloat(),m.offsetX=i.readFloat()*e,m.offsetY=i.readFloat()*e,m.offsetScaleX=i.readFloat(),m.offsetScaleY=i.readFloat(),m.offsetShearY=i.readFloat(),m.mixRotate=i.readFloat(),m.mixX=i.readFloat(),m.mixY=i.readFloat(),m.mixScaleX=i.readFloat(),m.mixScaleY=i.readFloat(),m.mixShearY=i.readFloat(),n.transformConstraints.push(m)}h=i.readInt(!0);for(let d=0,u;d<h;d++){const f=i.readString();if(!f)throw new Error("Path constraint data name must not be null.");const m=new Sf(f);m.order=i.readInt(!0),m.skinRequired=i.readBoolean(),u=i.readInt(!0);for(let p=0;p<u;p++)m.bones.push(n.bones[i.readInt(!0)]);m.target=n.slots[i.readInt(!0)],m.positionMode=i.readInt(!0),m.spacingMode=i.readInt(!0),m.rotateMode=i.readInt(!0),m.offsetRotation=i.readFloat(),m.position=i.readFloat(),m.positionMode==fe.Fixed&&(m.position*=e),m.spacing=i.readFloat(),(m.spacingMode==Be.Length||m.spacingMode==Be.Fixed)&&(m.spacing*=e),m.mixRotate=i.readFloat(),m.mixX=i.readFloat(),m.mixY=i.readFloat(),n.pathConstraints.push(m)}const c=this.readSkin(i,n,!0,o);c&&(n.defaultSkin=c,n.skins.push(c));{let d=n.skins.length;for($.setArraySize(n.skins,h=d+i.readInt(!0));d<h;d++){const u=this.readSkin(i,n,!1,o);if(!u)throw new Error("readSkin() should not have returned null.");n.skins[d]=u}}h=this.linkedMeshes.length;for(let d=0;d<h;d++){const u=this.linkedMeshes[d],f=u.skin?n.findSkin(u.skin):n.defaultSkin;if(!f)throw new Error("Not skin found for linked mesh.");if(!u.parent)throw new Error("Linked mesh parent must not be null");const m=f.getAttachment(u.slotIndex,u.parent);if(!m)throw new Error(`Parent mesh not found: ${u.parent}`);u.mesh.timelineAttachment=u.inheritTimeline?m:u.mesh,u.mesh.setParentMesh(m)}this.linkedMeshes.length=0,h=i.readInt(!0);for(let d=0;d<h;d++){const u=i.readStringRef();if(!u)throw new Error;const f=new _f(u);f.intValue=i.readInt(!1),f.floatValue=i.readFloat(),f.stringValue=i.readString(),f.audioPath=i.readString(),f.audioPath&&(f.volume=i.readFloat(),f.balance=i.readFloat()),n.events.push(f)}h=i.readInt(!0);for(let d=0;d<h;d++){const u=i.readString();if(!u)throw new Error("Animatio name must not be null.");n.animations.push(this.readAnimation(i,u,n))}return n}readSkin(t,e,n,i){let r=null,a=0;if(n){if(a=t.readInt(!0),a==0)return null;r=new Ul("default")}else{const l=t.readStringRef();if(!l)throw new Error("Skin name must not be null.");r=new Ul(l),r.bones.length=t.readInt(!0);for(let o=0,h=r.bones.length;o<h;o++)r.bones[o]=e.bones[t.readInt(!0)];for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.pathConstraints[t.readInt(!0)]);a=t.readInt(!0)}for(let l=0;l<a;l++){const o=t.readInt(!0);for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readStringRef();if(!d)throw new Error("Attachment name must not be null");const u=this.readAttachment(t,e,r,o,d,i);u&&r.setAttachment(o,d,u)}}return r}readAttachment(t,e,n,i,r,a){const l=this.scale;let o=t.readStringRef();switch(o||(o=r),t.readByte()){case Bt.Region:{let h=t.readStringRef();const c=t.readFloat(),d=t.readFloat(),u=t.readFloat(),f=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat(),v=t.readInt32(),b=this.readSequence(t);h||(h=o);const x=this.attachmentLoader.newRegionAttachment(n,o,h,b);return x?(x.path=h,x.x=d*l,x.y=u*l,x.scaleX=f,x.scaleY=m,x.rotation=c,x.width=p*l,x.height=g*l,at.rgba8888ToColor(x.color,v),x.sequence=b,b==null&&x.updateRegion(),x):null}case Bt.BoundingBox:{const h=t.readInt(!0),c=this.readVertices(t,h),d=a?t.readInt32():0,u=this.attachmentLoader.newBoundingBoxAttachment(n,o);return u?(u.worldVerticesLength=h<<1,u.vertices=c.vertices,u.bones=c.bones,a&&at.rgba8888ToColor(u.color,d),u):null}case Bt.Mesh:{let h=t.readStringRef();const c=t.readInt32(),d=t.readInt(!0),u=this.readFloatArray(t,d<<1,1),f=this.readShortArray(t),m=this.readVertices(t,d),p=t.readInt(!0),g=this.readSequence(t);let v=[],b=0,x=0;a&&(v=this.readShortArray(t),b=t.readFloat(),x=t.readFloat()),h||(h=o);const y=this.attachmentLoader.newMeshAttachment(n,o,h,g);return y?(y.path=h,at.rgba8888ToColor(y.color,c),y.bones=m.bones,y.vertices=m.vertices,y.worldVerticesLength=d<<1,y.triangles=f,y.regionUVs=new Float32Array(u),y.hullLength=p<<1,y.sequence=g,a&&(y.edges=v,y.width=b*l,y.height=x*l),y):null}case Bt.LinkedMesh:{let h=t.readStringRef();const c=t.readInt32(),d=t.readStringRef(),u=t.readStringRef(),f=t.readBoolean(),m=this.readSequence(t);let p=0,g=0;a&&(p=t.readFloat(),g=t.readFloat()),h||(h=o);const v=this.attachmentLoader.newMeshAttachment(n,o,h,m);return v?(v.path=h,at.rgba8888ToColor(v.color,c),v.sequence=m,a&&(v.width=p*l,v.height=g*l),this.linkedMeshes.push(new xC(v,d,i,u,f)),v):null}case Bt.Path:{const h=t.readBoolean(),c=t.readBoolean(),d=t.readInt(!0),u=this.readVertices(t,d),f=$.newArray(d/3,0);for(let g=0,v=f.length;g<v;g++)f[g]=t.readFloat()*l;const m=a?t.readInt32():0,p=this.attachmentLoader.newPathAttachment(n,o);return p?(p.closed=h,p.constantSpeed=c,p.worldVerticesLength=d<<1,p.vertices=u.vertices,p.bones=u.bones,p.lengths=f,a&&at.rgba8888ToColor(p.color,m),p):null}case Bt.Point:{const h=t.readFloat(),c=t.readFloat(),d=t.readFloat(),u=a?t.readInt32():0,f=this.attachmentLoader.newPointAttachment(n,o);return f?(f.x=c*l,f.y=d*l,f.rotation=h,a&&at.rgba8888ToColor(f.color,u),f):null}case Bt.Clipping:{const h=t.readInt(!0),c=t.readInt(!0),d=this.readVertices(t,c),u=a?t.readInt32():0,f=this.attachmentLoader.newClippingAttachment(n,o);return f?(f.endSlot=e.slots[h],f.worldVerticesLength=c<<1,f.vertices=d.vertices,f.bones=d.bones,a&&at.rgba8888ToColor(f.color,u),f):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new Ch(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?Kp:t.readByte()}readVertices(t,e){const n=this.scale,i=e<<1,r=new yC;if(!t.readBoolean())return r.vertices=this.readFloatArray(t,i,n),r;const a=new Array,l=new Array;for(let o=0;o<e;o++){const h=t.readInt(!0);l.push(h);for(let c=0;c<h;c++)l.push(t.readInt(!0)),a.push(t.readFloat()*n),a.push(t.readFloat()*n),a.push(t.readFloat())}return r.vertices=$.toFloatArray(a),r.bones=l,r}readFloatArray(t,e,n){const i=new Array(e);if(n==1)for(let r=0;r<e;r++)i[r]=t.readFloat();else for(let r=0;r<e;r++)i[r]=t.readFloat()*n;return i}readShortArray(t){const e=t.readInt(!0),n=new Array(e);for(let i=0;i<e;i++)n[i]=t.readShort();return n}readAnimation(t,e,n){t.readInt(!0);const i=new Array,r=this.scale;for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readInt(!0);for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readByte(),p=t.readInt(!0),g=p-1;switch(m){case IC:{const v=new fr(p,d);for(let b=0;b<p;b++)v.setFrame(b,t.readFloat(),t.readStringRef());i.push(v);break}case RC:{const v=t.readInt(!0),b=new lf(p,v,d);let x=t.readFloat(),y=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255;for(let T=0,C=0;b.setFrame(T,x,y,w,_,E),T!=g;T++){const R=t.readFloat(),P=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255;switch(t.readByte()){case gn:b.setStepped(T);break;case xn:Ut(t,b,C++,T,0,x,R,y,P,1),Ut(t,b,C++,T,1,x,R,w,O,1),Ut(t,b,C++,T,2,x,R,_,F,1),Ut(t,b,C++,T,3,x,R,E,D,1)}x=R,y=P,w=O,_=F,E=D}i.push(b);break}case PC:{const v=t.readInt(!0),b=new hf(p,v,d);let x=t.readFloat(),y=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255;for(let E=0,T=0;b.setFrame(E,x,y,w,_),E!=g;E++){const C=t.readFloat(),R=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255;switch(t.readByte()){case gn:b.setStepped(E);break;case xn:Ut(t,b,T++,E,0,x,C,y,R,1),Ut(t,b,T++,E,1,x,C,w,P,1),Ut(t,b,T++,E,2,x,C,_,O,1)}x=C,y=R,w=P,_=O}i.push(b);break}case kC:{const v=t.readInt(!0),b=new uf(p,v,d);let x=t.readFloat(),y=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255;for(let P=0,O=0;b.setFrame(P,x,y,w,_,E,T,C,R),P!=g;P++){const F=t.readFloat(),D=t.readUnsignedByte()/255,V=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,U=t.readUnsignedByte()/255,j=t.readUnsignedByte()/255,z=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255;switch(t.readByte()){case gn:b.setStepped(P);break;case xn:Ut(t,b,O++,P,0,x,F,y,D,1),Ut(t,b,O++,P,1,x,F,w,V,1),Ut(t,b,O++,P,2,x,F,_,X,1),Ut(t,b,O++,P,3,x,F,E,U,1),Ut(t,b,O++,P,4,x,F,T,j,1),Ut(t,b,O++,P,5,x,F,C,z,1),Ut(t,b,O++,P,6,x,F,R,N,1)}x=F,y=D,w=V,_=X,E=U,T=j,C=z,R=N}i.push(b);break}case FC:{const v=t.readInt(!0),b=new df(p,v,d);let x=t.readFloat(),y=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255;for(let R=0,P=0;b.setFrame(R,x,y,w,_,E,T,C),R!=g;R++){const O=t.readFloat(),F=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255,V=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,U=t.readUnsignedByte()/255,j=t.readUnsignedByte()/255;switch(t.readByte()){case gn:b.setStepped(R);break;case xn:Ut(t,b,P++,R,0,x,O,y,F,1),Ut(t,b,P++,R,1,x,O,w,D,1),Ut(t,b,P++,R,2,x,O,_,V,1),Ut(t,b,P++,R,3,x,O,E,X,1),Ut(t,b,P++,R,4,x,O,T,U,1),Ut(t,b,P++,R,5,x,O,C,j,1)}x=O,y=F,w=D,_=V,E=X,T=U,C=j}i.push(b);break}case DC:{const v=new cf(p,t.readInt(!0),d);let b=t.readFloat(),x=t.readUnsignedByte()/255;for(let y=0,w=0;v.setFrame(y,b,x),y!=g;y++){const _=t.readFloat(),E=t.readUnsignedByte()/255;switch(t.readByte()){case gn:v.setStepped(y);break;case xn:Ut(t,v,w++,y,0,b,_,x,E,1)}b=_,x=E}i.push(v)}}}}for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readInt(!0);for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readByte(),p=t.readInt(!0),g=t.readInt(!0);switch(m){case bC:i.push(si(t,new ga(p,g,d),1));break;case vC:i.push(Nc(t,new Jd(p,g,d),r));break;case wC:i.push(si(t,new Qd(p,g,d),r));break;case _C:i.push(si(t,new tf(p,g,d),r));break;case EC:i.push(Nc(t,new ef(p,g,d),1));break;case SC:i.push(si(t,new sf(p,g,d),1));break;case TC:i.push(si(t,new nf(p,g,d),1));break;case AC:i.push(Nc(t,new rf(p,g,d),1));break;case CC:i.push(si(t,new of(p,g,d),1));break;case MC:i.push(si(t,new af(p,g,d),1))}}}for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readInt(!0),u=t.readInt(!0),f=u-1,m=new mf(u,t.readInt(!0),d);let p=t.readFloat(),g=t.readFloat(),v=t.readFloat()*r;for(let b=0,x=0;m.setFrame(b,p,g,v,t.readByte(),t.readBoolean(),t.readBoolean()),b!=f;b++){const y=t.readFloat(),w=t.readFloat(),_=t.readFloat()*r;switch(t.readByte()){case gn:m.setStepped(b);break;case xn:Ut(t,m,x++,b,0,p,y,g,w,1),Ut(t,m,x++,b,1,p,y,v,_,r)}p=y,g=w,v=_}i.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readInt(!0),u=t.readInt(!0),f=u-1,m=new pf(u,t.readInt(!0),d);let p=t.readFloat(),g=t.readFloat(),v=t.readFloat(),b=t.readFloat(),x=t.readFloat(),y=t.readFloat(),w=t.readFloat();for(let _=0,E=0;m.setFrame(_,p,g,v,b,x,y,w),_!=f;_++){const T=t.readFloat(),C=t.readFloat(),R=t.readFloat(),P=t.readFloat(),O=t.readFloat(),F=t.readFloat(),D=t.readFloat();switch(t.readByte()){case gn:m.setStepped(_);break;case xn:Ut(t,m,E++,_,0,p,T,g,C,1),Ut(t,m,E++,_,1,p,T,v,R,1),Ut(t,m,E++,_,2,p,T,b,P,1),Ut(t,m,E++,_,3,p,T,x,O,1),Ut(t,m,E++,_,4,p,T,y,F,1),Ut(t,m,E++,_,5,p,T,w,D,1)}p=T,g=C,v=R,b=P,x=O,y=F,w=D}i.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){const d=t.readInt(!0),u=n.pathConstraints[d];for(let f=0,m=t.readInt(!0);f<m;f++)switch(t.readByte()){case OC:i.push(si(t,new gf(t.readInt(!0),t.readInt(!0),d),u.positionMode==fe.Fixed?r:1));break;case NC:i.push(si(t,new xf(t.readInt(!0),t.readInt(!0),d),u.spacingMode==Be.Length||u.spacingMode==Be.Fixed?r:1));break;case LC:const p=new yf(t.readInt(!0),t.readInt(!0),d);let g=t.readFloat(),v=t.readFloat(),b=t.readFloat(),x=t.readFloat();for(let y=0,w=0,_=p.getFrameCount()-1;p.setFrame(y,g,v,b,x),y!=_;y++){const E=t.readFloat(),T=t.readFloat(),C=t.readFloat(),R=t.readFloat();switch(t.readByte()){case gn:p.setStepped(y);break;case xn:Ut(t,p,w++,y,0,g,E,v,T,1),Ut(t,p,w++,y,1,g,E,b,C,1),Ut(t,p,w++,y,2,g,E,x,R,1)}g=E,v=T,b=C,x=R}i.push(p)}}for(let h=0,c=t.readInt(!0);h<c;h++){const d=n.skins[t.readInt(!0)];for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){const v=t.readStringRef();if(!v)throw new Error("attachmentName must not be null.");const b=d.getAttachment(m,v),x=this.readDeformTimelineType(t),y=t.readInt(!0),w=y-1;switch(x){case Kp:{const _=b,E=_.bones,T=_.vertices,C=E?T.length/3*2:T.length,R=t.readInt(!0),P=new ff(y,R,m,_);let O=t.readFloat();for(let F=0,D=0;;F++){let V,X=t.readInt(!0);if(X==0)V=E?$.newFloatArray(C):T;else{V=$.newFloatArray(C);const j=t.readInt(!0);if(X+=j,r==1)for(let z=j;z<X;z++)V[z]=t.readFloat();else for(let z=j;z<X;z++)V[z]=t.readFloat()*r;if(!E)for(let z=0,N=V.length;z<N;z++)V[z]+=T[z]}if(P.setFrame(F,O,V),F==w)break;const U=t.readFloat();switch(t.readByte()){case gn:P.setStepped(F);break;case xn:Ut(t,P,D++,F,0,O,U,0,1,1)}O=U}i.push(P);break}case BC:{const _=new To(y,m,b);for(let E=0;E<y;E++){const T=t.readFloat(),C=t.readInt32();_.setFrame(E,T,Zd[C&15],C>>4,t.readFloat())}i.push(_);break}}}}}const a=t.readInt(!0);if(a>0){const h=new xr(a),c=n.slots.length;for(let d=0;d<a;d++){const u=t.readFloat(),f=t.readInt(!0),m=$.newArray(c,0);for(let b=c-1;b>=0;b--)m[b]=-1;const p=$.newArray(c-f,0);let g=0,v=0;for(let b=0;b<f;b++){const x=t.readInt(!0);for(;g!=x;)p[v++]=g++;m[g+t.readInt(!0)]=g++}for(;g<c;)p[v++]=g++;for(let b=c-1;b>=0;b--)m[b]==-1&&(m[b]=p[--v]);h.setFrame(d,u,m)}i.push(h)}const l=t.readInt(!0);if(l>0){const h=new Ia(l);for(let c=0;c<l;c++){const d=t.readFloat(),u=n.events[t.readInt(!0)],f=new wf(d,u);f.intValue=t.readInt(!1),f.floatValue=t.readFloat(),f.stringValue=t.readBoolean()?t.readString():u.stringValue,f.data.audioPath&&(f.volume=t.readFloat(),f.balance=t.readFloat()),h.setFrame(c,f)}i.push(h)}let o=0;for(let h=0,c=i.length;h<c;h++)o=Math.max(o,i[h].getDuration());return new Mh(e,i,o)}}If.BlendModeValues=[ft.NORMAL,ft.ADD,ft.MULTIPLY,ft.SCREEN];let xC=class{constructor(t,e,n,i,r){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritTimeline=r}};class yC{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function si(s,t,e){let n=s.readFloat(),i=s.readFloat()*e;for(let r=0,a=0,l=t.getFrameCount()-1;t.setFrame(r,n,i),r!=l;r++){const o=s.readFloat(),h=s.readFloat()*e;switch(s.readByte()){case gn:t.setStepped(r);break;case xn:Ut(s,t,a++,r,0,n,o,i,h,e)}n=o,i=h}return t}function Nc(s,t,e){let n=s.readFloat(),i=s.readFloat()*e,r=s.readFloat()*e;for(let a=0,l=0,o=t.getFrameCount()-1;t.setFrame(a,n,i,r),a!=o;a++){const h=s.readFloat(),c=s.readFloat()*e,d=s.readFloat()*e;switch(s.readByte()){case gn:t.setStepped(a);break;case xn:Ut(s,t,l++,a,0,n,h,i,c,e),Ut(s,t,l++,a,1,n,h,r,d,e)}n=h,i=c,r=d}return t}function Ut(s,t,e,n,i,r,a,l,o,h){t.setBezier(e,n,i,r,l,s.readFloat(),s.readFloat()*h,s.readFloat(),s.readFloat()*h,a,o)}const bC=0,vC=1,wC=2,_C=3,EC=4,SC=5,TC=6,AC=7,CC=8,MC=9,IC=0,RC=1,PC=2,kC=3,FC=4,DC=5,Kp=0,BC=1,OC=0,NC=1,LC=2,gn=1,xn=2;class VC extends Td{}class kh{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new Af,i=typeof t=="string"?JSON.parse(t):t,r=i.skeleton;if(r){n.hash=r.hash,n.version=r.spine;const a=n.version.substr(0,3);if(a!=="4.0"&&a!=="4.1"){const l=`Spine 4.1 loader cant load version ${r.spine}. Please configure your pixi-spine bundle`;console.error(l)}n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height,n.fps=r.fps,n.imagesPath=r.images}if(i.bones)for(let a=0;a<i.bones.length;a++){const l=i.bones[a];let o=null;const h=W(l,"parent",null);if(h!=null&&(o=n.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new vf(n.bones.length,l.name,o);c.length=W(l,"length",0)*e,c.x=W(l,"x",0)*e,c.y=W(l,"y",0)*e,c.rotation=W(l,"rotation",0),c.scaleX=W(l,"scaleX",1),c.scaleY=W(l,"scaleY",1),c.shearX=W(l,"shearX",0),c.shearY=W(l,"shearY",0),c.transformMode=$.enumValue(Tt,W(l,"transform","Normal")),c.skinRequired=W(l,"skin",!1);const d=W(l,"color",null);d&&c.color.setFromString(d),n.bones.push(c)}if(i.slots)for(let a=0;a<i.slots.length;a++){const l=i.slots[a],o=n.findBone(l.bone);if(!o)throw new Error(`Couldn't find bone ${l.bone} for slot ${l.name}`);const h=new Cf(n.slots.length,l.name,o),c=W(l,"color",null);c&&h.color.setFromString(c);const d=W(l,"dark",null);d&&(h.darkColor=at.fromString(d)),h.attachmentName=W(l,"attachment",null),h.blendMode=kh.blendModeFromString(W(l,"blend","normal")),n.slots.push(h)}if(i.ik)for(let a=0;a<i.ik.length;a++){const l=i.ik[a],o=new Ef(l.name);o.order=W(l,"order",0),o.skinRequired=W(l,"skin",!1);for(let h=0;h<l.bones.length;h++){const c=l.bones[h],d=n.findBone(c);if(d==null)throw new Error(`IK bone not found: ${c}`);o.bones.push(d)}o.target=n.findBone(l.target),o.mix=W(l,"mix",1),o.softness=W(l,"softness",0)*e,o.bendDirection=W(l,"bendPositive",!0)?1:-1,o.compress=W(l,"compress",!1),o.stretch=W(l,"stretch",!1),o.uniform=W(l,"uniform",!1),n.ikConstraints.push(o)}if(i.transform)for(let a=0;a<i.transform.length;a++){const l=i.transform[a],o=new Mf(l.name);o.order=W(l,"order",0),o.skinRequired=W(l,"skin",!1);for(let d=0;d<l.bones.length;d++){const u=l.bones[d],f=n.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for transform constraint ${l.name}.`);o.bones.push(f)}const h=l.target,c=n.findBone(h);if(!c)throw new Error(`Couldn't find target bone ${h} for transform constraint ${l.name}.`);o.target=c,o.local=W(l,"local",!1),o.relative=W(l,"relative",!1),o.offsetRotation=W(l,"rotation",0),o.offsetX=W(l,"x",0)*e,o.offsetY=W(l,"y",0)*e,o.offsetScaleX=W(l,"scaleX",0),o.offsetScaleY=W(l,"scaleY",0),o.offsetShearY=W(l,"shearY",0),o.mixRotate=W(l,"mixRotate",1),o.mixX=W(l,"mixX",1),o.mixY=W(l,"mixY",o.mixX),o.mixScaleX=W(l,"mixScaleX",1),o.mixScaleY=W(l,"mixScaleY",o.mixScaleX),o.mixShearY=W(l,"mixShearY",1),n.transformConstraints.push(o)}if(i.path)for(let a=0;a<i.path.length;a++){const l=i.path[a],o=new Sf(l.name);o.order=W(l,"order",0),o.skinRequired=W(l,"skin",!1);for(let d=0;d<l.bones.length;d++){const u=l.bones[d],f=n.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for path constraint ${l.name}.`);o.bones.push(f)}const h=l.target,c=n.findSlot(h);if(!c)throw new Error(`Couldn't find target slot ${h} for path constraint ${l.name}.`);o.target=c,o.positionMode=$.enumValue(fe,W(l,"positionMode","Percent")),o.spacingMode=$.enumValue(Be,W(l,"spacingMode","Length")),o.rotateMode=$.enumValue(Te,W(l,"rotateMode","Tangent")),o.offsetRotation=W(l,"rotation",0),o.position=W(l,"position",0),o.positionMode==fe.Fixed&&(o.position*=e),o.spacing=W(l,"spacing",0),(o.spacingMode==Be.Length||o.spacingMode==Be.Fixed)&&(o.spacing*=e),o.mixRotate=W(l,"mixRotate",1),o.mixX=W(l,"mixX",1),o.mixY=W(l,"mixY",o.mixX),n.pathConstraints.push(o)}if(i.skins)for(let a=0;a<i.skins.length;a++){const l=i.skins[a],o=new Ul(l.name);if(l.bones)for(let h=0;h<l.bones.length;h++){const c=l.bones[h],d=n.findBone(c);if(!d)throw new Error(`Couldn't find bone ${c} for skin ${l.name}.`);o.bones.push(d)}if(l.ik)for(let h=0;h<l.ik.length;h++){const c=l.ik[h],d=n.findIkConstraint(c);if(!d)throw new Error(`Couldn't find IK constraint ${c} for skin ${l.name}.`);o.constraints.push(d)}if(l.transform)for(let h=0;h<l.transform.length;h++){const c=l.transform[h],d=n.findTransformConstraint(c);if(!d)throw new Error(`Couldn't find transform constraint ${c} for skin ${l.name}.`);o.constraints.push(d)}if(l.path)for(let h=0;h<l.path.length;h++){const c=l.path[h],d=n.findPathConstraint(c);if(!d)throw new Error(`Couldn't find path constraint ${c} for skin ${l.name}.`);o.constraints.push(d)}for(const h in l.attachments){const c=n.findSlot(h);if(!c)throw new Error(`Couldn't find slot ${h} for skin ${l.name}.`);const d=l.attachments[h];for(const u in d){const f=this.readAttachment(d[u],o,c.index,u,n);f&&o.setAttachment(c.index,u,f)}}n.skins.push(o),o.name=="default"&&(n.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin?n.findSkin(o.skin):n.defaultSkin;if(!h)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(!c)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.timelineAttachment=o.inheritTimeline?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,i.events)for(const a in i.events){const l=i.events[a],o=new _f(a);o.intValue=W(l,"int",0),o.floatValue=W(l,"float",0),o.stringValue=W(l,"string",""),o.audioPath=W(l,"audio",null),o.audioPath&&(o.volume=W(l,"volume",1),o.balance=W(l,"balance",0)),n.events.push(o)}if(i.animations)for(const a in i.animations){const l=i.animations[a];this.readAnimation(l,a,n)}return n}readAttachment(t,e,n,i,r){const a=this.scale;switch(i=W(t,"name",i),W(t,"type","region")){case"region":{const l=W(t,"path",i),o=this.readSequence(W(t,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(e,i,l,o);if(!h)return null;h.path=l,h.x=W(t,"x",0)*a,h.y=W(t,"y",0)*a,h.scaleX=W(t,"scaleX",1),h.scaleY=W(t,"scaleY",1),h.rotation=W(t,"rotation",0),h.width=t.width*a,h.height=t.height*a,h.sequence=o;const c=W(t,"color",null);return c&&h.color.setFromString(c),h}case"boundingbox":{const l=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(!l)return null;this.readVertices(t,l,t.vertexCount<<1);const o=W(t,"color",null);return o&&l.color.setFromString(o),l}case"mesh":case"linkedmesh":{const l=W(t,"path",i),o=this.readSequence(W(t,"sequence",null)),h=this.attachmentLoader.newMeshAttachment(e,i,l,o);if(!h)return null;h.path=l;const c=W(t,"color",null);c&&h.color.setFromString(c),h.width=W(t,"width",0)*a,h.height=W(t,"height",0)*a,h.sequence=o;const d=W(t,"parent",null);if(d)return this.linkedMeshes.push(new UC(h,W(t,"skin",null),n,d,W(t,"timelines",!0))),h;const u=t.uvs;return this.readVertices(t,h,u.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(u),h.edges=W(t,"edges",null),h.hullLength=W(t,"hull",0)*2,h}case"path":{const l=this.attachmentLoader.newPathAttachment(e,i);if(!l)return null;l.closed=W(t,"closed",!1),l.constantSpeed=W(t,"constantSpeed",!0);const o=t.vertexCount;this.readVertices(t,l,o<<1);const h=$.newArray(o/3,0);for(let d=0;d<t.lengths.length;d++)h[d]=t.lengths[d]*a;l.lengths=h;const c=W(t,"color",null);return c&&l.color.setFromString(c),l}case"point":{const l=this.attachmentLoader.newPointAttachment(e,i);if(!l)return null;l.x=W(t,"x",0)*a,l.y=W(t,"y",0)*a,l.rotation=W(t,"rotation",0);const o=W(t,"color",null);return o&&l.color.setFromString(o),l}case"clipping":{const l=this.attachmentLoader.newClippingAttachment(e,i);if(!l)return null;const o=W(t,"end",null);if(o!=null){const d=r.findSlot(o);if(d==null)throw new Error(`Clipping end slot not found: ${o}`);l.endSlot=d}const h=t.vertexCount;this.readVertices(t,l,h<<1);const c=W(t,"color",null);return c&&l.color.setFromString(c),l}}return null}readSequence(t){if(t==null)return null;const e=new Ch(W(t,"count",0));return e.start=W(t,"start",1),e.digits=W(t,"digits",0),e.setupIndex=W(t,"setup",0),e}readVertices(t,e,n){const i=this.scale;e.worldVerticesLength=n;const r=t.vertices;if(n==r.length){const o=$.toFloatArray(r);if(i!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=i;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let d=o+c*4;o<d;o+=4)l.push(r[o]),a.push(r[o+1]*i),a.push(r[o+2]*i),a.push(r[o+3])}e.bones=l,e.vertices=$.toFloatArray(a)}readAnimation(t,e,n){const i=this.scale,r=new Array;if(t.slots)for(const l in t.slots){const o=t.slots[l],h=n.findSlot(l);if(!h)throw new Error(`Slot not found: ${l}`);const c=h.index;for(const d in o){const u=o[d];if(!u)continue;const f=u.length;if(d=="attachment"){const m=new fr(f,c);for(let p=0;p<f;p++){const g=u[p];m.setFrame(p,W(g,"time",0),W(g,"name",null))}r.push(m)}else if(d=="rgba"){const m=new lf(f,f<<2,c);let p=u[0],g=W(p,"time",0),v=at.fromString(p.color);for(let b=0,x=0;;b++){m.setFrame(b,g,v.r,v.g,v.b,v.a);const y=u[b+1];if(!y){m.shrink(x);break}const w=W(y,"time",0),_=at.fromString(y.color),E=p.curve;E&&(x=$t(E,m,x,b,0,g,w,v.r,_.r,1),x=$t(E,m,x,b,1,g,w,v.g,_.g,1),x=$t(E,m,x,b,2,g,w,v.b,_.b,1),x=$t(E,m,x,b,3,g,w,v.a,_.a,1)),g=w,v=_,p=y}r.push(m)}else if(d=="rgb"){const m=new hf(f,f*3,c);let p=u[0],g=W(p,"time",0),v=at.fromString(p.color);for(let b=0,x=0;;b++){m.setFrame(b,g,v.r,v.g,v.b);const y=u[b+1];if(!y){m.shrink(x);break}const w=W(y,"time",0),_=at.fromString(y.color),E=p.curve;E&&(x=$t(E,m,x,b,0,g,w,v.r,_.r,1),x=$t(E,m,x,b,1,g,w,v.g,_.g,1),x=$t(E,m,x,b,2,g,w,v.b,_.b,1)),g=w,v=_,p=y}r.push(m)}else if(d=="alpha")r.push(Ln(u,new cf(f,f,c),0,1));else if(d=="rgba2"){const m=new uf(f,f*7,c);let p=u[0],g=W(p,"time",0),v=at.fromString(p.light),b=at.fromString(p.dark);for(let x=0,y=0;;x++){m.setFrame(x,g,v.r,v.g,v.b,v.a,b.r,b.g,b.b);const w=u[x+1];if(!w){m.shrink(y);break}const _=W(w,"time",0),E=at.fromString(w.light),T=at.fromString(w.dark),C=p.curve;C&&(y=$t(C,m,y,x,0,g,_,v.r,E.r,1),y=$t(C,m,y,x,1,g,_,v.g,E.g,1),y=$t(C,m,y,x,2,g,_,v.b,E.b,1),y=$t(C,m,y,x,3,g,_,v.a,E.a,1),y=$t(C,m,y,x,4,g,_,b.r,T.r,1),y=$t(C,m,y,x,5,g,_,b.g,T.g,1),y=$t(C,m,y,x,6,g,_,b.b,T.b,1)),g=_,v=E,b=T,p=w}r.push(m)}else if(d=="rgb2"){const m=new df(f,f*6,c);let p=u[0],g=W(p,"time",0),v=at.fromString(p.light),b=at.fromString(p.dark);for(let x=0,y=0;;x++){m.setFrame(x,g,v.r,v.g,v.b,b.r,b.g,b.b);const w=u[x+1];if(!w){m.shrink(y);break}const _=W(w,"time",0),E=at.fromString(w.light),T=at.fromString(w.dark),C=p.curve;C&&(y=$t(C,m,y,x,0,g,_,v.r,E.r,1),y=$t(C,m,y,x,1,g,_,v.g,E.g,1),y=$t(C,m,y,x,2,g,_,v.b,E.b,1),y=$t(C,m,y,x,3,g,_,b.r,T.r,1),y=$t(C,m,y,x,4,g,_,b.g,T.g,1),y=$t(C,m,y,x,5,g,_,b.b,T.b,1)),g=_,v=E,b=T,p=w}r.push(m)}}}if(t.bones)for(const l in t.bones){const o=t.bones[l],h=n.findBone(l);if(!h)throw new Error(`Bone not found: ${l}`);const c=h.index;for(const d in o){const u=o[d],f=u.length;if(f!=0){if(d==="rotate")r.push(Ln(u,new ga(f,f,c),0,1));else if(d==="translate"){const m=new Jd(f,f<<1,c);r.push(Lc(u,m,"x","y",0,i))}else if(d==="translatex"){const m=new Qd(f,f,c);r.push(Ln(u,m,0,i))}else if(d==="translatey"){const m=new tf(f,f,c);r.push(Ln(u,m,0,i))}else if(d==="scale"){const m=new ef(f,f<<1,c);r.push(Lc(u,m,"x","y",1,1))}else if(d==="scalex"){const m=new sf(f,f,c);r.push(Ln(u,m,1,1))}else if(d==="scaley"){const m=new nf(f,f,c);r.push(Ln(u,m,1,1))}else if(d==="shear"){const m=new rf(f,f<<1,c);r.push(Lc(u,m,"x","y",0,1))}else if(d==="shearx"){const m=new of(f,f,c);r.push(Ln(u,m,0,1))}else if(d==="sheary"){const m=new af(f,f,c);r.push(Ln(u,m,0,1))}}}}if(t.ik)for(const l in t.ik){const o=t.ik[l];let h=o[0];if(!h)continue;const c=n.findIkConstraint(l);if(!c)throw new Error(`IK Constraint not found: ${l}`);const d=n.ikConstraints.indexOf(c),u=new mf(o.length,o.length<<1,d);let f=W(h,"time",0),m=W(h,"mix",1),p=W(h,"softness",0)*i;for(let g=0,v=0;;g++){u.setFrame(g,f,m,p,W(h,"bendPositive",!0)?1:-1,W(h,"compress",!1),W(h,"stretch",!1));const b=o[g+1];if(!b){u.shrink(v);break}const x=W(b,"time",0),y=W(b,"mix",1),w=W(b,"softness",0)*i,_=h.curve;_&&(v=$t(_,u,v,g,0,f,x,m,y,1),v=$t(_,u,v,g,1,f,x,p,w,i)),f=x,m=y,p=w,h=b}r.push(u)}if(t.transform)for(const l in t.transform){const o=t.transform[l];let h=o[0];if(!h)continue;const c=n.findTransformConstraint(l);if(!c)throw new Error(`Transform constraint not found: ${l}`);const d=n.transformConstraints.indexOf(c),u=new pf(o.length,o.length*6,d);let f=W(h,"time",0),m=W(h,"mixRotate",1),p=W(h,"mixX",1),g=W(h,"mixY",p),v=W(h,"mixScaleX",1),b=W(h,"mixScaleY",v);const x=W(h,"mixShearY",1);for(let y=0,w=0;;y++){u.setFrame(y,f,m,p,g,v,b,x);const _=o[y+1];if(!_){u.shrink(w);break}const E=W(_,"time",0),T=W(_,"mixRotate",1),C=W(_,"mixX",1),R=W(_,"mixY",C),P=W(_,"mixScaleX",1),O=W(_,"mixScaleY",P),F=W(_,"mixShearY",1),D=h.curve;D&&(w=$t(D,u,w,y,0,f,E,m,T,1),w=$t(D,u,w,y,1,f,E,p,C,1),w=$t(D,u,w,y,2,f,E,g,R,1),w=$t(D,u,w,y,3,f,E,v,P,1),w=$t(D,u,w,y,4,f,E,b,O,1),w=$t(D,u,w,y,5,f,E,x,F,1)),f=E,m=T,p=C,g=R,v=P,b=O,v=P,h=_}r.push(u)}if(t.path)for(const l in t.path){const o=t.path[l],h=n.findPathConstraint(l);if(!h)throw new Error(`Path constraint not found: ${l}`);const c=n.pathConstraints.indexOf(h);for(const d in o){const u=o[d];let f=u[0];if(!f)continue;const m=u.length;if(d==="position"){const p=new gf(m,m,c);r.push(Ln(u,p,0,h.positionMode==fe.Fixed?i:1))}else if(d==="spacing"){const p=new xf(m,m,c);r.push(Ln(u,p,0,h.spacingMode==Be.Length||h.spacingMode==Be.Fixed?i:1))}else if(d==="mix"){const p=new yf(m,m*3,c);let g=W(f,"time",0),v=W(f,"mixRotate",1),b=W(f,"mixX",1),x=W(f,"mixY",b);for(let y=0,w=0;;y++){p.setFrame(y,g,v,b,x);const _=u[y+1];if(!_){p.shrink(w);break}const E=W(_,"time",0),T=W(_,"mixRotate",1),C=W(_,"mixX",1),R=W(_,"mixY",C),P=f.curve;P&&(w=$t(P,p,w,y,0,g,E,v,T,1),w=$t(P,p,w,y,1,g,E,b,C,1),w=$t(P,p,w,y,2,g,E,x,R,1)),g=E,v=T,b=C,x=R,f=_}r.push(p)}}}if(t.deform){t.attachments={};for(const l in t.deform){const o=t.deform[l],h=t.attachments[l]={};for(const c in o){const d=o[c],u=h[c]={};for(const f in d)u[f]={deform:d[f]}}}}if(t.attachments)for(const l in t.attachments){const o=t.attachments[l],h=n.findSkin(l);if(h!=null)for(const c in o){const d=o[c],u=n.findSlot(c);if(!u)throw new Error(`Slot not found: ${c}`);const f=u.index;for(const m in d){const p=d[m],g=h.getAttachment(f,m);for(const v in p){const b=p[v];let x=b[0];if(x){if(v=="deform"){const y=g.bones,w=g.vertices,_=y?w.length/3*2:w.length,E=new ff(b.length,b.length,f,g);let T=W(x,"time",0);for(let C=0,R=0;;C++){let P;const O=W(x,"vertices",null);if(!O)P=y?$.newFloatArray(_):w;else{P=$.newFloatArray(_);const X=W(x,"offset",0);if($.arrayCopy(O,0,P,X,O.length),i!=1)for(let U=X,j=U+O.length;U<j;U++)P[U]*=i;if(!y)for(let U=0;U<_;U++)P[U]+=w[U]}E.setFrame(C,T,P);const F=b[C+1];if(!F){E.shrink(R);break}const D=W(F,"time",0),V=x.curve;V&&(R=$t(V,E,R,C,0,T,D,0,1,1)),T=D,x=F}r.push(E)}else if(v=="sequence"){const y=new To(b.length,f,g);let w=0;for(let _=0;_<b.length;_++){const E=W(x,"delay",w),T=W(x,"time",0),C=Wn[W(x,"mode","hold")],R=W(x,"index",0);y.setFrame(_,T,C,R,E),w=E,x=b[_+1]}r.push(y)}}}}}}if(t.drawOrder){const l=new xr(t.drawOrder.length),o=n.slots.length;let h=0;for(let c=0;c<t.drawOrder.length;c++,h++){const d=t.drawOrder[c];let u=null;const f=W(d,"offsets",null);if(f){u=$.newArray(o,-1);const m=$.newArray(o-f.length,0);let p=0,g=0;for(let v=0;v<f.length;v++){const b=f[v],x=n.findSlot(b.slot);if(!x)throw new Error(`Slot not found: ${x}`);const y=x.index;for(;p!=y;)m[g++]=p++;u[p+b.offset]=p++}for(;p<o;)m[g++]=p++;for(let v=o-1;v>=0;v--)u[v]==-1&&(u[v]=m[--g])}l.setFrame(h,W(d,"time",0),u)}r.push(l)}if(t.events){const l=new Ia(t.events.length);let o=0;for(let h=0;h<t.events.length;h++,o++){const c=t.events[h],d=n.findEvent(c.name);if(!d)throw new Error(`Event not found: ${c.name}`);const u=new wf($.toSinglePrecision(W(c,"time",0)),d);u.intValue=W(c,"int",d.intValue),u.floatValue=W(c,"float",d.floatValue),u.stringValue=W(c,"string",d.stringValue),u.data.audioPath&&(u.volume=W(c,"volume",1),u.balance=W(c,"balance",0)),l.setFrame(o,u)}r.push(l)}let a=0;for(let l=0,o=r.length;l<o;l++)a=Math.max(a,r[l].getDuration());if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new Mh(e,r,a))}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return ft.NORMAL;if(t=="additive")return ft.ADD;if(t=="multiply")return ft.MULTIPLY;if(t=="screen")return ft.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class UC{constructor(t,e,n,i,r){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritTimeline=r}}function Ln(s,t,e,n){let i=s[0],r=W(i,"time",0),a=W(i,"value",e)*n,l=0;for(let o=0;;o++){t.setFrame(o,r,a);const h=s[o+1];if(!h)return t.shrink(l),t;const c=W(h,"time",0),d=W(h,"value",e)*n;i.curve&&(l=$t(i.curve,t,l,o,0,r,c,a,d,n)),r=c,a=d,i=h}}function Lc(s,t,e,n,i,r){let a=s[0],l=W(a,"time",0),o=W(a,e,i)*r,h=W(a,n,i)*r,c=0;for(let d=0;;d++){t.setFrame(d,l,o,h);const u=s[d+1];if(!u)return t.shrink(c),t;const f=W(u,"time",0),m=W(u,e,i)*r,p=W(u,n,i)*r,g=a.curve;g&&(c=$t(g,t,c,d,0,l,f,o,m,r),c=$t(g,t,c,d,1,l,f,h,p,r)),l=f,o=m,h=p,a=u}}function $t(s,t,e,n,i,r,a,l,o,h){if(s=="stepped")return t.setStepped(n),e;const c=i<<2,d=s[c],u=s[c+1]*h,f=s[c+2],m=s[c+3]*h;return t.setBezier(e,n,i,r,l,d,u,f,m,a,o),e+1}function W(s,t,e){return s[t]!==void 0?s[t]:e}let XC=class extends _o{createSkeleton(t){this.skeleton=new Tf(t),this.skeleton.updateWorldTransform(),this.stateData=new fy(t),this.state=new Ao(this.stateData)}};const YC=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline:cf,Animation:Mh,AnimationState:Ao,AnimationStateAdapter:mC,AnimationStateData:fy,AtlasAttachmentLoader:bf,Attachment:Kd,AttachmentTimeline:fr,Bone:zu,BoneData:vf,BoundingBoxAttachment:Sh,ClippingAttachment:Th,ConstraintData:Ph,CurveTimeline:Dn,CurveTimeline1:Bn,CurveTimeline2:Ih,DeformTimeline:ff,DrawOrderTimeline:xr,Event:wf,EventData:_f,EventQueue:dy,EventTimeline:Ia,EventType:Ss,IkConstraint:my,IkConstraintData:Ef,IkConstraintTimeline:mf,MeshAttachment:Sr,PathAttachment:Tr,PathConstraint:Co,PathConstraintData:Sf,PathConstraintMixTimeline:yf,PathConstraintPositionTimeline:gf,PathConstraintSpacingTimeline:xf,PointAttachment:Ah,RGB2Timeline:df,RGBA2Timeline:uf,RGBATimeline:lf,RGBTimeline:hf,RegionAttachment:Gt,RotateTimeline:ga,ScaleTimeline:ef,ScaleXTimeline:sf,ScaleYTimeline:nf,Sequence:Ch,SequenceMode:Wn,SequenceModeValues:Zd,SequenceTimeline:To,ShearTimeline:rf,ShearXTimeline:of,ShearYTimeline:af,Skeleton:Tf,SkeletonBinary:If,SkeletonBounds:VC,SkeletonData:Af,SkeletonJson:kh,Skin:Ul,SkinEntry:ju,Slot:py,SlotData:Cf,SpacingMode:Be,Spine:XC,Timeline:we,TrackEntry:Rh,TransformConstraint:gy,TransformConstraintData:Mf,TransformConstraintTimeline:pf,TranslateTimeline:Jd,TranslateXTimeline:Qd,TranslateYTimeline:tf,VertexAttachment:kn},Symbol.toStringTag,{value:"Module"}));var js=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.VER37=37]="VER37",s[s.VER38=38]="VER38",s[s.VER40=40]="VER40",s[s.VER41=41]="VER41",s))(js||{});function Xl(s){const t=s.substr(0,3),e=Math.floor(Number(t)*10+.001);return t==="3.7"?37:t==="3.8"?38:t==="4.0"?40:t==="4.1"?41:e<37?37:0}class $C{constructor(){this.scale=1}readSkeletonData(t,e){let n=null,i=this.readVersionOldFormat(e),r=Xl(i);if(r===js.VER38&&(n=new Me(new Dd(t))),i=this.readVersionNewFormat(e),r=Xl(i),(r===js.VER40||r===js.VER41)&&(n=new If(new bf(t))),!n){const a=`Unsupported version of spine model ${i}, please update pixi-spine`;console.error(a)}return n.scale=this.scale,n.readSkeletonData(e)}readVersionOldFormat(t){const e=new Ol(t);let n;try{e.readString(),n=e.readString()}catch{n=""}return n||""}readVersionNewFormat(t){const e=new Ol(t);e.readInt32(),e.readInt32();let n;try{n=e.readString()}catch{n=""}return n||""}}class GC{constructor(){this.scale=1}readSkeletonData(t,e){const n=e.skeleton.spine,i=Xl(n);let r=null;if(i===js.VER37&&(r=new ay(new qx(t))),i===js.VER38&&(r=new Ox(new Dd(t))),(i===js.VER40||i===js.VER41)&&(r=new kh(new bf(t))),!r){const a=`Unsupported version of spine model ${n}, please update pixi-spine`;console.error(a)}return r.scale=this.scale,r.readSkeletonData(e)}}class WC extends QA{createBinaryParser(){return new $C}createJsonParser(){return new GC}parseData(t,e,n){return{spineData:t.readSkeletonData(e,n),spineAtlas:e}}}class HC extends _o{createSkeleton(t){const e=Xl(t.version);let n=null;if(e===js.VER37&&(n=fC),e===js.VER38&&(n=aC),(e===js.VER40||e===js.VER41)&&(n=YC),!n){const i=`Cant detect version of spine model ${t.version}`;console.error(i)}this.skeleton=new n.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new n.AnimationStateData(t),this.state=new n.AnimationState(this.stateData)}}new WC().installLoader();class zC extends HC{constructor(e){super(e);Y(this,"timeScale",1);Y(this,"animationsNames",[]);Y(this,"currentAnimationName");Y(this,"isLoopMode");Y(this,"entry");e.animations.forEach(n=>{let{name:i}=n;this.animationsNames.push(i)}),this.reset()}setDefaultAnimationsMix(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250;return this.state.data.defaultMix=e/1e3,this}mixAnimations(e){let{animationName1:n,animationName2:i,duration:r=250}=e;return!this.animationsNames.includes(n)||!this.animationsNames.includes(i)?this:(this.stateData.setMix(n,i,r/1e3),this)}async playAnimation(e){let{name:n,isLoopMode:i=!1}=e;const{state:r}=this;if(this.animationsNames.includes(n)&&!(this.currentAnimationName===n&&this.isLoopMode))return this.currentAnimationName=n,this.isLoopMode=i,this.entry=r.setAnimation(0,n,i),r.clearListeners(),new Promise(a=>{r.addListener({complete:a})})}setTimeScale(e){let{timeScale:n=this.timeScale,isReversed:i=!1,ignoreInversion:r=!1}=e;this.timeScale=n;let a=n,l=this.state.timeScale<0?-1:1;r||(l=i?-1:1),a*=l,this.state.timeScale=a}isPlaying(){const{entry:e}=this;return e.trackTime<e.animationEnd}wind(e){const{entry:n}=this;if(!n)return this;const i=n.animationEnd*e;n.trackTime=i,this.previousFrameProgress=e,this.update(i)}reset(){this.playAnimation({name:this.animationsNames[0]}),this.wind(1),this.currentAnimationName=""}setTint(e){this.tint=e,this.autoUpdate||this.update()}}class jC extends Mt{constructor(e,n){super();Y(this,"spineView");Y(this,"payoutView");Y(this,"coinRainView");Y(this,"bigWinCurrencyView");Y(this,"reelsView");Y(this,"timeline",(()=>new We)());this.initSpine(e),this.initTexts(e,n)}initSpine(e){const n=new zC(e.big_win.spineData);this.spineView=this.addChild(n)}initTexts(e,n){const i=new Mt;i.scale.y=-1;const r=300,a=40,l=i.addChild(new xi({})).setMaximalWidth(r).setMaximalHeight(a).setFontName("default").setFontSize(100).setFontColor(13822365).setText(n.total_win_bmp).setAlignCenter().setAlignMiddle();l.pivot.set(r/2,a/2),l.y=-60;const o=300,h=80,c="0123456789",d=i.addChild(new xi({})).setMaximalWidth(o).setMaximalHeight(h).setFontName(c+".,",[...[...c.split(""),"period","period"].map(g=>e["payout_"+g])]).setFontSize(100).setText("1234567890.,").setAlignCenter().setAlignMiddle().setHiddenCharacters([","]);d.pivot.set(o/2,h/2);const u=this.spineView.skeleton.findSlotIndex("text");this.spineView.slotContainers[u].addChild(i),this.payoutView=d;const f=300,m=40,p=i.addChild(new xi({})).setMaximalWidth(f).setMaximalHeight(m).setFontColor(14857309).setFontName("default").setFontSize(100).setText("RUB").setAlignCenter().setAlignMiddle();p.pivot.set(f/2,m/2),p.y=60,this.bigWinCurrencyView=p}async present(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:123,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{spineView:i}=this;return this.payoutView.setText(Gs(e)),this.bigWinCurrencyView.setText(n),i.playAnimation({name:"win_total"}),this.timeline.deleteAllAnimations().addAnimation({duration:2500,onProgress:r=>{var a;(a=this.reelsView)==null||a.setBrightness({brightness:1-Math.min(1,Math.sin(Math.PI*r)*2)})}}).play()}setTimeScale(e){const n={name:"scale",value:e};this.timeline.setTimeScaleFactor(n),this.spineView.setTimeScale({timeScale:e})}}let qC=class extends Mt{constructor(t){super(),this.addChild(new ve(t.static_logo)).anchor.set(.5),[{x:-235,scale:-1,rotation:.7},{x:235,scale:1,rotation:-.7}].map(n=>{let{scale:i,x:r,rotation:a}=n;const l=new ve(t.chain);return l.anchor.set(.1,.5),l.rotation=a,l.x=r,l.y=-80,l.scale.set(i*.5,.5),this.addChild(l)})}};class KC extends XA{constructor(e){let{initialSymbolsIds:n,assets:i,dictionary:r,coefficients:a,isMobileDevice:l}=e;super({initialSymbolsIds:n,assets:i});Y(this,"interactiveView");Y(this,"payoutsInfoPanelView");Y(this,"isMobileDevice");Y(this,"featureTimeline",(()=>new We)());this.setSourceArea({width:qr,height:Qo}),this.isMobileDevice=l,this.initLogo(i),this.initBackground(i),this.initBigWin(i,r),this.initPayoutsInfoPanel(i,a),this.setupInteractivity()}initLogo(e){this.logoView=this.addChildAt(new qC(e),0),this.logoView.scale.set(.7),this.logoView.position.set(qr/2,-95)}initBackground(e){this.addChildAt(new ve(e.reels_mobile_background),1).position.set(-40,-32)}initPayoutsInfoPanel(e,n){this.payoutsInfoPanelView=this.reelsContainer.addChild(new $A({assets:e,reelsView:this,coefficients:n}))}initBigWin(e,n){const i=new jC(e,n);i.position.set(qr/2,Qo/2),this.bigWinView=this.addChild(i),i.reelsView=this}setupInteractivity(){const{payoutsInfoPanelView:e}=this,n=this.reelsContainer.addChild(new Fn).beginFill(16777215,1e-4).drawRect(0,0,qr,Qo).endFill();n.cursor="pointer",n.eventMode="static",n.on("pointerdown",i=>{let{global:r}=i;if(e.capturedSymbolView)return e.hide();const{x:a,y:l}=n.toLocal(r),o=Math.trunc(a/Er),h=Math.trunc(l/be+1);if(h<=0||h>De)return;const c=this.reelsViews[o].cellsViews[h];e.presentPayouts({capturedSymbolView:c.getSymbolView(),x:o,y:h-1,symbolId:c.currentSymbolId})}),this.interactiveView=n,this.setInteractive(!1)}updateTargetArea(e){const{isMobileDevice:n}=this;if(this.payoutsInfoPanelView.hide(),e>1.25&&!n)this.setTargetArea({x:0,y:.15,width:1,height:.7});else if(e>1.25&&n){const i=n?.2:.125;this.setTargetArea({x:i,y:.05,width:1-i*2,height:.7})}else e>.6?this.setTargetArea({x:.08,y:.2,width:.84,height:.5}):this.setTargetArea({x:.08,y:.2,width:.84,height:.6})}setBrightness(e){let{key:n,map:i,brightness:r}=e;super.setBrightness({key:n,map:i,brightness:r})}presentCellsWin(e){let{key:n,map:i,progress:r}=e;for(let a=0;a<i.length;a++)for(let l=0;l<i[0].length;l++)i[a][l]===n&&this.cellsViews[a][l+1].getSymbolView().presentWin(r)}setMasked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;super.setMasked(e)}setInteractive(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.setMasked(!e),this.interactiveView.visible=e}presentRandomSymbols(){io().forEach((e,n)=>e.forEach((i,r)=>this.cellsViews[n][r].presentSymbol(i)))}reset(){super.reset(),this.setInteractive(!1)}setTimeScale(e){super.setTimeScale(e),this.bigWinView.setTimeScale(e)}refreshPayoutsInfo(e){this.payoutsInfoPanelView.setBet(e)}presentBigWin(e,n){return this.bigWinView.present(e,n)}async presentSpinStart(){return await this.payoutsInfoPanelView.hide(),super.presentSpinStart()}async presentSpinStop(e){const n=e.map(i=>i.map(r=>r));await super.presentSpinStop({targetSymbolsIds:n}),this.setMasked(!1)}hidePayoutsInfo(){return this.payoutsInfoPanelView.hide()}reset(){this.setBrightness({brightness:1})}}/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Rf(s){const t=Object.create(null);for(const e of s.split(","))t[e]=1;return e=>e in t}const ee={},oo=[],qs=()=>{},ZC=()=>!1,Fh=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),Pf=s=>s.startsWith("onUpdate:"),ts=Object.assign,kf=(s,t)=>{const e=s.indexOf(t);e>-1&&s.splice(e,1)},JC=Object.prototype.hasOwnProperty,qt=(s,t)=>JC.call(s,t),It=Array.isArray,ao=s=>Dh(s)==="[object Map]",xy=s=>Dh(s)==="[object Set]",kt=s=>typeof s=="function",Pe=s=>typeof s=="string",_i=s=>typeof s=="symbol",ge=s=>s!==null&&typeof s=="object",yy=s=>(ge(s)||kt(s))&&kt(s.then)&&kt(s.catch),by=Object.prototype.toString,Dh=s=>by.call(s),QC=s=>Dh(s).slice(8,-1),vy=s=>Dh(s)==="[object Object]",Ff=s=>Pe(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,ta=Rf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Bh=s=>{const t=Object.create(null);return e=>t[e]||(t[e]=s(e))},tM=/-(\w)/g,en=Bh(s=>s.replace(tM,(t,e)=>e?e.toUpperCase():"")),eM=/\B([A-Z])/g,Rr=Bh(s=>s.replace(eM,"-$1").toLowerCase()),Oh=Bh(s=>s.charAt(0).toUpperCase()+s.slice(1)),Vc=Bh(s=>s?`on${Oh(s)}`:""),Vi=(s,t)=>!Object.is(s,t),Uc=(s,...t)=>{for(let e=0;e<s.length;e++)s[e](...t)},wy=(s,t,e,n=!1)=>{Object.defineProperty(s,t,{configurable:!0,enumerable:!1,writable:n,value:e})},sM=s=>{const t=parseFloat(s);return isNaN(t)?s:t};let Zp;const Nh=()=>Zp||(Zp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Df(s){if(It(s)){const t={};for(let e=0;e<s.length;e++){const n=s[e],i=Pe(n)?oM(n):Df(n);if(i)for(const r in i)t[r]=i[r]}return t}else if(Pe(s)||ge(s))return s}const nM=/;(?![^(]*\))/g,iM=/:([^]+)/,rM=/\/\*[^]*?\*\//g;function oM(s){const t={};return s.replace(rM,"").split(nM).forEach(e=>{if(e){const n=e.split(iM);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function re(s){let t="";if(Pe(s))t=s;else if(It(s))for(let e=0;e<s.length;e++){const n=re(s[e]);n&&(t+=n+" ")}else if(ge(s))for(const e in s)s[e]&&(t+=e+" ");return t.trim()}const aM="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",lM=Rf(aM);function _y(s){return!!s||s===""}const Ey=s=>!!(s&&s.__v_isRef===!0),Ks=s=>Pe(s)?s:s==null?"":It(s)||ge(s)&&(s.toString===by||!kt(s.toString))?Ey(s)?Ks(s.value):JSON.stringify(s,Sy,2):String(s),Sy=(s,t)=>Ey(t)?Sy(s,t.value):ao(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[n,i],r)=>(e[Xc(n,r)+" =>"]=i,e),{})}:xy(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Xc(e))}:_i(t)?Xc(t):ge(t)&&!It(t)&&!vy(t)?String(t):t,Xc=(s,t="")=>{var e;return _i(s)?`Symbol(${(e=s.description)!=null?e:t})`:s};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Bs;class hM{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Bs,!t&&Bs&&(this.index=(Bs.scopes||(Bs.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Bs;try{return Bs=this,t()}finally{Bs=e}}}on(){Bs=this}off(){Bs=this.parent}stop(t){if(this._active){this._active=!1;let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(this.effects.length=0,e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function cM(){return Bs}let ne;const Yc=new WeakSet;class Ty{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Bs&&Bs.active&&Bs.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Yc.has(this)&&(Yc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Cy(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jp(this),My(this);const t=ne,e=Mn;ne=this,Mn=!0;try{return this.fn()}finally{Iy(this),ne=t,Mn=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Nf(t);this.deps=this.depsTail=void 0,Jp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Yc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){qu(this)&&this.run()}get dirty(){return qu(this)}}let Ay=0,ea,sa;function Cy(s,t=!1){if(s.flags|=8,t){s.next=sa,sa=s;return}s.next=ea,ea=s}function Bf(){Ay++}function Of(){if(--Ay>0)return;if(sa){let t=sa;for(sa=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let s;for(;ea;){let t=ea;for(ea=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){s||(s=n)}t=e}}if(s)throw s}function My(s){for(let t=s.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Iy(s){let t,e=s.depsTail,n=e;for(;n;){const i=n.prevDep;n.version===-1?(n===e&&(e=i),Nf(n),uM(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}s.deps=t,s.depsTail=e}function qu(s){for(let t=s.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ry(t.dep.computed)||t.dep.version!==t.version))return!0;return!!s._dirty}function Ry(s){if(s.flags&4&&!(s.flags&16)||(s.flags&=-17,s.globalVersion===xa))return;s.globalVersion=xa;const t=s.dep;if(s.flags|=2,t.version>0&&!s.isSSR&&s.deps&&!qu(s)){s.flags&=-3;return}const e=ne,n=Mn;ne=s,Mn=!0;try{My(s);const i=s.fn(s._value);(t.version===0||Vi(i,s._value))&&(s._value=i,t.version++)}catch(i){throw t.version++,i}finally{ne=e,Mn=n,Iy(s),s.flags&=-3}}function Nf(s,t=!1){const{dep:e,prevSub:n,nextSub:i}=s;if(n&&(n.nextSub=i,s.prevSub=void 0),i&&(i.prevSub=n,s.nextSub=void 0),e.subs===s&&(e.subs=n,!n&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Nf(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function uM(s){const{prevDep:t,nextDep:e}=s;t&&(t.nextDep=e,s.prevDep=void 0),e&&(e.prevDep=t,s.nextDep=void 0)}let Mn=!0;const Py=[];function ji(){Py.push(Mn),Mn=!1}function qi(){const s=Py.pop();Mn=s===void 0?!0:s}function Jp(s){const{cleanup:t}=s;if(s.cleanup=void 0,t){const e=ne;ne=void 0;try{t()}finally{ne=e}}}let xa=0;class dM{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Lf{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!ne||!Mn||ne===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==ne)e=this.activeLink=new dM(ne,this),ne.deps?(e.prevDep=ne.depsTail,ne.depsTail.nextDep=e,ne.depsTail=e):ne.deps=ne.depsTail=e,ky(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const n=e.nextDep;n.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=n),e.prevDep=ne.depsTail,e.nextDep=void 0,ne.depsTail.nextDep=e,ne.depsTail=e,ne.deps===e&&(ne.deps=n)}return e}trigger(t){this.version++,xa++,this.notify(t)}notify(t){Bf();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Of()}}}function ky(s){if(s.dep.sc++,s.sub.flags&4){const t=s.dep.computed;if(t&&!s.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)ky(n)}const e=s.dep.subs;e!==s&&(s.prevSub=e,e&&(e.nextSub=s)),s.dep.subs=s}}const Ku=new WeakMap,yr=Symbol(""),Zu=Symbol(""),ya=Symbol("");function is(s,t,e){if(Mn&&ne){let n=Ku.get(s);n||Ku.set(s,n=new Map);let i=n.get(e);i||(n.set(e,i=new Lf),i.map=n,i.key=e),i.track()}}function di(s,t,e,n,i,r){const a=Ku.get(s);if(!a){xa++;return}const l=o=>{o&&o.trigger()};if(Bf(),t==="clear")a.forEach(l);else{const o=It(s),h=o&&Ff(e);if(o&&e==="length"){const c=Number(n);a.forEach((d,u)=>{(u==="length"||u===ya||!_i(u)&&u>=c)&&l(d)})}else switch((e!==void 0||a.has(void 0))&&l(a.get(e)),h&&l(a.get(ya)),t){case"add":o?h&&l(a.get("length")):(l(a.get(yr)),ao(s)&&l(a.get(Zu)));break;case"delete":o||(l(a.get(yr)),ao(s)&&l(a.get(Zu)));break;case"set":ao(s)&&l(a.get(yr));break}}Of()}function Or(s){const t=jt(s);return t===s?t:(is(t,"iterate",ya),Zs(s)?t:t.map(rs))}function Lh(s){return is(s=jt(s),"iterate",ya),s}const fM={__proto__:null,[Symbol.iterator](){return $c(this,Symbol.iterator,rs)},concat(...s){return Or(this).concat(...s.map(t=>It(t)?Or(t):t))},entries(){return $c(this,"entries",s=>(s[1]=rs(s[1]),s))},every(s,t){return ni(this,"every",s,t,void 0,arguments)},filter(s,t){return ni(this,"filter",s,t,e=>e.map(rs),arguments)},find(s,t){return ni(this,"find",s,t,rs,arguments)},findIndex(s,t){return ni(this,"findIndex",s,t,void 0,arguments)},findLast(s,t){return ni(this,"findLast",s,t,rs,arguments)},findLastIndex(s,t){return ni(this,"findLastIndex",s,t,void 0,arguments)},forEach(s,t){return ni(this,"forEach",s,t,void 0,arguments)},includes(...s){return Gc(this,"includes",s)},indexOf(...s){return Gc(this,"indexOf",s)},join(s){return Or(this).join(s)},lastIndexOf(...s){return Gc(this,"lastIndexOf",s)},map(s,t){return ni(this,"map",s,t,void 0,arguments)},pop(){return Oo(this,"pop")},push(...s){return Oo(this,"push",s)},reduce(s,...t){return Qp(this,"reduce",s,t)},reduceRight(s,...t){return Qp(this,"reduceRight",s,t)},shift(){return Oo(this,"shift")},some(s,t){return ni(this,"some",s,t,void 0,arguments)},splice(...s){return Oo(this,"splice",s)},toReversed(){return Or(this).toReversed()},toSorted(s){return Or(this).toSorted(s)},toSpliced(...s){return Or(this).toSpliced(...s)},unshift(...s){return Oo(this,"unshift",s)},values(){return $c(this,"values",rs)}};function $c(s,t,e){const n=Lh(s),i=n[t]();return n!==s&&!Zs(s)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=e(r.value)),r}),i}const mM=Array.prototype;function ni(s,t,e,n,i,r){const a=Lh(s),l=a!==s&&!Zs(s),o=a[t];if(o!==mM[t]){const d=o.apply(s,r);return l?rs(d):d}let h=e;a!==s&&(l?h=function(d,u){return e.call(this,rs(d),u,s)}:e.length>2&&(h=function(d,u){return e.call(this,d,u,s)}));const c=o.call(a,h,n);return l&&i?i(c):c}function Qp(s,t,e,n){const i=Lh(s);let r=e;return i!==s&&(Zs(s)?e.length>3&&(r=function(a,l,o){return e.call(this,a,l,o,s)}):r=function(a,l,o){return e.call(this,a,rs(l),o,s)}),i[t](r,...n)}function Gc(s,t,e){const n=jt(s);is(n,"iterate",ya);const i=n[t](...e);return(i===-1||i===!1)&&Yf(e[0])?(e[0]=jt(e[0]),n[t](...e)):i}function Oo(s,t,e=[]){ji(),Bf();const n=jt(s)[t].apply(s,e);return Of(),qi(),n}const pM=Rf("__proto__,__v_isRef,__isVue"),Fy=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(_i));function gM(s){_i(s)||(s=String(s));const t=jt(this);return is(t,"has",s),t.hasOwnProperty(s)}class Dy{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,n){if(e==="__v_skip")return t.__v_skip;const i=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return r;if(e==="__v_raw")return n===(i?r?AM:Ly:r?Ny:Oy).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=It(t);if(!i){let o;if(a&&(o=fM[e]))return o;if(e==="hasOwnProperty")return gM}const l=Reflect.get(t,e,as(t)?t:n);return(_i(e)?Fy.has(e):pM(e))||(i||is(t,"get",e),r)?l:as(l)?a&&Ff(e)?l:l.value:ge(l)?i?Vy(l):Uf(l):l}}class By extends Dy{constructor(t=!1){super(!1,t)}set(t,e,n,i){let r=t[e];if(!this._isShallow){const o=Ar(r);if(!Zs(n)&&!Ar(n)&&(r=jt(r),n=jt(n)),!It(t)&&as(r)&&!as(n))return o?!1:(r.value=n,!0)}const a=It(t)&&Ff(e)?Number(e)<t.length:qt(t,e),l=Reflect.set(t,e,n,as(t)?t:i);return t===jt(i)&&(a?Vi(n,r)&&di(t,"set",e,n):di(t,"add",e,n)),l}deleteProperty(t,e){const n=qt(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&n&&di(t,"delete",e,void 0),i}has(t,e){const n=Reflect.has(t,e);return(!_i(e)||!Fy.has(e))&&is(t,"has",e),n}ownKeys(t){return is(t,"iterate",It(t)?"length":yr),Reflect.ownKeys(t)}}class xM extends Dy{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const yM=new By,bM=new xM,vM=new By(!0);const Ju=s=>s,sl=s=>Reflect.getPrototypeOf(s);function wM(s,t,e){return function(...n){const i=this.__v_raw,r=jt(i),a=ao(r),l=s==="entries"||s===Symbol.iterator&&a,o=s==="keys"&&a,h=i[s](...n),c=e?Ju:t?Qu:rs;return!t&&is(r,"iterate",o?Zu:yr),{next(){const{value:d,done:u}=h.next();return u?{value:d,done:u}:{value:l?[c(d[0]),c(d[1])]:c(d),done:u}},[Symbol.iterator](){return this}}}}function nl(s){return function(...t){return s==="delete"?!1:s==="clear"?void 0:this}}function _M(s,t){const e={get(i){const r=this.__v_raw,a=jt(r),l=jt(i);s||(Vi(i,l)&&is(a,"get",i),is(a,"get",l));const{has:o}=sl(a),h=t?Ju:s?Qu:rs;if(o.call(a,i))return h(r.get(i));if(o.call(a,l))return h(r.get(l));r!==a&&r.get(i)},get size(){const i=this.__v_raw;return!s&&is(jt(i),"iterate",yr),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,a=jt(r),l=jt(i);return s||(Vi(i,l)&&is(a,"has",i),is(a,"has",l)),i===l?r.has(i):r.has(i)||r.has(l)},forEach(i,r){const a=this,l=a.__v_raw,o=jt(l),h=t?Ju:s?Qu:rs;return!s&&is(o,"iterate",yr),l.forEach((c,d)=>i.call(r,h(c),h(d),a))}};return ts(e,s?{add:nl("add"),set:nl("set"),delete:nl("delete"),clear:nl("clear")}:{add(i){!t&&!Zs(i)&&!Ar(i)&&(i=jt(i));const r=jt(this);return sl(r).has.call(r,i)||(r.add(i),di(r,"add",i,i)),this},set(i,r){!t&&!Zs(r)&&!Ar(r)&&(r=jt(r));const a=jt(this),{has:l,get:o}=sl(a);let h=l.call(a,i);h||(i=jt(i),h=l.call(a,i));const c=o.call(a,i);return a.set(i,r),h?Vi(r,c)&&di(a,"set",i,r):di(a,"add",i,r),this},delete(i){const r=jt(this),{has:a,get:l}=sl(r);let o=a.call(r,i);o||(i=jt(i),o=a.call(r,i)),l&&l.call(r,i);const h=r.delete(i);return o&&di(r,"delete",i,void 0),h},clear(){const i=jt(this),r=i.size!==0,a=i.clear();return r&&di(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=wM(i,s,t)}),e}function Vf(s,t){const e=_M(s,t);return(n,i,r)=>i==="__v_isReactive"?!s:i==="__v_isReadonly"?s:i==="__v_raw"?n:Reflect.get(qt(e,i)&&i in n?e:n,i,r)}const EM={get:Vf(!1,!1)},SM={get:Vf(!1,!0)},TM={get:Vf(!0,!1)};const Oy=new WeakMap,Ny=new WeakMap,Ly=new WeakMap,AM=new WeakMap;function CM(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function MM(s){return s.__v_skip||!Object.isExtensible(s)?0:CM(QC(s))}function Uf(s){return Ar(s)?s:Xf(s,!1,yM,EM,Oy)}function IM(s){return Xf(s,!1,vM,SM,Ny)}function Vy(s){return Xf(s,!0,bM,TM,Ly)}function Xf(s,t,e,n,i){if(!ge(s)||s.__v_raw&&!(t&&s.__v_isReactive))return s;const r=i.get(s);if(r)return r;const a=MM(s);if(a===0)return s;const l=new Proxy(s,a===2?n:e);return i.set(s,l),l}function lo(s){return Ar(s)?lo(s.__v_raw):!!(s&&s.__v_isReactive)}function Ar(s){return!!(s&&s.__v_isReadonly)}function Zs(s){return!!(s&&s.__v_isShallow)}function Yf(s){return s?!!s.__v_raw:!1}function jt(s){const t=s&&s.__v_raw;return t?jt(t):s}function RM(s){return!qt(s,"__v_skip")&&Object.isExtensible(s)&&wy(s,"__v_skip",!0),s}const rs=s=>ge(s)?Uf(s):s,Qu=s=>ge(s)?Vy(s):s;function as(s){return s?s.__v_isRef===!0:!1}function te(s){return PM(s,!1)}function PM(s,t){return as(s)?s:new kM(s,t)}class kM{constructor(t,e){this.dep=new Lf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:jt(t),this._value=e?t:rs(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,n=this.__v_isShallow||Zs(t)||Ar(t);t=n?t:jt(t),Vi(t,e)&&(this._rawValue=t,this._value=n?t:rs(t),this.dep.trigger())}}function FM(s){return as(s)?s.value:s}const DM={get:(s,t,e)=>t==="__v_raw"?s:FM(Reflect.get(s,t,e)),set:(s,t,e,n)=>{const i=s[t];return as(i)&&!as(e)?(i.value=e,!0):Reflect.set(s,t,e,n)}};function Uy(s){return lo(s)?s:new Proxy(s,DM)}class BM{constructor(t,e,n){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Lf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ne!==this)return Cy(this,!0),!0}get value(){const t=this.dep.track();return Ry(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function OM(s,t,e=!1){let n,i;return kt(s)?n=s:(n=s.get,i=s.set),new BM(n,i,e)}const il={},Yl=new WeakMap;let lr;function NM(s,t=!1,e=lr){if(e){let n=Yl.get(e);n||Yl.set(e,n=[]),n.push(s)}}function LM(s,t,e=ee){const{immediate:n,deep:i,once:r,scheduler:a,augmentJob:l,call:o}=e,h=y=>i?y:Zs(y)||i===!1||i===0?fi(y,1):fi(y);let c,d,u,f,m=!1,p=!1;if(as(s)?(d=()=>s.value,m=Zs(s)):lo(s)?(d=()=>h(s),m=!0):It(s)?(p=!0,m=s.some(y=>lo(y)||Zs(y)),d=()=>s.map(y=>{if(as(y))return y.value;if(lo(y))return h(y);if(kt(y))return o?o(y,2):y()})):kt(s)?t?d=o?()=>o(s,2):s:d=()=>{if(u){ji();try{u()}finally{qi()}}const y=lr;lr=c;try{return o?o(s,3,[f]):s(f)}finally{lr=y}}:d=qs,t&&i){const y=d,w=i===!0?1/0:i;d=()=>fi(y(),w)}const g=cM(),v=()=>{c.stop(),g&&g.active&&kf(g.effects,c)};if(r&&t){const y=t;t=(...w)=>{y(...w),v()}}let b=p?new Array(s.length).fill(il):il;const x=y=>{if(!(!(c.flags&1)||!c.dirty&&!y))if(t){const w=c.run();if(i||m||(p?w.some((_,E)=>Vi(_,b[E])):Vi(w,b))){u&&u();const _=lr;lr=c;try{const E=[w,b===il?void 0:p&&b[0]===il?[]:b,f];o?o(t,3,E):t(...E),b=w}finally{lr=_}}}else c.run()};return l&&l(x),c=new Ty(d),c.scheduler=a?()=>a(x,!1):x,f=y=>NM(y,!1,c),u=c.onStop=()=>{const y=Yl.get(c);if(y){if(o)o(y,4);else for(const w of y)w();Yl.delete(c)}},t?n?x(!0):b=c.run():a?a(x.bind(null,!0),!0):c.run(),v.pause=c.pause.bind(c),v.resume=c.resume.bind(c),v.stop=v,v}function fi(s,t=1/0,e){if(t<=0||!ge(s)||s.__v_skip||(e=e||new Set,e.has(s)))return s;if(e.add(s),t--,as(s))fi(s.value,t,e);else if(It(s))for(let n=0;n<s.length;n++)fi(s[n],t,e);else if(xy(s)||ao(s))s.forEach(n=>{fi(n,t,e)});else if(vy(s)){for(const n in s)fi(s[n],t,e);for(const n of Object.getOwnPropertySymbols(s))Object.prototype.propertyIsEnumerable.call(s,n)&&fi(s[n],t,e)}return s}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ra(s,t,e,n){try{return n?s(...n):s()}catch(i){Vh(i,t,e)}}function Jn(s,t,e,n){if(kt(s)){const i=Ra(s,t,e,n);return i&&yy(i)&&i.catch(r=>{Vh(r,t,e)}),i}if(It(s)){const i=[];for(let r=0;r<s.length;r++)i.push(Jn(s[r],t,e,n));return i}}function Vh(s,t,e,n=!0){const i=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||ee;if(t){let l=t.parent;const o=t.proxy,h=`https://vuejs.org/error-reference/#runtime-${e}`;for(;l;){const c=l.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](s,o,h)===!1)return}l=l.parent}if(r){ji(),Ra(r,null,10,[s,o,h]),qi();return}}VM(s,e,i,n,a)}function VM(s,t,e,n=!0,i=!1){if(i)throw s;console.error(s)}const xs=[];let $n=-1;const ho=[];let ki=null,Hr=0;const Xy=Promise.resolve();let $l=null;function Gl(s){const t=$l||Xy;return s?t.then(this?s.bind(this):s):t}function UM(s){let t=$n+1,e=xs.length;for(;t<e;){const n=t+e>>>1,i=xs[n],r=ba(i);r<s||r===s&&i.flags&2?t=n+1:e=n}return t}function $f(s){if(!(s.flags&1)){const t=ba(s),e=xs[xs.length-1];!e||!(s.flags&2)&&t>=ba(e)?xs.push(s):xs.splice(UM(t),0,s),s.flags|=1,Yy()}}function Yy(){$l||($l=Xy.then(Wy))}function $y(s){It(s)?ho.push(...s):ki&&s.id===-1?ki.splice(Hr+1,0,s):s.flags&1||(ho.push(s),s.flags|=1),Yy()}function tg(s,t,e=$n+1){for(;e<xs.length;e++){const n=xs[e];if(n&&n.flags&2){if(s&&n.id!==s.uid)continue;xs.splice(e,1),e--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Gy(s){if(ho.length){const t=[...new Set(ho)].sort((e,n)=>ba(e)-ba(n));if(ho.length=0,ki){ki.push(...t);return}for(ki=t,Hr=0;Hr<ki.length;Hr++){const e=ki[Hr];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}ki=null,Hr=0}}const ba=s=>s.id==null?s.flags&2?-1:1/0:s.id;function Wy(s){const t=qs;try{for($n=0;$n<xs.length;$n++){const e=xs[$n];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ra(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;$n<xs.length;$n++){const e=xs[$n];e&&(e.flags&=-2)}$n=-1,xs.length=0,Gy(),$l=null,(xs.length||ho.length)&&Wy()}}let He=null,Hy=null;function Wl(s){const t=He;return He=s,Hy=s&&s.type.__scopeId||null,t}function Ms(s,t=He,e){if(!t||s._n)return s;const n=(...i)=>{n._d&&cg(-1);const r=Wl(t);let a;try{a=s(...i)}finally{Wl(r),n._d&&cg(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Hl(s,t){if(He===null)return s;const e=$h(He),n=s.dirs||(s.dirs=[]);for(let i=0;i<t.length;i++){let[r,a,l,o=ee]=t[i];r&&(kt(r)&&(r={mounted:r,updated:r}),r.deep&&fi(a),n.push({dir:r,instance:e,value:a,oldValue:void 0,arg:l,modifiers:o}))}return s}function Qi(s,t,e,n){const i=s.dirs,r=t&&t.dirs;for(let a=0;a<i.length;a++){const l=i[a];r&&(l.oldValue=r[a].value);let o=l.dir[n];o&&(ji(),Jn(o,e,8,[s.el,l,s,t]),qi())}}const XM=Symbol("_vte"),YM=s=>s.__isTeleport;function Gf(s,t){s.shapeFlag&6&&s.component?(s.transition=t,Gf(s.component.subTree,t)):s.shapeFlag&128?(s.ssContent.transition=t.clone(s.ssContent),s.ssFallback.transition=t.clone(s.ssFallback)):s.transition=t}function zy(s){s.ids=[s.ids[0]+s.ids[2]+++"-",0,0]}function zl(s,t,e,n,i=!1){if(It(s)){s.forEach((m,p)=>zl(m,t&&(It(t)?t[p]:t),e,n,i));return}if(co(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&zl(s,t,e,n.component.subTree);return}const r=n.shapeFlag&4?$h(n.component):n.el,a=i?null:r,{i:l,r:o}=s,h=t&&t.r,c=l.refs===ee?l.refs={}:l.refs,d=l.setupState,u=jt(d),f=d===ee?()=>!1:m=>qt(u,m);if(h!=null&&h!==o&&(Pe(h)?(c[h]=null,f(h)&&(d[h]=null)):as(h)&&(h.value=null)),kt(o))Ra(o,l,12,[a,c]);else{const m=Pe(o),p=as(o);if(m||p){const g=()=>{if(s.f){const v=m?f(o)?d[o]:c[o]:o.value;i?It(v)&&kf(v,r):It(v)?v.includes(r)||v.push(r):m?(c[o]=[r],f(o)&&(d[o]=c[o])):(o.value=[r],s.k&&(c[s.k]=o.value))}else m?(c[o]=a,f(o)&&(d[o]=a)):p&&(o.value=a,s.k&&(c[s.k]=a))};a?(g.id=-1,Fs(g,e)):g()}}}Nh().requestIdleCallback;Nh().cancelIdleCallback;const co=s=>!!s.type.__asyncLoader,jy=s=>s.type.__isKeepAlive;function $M(s,t){qy(s,"a",t)}function GM(s,t){qy(s,"da",t)}function qy(s,t,e=Ze){const n=s.__wdc||(s.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return s()});if(Uh(t,n,e),e){let i=e.parent;for(;i&&i.parent;)jy(i.parent.vnode)&&WM(n,t,e,i),i=i.parent}}function WM(s,t,e,n){const i=Uh(t,s,n,!0);Hf(()=>{kf(n[t],i)},e)}function Uh(s,t,e=Ze,n=!1){if(e){const i=e[s]||(e[s]=[]),r=t.__weh||(t.__weh=(...a)=>{ji();const l=Pa(e),o=Jn(t,e,s,a);return l(),qi(),o});return n?i.unshift(r):i.push(r),r}}const Ei=s=>(t,e=Ze)=>{(!wa||s==="sp")&&Uh(s,(...n)=>t(...n),e)},HM=Ei("bm"),Wf=Ei("m"),Ky=Ei("bu"),Zy=Ei("u"),zM=Ei("bum"),Hf=Ei("um"),jM=Ei("sp"),qM=Ei("rtg"),KM=Ei("rtc");function ZM(s,t=Ze){Uh("ec",s,t)}const Jy="components";function hs(s,t){return QM(Jy,s,!0,t)||s}const JM=Symbol.for("v-ndc");function QM(s,t,e=!0,n=!1){const i=He||Ze;if(i){const r=i.type;if(s===Jy){const l=XI(r,!1);if(l&&(l===t||l===en(t)||l===Oh(en(t))))return r}const a=eg(i[s]||r[s],t)||eg(i.appContext[s],t);return!a&&n?r:a}}function eg(s,t){return s&&(s[t]||s[en(t)]||s[Oh(en(t))])}function sg(s,t,e,n){let i;const r=e&&e[n],a=It(s);if(a||Pe(s)){const l=a&&lo(s);let o=!1;l&&(o=!Zs(s),s=Lh(s)),i=new Array(s.length);for(let h=0,c=s.length;h<c;h++)i[h]=t(o?rs(s[h]):s[h],h,void 0,r&&r[h])}else if(typeof s=="number"){i=new Array(s);for(let l=0;l<s;l++)i[l]=t(l+1,l,void 0,r&&r[l])}else if(ge(s))if(s[Symbol.iterator])i=Array.from(s,(l,o)=>t(l,o,void 0,r&&r[o]));else{const l=Object.keys(s);i=new Array(l.length);for(let o=0,h=l.length;o<h;o++){const c=l[o];i[o]=t(s[c],c,o,r&&r[o])}}else i=[];return e&&(e[n]=i),i}function zf(s,t,e={},n,i){if(He.ce||He.parent&&co(He.parent)&&He.parent.ce)return t!=="default"&&(e.name=t),ie(),yo(ys,null,[Nt("slot",e,n&&n())],64);let r=s[t];r&&r._c&&(r._d=!1),ie();const a=r&&Qy(r(e)),l=e.key||a&&a.key,o=yo(ys,{key:(l&&!_i(l)?l:`_${t}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&s._===1?64:-2);return!i&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),r&&r._c&&(r._d=!0),o}function Qy(s){return s.some(t=>Kf(t)?!(t.type===Gi||t.type===ys&&!Qy(t.children)):!0)?s:null}const td=s=>s?vb(s)?$h(s):td(s.parent):null,na=ts(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>td(s.parent),$root:s=>td(s.root),$host:s=>s.ce,$emit:s=>s.emit,$options:s=>jf(s),$forceUpdate:s=>s.f||(s.f=()=>{$f(s.update)}),$nextTick:s=>s.n||(s.n=Gl.bind(s.proxy)),$watch:s=>wI.bind(s)}),Wc=(s,t)=>s!==ee&&!s.__isScriptSetup&&qt(s,t),tI={get({_:s},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:n,data:i,props:r,accessCache:a,type:l,appContext:o}=s;let h;if(t[0]!=="$"){const f=a[t];if(f!==void 0)switch(f){case 1:return n[t];case 2:return i[t];case 4:return e[t];case 3:return r[t]}else{if(Wc(n,t))return a[t]=1,n[t];if(i!==ee&&qt(i,t))return a[t]=2,i[t];if((h=s.propsOptions[0])&&qt(h,t))return a[t]=3,r[t];if(e!==ee&&qt(e,t))return a[t]=4,e[t];ed&&(a[t]=0)}}const c=na[t];let d,u;if(c)return t==="$attrs"&&is(s.attrs,"get",""),c(s);if((d=l.__cssModules)&&(d=d[t]))return d;if(e!==ee&&qt(e,t))return a[t]=4,e[t];if(u=o.config.globalProperties,qt(u,t))return u[t]},set({_:s},t,e){const{data:n,setupState:i,ctx:r}=s;return Wc(i,t)?(i[t]=e,!0):n!==ee&&qt(n,t)?(n[t]=e,!0):qt(s.props,t)||t[0]==="$"&&t.slice(1)in s?!1:(r[t]=e,!0)},has({_:{data:s,setupState:t,accessCache:e,ctx:n,appContext:i,propsOptions:r}},a){let l;return!!e[a]||s!==ee&&qt(s,a)||Wc(t,a)||(l=r[0])&&qt(l,a)||qt(n,a)||qt(na,a)||qt(i.config.globalProperties,a)},defineProperty(s,t,e){return e.get!=null?s._.accessCache[t]=0:qt(e,"value")&&this.set(s,t,e.value,null),Reflect.defineProperty(s,t,e)}};function ng(s){return It(s)?s.reduce((t,e)=>(t[e]=null,t),{}):s}let ed=!0;function eI(s){const t=jf(s),e=s.proxy,n=s.ctx;ed=!1,t.beforeCreate&&ig(t.beforeCreate,s,"bc");const{data:i,computed:r,methods:a,watch:l,provide:o,inject:h,created:c,beforeMount:d,mounted:u,beforeUpdate:f,updated:m,activated:p,deactivated:g,beforeDestroy:v,beforeUnmount:b,destroyed:x,unmounted:y,render:w,renderTracked:_,renderTriggered:E,errorCaptured:T,serverPrefetch:C,expose:R,inheritAttrs:P,components:O,directives:F,filters:D}=t;if(h&&sI(h,n,null),a)for(const U in a){const j=a[U];kt(j)&&(n[U]=j.bind(e))}if(i){const U=i.call(e,e);ge(U)&&(s.data=Uf(U))}if(ed=!0,r)for(const U in r){const j=r[U],z=kt(j)?j.bind(e,e):kt(j.get)?j.get.bind(e,e):qs,N=!kt(j)&&kt(j.set)?j.set.bind(e):qs,G=_b({get:z,set:N});Object.defineProperty(n,U,{enumerable:!0,configurable:!0,get:()=>G.value,set:q=>G.value=q})}if(l)for(const U in l)tb(l[U],n,e,U);if(o){const U=kt(o)?o.call(e):o;Reflect.ownKeys(U).forEach(j=>{lI(j,U[j])})}c&&ig(c,s,"c");function X(U,j){It(j)?j.forEach(z=>U(z.bind(e))):j&&U(j.bind(e))}if(X(HM,d),X(Wf,u),X(Ky,f),X(Zy,m),X($M,p),X(GM,g),X(ZM,T),X(KM,_),X(qM,E),X(zM,b),X(Hf,y),X(jM,C),It(R))if(R.length){const U=s.exposed||(s.exposed={});R.forEach(j=>{Object.defineProperty(U,j,{get:()=>e[j],set:z=>e[j]=z})})}else s.exposed||(s.exposed={});w&&s.render===qs&&(s.render=w),P!=null&&(s.inheritAttrs=P),O&&(s.components=O),F&&(s.directives=F),C&&zy(s)}function sI(s,t,e=qs){It(s)&&(s=sd(s));for(const n in s){const i=s[n];let r;ge(i)?"default"in i?r=gl(i.from||n,i.default,!0):r=gl(i.from||n):r=gl(i),as(r)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:a=>r.value=a}):t[n]=r}}function ig(s,t,e){Jn(It(s)?s.map(n=>n.bind(t.proxy)):s.bind(t.proxy),t,e)}function tb(s,t,e,n){let i=n.includes(".")?mb(e,n):()=>e[n];if(Pe(s)){const r=t[s];kt(r)&&fo(i,r)}else if(kt(s))fo(i,s.bind(e));else if(ge(s))if(It(s))s.forEach(r=>tb(r,t,e,n));else{const r=kt(s.handler)?s.handler.bind(e):t[s.handler];kt(r)&&fo(i,r,s)}}function jf(s){const t=s.type,{mixins:e,extends:n}=t,{mixins:i,optionsCache:r,config:{optionMergeStrategies:a}}=s.appContext,l=r.get(t);let o;return l?o=l:!i.length&&!e&&!n?o=t:(o={},i.length&&i.forEach(h=>jl(o,h,a,!0)),jl(o,t,a)),ge(t)&&r.set(t,o),o}function jl(s,t,e,n=!1){const{mixins:i,extends:r}=t;r&&jl(s,r,e,!0),i&&i.forEach(a=>jl(s,a,e,!0));for(const a in t)if(!(n&&a==="expose")){const l=nI[a]||e&&e[a];s[a]=l?l(s[a],t[a]):t[a]}return s}const nI={data:rg,props:og,emits:og,methods:zo,computed:zo,beforeCreate:ms,created:ms,beforeMount:ms,mounted:ms,beforeUpdate:ms,updated:ms,beforeDestroy:ms,beforeUnmount:ms,destroyed:ms,unmounted:ms,activated:ms,deactivated:ms,errorCaptured:ms,serverPrefetch:ms,components:zo,directives:zo,watch:rI,provide:rg,inject:iI};function rg(s,t){return t?s?function(){return ts(kt(s)?s.call(this,this):s,kt(t)?t.call(this,this):t)}:t:s}function iI(s,t){return zo(sd(s),sd(t))}function sd(s){if(It(s)){const t={};for(let e=0;e<s.length;e++)t[s[e]]=s[e];return t}return s}function ms(s,t){return s?[...new Set([].concat(s,t))]:t}function zo(s,t){return s?ts(Object.create(null),s,t):t}function og(s,t){return s?It(s)&&It(t)?[...new Set([...s,...t])]:ts(Object.create(null),ng(s),ng(t??{})):t}function rI(s,t){if(!s)return t;if(!t)return s;const e=ts(Object.create(null),s);for(const n in t)e[n]=ms(s[n],t[n]);return e}function eb(){return{app:null,config:{isNativeTag:ZC,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let oI=0;function aI(s,t){return function(n,i=null){kt(n)||(n=ts({},n)),i!=null&&!ge(i)&&(i=null);const r=eb(),a=new WeakSet,l=[];let o=!1;const h=r.app={_uid:oI++,_component:n,_props:i,_container:null,_context:r,_instance:null,version:$I,get config(){return r.config},set config(c){},use(c,...d){return a.has(c)||(c&&kt(c.install)?(a.add(c),c.install(h,...d)):kt(c)&&(a.add(c),c(h,...d))),h},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),h},component(c,d){return d?(r.components[c]=d,h):r.components[c]},directive(c,d){return d?(r.directives[c]=d,h):r.directives[c]},mount(c,d,u){if(!o){const f=h._ceVNode||Nt(n,i);return f.appContext=r,u===!0?u="svg":u===!1&&(u=void 0),d&&t?t(f,c):s(f,c,u),o=!0,h._container=c,c.__vue_app__=h,$h(f.component)}},onUnmount(c){l.push(c)},unmount(){o&&(Jn(l,h._instance,16),s(null,h._container),delete h._container.__vue_app__)},provide(c,d){return r.provides[c]=d,h},runWithContext(c){const d=uo;uo=h;try{return c()}finally{uo=d}}};return h}}let uo=null;function lI(s,t){if(Ze){let e=Ze.provides;const n=Ze.parent&&Ze.parent.provides;n===e&&(e=Ze.provides=Object.create(n)),e[s]=t}}function gl(s,t,e=!1){const n=Ze||He;if(n||uo){const i=uo?uo._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&s in i)return i[s];if(arguments.length>1)return e&&kt(t)?t.call(n&&n.proxy):t}}const sb={},nb=()=>Object.create(sb),ib=s=>Object.getPrototypeOf(s)===sb;function hI(s,t,e,n=!1){const i={},r=nb();s.propsDefaults=Object.create(null),rb(s,t,i,r);for(const a in s.propsOptions[0])a in i||(i[a]=void 0);e?s.props=n?i:IM(i):s.type.props?s.props=i:s.props=r,s.attrs=r}function cI(s,t,e,n){const{props:i,attrs:r,vnode:{patchFlag:a}}=s,l=jt(i),[o]=s.propsOptions;let h=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=s.vnode.dynamicProps;for(let d=0;d<c.length;d++){let u=c[d];if(Xh(s.emitsOptions,u))continue;const f=t[u];if(o)if(qt(r,u))f!==r[u]&&(r[u]=f,h=!0);else{const m=en(u);i[m]=nd(o,l,m,f,s,!1)}else f!==r[u]&&(r[u]=f,h=!0)}}}else{rb(s,t,i,r)&&(h=!0);let c;for(const d in l)(!t||!qt(t,d)&&((c=Rr(d))===d||!qt(t,c)))&&(o?e&&(e[d]!==void 0||e[c]!==void 0)&&(i[d]=nd(o,l,d,void 0,s,!0)):delete i[d]);if(r!==l)for(const d in r)(!t||!qt(t,d))&&(delete r[d],h=!0)}h&&di(s.attrs,"set","")}function rb(s,t,e,n){const[i,r]=s.propsOptions;let a=!1,l;if(t)for(let o in t){if(ta(o))continue;const h=t[o];let c;i&&qt(i,c=en(o))?!r||!r.includes(c)?e[c]=h:(l||(l={}))[c]=h:Xh(s.emitsOptions,o)||(!(o in n)||h!==n[o])&&(n[o]=h,a=!0)}if(r){const o=jt(e),h=l||ee;for(let c=0;c<r.length;c++){const d=r[c];e[d]=nd(i,o,d,h[d],s,!qt(h,d))}}return a}function nd(s,t,e,n,i,r){const a=s[e];if(a!=null){const l=qt(a,"default");if(l&&n===void 0){const o=a.default;if(a.type!==Function&&!a.skipFactory&&kt(o)){const{propsDefaults:h}=i;if(e in h)n=h[e];else{const c=Pa(i);n=h[e]=o.call(null,t),c()}}else n=o;i.ce&&i.ce._setProp(e,n)}a[0]&&(r&&!l?n=!1:a[1]&&(n===""||n===Rr(e))&&(n=!0))}return n}const uI=new WeakMap;function ob(s,t,e=!1){const n=e?uI:t.propsCache,i=n.get(s);if(i)return i;const r=s.props,a={},l=[];let o=!1;if(!kt(s)){const c=d=>{o=!0;const[u,f]=ob(d,t,!0);ts(a,u),f&&l.push(...f)};!e&&t.mixins.length&&t.mixins.forEach(c),s.extends&&c(s.extends),s.mixins&&s.mixins.forEach(c)}if(!r&&!o)return ge(s)&&n.set(s,oo),oo;if(It(r))for(let c=0;c<r.length;c++){const d=en(r[c]);ag(d)&&(a[d]=ee)}else if(r)for(const c in r){const d=en(c);if(ag(d)){const u=r[c],f=a[d]=It(u)||kt(u)?{type:u}:ts({},u),m=f.type;let p=!1,g=!0;if(It(m))for(let v=0;v<m.length;++v){const b=m[v],x=kt(b)&&b.name;if(x==="Boolean"){p=!0;break}else x==="String"&&(g=!1)}else p=kt(m)&&m.name==="Boolean";f[0]=p,f[1]=g,(p||qt(f,"default"))&&l.push(d)}}const h=[a,l];return ge(s)&&n.set(s,h),h}function ag(s){return s[0]!=="$"&&!ta(s)}const ab=s=>s[0]==="_"||s==="$stable",qf=s=>It(s)?s.map(jn):[jn(s)],dI=(s,t,e)=>{if(t._n)return t;const n=Ms((...i)=>qf(t(...i)),e);return n._c=!1,n},lb=(s,t,e)=>{const n=s._ctx;for(const i in s){if(ab(i))continue;const r=s[i];if(kt(r))t[i]=dI(i,r,n);else if(r!=null){const a=qf(r);t[i]=()=>a}}},hb=(s,t)=>{const e=qf(t);s.slots.default=()=>e},cb=(s,t,e)=>{for(const n in t)(e||n!=="_")&&(s[n]=t[n])},fI=(s,t,e)=>{const n=s.slots=nb();if(s.vnode.shapeFlag&32){const i=t._;i?(cb(n,t,e),e&&wy(n,"_",i,!0)):lb(t,n)}else t&&hb(s,t)},mI=(s,t,e)=>{const{vnode:n,slots:i}=s;let r=!0,a=ee;if(n.shapeFlag&32){const l=t._;l?e&&l===1?r=!1:cb(i,t,e):(r=!t.$stable,lb(t,i)),a=t}else t&&(hb(s,t),a={default:1});if(r)for(const l in i)!ab(l)&&a[l]==null&&delete i[l]},Fs=MI;function pI(s){return gI(s)}function gI(s,t){const e=Nh();e.__VUE__=!0;const{insert:n,remove:i,patchProp:r,createElement:a,createText:l,createComment:o,setText:h,setElementText:c,parentNode:d,nextSibling:u,setScopeId:f=qs,insertStaticContent:m}=s,p=(k,L,H,et=null,Z=null,st=null,rt=void 0,it=null,ot=!!L.dynamicChildren)=>{if(k===L)return;k&&!No(k,L)&&(et=vt(k),q(k,Z,st,!0),k=null),L.patchFlag===-2&&(ot=!1,L.dynamicChildren=null);const{type:nt,ref:gt,shapeFlag:S}=L;switch(nt){case Yh:g(k,L,H,et);break;case Gi:v(k,L,H,et);break;case ia:k==null&&b(L,H,et,rt);break;case ys:O(k,L,H,et,Z,st,rt,it,ot);break;default:S&1?w(k,L,H,et,Z,st,rt,it,ot):S&6?F(k,L,H,et,Z,st,rt,it,ot):(S&64||S&128)&&nt.process(k,L,H,et,Z,st,rt,it,ot,Et)}gt!=null&&Z&&zl(gt,k&&k.ref,st,L||k,!L)},g=(k,L,H,et)=>{if(k==null)n(L.el=l(L.children),H,et);else{const Z=L.el=k.el;L.children!==k.children&&h(Z,L.children)}},v=(k,L,H,et)=>{k==null?n(L.el=o(L.children||""),H,et):L.el=k.el},b=(k,L,H,et)=>{[k.el,k.anchor]=m(k.children,L,H,et,k.el,k.anchor)},x=({el:k,anchor:L},H,et)=>{let Z;for(;k&&k!==L;)Z=u(k),n(k,H,et),k=Z;n(L,H,et)},y=({el:k,anchor:L})=>{let H;for(;k&&k!==L;)H=u(k),i(k),k=H;i(L)},w=(k,L,H,et,Z,st,rt,it,ot)=>{L.type==="svg"?rt="svg":L.type==="math"&&(rt="mathml"),k==null?_(L,H,et,Z,st,rt,it,ot):C(k,L,Z,st,rt,it,ot)},_=(k,L,H,et,Z,st,rt,it)=>{let ot,nt;const{props:gt,shapeFlag:S,transition:M,dirs:B}=k;if(ot=k.el=a(k.type,st,gt&&gt.is,gt),S&8?c(ot,k.children):S&16&&T(k.children,ot,null,et,Z,Hc(k,st),rt,it),B&&Qi(k,null,et,"created"),E(ot,k,k.scopeId,rt,et),gt){for(const dt in gt)dt!=="value"&&!ta(dt)&&r(ot,dt,null,gt[dt],st,et);"value"in gt&&r(ot,"value",null,gt.value,st),(nt=gt.onVnodeBeforeMount)&&Vn(nt,et,k)}B&&Qi(k,null,et,"beforeMount");const J=xI(Z,M);J&&M.beforeEnter(ot),n(ot,L,H),((nt=gt&&gt.onVnodeMounted)||J||B)&&Fs(()=>{nt&&Vn(nt,et,k),J&&M.enter(ot),B&&Qi(k,null,et,"mounted")},Z)},E=(k,L,H,et,Z)=>{if(H&&f(k,H),et)for(let st=0;st<et.length;st++)f(k,et[st]);if(Z){let st=Z.subTree;if(L===st||gb(st.type)&&(st.ssContent===L||st.ssFallback===L)){const rt=Z.vnode;E(k,rt,rt.scopeId,rt.slotScopeIds,Z.parent)}}},T=(k,L,H,et,Z,st,rt,it,ot=0)=>{for(let nt=ot;nt<k.length;nt++){const gt=k[nt]=it?Fi(k[nt]):jn(k[nt]);p(null,gt,L,H,et,Z,st,rt,it)}},C=(k,L,H,et,Z,st,rt)=>{const it=L.el=k.el;let{patchFlag:ot,dynamicChildren:nt,dirs:gt}=L;ot|=k.patchFlag&16;const S=k.props||ee,M=L.props||ee;let B;if(H&&tr(H,!1),(B=M.onVnodeBeforeUpdate)&&Vn(B,H,L,k),gt&&Qi(L,k,H,"beforeUpdate"),H&&tr(H,!0),(S.innerHTML&&M.innerHTML==null||S.textContent&&M.textContent==null)&&c(it,""),nt?R(k.dynamicChildren,nt,it,H,et,Hc(L,Z),st):rt||j(k,L,it,null,H,et,Hc(L,Z),st,!1),ot>0){if(ot&16)P(it,S,M,H,Z);else if(ot&2&&S.class!==M.class&&r(it,"class",null,M.class,Z),ot&4&&r(it,"style",S.style,M.style,Z),ot&8){const J=L.dynamicProps;for(let dt=0;dt<J.length;dt++){const xt=J[dt],Zt=S[xt],Jt=M[xt];(Jt!==Zt||xt==="value")&&r(it,xt,Zt,Jt,Z,H)}}ot&1&&k.children!==L.children&&c(it,L.children)}else!rt&&nt==null&&P(it,S,M,H,Z);((B=M.onVnodeUpdated)||gt)&&Fs(()=>{B&&Vn(B,H,L,k),gt&&Qi(L,k,H,"updated")},et)},R=(k,L,H,et,Z,st,rt)=>{for(let it=0;it<L.length;it++){const ot=k[it],nt=L[it],gt=ot.el&&(ot.type===ys||!No(ot,nt)||ot.shapeFlag&70)?d(ot.el):H;p(ot,nt,gt,null,et,Z,st,rt,!0)}},P=(k,L,H,et,Z)=>{if(L!==H){if(L!==ee)for(const st in L)!ta(st)&&!(st in H)&&r(k,st,L[st],null,Z,et);for(const st in H){if(ta(st))continue;const rt=H[st],it=L[st];rt!==it&&st!=="value"&&r(k,st,it,rt,Z,et)}"value"in H&&r(k,"value",L.value,H.value,Z)}},O=(k,L,H,et,Z,st,rt,it,ot)=>{const nt=L.el=k?k.el:l(""),gt=L.anchor=k?k.anchor:l("");let{patchFlag:S,dynamicChildren:M,slotScopeIds:B}=L;B&&(it=it?it.concat(B):B),k==null?(n(nt,H,et),n(gt,H,et),T(L.children||[],H,gt,Z,st,rt,it,ot)):S>0&&S&64&&M&&k.dynamicChildren?(R(k.dynamicChildren,M,H,Z,st,rt,it),(L.key!=null||Z&&L===Z.subTree)&&ub(k,L,!0)):j(k,L,H,gt,Z,st,rt,it,ot)},F=(k,L,H,et,Z,st,rt,it,ot)=>{L.slotScopeIds=it,k==null?L.shapeFlag&512?Z.ctx.activate(L,H,et,rt,ot):D(L,H,et,Z,st,rt,ot):V(k,L,ot)},D=(k,L,H,et,Z,st,rt)=>{const it=k.component=BI(k,et,Z);if(jy(k)&&(it.ctx.renderer=Et),NI(it,!1,rt),it.asyncDep){if(Z&&Z.registerDep(it,X,rt),!k.el){const ot=it.subTree=Nt(Gi);v(null,ot,L,H)}}else X(it,k,L,H,Z,st,rt)},V=(k,L,H)=>{const et=L.component=k.component;if(AI(k,L,H))if(et.asyncDep&&!et.asyncResolved){U(et,L,H);return}else et.next=L,et.update();else L.el=k.el,et.vnode=L},X=(k,L,H,et,Z,st,rt)=>{const it=()=>{if(k.isMounted){let{next:S,bu:M,u:B,parent:J,vnode:dt}=k;{const ns=db(k);if(ns){S&&(S.el=dt.el,U(k,S,rt)),ns.asyncDep.then(()=>{k.isUnmounted||it()});return}}let xt=S,Zt;tr(k,!1),S?(S.el=dt.el,U(k,S,rt)):S=dt,M&&Uc(M),(Zt=S.props&&S.props.onVnodeBeforeUpdate)&&Vn(Zt,J,S,dt),tr(k,!0);const Jt=zc(k),ss=k.subTree;k.subTree=Jt,p(ss,Jt,d(ss.el),vt(ss),k,Z,st),S.el=Jt.el,xt===null&&CI(k,Jt.el),B&&Fs(B,Z),(Zt=S.props&&S.props.onVnodeUpdated)&&Fs(()=>Vn(Zt,J,S,dt),Z)}else{let S;const{el:M,props:B}=L,{bm:J,m:dt,parent:xt,root:Zt,type:Jt}=k,ss=co(L);if(tr(k,!1),J&&Uc(J),!ss&&(S=B&&B.onVnodeBeforeMount)&&Vn(S,xt,L),tr(k,!0),M&&Ot){const ns=()=>{k.subTree=zc(k),Ot(M,k.subTree,k,Z,null)};ss&&Jt.__asyncHydrate?Jt.__asyncHydrate(M,k,ns):ns()}else{Zt.ce&&Zt.ce._injectChildStyle(Jt);const ns=k.subTree=zc(k);p(null,ns,H,et,k,Z,st),L.el=ns.el}if(dt&&Fs(dt,Z),!ss&&(S=B&&B.onVnodeMounted)){const ns=L;Fs(()=>Vn(S,xt,ns),Z)}(L.shapeFlag&256||xt&&co(xt.vnode)&&xt.vnode.shapeFlag&256)&&k.a&&Fs(k.a,Z),k.isMounted=!0,L=H=et=null}};k.scope.on();const ot=k.effect=new Ty(it);k.scope.off();const nt=k.update=ot.run.bind(ot),gt=k.job=ot.runIfDirty.bind(ot);gt.i=k,gt.id=k.uid,ot.scheduler=()=>$f(gt),tr(k,!0),nt()},U=(k,L,H)=>{L.component=k;const et=k.vnode.props;k.vnode=L,k.next=null,cI(k,L.props,et,H),mI(k,L.children,H),ji(),tg(k),qi()},j=(k,L,H,et,Z,st,rt,it,ot=!1)=>{const nt=k&&k.children,gt=k?k.shapeFlag:0,S=L.children,{patchFlag:M,shapeFlag:B}=L;if(M>0){if(M&128){N(nt,S,H,et,Z,st,rt,it,ot);return}else if(M&256){z(nt,S,H,et,Z,st,rt,it,ot);return}}B&8?(gt&16&&ht(nt,Z,st),S!==nt&&c(H,S)):gt&16?B&16?N(nt,S,H,et,Z,st,rt,it,ot):ht(nt,Z,st,!0):(gt&8&&c(H,""),B&16&&T(S,H,et,Z,st,rt,it,ot))},z=(k,L,H,et,Z,st,rt,it,ot)=>{k=k||oo,L=L||oo;const nt=k.length,gt=L.length,S=Math.min(nt,gt);let M;for(M=0;M<S;M++){const B=L[M]=ot?Fi(L[M]):jn(L[M]);p(k[M],B,H,null,Z,st,rt,it,ot)}nt>gt?ht(k,Z,st,!0,!1,S):T(L,H,et,Z,st,rt,it,ot,S)},N=(k,L,H,et,Z,st,rt,it,ot)=>{let nt=0;const gt=L.length;let S=k.length-1,M=gt-1;for(;nt<=S&&nt<=M;){const B=k[nt],J=L[nt]=ot?Fi(L[nt]):jn(L[nt]);if(No(B,J))p(B,J,H,null,Z,st,rt,it,ot);else break;nt++}for(;nt<=S&&nt<=M;){const B=k[S],J=L[M]=ot?Fi(L[M]):jn(L[M]);if(No(B,J))p(B,J,H,null,Z,st,rt,it,ot);else break;S--,M--}if(nt>S){if(nt<=M){const B=M+1,J=B<gt?L[B].el:et;for(;nt<=M;)p(null,L[nt]=ot?Fi(L[nt]):jn(L[nt]),H,J,Z,st,rt,it,ot),nt++}}else if(nt>M)for(;nt<=S;)q(k[nt],Z,st,!0),nt++;else{const B=nt,J=nt,dt=new Map;for(nt=J;nt<=M;nt++){const Ps=L[nt]=ot?Fi(L[nt]):jn(L[nt]);Ps.key!=null&&dt.set(Ps.key,nt)}let xt,Zt=0;const Jt=M-J+1;let ss=!1,ns=0;const Si=new Array(Jt);for(nt=0;nt<Jt;nt++)Si[nt]=0;for(nt=B;nt<=S;nt++){const Ps=k[nt];if(Zt>=Jt){q(Ps,Z,st,!0);continue}let On;if(Ps.key!=null)On=dt.get(Ps.key);else for(xt=J;xt<=M;xt++)if(Si[xt-J]===0&&No(Ps,L[xt])){On=xt;break}On===void 0?q(Ps,Z,st,!0):(Si[On-J]=nt+1,On>=ns?ns=On:ss=!0,p(Ps,L[On],H,null,Z,st,rt,it,ot),Zt++)}const Mo=ss?yI(Si):oo;for(xt=Mo.length-1,nt=Jt-1;nt>=0;nt--){const Ps=J+nt,On=L[Ps],em=Ps+1<gt?L[Ps+1].el:et;Si[nt]===0?p(null,On,H,em,Z,st,rt,it,ot):ss&&(xt<0||nt!==Mo[xt]?G(On,H,em,2):xt--)}}},G=(k,L,H,et,Z=null)=>{const{el:st,type:rt,transition:it,children:ot,shapeFlag:nt}=k;if(nt&6){G(k.component.subTree,L,H,et);return}if(nt&128){k.suspense.move(L,H,et);return}if(nt&64){rt.move(k,L,H,Et);return}if(rt===ys){n(st,L,H);for(let S=0;S<ot.length;S++)G(ot[S],L,H,et);n(k.anchor,L,H);return}if(rt===ia){x(k,L,H);return}if(et!==2&&nt&1&&it)if(et===0)it.beforeEnter(st),n(st,L,H),Fs(()=>it.enter(st),Z);else{const{leave:S,delayLeave:M,afterLeave:B}=it,J=()=>n(st,L,H),dt=()=>{S(st,()=>{J(),B&&B()})};M?M(st,J,dt):dt()}else n(st,L,H)},q=(k,L,H,et=!1,Z=!1)=>{const{type:st,props:rt,ref:it,children:ot,dynamicChildren:nt,shapeFlag:gt,patchFlag:S,dirs:M,cacheIndex:B}=k;if(S===-2&&(Z=!1),it!=null&&zl(it,null,H,k,!0),B!=null&&(L.renderCache[B]=void 0),gt&256){L.ctx.deactivate(k);return}const J=gt&1&&M,dt=!co(k);let xt;if(dt&&(xt=rt&&rt.onVnodeBeforeUnmount)&&Vn(xt,L,k),gt&6)tt(k.component,H,et);else{if(gt&128){k.suspense.unmount(H,et);return}J&&Qi(k,null,L,"beforeUnmount"),gt&64?k.type.remove(k,L,H,Et,et):nt&&!nt.hasOnce&&(st!==ys||S>0&&S&64)?ht(nt,L,H,!1,!0):(st===ys&&S&384||!Z&&gt&16)&&ht(ot,L,H),et&&K(k)}(dt&&(xt=rt&&rt.onVnodeUnmounted)||J)&&Fs(()=>{xt&&Vn(xt,L,k),J&&Qi(k,null,L,"unmounted")},H)},K=k=>{const{type:L,el:H,anchor:et,transition:Z}=k;if(L===ys){Q(H,et);return}if(L===ia){y(k);return}const st=()=>{i(H),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(k.shapeFlag&1&&Z&&!Z.persisted){const{leave:rt,delayLeave:it}=Z,ot=()=>rt(H,st);it?it(k.el,st,ot):ot()}else st()},Q=(k,L)=>{let H;for(;k!==L;)H=u(k),i(k),k=H;i(L)},tt=(k,L,H)=>{const{bum:et,scope:Z,job:st,subTree:rt,um:it,m:ot,a:nt}=k;lg(ot),lg(nt),et&&Uc(et),Z.stop(),st&&(st.flags|=8,q(rt,k,L,H)),it&&Fs(it,L),Fs(()=>{k.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},ht=(k,L,H,et=!1,Z=!1,st=0)=>{for(let rt=st;rt<k.length;rt++)q(k[rt],L,H,et,Z)},vt=k=>{if(k.shapeFlag&6)return vt(k.component.subTree);if(k.shapeFlag&128)return k.suspense.next();const L=u(k.anchor||k.el),H=L&&L[XM];return H?u(H):L};let At=!1;const _t=(k,L,H)=>{k==null?L._vnode&&q(L._vnode,null,null,!0):p(L._vnode||null,k,L,null,null,null,H),L._vnode=k,At||(At=!0,tg(),Gy(),At=!1)},Et={p,um:q,m:G,r:K,mt:D,mc:T,pc:j,pbc:R,n:vt,o:s};let St,Ot;return t&&([St,Ot]=t(Et)),{render:_t,hydrate:St,createApp:aI(_t,St)}}function Hc({type:s,props:t},e){return e==="svg"&&s==="foreignObject"||e==="mathml"&&s==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function tr({effect:s,job:t},e){e?(s.flags|=32,t.flags|=4):(s.flags&=-33,t.flags&=-5)}function xI(s,t){return(!s||s&&!s.pendingBranch)&&t&&!t.persisted}function ub(s,t,e=!1){const n=s.children,i=t.children;if(It(n)&&It(i))for(let r=0;r<n.length;r++){const a=n[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=Fi(i[r]),l.el=a.el),!e&&l.patchFlag!==-2&&ub(a,l)),l.type===Yh&&(l.el=a.el)}}function yI(s){const t=s.slice(),e=[0];let n,i,r,a,l;const o=s.length;for(n=0;n<o;n++){const h=s[n];if(h!==0){if(i=e[e.length-1],s[i]<h){t[n]=i,e.push(n);continue}for(r=0,a=e.length-1;r<a;)l=r+a>>1,s[e[l]]<h?r=l+1:a=l;h<s[e[r]]&&(r>0&&(t[n]=e[r-1]),e[r]=n)}}for(r=e.length,a=e[r-1];r-- >0;)e[r]=a,a=t[a];return e}function db(s){const t=s.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:db(t)}function lg(s){if(s)for(let t=0;t<s.length;t++)s[t].flags|=8}const bI=Symbol.for("v-scx"),vI=()=>gl(bI);function fo(s,t,e){return fb(s,t,e)}function fb(s,t,e=ee){const{immediate:n,deep:i,flush:r,once:a}=e,l=ts({},e),o=t&&n||!t&&r!=="post";let h;if(wa){if(r==="sync"){const f=vI();h=f.__watcherHandles||(f.__watcherHandles=[])}else if(!o){const f=()=>{};return f.stop=qs,f.resume=qs,f.pause=qs,f}}const c=Ze;l.call=(f,m,p)=>Jn(f,c,m,p);let d=!1;r==="post"?l.scheduler=f=>{Fs(f,c&&c.suspense)}:r!=="sync"&&(d=!0,l.scheduler=(f,m)=>{m?f():$f(f)}),l.augmentJob=f=>{t&&(f.flags|=4),d&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const u=LM(s,t,l);return wa&&(h?h.push(u):o&&u()),u}function wI(s,t,e){const n=this.proxy,i=Pe(s)?s.includes(".")?mb(n,s):()=>n[s]:s.bind(n,n);let r;kt(t)?r=t:(r=t.handler,e=t);const a=Pa(this),l=fb(i,r.bind(n),e);return a(),l}function mb(s,t){const e=t.split(".");return()=>{let n=s;for(let i=0;i<e.length&&n;i++)n=n[e[i]];return n}}const _I=(s,t)=>t==="modelValue"||t==="model-value"?s.modelModifiers:s[`${t}Modifiers`]||s[`${en(t)}Modifiers`]||s[`${Rr(t)}Modifiers`];function EI(s,t,...e){if(s.isUnmounted)return;const n=s.vnode.props||ee;let i=e;const r=t.startsWith("update:"),a=r&&_I(n,t.slice(7));a&&(a.trim&&(i=e.map(c=>Pe(c)?c.trim():c)),a.number&&(i=e.map(sM)));let l,o=n[l=Vc(t)]||n[l=Vc(en(t))];!o&&r&&(o=n[l=Vc(Rr(t))]),o&&Jn(o,s,6,i);const h=n[l+"Once"];if(h){if(!s.emitted)s.emitted={};else if(s.emitted[l])return;s.emitted[l]=!0,Jn(h,s,6,i)}}function pb(s,t,e=!1){const n=t.emitsCache,i=n.get(s);if(i!==void 0)return i;const r=s.emits;let a={},l=!1;if(!kt(s)){const o=h=>{const c=pb(h,t,!0);c&&(l=!0,ts(a,c))};!e&&t.mixins.length&&t.mixins.forEach(o),s.extends&&o(s.extends),s.mixins&&s.mixins.forEach(o)}return!r&&!l?(ge(s)&&n.set(s,null),null):(It(r)?r.forEach(o=>a[o]=null):ts(a,r),ge(s)&&n.set(s,a),a)}function Xh(s,t){return!s||!Fh(t)?!1:(t=t.slice(2).replace(/Once$/,""),qt(s,t[0].toLowerCase()+t.slice(1))||qt(s,Rr(t))||qt(s,t))}function zc(s){const{type:t,vnode:e,proxy:n,withProxy:i,propsOptions:[r],slots:a,attrs:l,emit:o,render:h,renderCache:c,props:d,data:u,setupState:f,ctx:m,inheritAttrs:p}=s,g=Wl(s);let v,b;try{if(e.shapeFlag&4){const y=i||n,w=y;v=jn(h.call(w,y,c,d,f,u,m)),b=l}else{const y=t;v=jn(y.length>1?y(d,{attrs:l,slots:a,emit:o}):y(d,null)),b=t.props?l:SI(l)}}catch(y){ra.length=0,Vh(y,s,1),v=Nt(Gi)}let x=v;if(b&&p!==!1){const y=Object.keys(b),{shapeFlag:w}=x;y.length&&w&7&&(r&&y.some(Pf)&&(b=TI(b,r)),x=bo(x,b,!1,!0))}return e.dirs&&(x=bo(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&Gf(x,e.transition),v=x,Wl(g),v}const SI=s=>{let t;for(const e in s)(e==="class"||e==="style"||Fh(e))&&((t||(t={}))[e]=s[e]);return t},TI=(s,t)=>{const e={};for(const n in s)(!Pf(n)||!(n.slice(9)in t))&&(e[n]=s[n]);return e};function AI(s,t,e){const{props:n,children:i,component:r}=s,{props:a,children:l,patchFlag:o}=t,h=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&o>=0){if(o&1024)return!0;if(o&16)return n?hg(n,a,h):!!a;if(o&8){const c=t.dynamicProps;for(let d=0;d<c.length;d++){const u=c[d];if(a[u]!==n[u]&&!Xh(h,u))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:n===a?!1:n?a?hg(n,a,h):!0:!!a;return!1}function hg(s,t,e){const n=Object.keys(t);if(n.length!==Object.keys(s).length)return!0;for(let i=0;i<n.length;i++){const r=n[i];if(t[r]!==s[r]&&!Xh(e,r))return!0}return!1}function CI({vnode:s,parent:t},e){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===s&&(n.el=s.el),n===s)(s=t.vnode).el=e,t=t.parent;else break}}const gb=s=>s.__isSuspense;function MI(s,t){t&&t.pendingBranch?It(s)?t.effects.push(...s):t.effects.push(s):$y(s)}const ys=Symbol.for("v-fgt"),Yh=Symbol.for("v-txt"),Gi=Symbol.for("v-cmt"),ia=Symbol.for("v-stc"),ra=[];let Ls=null;function ie(s=!1){ra.push(Ls=s?null:[])}function II(){ra.pop(),Ls=ra[ra.length-1]||null}let va=1;function cg(s,t=!1){va+=s,s<0&&Ls&&t&&(Ls.hasOnce=!0)}function xb(s){return s.dynamicChildren=va>0?Ls||oo:null,II(),va>0&&Ls&&Ls.push(s),s}function Re(s,t,e,n,i,r){return xb(In(s,t,e,n,i,r,!0))}function yo(s,t,e,n,i){return xb(Nt(s,t,e,n,i,!0))}function Kf(s){return s?s.__v_isVNode===!0:!1}function No(s,t){return s.type===t.type&&s.key===t.key}const yb=({key:s})=>s??null,xl=({ref:s,ref_key:t,ref_for:e})=>(typeof s=="number"&&(s=""+s),s!=null?Pe(s)||as(s)||kt(s)?{i:He,r:s,k:t,f:!!e}:s:null);function In(s,t=null,e=null,n=0,i=null,r=s===ys?0:1,a=!1,l=!1){const o={__v_isVNode:!0,__v_skip:!0,type:s,props:t,key:t&&yb(t),ref:t&&xl(t),scopeId:Hy,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:He};return l?(Zf(o,e),r&128&&s.normalize(o)):e&&(o.shapeFlag|=Pe(e)?8:16),va>0&&!a&&Ls&&(o.patchFlag>0||r&6)&&o.patchFlag!==32&&Ls.push(o),o}const Nt=RI;function RI(s,t=null,e=null,n=0,i=null,r=!1){if((!s||s===JM)&&(s=Gi),Kf(s)){const l=bo(s,t,!0);return e&&Zf(l,e),va>0&&!r&&Ls&&(l.shapeFlag&6?Ls[Ls.indexOf(s)]=l:Ls.push(l)),l.patchFlag=-2,l}if(YI(s)&&(s=s.__vccOpts),t){t=PI(t);let{class:l,style:o}=t;l&&!Pe(l)&&(t.class=re(l)),ge(o)&&(Yf(o)&&!It(o)&&(o=ts({},o)),t.style=Df(o))}const a=Pe(s)?1:gb(s)?128:YM(s)?64:ge(s)?4:kt(s)?2:0;return In(s,t,e,n,i,a,r,!0)}function PI(s){return s?Yf(s)||ib(s)?ts({},s):s:null}function bo(s,t,e=!1,n=!1){const{props:i,ref:r,patchFlag:a,children:l,transition:o}=s,h=t?kI(i||{},t):i,c={__v_isVNode:!0,__v_skip:!0,type:s.type,props:h,key:h&&yb(h),ref:t&&t.ref?e&&r?It(r)?r.concat(xl(t)):[r,xl(t)]:xl(t):r,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:l,target:s.target,targetStart:s.targetStart,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:t&&s.type!==ys?a===-1?16:a|16:a,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:o,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&bo(s.ssContent),ssFallback:s.ssFallback&&bo(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return o&&n&&Gf(c,o.clone(c)),c}function Js(s=" ",t=0){return Nt(Yh,null,s,t)}function Ki(s,t){const e=Nt(ia,null,s);return e.staticCount=t,e}function bb(s="",t=!1){return t?(ie(),yo(Gi,null,s)):Nt(Gi,null,s)}function jn(s){return s==null||typeof s=="boolean"?Nt(Gi):It(s)?Nt(ys,null,s.slice()):Kf(s)?Fi(s):Nt(Yh,null,String(s))}function Fi(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:bo(s)}function Zf(s,t){let e=0;const{shapeFlag:n}=s;if(t==null)t=null;else if(It(t))e=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),Zf(s,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!ib(t)?t._ctx=He:i===3&&He&&(He.slots._===1?t._=1:(t._=2,s.patchFlag|=1024))}else kt(t)?(t={default:t,_ctx:He},e=32):(t=String(t),n&64?(e=16,t=[Js(t)]):e=8);s.children=t,s.shapeFlag|=e}function kI(...s){const t={};for(let e=0;e<s.length;e++){const n=s[e];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=re([t.class,n.class]));else if(i==="style")t.style=Df([t.style,n.style]);else if(Fh(i)){const r=t[i],a=n[i];a&&r!==a&&!(It(r)&&r.includes(a))&&(t[i]=r?[].concat(r,a):a)}else i!==""&&(t[i]=n[i])}return t}function Vn(s,t,e,n=null){Jn(s,t,7,[e,n])}const FI=eb();let DI=0;function BI(s,t,e){const n=s.type,i=(t?t.appContext:s.appContext)||FI,r={uid:DI++,vnode:s,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new hM(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ob(n,i),emitsOptions:pb(n,i),emit:null,emitted:null,propsDefaults:ee,inheritAttrs:n.inheritAttrs,ctx:ee,data:ee,props:ee,attrs:ee,slots:ee,refs:ee,setupState:ee,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=EI.bind(null,r),s.ce&&s.ce(r),r}let Ze=null;const OI=()=>Ze||He;let ql,id;{const s=Nh(),t=(e,n)=>{let i;return(i=s[e])||(i=s[e]=[]),i.push(n),r=>{i.length>1?i.forEach(a=>a(r)):i[0](r)}};ql=t("__VUE_INSTANCE_SETTERS__",e=>Ze=e),id=t("__VUE_SSR_SETTERS__",e=>wa=e)}const Pa=s=>{const t=Ze;return ql(s),s.scope.on(),()=>{s.scope.off(),ql(t)}},ug=()=>{Ze&&Ze.scope.off(),ql(null)};function vb(s){return s.vnode.shapeFlag&4}let wa=!1;function NI(s,t=!1,e=!1){t&&id(t);const{props:n,children:i}=s.vnode,r=vb(s);hI(s,n,r,t),fI(s,i,e);const a=r?LI(s,t):void 0;return t&&id(!1),a}function LI(s,t){const e=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,tI);const{setup:n}=e;if(n){ji();const i=s.setupContext=n.length>1?UI(s):null,r=Pa(s),a=Ra(n,s,0,[s.props,i]),l=yy(a);if(qi(),r(),(l||s.sp)&&!co(s)&&zy(s),l){if(a.then(ug,ug),t)return a.then(o=>{dg(s,o,t)}).catch(o=>{Vh(o,s,0)});s.asyncDep=a}else dg(s,a,t)}else wb(s,t)}function dg(s,t,e){kt(t)?s.type.__ssrInlineRender?s.ssrRender=t:s.render=t:ge(t)&&(s.setupState=Uy(t)),wb(s,e)}let fg;function wb(s,t,e){const n=s.type;if(!s.render){if(!t&&fg&&!n.render){const i=n.template||jf(s).template;if(i){const{isCustomElement:r,compilerOptions:a}=s.appContext.config,{delimiters:l,compilerOptions:o}=n,h=ts(ts({isCustomElement:r,delimiters:l},a),o);n.render=fg(i,h)}}s.render=n.render||qs}{const i=Pa(s);ji();try{eI(s)}finally{qi(),i()}}}const VI={get(s,t){return is(s,"get",""),s[t]}};function UI(s){const t=e=>{s.exposed=e||{}};return{attrs:new Proxy(s.attrs,VI),slots:s.slots,emit:s.emit,expose:t}}function $h(s){return s.exposed?s.exposeProxy||(s.exposeProxy=new Proxy(Uy(RM(s.exposed)),{get(t,e){if(e in t)return t[e];if(e in na)return na[e](s)},has(t,e){return e in t||e in na}})):s.proxy}function XI(s,t=!0){return kt(s)?s.displayName||s.name:s.name||t&&s.__name}function YI(s){return kt(s)&&"__vccOpts"in s}const _b=(s,t)=>OM(s,t,wa),$I="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rd;const mg=typeof window<"u"&&window.trustedTypes;if(mg)try{rd=mg.createPolicy("vue",{createHTML:s=>s})}catch{}const Eb=rd?s=>rd.createHTML(s):s=>s,GI="http://www.w3.org/2000/svg",WI="http://www.w3.org/1998/Math/MathML",ui=typeof document<"u"?document:null,pg=ui&&ui.createElement("template"),HI={insert:(s,t,e)=>{t.insertBefore(s,e||null)},remove:s=>{const t=s.parentNode;t&&t.removeChild(s)},createElement:(s,t,e,n)=>{const i=t==="svg"?ui.createElementNS(GI,s):t==="mathml"?ui.createElementNS(WI,s):e?ui.createElement(s,{is:e}):ui.createElement(s);return s==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:s=>ui.createTextNode(s),createComment:s=>ui.createComment(s),setText:(s,t)=>{s.nodeValue=t},setElementText:(s,t)=>{s.textContent=t},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>ui.querySelector(s),setScopeId(s,t){s.setAttribute(t,"")},insertStaticContent(s,t,e,n,i,r){const a=e?e.previousSibling:t.lastChild;if(i&&(i===r||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),e),!(i===r||!(i=i.nextSibling)););else{pg.innerHTML=Eb(n==="svg"?`<svg>${s}</svg>`:n==="mathml"?`<math>${s}</math>`:s);const l=pg.content;if(n==="svg"||n==="mathml"){const o=l.firstChild;for(;o.firstChild;)l.appendChild(o.firstChild);l.removeChild(o)}t.insertBefore(l,e)}return[a?a.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},zI=Symbol("_vtc");function jI(s,t,e){const n=s[zI];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?s.removeAttribute("class"):e?s.setAttribute("class",t):s.className=t}const Kl=Symbol("_vod"),Sb=Symbol("_vsh"),Zl={beforeMount(s,{value:t},{transition:e}){s[Kl]=s.style.display==="none"?"":s.style.display,e&&t?e.beforeEnter(s):Lo(s,t)},mounted(s,{value:t},{transition:e}){e&&t&&e.enter(s)},updated(s,{value:t,oldValue:e},{transition:n}){!t!=!e&&(n?t?(n.beforeEnter(s),Lo(s,!0),n.enter(s)):n.leave(s,()=>{Lo(s,!1)}):Lo(s,t))},beforeUnmount(s,{value:t}){Lo(s,t)}};function Lo(s,t){s.style.display=t?s[Kl]:"none",s[Sb]=!t}const Tb=Symbol("");function Jf(s){const t=OI();if(!t)return;const e=t.ut=(i=s(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(r=>Jl(r,i))},n=()=>{const i=s(t.proxy);t.ce?Jl(t.ce,i):od(t.subTree,i),e(i)};Ky(()=>{$y(n)}),Wf(()=>{fo(n,qs,{flush:"post"});const i=new MutationObserver(n);i.observe(t.subTree.el.parentNode,{childList:!0}),Hf(()=>i.disconnect())})}function od(s,t){if(s.shapeFlag&128){const e=s.suspense;s=e.activeBranch,e.pendingBranch&&!e.isHydrating&&e.effects.push(()=>{od(e.activeBranch,t)})}for(;s.component;)s=s.component.subTree;if(s.shapeFlag&1&&s.el)Jl(s.el,t);else if(s.type===ys)s.children.forEach(e=>od(e,t));else if(s.type===ia){let{el:e,anchor:n}=s;for(;e&&(Jl(e,t),e!==n);)e=e.nextSibling}}function Jl(s,t){if(s.nodeType===1){const e=s.style;let n="";for(const i in t)e.setProperty(`--${i}`,t[i]),n+=`--${i}: ${t[i]};`;e[Tb]=n}}const qI=/(^|;)\s*display\s*:/;function KI(s,t,e){const n=s.style,i=Pe(e);let r=!1;if(e&&!i){if(t)if(Pe(t))for(const a of t.split(";")){const l=a.slice(0,a.indexOf(":")).trim();e[l]==null&&yl(n,l,"")}else for(const a in t)e[a]==null&&yl(n,a,"");for(const a in e)a==="display"&&(r=!0),yl(n,a,e[a])}else if(i){if(t!==e){const a=n[Tb];a&&(e+=";"+a),n.cssText=e,r=qI.test(e)}}else t&&s.removeAttribute("style");Kl in s&&(s[Kl]=r?n.display:"",s[Sb]&&(n.display="none"))}const gg=/\s*!important$/;function yl(s,t,e){if(It(e))e.forEach(n=>yl(s,t,n));else if(e==null&&(e=""),t.startsWith("--"))s.setProperty(t,e);else{const n=ZI(s,t);gg.test(e)?s.setProperty(Rr(n),e.replace(gg,""),"important"):s[n]=e}}const xg=["Webkit","Moz","ms"],jc={};function ZI(s,t){const e=jc[t];if(e)return e;let n=en(t);if(n!=="filter"&&n in s)return jc[t]=n;n=Oh(n);for(let i=0;i<xg.length;i++){const r=xg[i]+n;if(r in s)return jc[t]=r}return t}const yg="http://www.w3.org/1999/xlink";function bg(s,t,e,n,i,r=lM(t)){n&&t.startsWith("xlink:")?e==null?s.removeAttributeNS(yg,t.slice(6,t.length)):s.setAttributeNS(yg,t,e):e==null||r&&!_y(e)?s.removeAttribute(t):s.setAttribute(t,r?"":_i(e)?String(e):e)}function vg(s,t,e,n,i){if(t==="innerHTML"||t==="textContent"){e!=null&&(s[t]=t==="innerHTML"?Eb(e):e);return}const r=s.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?s.getAttribute("value")||"":s.value,o=e==null?s.type==="checkbox"?"on":"":String(e);(l!==o||!("_value"in s))&&(s.value=o),e==null&&s.removeAttribute(t),s._value=e;return}let a=!1;if(e===""||e==null){const l=typeof s[t];l==="boolean"?e=_y(e):e==null&&l==="string"?(e="",a=!0):l==="number"&&(e=0,a=!0)}try{s[t]=e}catch{}a&&s.removeAttribute(i||t)}function JI(s,t,e,n){s.addEventListener(t,e,n)}function QI(s,t,e,n){s.removeEventListener(t,e,n)}const wg=Symbol("_vei");function tR(s,t,e,n,i=null){const r=s[wg]||(s[wg]={}),a=r[t];if(n&&a)a.value=n;else{const[l,o]=eR(t);if(n){const h=r[t]=iR(n,i);JI(s,l,h,o)}else a&&(QI(s,l,a,o),r[t]=void 0)}}const _g=/(?:Once|Passive|Capture)$/;function eR(s){let t;if(_g.test(s)){t={};let n;for(;n=s.match(_g);)s=s.slice(0,s.length-n[0].length),t[n[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):Rr(s.slice(2)),t]}let qc=0;const sR=Promise.resolve(),nR=()=>qc||(sR.then(()=>qc=0),qc=Date.now());function iR(s,t){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;Jn(rR(n,e.value),t,5,[n])};return e.value=s,e.attached=nR(),e}function rR(s,t){if(It(t)){const e=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{e.call(s),s._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const Eg=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,oR=(s,t,e,n,i,r)=>{const a=i==="svg";t==="class"?jI(s,n,a):t==="style"?KI(s,e,n):Fh(t)?Pf(t)||tR(s,t,e,n,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):aR(s,t,n,a))?(vg(s,t,n),!s.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&bg(s,t,n,a,r,t!=="value")):s._isVueCE&&(/[A-Z]/.test(t)||!Pe(n))?vg(s,en(t),n,r,t):(t==="true-value"?s._trueValue=n:t==="false-value"&&(s._falseValue=n),bg(s,t,n,a))};function aR(s,t,e,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in s&&Eg(t)&&kt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&s.tagName==="INPUT"||t==="type"&&s.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=s.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Eg(t)&&Pe(e)?!1:t in s}const lR=ts({patchProp:oR},HI);let Sg;function hR(){return Sg||(Sg=pI(lR))}const cR=(...s)=>{const t=hR().createApp(...s),{mount:e}=t;return t.mount=n=>{const i=dR(n);if(!i)return;const r=t._component;!kt(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=e(i,!1,uR(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t};function uR(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function dR(s){return Pe(s)?document.querySelector(s):s}const es=(s,t)=>{const e=s.__vccOpts||s;for(const[n,i]of t)e[n]=i;return e},fR={class:"body",ref:"body"},mR={__name:"TextField",props:{maximalWidth:Number,maximalHeight:Number,layoutX:String,layoutY:String,padding:{type:Number,default:0}},setup(s){Jf(i=>({cc0183e6:s.maximalWidth,e7ccec80:s.maximalHeight}));const t=te(null),e=s;function n(){const i=t.value,{clientWidth:r,clientHeight:a}=i,{maximalWidth:l,maximalHeight:o,padding:h}=e,c=Math.min(1,(l-h*2)/r),d=Math.min(1,o/a),u=Math.min(c,d),f=l-r*u,m=o-a*u,p=e.layoutX??"left",g=e.layoutY??"top";let v,b;switch(p){case"left":v=0;break;case"center":v=f/2;break;case"right":v=f;break}switch(g){case"top":b=0;break;case"middle":b=m/2;break;case"bottom":b=m;break}i.style.transform=`
		  scaleX(${u})
		  scaleY(${u})`,i.style.left=v+"px",i.style.top=b+"px"}return Zy(()=>{Gl(n())}),Wf(()=>{Gl(n())}),(i,r)=>(ie(),Re("div",fR,[In("div",{class:"content-container",ref_key:"contentContainer",ref:t},[zf(i.$slots,"default",{},void 0,!0)],512)],512))}},Qs=es(mR,[["__scopeId","data-v-4b8517a4"]]);const pR={class:"background"},gR={__name:"Indicator",props:{width:Number,textFieldWidth:Number,indicatorValue:String|Number,captionText:String},setup(s){Jf(n=>({"64c92b69":s.width+"px","75b7cffa":e.value,"0b27d882":s.captionText?"17px":"30px","375ef760":s.captionText?"0px":"-5px"}));const t=s,e=_b(()=>(t.width-t.textFieldWidth)/2+"px");return(n,i)=>(ie(),Re("div",pR,[Nt(Qs,{class:"value text-field",layoutX:"center",layoutY:"middle",maximalWidth:s.textFieldWidth,maximalHeight:s.captionText?30:60},{default:Ms(()=>[Js(Ks(s.indicatorValue),1)]),_:1},8,["maximalWidth","maximalHeight"]),Hl(Nt(Qs,{class:"caption text-field",layoutX:"center",layoutY:"middle",maximalWidth:s.textFieldWidth,maximalHeight:30},{default:Ms(()=>[Js(Ks(s.captionText),1)]),_:1},8,["maximalWidth"]),[[Zl,s.captionText]]),zf(n.$slots,"default",{},void 0,!0)]))}},Ab=es(gR,[["__scopeId","data-v-c983c49c"]]);const xR={__name:"Selector",props:{isDecorated:{type:Boolean,default:!0},selectableValues:{type:Array,default:[]},captionText:String,indicatorValue:String,initialIndex:{type:Number,default:0}},emits:["selected"],setup(s,{expose:t,emit:e}){const n=e,i=s,r=te(i.initialIndex);function a(){r.value=Math.max(0,r.value-1),n("selected",r.value)}function l(){r.value=Math.min(i.selectableValues.length-1,r.value+1),n("selected",r.value)}function o(h){r.value=h??0}return t({setSelectedIndex:o}),(h,c)=>(ie(),yo(Ab,{id:"betSelector",width:150,captionText:s.captionText,indicatorValue:s.selectableValues[r.value]},{default:Ms(()=>[Hl(In("div",{class:re([{disabled:!r.value},"button left"]),onClick:a}," - ",2),[[Zl,s.isDecorated]]),Hl(In("div",{class:re([{disabled:r.value>=s.selectableValues.length-1},"button right"]),onClick:l}," + ",2),[[Zl,s.isDecorated]])]),_:1},8,["captionText","indicatorValue"]))}},ad=es(xR,[["__scopeId","data-v-468437f5"]]);const yR={__name:"FPSLabel",props:{FPS:Number},setup(s){const t=s;return(e,n)=>(ie(),yo(Qs,{class:"text-field",layoutX:"left",layoutY:"middle",maximalWidth:100,maximalHeight:30},{default:Ms(()=>[Js(Ks("FPS: "+t.FPS),1)]),_:1}))}},bR=es(yR,[["__scopeId","data-v-13317247"]]);const vR={},wR={class:"blurred-background"};function _R(s,t){return ie(),Re("div",wR)}const ER=es(vR,[["render",_R],["__scopeId","data-v-cf3c4f12"]]);const SR={},TR={class:"body"};function AR(s,t){return ie(),Re("div",TR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-f3c89a58><g class="svg-group enable-pointer-events" data-v-f3c89a58><g id="spin-idle" data-v-f3c89a58><linearGradient id="SVGID_00000086649923314100413310000001055583291564839097_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-f3c89a58><stop offset="0.162" stop-color="#474747" data-v-f3c89a58></stop><stop offset="0.462" stop-color="#383838" data-v-f3c89a58></stop><stop offset="1" stop-color="#141414" data-v-f3c89a58></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000086649923314100413310000001055583291564839097_)" data-v-f3c89a58></circle><linearGradient id="SVGID_00000105426574504272220740000010344533675462339208_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-f3c89a58><stop offset="0" stop-color="#383838" data-v-f3c89a58></stop><stop offset="0.097" stop-color="#2A2A2A" data-v-f3c89a58></stop><stop offset="0.24" stop-color="#1F1F1F" data-v-f3c89a58></stop><stop offset="0.441" stop-color="#181818" data-v-f3c89a58></stop><stop offset="1" stop-color="#161616" data-v-f3c89a58></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000105426574504272220740000010344533675462339208_)" data-v-f3c89a58></circle><path fill="currentColor" d="M152.8 216.1c-36.3 0-65.7-29.4-65.7-65.5s29.5-65.5 65.7-65.5c2.4 0 4.8.1 7.3.4V74.9c0-1.4.8-2.6 2.1-3.1s2.7-.2 3.7.8l23.3 23.3c1.3 1.3 1.3 3.4 0 4.8L165.9 124c-1 1-2.4 1.3-3.7.7-1.2-.5-2.1-1.8-2.1-3.1v-11.7c-2.4-.4-4.8-.6-7.3-.6-23 0-41.7 18.6-41.7 41.5s18.7 41.5 41.7 41.5 41.6-18.6 41.6-41.5c0-1.9 1.5-3.4 3.4-3.4h17.3c1.9 0 3.4 1.5 3.4 3.4.1 35.9-29.4 65.3-65.7 65.3z" class="st2" data-v-f3c89a58></path></g></g></svg>',1)]))}const CR=es(SR,[["render",AR],["__scopeId","data-v-f3c89a58"]]);const MR={},IR={class:"body"};function RR(s,t){return ie(),Re("div",IR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-dab11123><g class="svg-group disabled" data-v-dab11123><g id="skip-disabled-idle" data-v-dab11123><linearGradient id="SVGID_00000005228982790153751770000011151094881168385934_" x1="-2985.818" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-dab11123><stop offset="0.162" stop-color="#474747" data-v-dab11123></stop><stop offset="0.462" stop-color="#383838" data-v-dab11123></stop><stop offset="1" stop-color="#141414" data-v-dab11123></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000005228982790153751770000011151094881168385934_)" data-v-dab11123></circle><linearGradient id="SVGID_00000027563328299601542920000006710843592585583240_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-dab11123><stop offset="0" stop-color="#474747" data-v-dab11123></stop><stop offset="0.109" stop-color="#3D3D3D" data-v-dab11123></stop><stop offset="0.456" stop-color="#222" data-v-dab11123></stop><stop offset="0.764" stop-color="#121212" data-v-dab11123></stop><stop offset="1" stop-color="#0C0C0C" data-v-dab11123></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000027563328299601542920000006710843592585583240_)" data-v-dab11123></circle><path fill="currentColor" d="M203.3 209.1H102.7c-5.5 0-10-4.5-10-10V98.9c0-5.5 4.5-10 10-10h100.5c5.5 0 10 4.5 10 10V199c.1 5.6-4.4 10.1-9.9 10.1z" class="st24" data-v-dab11123></path></g></g></svg>',1)]))}const PR=es(MR,[["render",RR],["__scopeId","data-v-dab11123"]]);const kR={},FR={class:"body"};function DR(s,t){return ie(),Re("div",FR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-d658200b><g class="svg-group enable-pointer-events" data-v-d658200b><g id="spin-idle" data-v-d658200b><linearGradient id="SVGID_00000086649923314100413310000001055583291564839097_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-d658200b><stop offset="0.162" stop-color="#474747" data-v-d658200b></stop><stop offset="0.462" stop-color="#383838" data-v-d658200b></stop><stop offset="1" stop-color="#141414" data-v-d658200b></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000086649923314100413310000001055583291564839097_)" data-v-d658200b></circle><linearGradient id="SVGID_00000105426574504272220740000010344533675462339208_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-d658200b><stop offset="0" stop-color="#383838" data-v-d658200b></stop><stop offset="0.097" stop-color="#2A2A2A" data-v-d658200b></stop><stop offset="0.24" stop-color="#1F1F1F" data-v-d658200b></stop><stop offset="0.441" stop-color="#181818" data-v-d658200b></stop><stop offset="1" stop-color="#161616" data-v-d658200b></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000105426574504272220740000010344533675462339208_)" data-v-d658200b></circle><path fill="currentColor" d="M207.1 186H96.5c-7.6 0-13.8 5.7-13.8 12.8s6.2 12.8 13.8 12.8h110.6c7.6 0 13.8-5.7 13.8-12.8 0-7-6.2-12.8-13.8-12.8zM207.1 136.4H96.5c-7.6 0-13.8 5.7-13.8 12.8S88.9 162 96.5 162h110.6c7.6 0 13.8-5.7 13.8-12.8s-6.2-12.8-13.8-12.8zM96.5 111.5h110.6c7.6 0 13.8-5.7 13.8-12.8 0-7.1-6.2-12.8-13.8-12.8H96.5c-7.6 0-13.8 5.7-13.8 12.8 0 7 6.2 12.8 13.8 12.8z" class="st2" data-v-d658200b></path></g></g></svg>',1)]))}const BR=es(kR,[["render",DR],["__scopeId","data-v-d658200b"]]);const OR={},NR={class:"body"};function LR(s,t){return ie(),Re("div",NR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-054f7bb4><g class="svg-group enable-pointer-events" data-v-054f7bb4><g id="quickspin-idle" data-v-054f7bb4><linearGradient id="SVGID_00000042000721181014424560000004377510033180362113_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-054f7bb4><stop offset="0.162" stop-color="#474747" data-v-054f7bb4></stop><stop offset="0.462" stop-color="#383838" data-v-054f7bb4></stop><stop offset="1" stop-color="#141414" data-v-054f7bb4></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000042000721181014424560000004377510033180362113_)" data-v-054f7bb4></circle><linearGradient id="SVGID_00000174597296389607395020000015731590267940817049_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-054f7bb4><stop offset="0" stop-color="#474747" data-v-054f7bb4></stop><stop offset="0.109" stop-color="#3D3D3D" data-v-054f7bb4></stop><stop offset="0.456" stop-color="#222" data-v-054f7bb4></stop><stop offset="0.764" stop-color="#121212" data-v-054f7bb4></stop><stop offset="1" stop-color="#0C0C0C" data-v-054f7bb4></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000174597296389607395020000015731590267940817049_)" data-v-054f7bb4></circle><path fill="currentColor" d="M224.3 139.9l-42.5-35.1c-5.1-4.2-12.3-5-18.4-2.2-5.4 2.6-8.7 7.6-8.7 13.2v21.6l-39.5-32.7c-5.1-4.2-12.3-5-18.4-2.2-5.4 2.6-8.7 7.6-8.7 13.2v70.2c0 5.6 3.4 10.7 8.7 13.2 2.4 1.1 5 1.7 7.6 1.7 3.9 0 7.8-1.3 10.9-3.9l39.5-32.6v21.6c0 5.6 3.4 10.7 8.7 13.2 2.4 1.1 5 1.7 7.6 1.7 3.9 0 7.8-1.3 10.9-3.9l42.5-35.1c3.4-2.8 5.4-6.8 5.4-11.1-.2-4-2.2-8-5.6-10.8z" class="st2" data-v-054f7bb4></path></g></g></svg>',1)]))}const VR=es(OR,[["render",LR],["__scopeId","data-v-054f7bb4"]]);const UR={},XR={class:"body"};function YR(s,t){return ie(),Re("div",XR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-05d31d17><g class="svg-group enable-pointer-events" data-v-05d31d17><g id="bet-idle" data-v-05d31d17><linearGradient id="SVGID_00000021089692665929812050000010742534780091589055_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-05d31d17><stop offset="0.162" stop-color="#474747" data-v-05d31d17></stop><stop offset="0.462" stop-color="#383838" data-v-05d31d17></stop><stop offset="1" stop-color="#141414" data-v-05d31d17></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000021089692665929812050000010742534780091589055_)" data-v-05d31d17></circle><linearGradient id="SVGID_00000091011380694620307850000004856209860762763686_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-05d31d17><stop offset="0" stop-color="#474747" data-v-05d31d17></stop><stop offset="0.109" stop-color="#3D3D3D" data-v-05d31d17></stop><stop offset="0.456" stop-color="#222" data-v-05d31d17></stop><stop offset="0.764" stop-color="#121212" data-v-05d31d17></stop><stop offset="1" stop-color="#0C0C0C" data-v-05d31d17></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000091011380694620307850000004856209860762763686_)" data-v-05d31d17></circle><path fill="currentColor" d="M134.7 81.4c-22.8 0-39.9 9.7-39.9 22.8s17.1 22.8 39.9 22.8 39.9-9.7 39.9-22.8-17.1-22.8-39.9-22.8z" class="st2" data-v-05d31d17></path><path fill="currentColor" d="M134.7 138.5c-16.5 0-30.8-4.6-39.9-12v6.3c0 13.1 17.1 22.8 39.9 22.8s39.9-9.7 39.9-22.8v-6.3c-9.1 7.4-23.4 12-39.9 12z" class="st2" data-v-05d31d17></path><path fill="currentColor" d="M134.7 167c-16.5 0-30.8-4.6-39.9-12v6.3c0 13.1 17.1 22.8 39.9 22.8s39.9-9.7 39.9-22.8V155c-9.1 7.4-23.4 12-39.9 12z" class="st2" data-v-05d31d17></path><path fill="currentColor" d="M134.7 195.5c-16.5 0-30.8-4.6-39.9-12v6.3c0 13.1 17.1 22.8 39.9 22.8s39.9-9.7 39.9-22.8v-6.3c-9.1 7.4-23.4 12-39.9 12zM191.7 178.4H186v17.1h5.7c22.8 0 39.9-9.7 39.9-22.8v-6.3c-9.1 7.4-23.3 12-39.9 12zM191.7 121.3H186V167h5.7c22.8 0 39.9-9.7 39.9-22.8s-17.1-22.9-39.9-22.9z" class="st2" data-v-05d31d17></path></g></g></svg>',1)]))}const $R=es(UR,[["render",YR],["__scopeId","data-v-05d31d17"]]);const GR={},WR={class:"body"};function HR(s,t){return ie(),Re("div",WR,t[0]||(t[0]=[Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-58be78aa><g class="svg-group enable-pointer-events" data-v-58be78aa><g id="autoplay-idle" data-v-58be78aa><linearGradient id="SVGID_00000013890713939924517410000012163221973519894410_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-58be78aa><stop offset="0.162" stop-color="#474747" data-v-58be78aa></stop><stop offset="0.462" stop-color="#383838" data-v-58be78aa></stop><stop offset="1" stop-color="#141414" data-v-58be78aa></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000013890713939924517410000012163221973519894410_)" data-v-58be78aa></circle><linearGradient id="SVGID_00000008870057243538626970000004548477235010329005_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-58be78aa><stop offset="0" stop-color="#474747" data-v-58be78aa></stop><stop offset="0.109" stop-color="#3D3D3D" data-v-58be78aa></stop><stop offset="0.456" stop-color="#222" data-v-58be78aa></stop><stop offset="0.764" stop-color="#121212" data-v-58be78aa></stop><stop offset="1" stop-color="#0C0C0C" data-v-58be78aa></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000008870057243538626970000004548477235010329005_)" data-v-58be78aa></circle><path fill="currentColor" d="M137.6 203.6c-2.8 0-5.6-.6-8.3-1.8-5.9-2.8-9.6-8.3-9.6-14.4v-76.7c0-6.1 3.7-11.6 9.6-14.4 6.7-3.1 14.6-2.2 20.2 2.4l46.6 38.3c3.7 3.1 5.9 7.5 5.9 12.1s-2.1 9-5.9 12.1l-46.6 38.3c-3.3 2.7-7.6 4.1-11.9 4.1z" class="st2" data-v-58be78aa></path></g><g class="spin-number-g" data-v-58be78aa><text class="spin-number-text" x="50%" y="50%" text-anchor="middle" data-v-58be78aa></text></g></g></svg>',1)]))}const zR=es(GR,[["render",HR],["__scopeId","data-v-58be78aa"]]);const jR={class:"body"},qR={__name:"ButtonStopAuto",setup(s){return(t,e)=>(ie(),Re("div",jR,[e[0]||(e[0]=Ki('<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" viewBox="0 0 300 300" xml:space="preserve" data-v-068d889f><g class="svg-group enable-pointer-events" data-v-068d889f><g id="autoplay-idle" data-v-068d889f><linearGradient id="SVGID_00000013890713939924517410000012163221973519894410_" x1="-2985.817" x2="-2657.354" y1="-4896.724" y2="-4896.724" gradientTransform="rotate(95.258 -3639.152 -1016.647) scale(1.00001)" gradientUnits="userSpaceOnUse" data-v-068d889f><stop offset="0.162" stop-color="#474747" data-v-068d889f></stop><stop offset="0.462" stop-color="#383838" data-v-068d889f></stop><stop offset="1" stop-color="#141414" data-v-068d889f></stop></linearGradient><circle cx="150" cy="150" r="149.5" fill="url(#SVGID_00000013890713939924517410000012163221973519894410_)" data-v-068d889f></circle><linearGradient id="SVGID_00000008870057243538626970000004548477235010329005_" x1="-7289.62" x2="-6980.939" y1="4954.616" y2="4954.616" gradientTransform="rotate(-91.208 -5846.359 -1015.712) scale(1.00002)" gradientUnits="userSpaceOnUse" data-v-068d889f><stop offset="0" stop-color="#474747" data-v-068d889f></stop><stop offset="0.109" stop-color="#3D3D3D" data-v-068d889f></stop><stop offset="0.456" stop-color="#222" data-v-068d889f></stop><stop offset="0.764" stop-color="#121212" data-v-068d889f></stop><stop offset="1" stop-color="#0C0C0C" data-v-068d889f></stop></linearGradient><circle cx="150" cy="150" r="140.5" fill="url(#SVGID_00000008870057243538626970000004548477235010329005_)" data-v-068d889f></circle></g><g class="spin-number-g" data-v-068d889f><text class="spin-number-text" x="50%" y="50%" text-anchor="middle" data-v-068d889f></text></g></g></svg>',1)),Nt(Qs,{class:"text-field",layoutX:"center",layoutY:"middle",maximalWidth:50,maximalHeight:50},{default:Ms(()=>[zf(t.$slots,"default",{},void 0,!0)]),_:3})]))}},KR=es(qR,[["__scopeId","data-v-068d889f"]]);const ZR={},JR={class:"body"};function QR(s,t){return ie(),Re("div",JR)}const tP=es(ZR,[["render",QR],["__scopeId","data-v-71a47e8b"]]);const eP={__name:"PopupError",props:{messageText:String,buttonText:String},emits:["close"],setup(s,{emit:t}){const e=t;return(n,i)=>(ie(),Re("div",null,[i[1]||(i[1]=In("div",{class:"body-background"},null,-1)),Nt(Qs,{class:"message-text",maximalWidth:250,maximalHeight:40,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.messageText),1)]),_:1}),Nt(Qs,{onClick:i[0]||(i[0]=r=>e("close")),class:"button",maximalWidth:80,maximalHeight:40,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.buttonText),1)]),_:1})]))}},sP=es(eP,[["__scopeId","data-v-0f8a0860"]]);const nP={__name:"PopupSelector",props:{isSimplifiedMode:Boolean,messageText:String,buttonText:String,selectorIndex:Number,selectorCaptionText:String,selectableValues:Array,selectableCaptionValues:{type:Array,default:[]},selectorIndex2:Number,selectorCaptionText2:String,selectableValues2:Array,selectableCaptionValues2:{type:Array,default:[]}},emits:["confirm","close","selected","selected2"],setup(s,{expose:t,emit:e}){const n=te(0),i=te(0),r=e,a=te(null),l=te(null);function o(u){n.value=u,r("selected",u)}function h(u){i.value=u,r("selected2",u)}function c(u){n.value=u??0,a.value.setSelectedIndex(u)}function d(u){i.value=u??0,l.value.setSelectedIndex(u)}return t({setSelectedIndex:c,setSelectedIndex2:d}),(u,f)=>(ie(),Re("div",null,[f[4]||(f[4]=In("div",{class:"body-background"},null,-1)),Nt(Qs,{class:re(["message-text",{centralHeader:!s.selectableValues2}]),maximalWidth:s.selectableValues2?200:250,maximalHeight:20,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.messageText),1)]),_:1},8,["class","maximalWidth"]),Nt(Qs,{onClick:f[0]||(f[0]=m=>r("confirm",n.value)),class:"button",maximalWidth:110,maximalHeight:30,layoutX:"center",layoutY:"middle",padding:10},{default:Ms(()=>[Js(Ks(s.buttonText),1)]),_:1}),Nt(ad,{ref_key:"selector",ref:a,class:re(["decorated selector",{centralSelector:!s.selectableValues2}]),onSelected:f[1]||(f[1]=m=>o(m)),isDecorated:!s.isSimplifiedMode,width:200,textFieldWidth:100,selectableValues:s.selectableValues,captionText:s.selectorCaptionText??s.selectableCaptionValues[n.value]},null,8,["class","isDecorated","selectableValues","captionText"]),s.selectableValues2?(ie(),yo(ad,{key:0,ref_key:"selector2",ref:l,class:"decorated selector2",onSelected:f[2]||(f[2]=m=>h(m)),isDecorated:!s.isSimplifiedMode,width:200,textFieldWidth:100,selectableValues:s.selectableValues2,captionText:s.selectorCaptionText2??s.selectableCaptionValues2[n.value]},null,8,["isDecorated","selectableValues","captionText"])):bb("",!0),In("div",{onClick:f[3]||(f[3]=m=>r("close")),class:"button-close"},"  ")]))}},iP=es(nP,[["__scopeId","data-v-3a979bd8"]]);const rP={class:"reels"},oP={class:re({"symbol-selector-column":!0}),style:{top:"0px"}},aP=["onChange"],lP={key:0,value:"1"},hP={__name:"CheatScreen",props:{messageText:String,instructionText:String,buttonText:String},emits:["confirm","close"],setup(s,{emit:t}){const e=t,n=new Array(As).fill(0).map((o,h)=>new Array(De).fill(2)),i=te(As),r=te([0,7,7,7,7,7,7,7]);function a({e:o,x:h,y:c}){const{options:d}=o.target,u=Number(d[d.selectedIndex].value);n[h][c]=u}function l(){e("confirm",{reels:n})}return(o,h)=>(ie(),Re("div",null,[h[3]||(h[3]=In("div",{class:"body-background"},null,-1)),Nt(Qs,{class:"message-text",maximalWidth:220,maximalHeight:20,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.messageText),1)]),_:1}),In("div",rP,[(ie(!0),Re(ys,null,sg(i.value+1,c=>(ie(),Re("div",oP,[(ie(!0),Re(ys,null,sg(r.value[c],d=>(ie(),Re("select",{onChange:u=>a({e:u,x:c-1,y:d-1}),name:"symbols",class:re({"symbol-selector":!0})},[h[2]||(h[2]=Ki('<option value="2" selected="selected" data-v-c77a8b52></option><option value="3" data-v-c77a8b52></option><option value="4" data-v-c77a8b52></option><option value="5" data-v-c77a8b52></option><option value="6" data-v-c77a8b52></option><option value="7" data-v-c77a8b52></option>',6)),c>1?(ie(),Re("option",lP,"")):bb("",!0)],40,aP))),256))]))),256))]),Nt(Qs,{class:"instruction-text",maximalWidth:220,maximalHeight:20,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.instructionText),1)]),_:1}),Nt(Qs,{onClick:h[0]||(h[0]=c=>l()),class:"button",maximalWidth:120,maximalHeight:20,layoutX:"center",layoutY:"middle"},{default:Ms(()=>[Js(Ks(s.buttonText),1)]),_:1}),In("div",{onClick:h[1]||(h[1]=c=>e("close")),class:"button-close"},"  ")]))}},cP=es(hP,[["__scopeId","data-v-c77a8b52"]]);let mt;function uP(s){return mt=cR(mP),mt.mount("#"+s),mt}const Qf={components:{Indicator:Ab,Selector:ad,FPSLabel:bR,TextField:Qs,UIPanelBackground:ER,ButtonSpin:CR,ButtonSkip:PR,ButtonSettings:BR,ButtonTurbo:VR,ButtonBet:$R,ButtonAuto:zR,ButtonStopAuto:KR,Overlay:tP,ErrorPopup:sP,PopupSelector:iP,CheatScreen:cP},setup(){mt.FPS=te(0),mt.resolve=void 0,mt.isHidden=te(!0),mt.uiAlpha=te(0),mt.isSpinExpected=te(!1),mt.isSkipExpected=te(!1),mt.activePopupName=te(""),mt.currencyCode=te(""),mt.errorText=te(""),mt.isSimplifiedMode=te(!0),mt.betsOptions=te([]),mt.autoplayOptions=te([]),mt.payout=te(0),mt.balance=te(0),mt.betIndex=te(0),mt.isTurboMode=te(!1),mt.remainingAutoSpinsCount=te(0),mt.dictionary=te({}),mt.refresh=h=>{for(const[c,d]of Object.entries(h))mt[c].value=d},mt.getUserInput=()=>new Promise(h=>{mt.resolve=h}),fo(mt.isSimplifiedMode,h=>{!h&&mt.activePopupName.value==="bet"&&(mt.activePopupName.value="")}),fo(mt.betIndex,h=>{a.value.setSelectedIndex(h),o.value.setSelectedIndex(h)});function s(){Gl(()=>mt.activePopupName.value="")}function t(h){var c;(c=mt.resolve)==null||c.call(mt,h),mt.resolve=void 0}function e(h){t(h),s()}function n(){var h;mt.isTurboMode.value=!mt.isTurboMode.value,(h=mt.onTurboToggle)==null||h.call(mt,mt.isTurboMode.value)}function i(h){var c;mt.remainingAutoSpinsCount.value=h,(c=mt.onAutoplaySpinsCountChange)==null||c.call(mt,h)}function r(){var h;(h=mt.onSkipRequested)==null||h.call(mt),mt.isSkipExpected.value=!1}const a=te(null),l=te(null),o=te(null);return{FPS:mt.FPS,resolve:t,resolveAndClosePopups:e,isHidden:mt.isHidden,uiAlpha:mt.uiAlpha,isSpinExpected:mt.isSpinExpected,isSkipExpected:mt.isSkipExpected,activePopupName:mt.activePopupName,currencyCode:mt.currencyCode,errorText:mt.errorText,isSimplifiedMode:mt.isSimplifiedMode,betsOptions:mt.betsOptions,autoplayOptions:mt.autoplayOptions,remainingAutoSpinsCount:mt.remainingAutoSpinsCount,payout:mt.payout,balance:mt.balance,betIndex:mt.betIndex,isTurboMode:mt.isTurboMode,dictionary:mt.dictionary,closeAllPopups:s,toggleTurbo:n,setRemainingAutoSpinsCount:i,skip:r,betSelector:a,lineSelector:l,popupBetSelector:o}}},Tg=()=>{Jf(s=>({"52712b56":s.uiAlpha,"2cebcb82":s.uiAlpha?"100%":0}))},Ag=Qf.setup;Qf.setup=Ag?(s,t)=>(Tg(),Ag(s,t)):Tg;const dP={class:"ui-container"};function fP(s,t,e,n,i,r){const a=hs("UIPanelBackground"),l=hs("Indicator"),o=hs("Selector"),h=hs("ButtonSpin"),c=hs("ButtonSkip"),d=hs("ButtonSettings"),u=hs("ButtonTurbo"),f=hs("ButtonBet"),m=hs("ButtonAuto"),p=hs("ButtonStopAuto"),g=hs("Overlay"),v=hs("ErrorPopup"),b=hs("PopupSelector"),x=hs("CheatScreen"),y=hs("FPSLabel");return ie(),Re("div",dP,[Nt(a,{id:"panelBackground"}),Nt(l,{id:"winIndicator",class:re({decorated:!n.isSimplifiedMode}),width:150,textFieldWidth:120,captionText:n.dictionary.win+" ("+n.currencyCode+")",indicatorValue:n.payout},null,8,["class","captionText","indicatorValue"]),Nt(l,{id:"balanceIndicator",class:re({decorated:!n.isSimplifiedMode}),width:150,textFieldWidth:120,captionText:n.dictionary.balance+" ("+n.currencyCode+")",indicatorValue:n.balance},null,8,["class","captionText","indicatorValue"]),Nt(o,{id:"betSelector",ref:"betSelector",onSelected:t[0]||(t[0]=w=>n.resolve({key:"change_bet",value:w})),isDecorated:!n.isSimplifiedMode,class:re({decorated:!n.isSimplifiedMode,disabled:!n.isSimplifiedMode&&!n.isSpinExpected}),width:150,textFieldWidth:n.isSimplifiedMode?120:70,captionText:n.dictionary.bet+" ("+n.currencyCode+")",selectableValues:n.betsOptions},null,8,["isDecorated","class","textFieldWidth","captionText","selectableValues"]),Nt(h,{onClick:t[1]||(t[1]=()=>n.resolve({key:"make_bet"})),class:re({disabled:!n.isSpinExpected}),id:"spinButton"},null,8,["class"]),Hl(Nt(c,{onClick:t[2]||(t[2]=w=>n.skip()),class:re({disabled:!n.isSkipExpected,hidden:n.isSpinExpected}),id:"skipButton"},null,8,["class"]),[[Zl,!n.isSpinExpected]]),Nt(d,{class:re({disabled:!n.isSpinExpected}),onClick:t[3]||(t[3]=w=>n.activePopupName="cheats"),id:"settingsButton"},null,8,["class"]),Nt(u,{class:re({active:n.isTurboMode}),onClick:t[4]||(t[4]=w=>n.toggleTurbo()),id:"turboButton"},null,8,["class"]),Nt(f,{class:re({disabled:!n.isSpinExpected,hidden:!n.isSimplifiedMode}),onClick:t[5]||(t[5]=w=>n.activePopupName="bet"),id:"betButton"},null,8,["class"]),Nt(m,{class:re({disabled:!n.isSpinExpected||n.remainingAutoSpinsCount}),id:"autoButton",onClick:t[6]||(t[6]=w=>n.activePopupName="autoplay")},null,8,["class"]),Nt(p,{class:re({hidden:!n.remainingAutoSpinsCount}),id:"stopAutoButton",onClick:t[7]||(t[7]=w=>n.setRemainingAutoSpinsCount(0))},{default:Ms(()=>[Js(Ks(n.remainingAutoSpinsCount),1)]),_:1},8,["class"]),Nt(g,{onClick:t[8]||(t[8]=w=>n.closeAllPopups()),class:re({hidden:!n.activePopupName&&!n.errorText}),id:"overlay"},null,8,["class"]),Nt(v,{class:re({hidden:!n.errorText&&!n.activePopupName.includes("error")}),onClose:t[9]||(t[9]=w=>n.errorText=""),messageText:n.errorText,buttonText:n.dictionary.ok,id:"errorPopup"},null,8,["class","messageText","buttonText"]),Nt(b,{class:re({hidden:!n.activePopupName.includes("autoplay")}),onClose:t[10]||(t[10]=w=>n.closeAllPopups()),onConfirm:t[11]||(t[11]=w=>{n.setRemainingAutoSpinsCount(n.autoplayOptions[w]-1),n.resolveAndClosePopups({key:"make_bet"})}),messageText:n.dictionary.select_autoplay,buttonText:n.dictionary.start,selectableValues:n.autoplayOptions,id:"autoplayPopup"},null,8,["class","messageText","buttonText","selectableValues"]),Nt(b,{id:"popupBetSelector",ref:"popupBetSelector",class:re({hidden:!n.activePopupName.includes("bet")}),onSelected:t[12]||(t[12]=w=>n.resolve({key:"change_bet",value:w})),onSelected2:t[13]||(t[13]=w=>n.resolve({key:"change_lines_count",value:w})),onClose:t[14]||(t[14]=w=>n.closeAllPopups()),onConfirm:t[15]||(t[15]=w=>n.resolveAndClosePopups({key:"make_bet"})),messageText:n.dictionary.select_bet,buttonText:n.dictionary.make_bet,selectorIndex:0,selectableValues:n.betsOptions,selectorCaptionText:"("+n.currencyCode+")"},null,8,["class","messageText","buttonText","selectableValues","selectorCaptionText"]),Nt(x,{class:re({hidden:!n.activePopupName.includes("cheats")}),onClose:t[16]||(t[16]=w=>n.closeAllPopups()),onConfirm:t[17]||(t[17]=({reels:w,specialSymbolId:_})=>n.resolveAndClosePopups({key:"make_cheat_bet",value:{reels:w,specialSymbolId:_}})),messageText:n.dictionary.bet+" "+n.betsOptions[n.betIndex]+" ("+n.currencyCode+")",instructionText:n.dictionary.expected_reels,buttonText:n.dictionary.make_bet,id:"cheats"},null,8,["class","messageText","instructionText","buttonText"]),Nt(y,{FPS:n.FPS},null,8,["FPS"])])}const mP=es(Qf,[["render",fP],["__scopeId","data-v-4cdd05f1"]]);class Kc extends os{constructor(){super(...arguments);Y(this,"descriptors",[])}attach(e){let{element:n,name:i="element",offsetX:r=0,offsetY:a=0,scaleFactor:l=1}=e;if(!n)return this;for(const h of this.descriptors)if(h.element===n)return this;const{style:o}=n;return o.removeProperty("right"),o.removeProperty("bottom"),o.removeProperty("transform"),o.position="absolute",o.setProperty("transform-origin","top left"),this.descriptors.push({element:n,name:i,offsetX:r,offsetY:a,scaleFactor:l}),this.adjustToTargetArea(),this}deleteItem(){var i;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"element";const n=(i=this.getDescriptor(e))==null?void 0:i.element;n&&(this.detach(n),n==null||n.remove())}detach(e){for(let n=0;n<this.descriptors.length;n++)if(this.descriptors[n].element===e){this.descriptors.splice(n,1);break}return this}adjustToTargetArea(){return super.adjustToTargetArea(),this.descriptors.forEach(e=>{let{element:n,offsetX:i,offsetY:r,scaleFactor:a}=e;const{style:l}=n;l.transform=`
				scaleX(${this.scale.x*a})
				scaleY(${this.scale.y*a})
				translateX(${i}px)
				translateY(${r}px)`,l.left=this.x+"px",l.top=this.y+"px"}),this}getDescriptor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"element";for(const n of this.descriptors)if(n.name===e)return n;return null}getHTMLElement(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"element";return(n=this.getDescriptor(e))==null?void 0:n.element}setElementVisible(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"element",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=this.getHTMLElement(e);return i?(i.style.display=n?"block":"none",this):this}translateElement(e){let{name:n,x:i,y:r}=e;const a=this.getDescriptor(n);return a&&(a.offsetX=i??a.offsetX,a.offsetY=r??a.offsetY),this}scaleElement(e){let{name:n,scaleFactor:i=1}=e;const r=this.getDescriptor(n);return r&&(r.scaleFactor=i),this.adjustToTargetArea()}}class pP extends os{constructor(e){let{vueContext:n,isMobileDevice:i}=e;super();Y(this,"vueContext");Y(this,"isMobileDevice");this.isMobileDevice=i,this.vueContext=n,this.popupsContainer=this.addChild(new Kc).setSourceArea({width:300,height:250}),["errorPopup","autoplayPopup","popupBetSelector","cheats"].forEach(r=>{this.popupsContainer.attach({name:r,element:document.getElementById(r)})}),this.buttonsGroupContainer=this.addChild(new Kc),this.buttonsGroupContainer.eventMode="none",["spinButton","skipButton","settingsButton","turboButton","betButton","autoButton","stopAutoButton","riskButton"].forEach(r=>{this.buttonsGroupContainer.attach({name:r,element:document.getElementById(r)})}),["panelBackground","winIndicator","balanceIndicator","betSelector","lineSelector","overlay"].forEach(r=>{this[r]=this.addChild(new Kc).attach({name:"element",element:document.getElementById(r)}),this[r].eventMode="none"}),this.overlay.setTargetArea({x:0,y:0,width:1,height:1}).setSourceArea({width:100,height:100}).stretchHorizontally().stretchVertically()}updateTargetArea(e){const{panelBackground:n,winIndicator:i,balanceIndicator:r,betSelector:a,lineSelector:l,buttonsGroupContainer:o,popupsContainer:h,isMobileDevice:c}=this;if(e>1.25&&!c)this.vueContext.isSimplifiedMode.value=!1,n.setSourceArea({width:200,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).stretchVertically().stretchHorizontally(),o.stickCenter().stickTop().setSourceArea({width:1e3,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"settingsButton",x:20,y:5}).translateElement({name:"spinButton",x:465,y:-20}).translateElement({name:"skipButton",x:465,y:-20}).translateElement({name:"turboButton",x:410,y:5}).translateElement({name:"autoButton",x:540,y:5}).translateElement({name:"stopAutoButton",x:540,y:5}).translateElement({name:"riskButton",x:1090,y:-75}).scaleElement({name:"riskButton",scaleFactor:.6}),i.stickCenter().stickTop().setSourceArea({width:1e3,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:625,y:5}),r.stickCenter().stickTop().setSourceArea({width:1e3,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:815,y:5}),a.stickCenter().stickTop().setSourceArea({width:1e3,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:250,y:5}),l.stickCenter().stickTop().setSourceArea({width:1e3,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:90,y:5}).setElementVisible(),h.setTargetArea({x:.3,y:.25,width:.4,height:.5});else if(e>1.25&&c){const d=c?.2:.1;this.vueContext.isSimplifiedMode.value=!0,n.setSourceArea({width:200,height:60}).setTargetArea({x:0,y:1-d,width:1,height:d}).stretchVertically().stretchHorizontally(),o.stickRight().stickMiddle().setSourceArea({width:75,height:700}).setTargetArea(c?{x:.75,y:-.555,width:.25,height:2}:{x:.75,y:0,width:.25,height:1}).translateElement({name:"betButton",x:20,y:197}).translateElement({name:"autoButton",x:20,y:250}).translateElement({name:"stopAutoButton",x:20,y:250}).translateElement({name:"spinButton",x:-10,y:300}).translateElement({name:"skipButton",x:-10,y:300}).translateElement({name:"turboButton",x:20,y:370}).translateElement({name:"settingsButton",x:20,y:423}).translateElement({name:"riskButton",x:-150,y:335}).scaleElement({name:"riskButton",scaleFactor:.6}),l.setElementVisible("element",!1),a.stickLeft().stickMiddle().setSourceArea({width:600,height:60}).setTargetArea({x:0,y:1-d,width:1,height:d}).translateElement({name:"element",x:20,y:5}),i.stickCenter().stickMiddle().setSourceArea({width:600,height:60}).setTargetArea({x:0,y:1-d,width:1,height:d}).translateElement({name:"element",x:225,y:5}),r.stickRight().stickMiddle().setSourceArea({width:600,height:60}).setTargetArea({x:0,y:1-d,width:1,height:d}).translateElement({name:"element",x:430,y:5}),this.popupsContainer.setTargetArea({x:.2,y:.025,width:.6,height:.825})}else this.vueContext.isSimplifiedMode.value=!0,n.setSourceArea({width:200,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).stretchVertically().stretchHorizontally(),o.stickCenter().stickBottom().setSourceArea({width:400,height:150}).setTargetArea({x:0,y:.65,width:1,height:.25}).translateElement({name:"settingsButton",x:25,y:95}).translateElement({name:"turboButton",x:95,y:95}).translateElement({name:"spinButton",x:166,y:75}).translateElement({name:"skipButton",x:166,y:75}).translateElement({name:"autoButton",x:255,y:95}).translateElement({name:"stopAutoButton",x:255,y:95}).translateElement({name:"betButton",x:325,y:95}).translateElement({name:"riskButton",x:257,y:60}).scaleElement({name:"riskButton",scaleFactor:.6}),l.setElementVisible("element",!1),a.stickLeft().stickTop().setSourceArea({width:400,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:0,y:5}),i.stickCenter().stickTop().setSourceArea({width:400,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:125,y:5}),r.stickRight().stickTop().setSourceArea({width:400,height:60}).setTargetArea({x:0,y:.9,width:1,height:.1}).translateElement({name:"element",x:250,y:5}),this.popupsContainer.setTargetArea({x:.05,y:0,width:.9,height:1})}}class gP extends os{constructor(e,n){super();Y(this,"timeline",(()=>new We)());Y(this,"progressMaskView");Y(this,"barContainer");Y(this,"captionView");this.setSourceArea({width:949,height:603}),this.initBar(e),this.initCaption(n),this.setProgress(0)}initBar(e){const n=this.addChild(new Mt);n.addChild(new ve(e.progress_bar_frame)).position.set(140,155);const i=n.addChild(new ve(e.progress_bar));this.progressMaskView=n.addChild(new Fn).beginFill(16711680,.5).drawRect(0,0,633,400).endFill(),this.progressMaskView.x=163,i.mask=this.progressMaskView,i.position.set(167,182),n.y=200,this.barContainer=n}initCaption(e){const n=new xi({maximalWidth:949,maximalHeight:200}).setFontName("default").setFontSize(60).setText(e.loading_bmp).setAlignCenter().setAlignMiddle().setFontColor(65535);n.pivot.set(949/2,200/2),n.position.set(n.pivot.x,n.pivot.y+185),this.captionView=this.addChild(n),this.timeline.addAnimation({duration:1500,onProgress:i=>{n.scale.set(1,1+.1*(1-i)*Math.cos(Math.PI*2*(i*5%1)))}}).setLoopMode().play()}updateTargetArea(e){e>1?this.setTargetArea({x:.25,y:.25,width:.5,height:.5}):this.setTargetArea({x:.05,y:.25,width:.9,height:.5})}setProgress(e){this.progressMaskView.scale.x=e}destroy(){super.destroy(!0),this.timeline.destroy()}}class xP extends os{constructor(e,n){super();Y(this,"backgroundView");Y(this,"progressBarView");Y(this,"overlayView");this.initBackground(),this.initProgressBar(e,n),os.onResize()}initBackground(){const e=this.addChild(new os).setTargetArea({x:0,y:0,width:1,height:1}).setSourceArea({width:100,height:100}).highlight(2039644,1).stretchHorizontally().stretchVertically();this.backgroundView=e}initProgressBar(e,n){this.progressBarView=new gP(e,n),this.addChild(this.progressBarView)}initLogo(e){this.addChild(new LogoView(e))}setProgress(e){this.progressBarView.setProgress(e)}async hide(e){const n=new We().addAnimation({duration:1e3,onProgress:i=>{this.progressBarView.alpha=1-i,this.alpha=1-i,e(i)}});await n.play(),this.progressBarView.destroy(),n.destroy()}}const yP=750;function bP(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}async function vP(s){if(await new Promise(i=>{setTimeout(()=>i(),1e3)}),bP())return .75;const t=performance.now(),e=s.stage.addChild(new Mt);for(let i=0;i<1e5;i++)e.addChild(new Fn).beginFill(65280,.5).drawRect(0,0,1e3,1e3).beginFill();e.destroy();const n=performance.now()-t;return Math.min(1,yP/n)}class wP extends os{constructor(){super(),this.setTargetArea({x:0,y:0,width:1,height:1}).setSourceArea({width:100,height:100}).stretchHorizontally().stretchVertically().highlight(0,.001),this.on("pointerdown",()=>{var t;(t=this.onClick)==null||t.call(this),this.setInteractive(!1)})}setInteractive(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.eventMode=t?"static":"none",this.cursor=t?"pointer":"default"}onClick(){}}class _P extends Mt{constructor(e){super();Y(this,"contentContainer");Y(this,"framesViews");Y(this,"currentFrameView");const n=this.addChild(new Mt);this.framesViews=new Array(10).fill(0).map((i,r)=>{const a=e["coin_frame_"+r],l=new ve(a);return l.anchor.set(.5),l.visible=!1,n.addChild(l)}),this.setFlipProgress(),this.contentContainer=n}setFlipProgress(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.currentFrameView&&(this.currentFrameView.visible=!1);const n=Math.trunc(e*9);this.currentFrameView=this.framesViews[n],this.currentFrameView.visible=!0}setScale(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.contentContainer.scale.set(e)}setRotation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.contentContainer.rotation=e}}class EP extends Mt{constructor(e,n){super();Y(this,"contentContainer");this.contentContainer=this.addChild(new Mt);const i=new ve(e["symbol_"+(n+1)+"_0"]);i.anchor.set(.5),this.contentContainer.addChild(i)}setScale(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.contentContainer.scale.set(e)}setRotation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.contentContainer.rotation=e}}const Cg=[{x:200,delay:0,duration:1e3,scale:.65},{x:400,delay:500,duration:1e3,scale:.65},{x:800,delay:300,duration:1e3,scale:.65},{x:800,delay:300,duration:1e3,scale:.65},{x:160,delay:100,duration:600,scale:1,gemType:0},{x:860,delay:400,duration:550,scale:1,gemType:1},{x:75,delay:0,duration:700,scale:1,gemType:2},{x:650,delay:750,duration:800,scale:.75,gemType:3},{x:750,delay:150,duration:860,scale:.5,gemType:4},{x:250,delay:100,duration:760,scale:.5,gemType:5},{x:50,delay:0,duration:500,scale:1},{x:250,delay:300,duration:500,scale:1},{x:500,delay:100,duration:500,scale:1},{x:700,delay:0,duration:450,scale:1},{x:900,delay:300,duration:450,scale:1}];class SP extends os{constructor(e){super();Y(this,"timeline",(()=>new We)());Y(this,"gemsViews");this.setSourceArea({width:1e3,height:1e3}).setTargetArea({x:0,y:0,width:1,height:1}).stretchHorizontally().stretchVertically(),this.initGems(e),this.onAdjustedToTargetArea(),this.setProgress()}initGems(e){this.gemsViews=[...Cg.map(n=>{let{scale:i,gemType:r}=n;const a=r===void 0?new _P(e):new EP(e,r);return a.setScale(i),this.addChild(a)})]}setProgress(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;Cg.forEach((n,i)=>{var u;let{delay:r,duration:a,x:l}=n;const o=e*2e3,h=this.gemsViews[i],c=Math.max(0,(o-r)/a)%1,d=Math.abs(Math.sin(Math.PI*1*c));(u=h.setFlipProgress)==null||u.call(h,d),h.setRotation(Math.PI*3*c),h.x=l,h.y=-100+1200*c**2}),this.alpha=Math.min(1,Math.sin(Math.PI*e)*3)}onAdjustedToTargetArea(){const e=Math.min(this.scale.x,this.scale.y)*1.5;this.gemsViews.forEach(n=>{n.scale.set(1/this.scale.x*e,1/this.scale.y*e)})}present(){return this.timeline.deleteAllAnimations().addAnimation({duration:2500,onProgress:e=>this.setProgress(e)}).play()}}function TP(){return navigator.languages!=null?navigator.languages[0]:navigator.language}const AP=["ar","he","fa","ur","sd","ps","yi"],CP="en";async function Mg(s){const t=await pi.load({src:s,loadParser:"loadTxt"});return JSON.parse(t)}async function MP(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:TP(),t={};try{t=await Mg("./translations/"+s+".json")}catch{try{t=await Mg("./translations/"+CP+".json")}catch{}}return{...t,isLTRTextDirection:!AP.includes(s)}}ct.MIPMAP_MODES=tn.ON;class IP{constructor(){Y(this,"assets");Y(this,"pixiApplication");Y(this,"loadingScreen");Y(this,"backgroundView");Y(this,"reelsView");Y(this,"interactiveLayerView");Y(this,"vueContext");Y(this,"remainingAutoSpinsCount",0);Y(this,"isTurboMode");Y(this,"vfxLevel");Y(this,"isMobileDevice");Y(this,"languageCode");Y(this,"dictionary");Y(this,"isLTRTextDirection")}setup(t){let{wrapperHTMLElementId:e,customVFXLevel:n,customUIOption:i,languageCode:r,backgroundColor:a=2039644,dictionary:l}=t;this.dictionary=l,this.languageCode=r,this.vueContext=uP(e),this.pixiApplication=new vd({background:a}),this.vfxLevel=n,this.isMobileDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,i==="mobile"?this.isMobileDevice=!0:i==="desktop"&&(this.isMobileDevice=!1),Object.assign(this.pixiApplication.view.style,{width:"100%",height:"100%",position:"absolute","z-index":1}),document.getElementById(e).appendChild(this.pixiApplication.view),os.install(this.pixiApplication,!0);let o=0;return Oe.shared.add(()=>{We.update();const h=Date.now();h-o<1e3||(o=h,this.vueContext.refresh({FPS:Math.trunc(Oe.shared.FPS)}))}),this}async init(t){let{initialReels:e=io(),currencyCode:n,betsOptions:i,betIndex:r,balance:a,coefficients:l}=t;this.dictionary||(this.dictionary=await MP(this.languageCode),this.isLTRTextDirection=this.dictionary.isLTRTextDirection,xi.isLTRTextDirection=this.isLTRTextDirection);const o=window.devicePixelRatio,h=this.isMobileDevice?Math.min(2,o):1,c=o-h;if(this.vfxLevel)this.pixiApplication.renderer.resolution=this.vfxLevel;else{const u=await vP(this.pixiApplication);this.pixiApplication.renderer.resolution=h+c*u,this.vfxLevel=u}const{stage:d}=this.pixiApplication;this.assets=await IA(),this.initBitmapFonts(),this.initLoadingScreen(),os.onResize(),this.assets=await RA(u=>{this.loadingScreen.setProgress(u)}),this.initBackground(),this.initReels({initialReels:e,coefficients:l}),this.initCoinRain(this.assets),this.initVueUIContainer(),d.addChild(this.loadingScreen),this.initInteractiveLayer(),os.onResize(),await this.reelsView.preRenderSymbols(),this.vueContext.refresh({dictionary:this.dictionary,currencyCode:n,betsOptions:i.map(u=>Gs(u)),autoplayOptions:[5,10,25,50,100,1/0],balance:Gs(a),payout:Gs(0),betIndex:r}),await this.loadingScreen.hide(u=>{this.vueContext.refresh({uiAlpha:u})}),this.loadingScreen.destroy(),this.vueContext.onAutoplaySpinsCountChange=u=>{this.remainingAutoSpinsCount=u},this.vueContext.onTurboToggle=u=>{this.gamePlayTimeScale=u?Vp:1,this.isTurboMode=u,this.setGamePlayTimeScale()},this.vueContext.onSkipRequested=()=>{this.skip()}}initLoadingScreen(){const{pixiApplication:{stage:t},assets:e,dictionary:n}=this;this.loadingScreen=t.addChild(new xP(e,n))}initBackground(){const{pixiApplication:{stage:t},assets:e,isMobileDevice:n}=this;this.backgroundView=t.addChild(new MA(e))}initReels(t){let{initialReels:e,coefficients:n}=t;const{pixiApplication:{stage:i},assets:r,dictionary:a,isMobileDevice:l}=this;this.reelsView=i.addChild(new KC({initialSymbolsIds:e,assets:r,dictionary:a,coefficients:n,isMobileDevice:l}))}initCoinRain(t){const{pixiApplication:{stage:e}}=this;this.coinRainView=new SP(t),e.addChild(this.coinRainView)}initInteractiveLayer(){const{pixiApplication:{stage:t}}=this;this.interactiveLayerView=t.addChild(new wP),this.interactiveLayerView.onClick=()=>{this.skip()}}initVueUIContainer(){const{vueContext:t,isMobileDevice:e,pixiApplication:{stage:n}}=this;n.addChild(new pP({vueContext:t,isMobileDevice:e}))}initBitmapFonts(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];Object.values(this.dictionary).forEach(n=>e.push(n)),xi.fontStyles.default={fontFamily:"default",dropShadow:!0,dropShadowDistance:7,dropShadowAngle:Math.PI/2,dropShadowColor:1639493,fontWeight:"bold",fontSize:256,fill:["#FFFFFF","#CCCCCC"]},this.isLTRTextDirection&&gs.from("default",xi.fontStyles.default,{chars:[...new Set([...t.map(n=>{let{name:i}=n;return i}).join("").split(""),...e.join("").split(""),..."0123456789x:,./ABCDEFGHIJKLMNOPQRSTUVWXYZ-|="])]})}destroy(){os.uninstall(),Oe.shared.stop(),this.pixiApplication.stage.destroy(!0),We.destroy()}skip(){this.vueContext.refresh({isSkipExpected:!1}),this.interactiveLayerView.setInteractive(!1),this.reelsView.setInteractive(!1),this.setGamePlayTimeScale(5)}setGamePlayTimeScale(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;const e=this.isTurboMode?Vp:1,n=t*e;this.reelsView.setTimeScale(n)}async getUserInput(t){let{betIndex:e,balance:n,currencyCode:i,bet:r,betsOptions:a,payout:l=0}=t;return this.setGamePlayTimeScale(),this.vueContext.refresh({betIndex:e,balance:Gs(n),betsOptions:a.map(o=>Gs(o)),currencyCode:i,isSpinExpected:!0,isSkipExpected:!1,payout:Gs(l)}),this.interactiveLayerView.setInteractive(!1),this.reelsView.refreshPayoutsInfo(r),this.reelsView.setInteractive(),this.remainingAutoSpinsCount?(this.remainingAutoSpinsCount--,{key:"make_bet"}):this.vueContext.getUserInput()}async presentSpinStart(t){let{balance:e,commonPayout:n}=t;const{reelsView:i,dictionary:r}=this,a=!1,l=Gs(n??0);return this.vueContext.refresh({activePopupName:"",remainingAutoSpinsCount:this.remainingAutoSpinsCount,isSpinExpected:!1,isSkipExpected:a,balance:Gs(e),payout:l}),this.setGamePlayTimeScale(),this.interactiveLayerView.setInteractive(a),i.setInteractive(!1),i.presentSpinStart()}presentSpinStop(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:io();return this.setGamePlayTimeScale(),this.vueContext.refresh({isSkipExpected:!0}),this.interactiveLayerView.setInteractive(),this.reelsView.setInteractive(!1),this.reelsView.presentSpinStop(t)}presentCascade(t){let{collapses:e,patchMap:n}=t;return this.vueContext.refresh({isSkipExpected:!0}),this.setGamePlayTimeScale(),this.reelsView.presentCascade({collapses:e,patchMap:n})}async presentWin(t){let{payout:e,coefficient:n,commonPayout:i,currencyCode:r}=t;this.setGamePlayTimeScale();const a=Gs(i);this.vueContext.refresh({isSkipExpected:!0,payout:a}),this.interactiveLayerView.setInteractive(),this.reelsView.setInteractive(!1)}presentLose(){}presentTotalWin(t){let{totalCoefficient:e,totalPayout:n,currencyCode:i}=t;if(this.setGamePlayTimeScale(),!(e<5))return this.vueContext.refresh({isSkipExpected:!0,isSpinExpected:!1}),this.interactiveLayerView.setInteractive(),this.coinRainView.present(),this.reelsView.presentBigWin(n,i)}presentError(t){this.setGamePlayTimeScale(),this.remainingAutoSpinsCount=0,this.vueContext.refresh({isSkipExpected:!1,remainingAutoSpinsCount:0,errorText:this.dictionary["error_"+t]??t}),this.interactiveLayerView.setInteractive(!1)}}const tm=new URLSearchParams(document.location.search),RP=tm.get("lang")??"en",PP=tm.get("vfx"),kP=tm.get("view"),FP=window.location.protocol,DP=window.location.hostname,BP=50004,OP=new IP().setup({languageCode:RP,customVFXLevel:PP,customUIOption:kP,wrapperHTMLElementId:"projectWrapper"}),Kr={url:document.serviceURL??FP+"//"+DP+":"+BP+"/",get:s=>fetch(Kr.url+s,{method:"GET",credentials:"include"}).then(t=>t.json()).then(t=>t).catch(t=>({errorCode:-1})),post:function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fetch(Kr.url+s,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>e).catch(e=>({errorCode:-1}))},gameDescription:()=>Kr.get("crystal/gameDescription"),makeBet:s=>Kr.post("crystal/makeBet",s)};new kb({webAPI:Kr,presentation:OP}).init();console.log(Kr);
